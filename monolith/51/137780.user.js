// ==UserScript==
// @name			Facebook - Memes in chat by Ian Wyvern
// @description	                Add memes into your chat on Facebook.
// @description	        Thank you for using my script!
// @include			http://facebook.com/*
// @include			http://*.facebook.com/*
// @include			https://facebook.com/*
// @include			https://*.facebook.com/*
// @exclude			http://*.channel.facebook.com/*
// @exclude			https://*.channel.facebook.com/*
// @author			Ian Wyvern
// @version			0.99
// @versionnumber	0.99
// ==/UserScript==
//


	var version, storage, spemotsInfo, spemotsTitle, headTag, styleTag, ArrowStyleUp, ArrowStyleDown, fEmotBarDom, fEmotsListDom, fArrow;

	version = 2;
	


	storage = 'none';

	try {
		if (typeof GM_getValue === 'function' && typeof GM_setValue === 'function') {
			GM_setValue('testkey', 'testvalue');
			if (GM_getValue('testkey', false) === 'testvalue') { storage='greasemonkey'; }
		}
	} catch(x) {}
	if (storage=='none' && typeof localStorage == 'object') { storage='localstorage'; }

	function setValue(key, value) {
		switch (storage) {
			case 'greasemonkey':
				GM_setValue('0-'+key, value);
				break;
			case 'localstorage':
				localStorage['femotbar-0-'+key] = value;
				break;
		}
	}

	function getValue(key, value) {
		switch (storage) {
			case 'greasemonkey':
				return GM_getValue('0-'+key, value);
			case 'localstorage':
				var val = localStorage['femotbar-0-'+key];
				if (val=='true') { return true; }
				else if (val=='false') { return false; }
				else if (val) { return val; }
				break;
		}
		return value;
	}
	
	function xmlhttpRequest(params, callBack) {
		if (typeof GM_xmlhttpRequest !== 'undefined') {
			params['onload'] = callBack;
			return GM_xmlhttpRequest(params);
		}
		return null;
	}

	function openInTab(url) {
		if (typeof GM_openInTab !== 'undefined') { GM_openInTab(url); }
		else { window.open(url); }
	}

	
	

	function createSelection(field, start, end) {
		if( field.createTextRange ) {
			var selRange = field.createTextRange();
			selRange.collapse(true);
			selRange.moveStart('character', start);
			selRange.moveEnd('character', end);
			selRange.select();
		} else if( field.setSelectionRange ) {
			field.setSelectionRange(start, end);
		} else if( field.selectionStart ) {
			field.selectionStart = start;
			field.selectionEnd = end;
		}
		field.focus();
	}       
	
	function getCursorPosition(field) {
		var CursorPos = 0;
		if (field.selectionStart || field.selectionStart == '0') CursorPos = field.selectionStart;
		return (CursorPos);
	}
	

	
	var mean = 
'[[487645741266039]][[487645731266040]][[487645727932707]][[487645734599373]][[487645737932706]]\n'+
'[[487645824599364]][[487645821266031]][[487645814599365]][[487645817932698]][[487645827932697]]\n'+
'[[487645911266022]][[487645907932689]][[487645914599355]][[487645904599356]][[487645917932688]]\n'+
'[[487646001266013]][[487645997932680]][[487645987932681]][[487645991266014]][[487646004599346]]\n'+
'[[487646271265986]][[487646254599321]][[487646261265987]][[487646251265988]][[487646247932655]]'
var feellikeasir = '[[336963796401733]][[336963789735067]][[336963799735066]][[336963793068400]][[336963786401734]][[336963883068391]]\n'+
'[[336963876401725]][[336963886401724]][[336963879735058]][[336963889735057]][[336963976401715]][[336963969735049]]\n'+
'[[336963979735048]][[336963973068382]][[336963966401716]][[336964049735041]][[336964043068375]][[336964046401708]]\n'+
'[[336964056401707]][[336964053068374]][[336964176401695]][[336964173068362]][[336964183068361]][[336964179735028]]\n'+
'[[336964169735029]][[336964259735020]][[336964269735019]][[336964273068352]][[336964276401685]][[336964263068353]]'
var lol = 
'[[324818360907766]][[324818364241099]][[324818357574433]][[324818354241100]][[324818367574432]]\n'+ 
'[[324818494241086]][[324818480907754]][[324818490907753]][[324818484241087]][[324818487574420]]\n'+ 
'[[324818560907746]][[324818557574413]][[324818567574412]][[324818564241079]][[324818570907745]]\n'+ 
'[[324818667574402]][[324818654241070]][[324818660907736]][[324818664241069]][[324818657574403]]\n'+ 
'[[324818767574392]][[324818774241058]][[324818777574391]][[324818764241059]][[324818770907725]]\n'+ 
'[[324818857574383]][[324818867574382]][[324818850907717]][[324818860907716]][[324818864241049]]' 
var fuckyeah = 
'[[324816030907999]][[324816020908000]][[324816024241333]][[324816017574667]][[324816027574666]][[324816147574654]]\n'+
'[[324816137574655]][[324816140907988]][[324816134241322]][[324816144241321]][[324816220907980]][[324816214241314]]\n'+
'[[324816217574647]][[324816224241313]][[324816227574646]][[324816287574640]][[324816297574639]][[324816294241306]]\n'+
'[[324816290907973]][[324816300907972]][[324816384241297]][[324816380907964]][[324816370907965]][[324816374241298]]\n'+
'[[324816367574632]][[324816477574621]][[324816487574620]][[324816484241287]][[324816480907954]][[324816474241288]]\n'+
'[[324816567574612]][[324816564241279]][[324816554241280]][[324816560907946]][[324816557574613]]'
var Asa7by = 
'[[471535116203928]][[471535122870594]][[471535106203929]][[471535126203927]][[471535119537261]]\n'+
'[[471535329537240]][[471535342870572]][[471535326203907]][[471535359537237]][[471535356203904]]\n'+
'[[471535586203881]][[471535542870552]][[471535539537219]][[471535536203886]][[471535532870553]]\n'+
'[[471535789537194]][[471535782870528]][[471535796203860]][[471535806203859]][[471535786203861]]\n'+
'[[471536062870500]][[471536066203833]][[471536059537167]][[471536072870499]][[471536069537166]]\n'+
'[[471536289537144]][[471536292870477]][[471536296203810]][[471536299537143]][[471536306203809]]'
var truestory = 
'[[231611776936196]][[231611780269529]][[231611773602863]][[231611770269530]][[231611766936197]]\n'+
'[[231611896936184]][[231611890269518]][[231611886936185]][[231611900269517]][[231611893602851]]\n'+
'[[231611980269509]][[231611976936176]][[231611983602842]][[231611986936175]][[231611973602843]]\n'+
'[[231612070269500]][[231612066936167]][[231612080269499]][[231612073602833]][[231612076936166]]\n'+
'[[231612180269489]][[231612183602822]][[231612190269488]][[231612176936156]][[231612186936155]]'
var nothing = '[[380956931928003]][[380956945261335]][[380956938594669]][[380956941928002]][[380956935261336]][[380957041927992]]\n'+
'[[380957048594658]][[380957038594659]][[380957045261325]][[380957051927991]][[380957135261316]][[380957141927982]]\n'+
'[[380957145261315]][[380957131927983]][[380957138594649]][[380957208594642]][[380957215261308]][[380957211927975]]\n'+
'[[380957205261309]][[380957201927976]][[380957345261295]][[380957341927962]][[380957338594629]][[380957348594628]]\n'+
'[[380957335261296]][[380957421927954]][[380957425261287]][[380957428594620]][[380957415261288]]'
var dontsay ='[[411119668948562]][[411119678948561]][[411119655615230]][[411119685615227]][[411119675615228]][[411119872281875]]\n'+
'[[411119892281873]][[411119858948543]][[411119865615209]][[411119958948533]][[411120082281854]][[411120088948520]]\n'+
'[[411120085615187]][[411120078948521]][[411120092281853]][[411120302281832]][[411120298948499]][[411120288948500]]\n'+
'[[411120295615166]][[411120315615164]][[411120555615140]][[411120568948472]][[411120562281806]][[411120558948473]]\n'+
'[[411120565615139]][[411120692281793]][[411120685615127]][[411120688948460]][[411120682281794]][[411120678948461]]'
var fap = '[[389747541049822]][[389747537716489]][[389747544383155]][[389747534383156]][[389747531049823]]\n'+
'[[389747657716477]][[389747651049811]][[389747654383144]][[389747647716478]][[389747661049810]]\n'+
'[[389747734383136]][[389747727716470]][[389747737716469]][[389747741049802]][[389747724383137]]\n'+
'[[389747827716460]][[389747824383127]][[389747821049794]][[389747814383128]][[389747817716461]]\n'+
'[[389747931049783]][[389747937716449]][[389747934383116]][[389747944383115]][[389747941049782]]'
var baww = '[[449135841779361]][[449135848446027]][[449135851779360]][[449135838446028]][[449135855112693]]\n'+
'[[449136038446008]][[449136041779341]][[449136048446007]][[449136055112673]][[449136035112675]]\n'+
'[[449136221779323]][[449136211779324]][[449136218445990]][[449136225112656]][[449136228445989]]\n'+
'[[449136295112649]][[449136288445983]][[449136285112650]][[449136298445982]][[449136291779316]]\n'+
'[[449136441779301]][[449136455112633]][[449136448445967]][[449136451779300]][[449136445112634]]\n'+
'[[449136531779292]][[449136535112625]][[449136528445959]][[449136538445958]][[449136525112626]]'
var somuch = '[[286164641477632]][[286164648144298]][[286164638144299]][[286164654810964]][[286164644810965]][[286164868144276]]\n'+
'[[286164854810944]][[286164864810943]][[286164858144277]][[286164861477610]][[286165031477593]][[286165028144260]]\n'+
'[[286165034810926]][[286165038144259]][[286165041477592]][[286165211477575]][[286165218144241]][[286165204810909]]\n'+
'[[286165208144242]][[286165221477574]][[286165328144230]][[286165341477562]][[286165338144229]][[286165334810896]]\n'+
'[[286165331477563]][[286165414810888]][[286165421477554]][[286165418144221]][[286165428144220]][[286165424810887]]\n'+
'[[286165508144212]][[286165514810878]][[286165511477545]][[286165518144211]][[286165504810879]][[286165591477537]]'
var yuno = '[[311066705635860]][[311066708969193]][[311066712302526]][[311066702302527]][[311066698969194]][[311066835635847]]\n'+
'[[311066825635848]][[311066828969181]][[311066832302514]][[311066822302515]][[311066912302506]][[311066905635840]]\n'+
'[[311066915635839]][[311066908969173]][[311066918969172]][[311066985635832]][[311066975635833]][[311066988969165]]\n'+
'[[311066982302499]][[311066978969166]][[311067125635818]][[311067122302485]][[311067128969151]][[311067132302484]]\n'+
'[[311067118969152]][[311067205635810]][[311067195635811]][[311067198969144]][[311067208969143]][[311067202302477]]'
var inglip ='[[322783667782163]][[322783677782162]][[322783671115496]][[322783681115495]][[322783674448829]][[322783787782151]]\n'+
'[[322783777782152]][[322783791115484]][[322783784448818]][[322783781115485]][[322783877782142]][[322783881115475]]\n'+
'[[322783871115476]][[322783874448809]][[322783867782143]][[322783951115468]][[322783944448802]][[322783947782135]]\n'+
'[[322783937782136]][[322783941115469]][[322784034448793]][[322784031115460]][[322784041115459]][[322784044448792]]\n'+
'[[322784037782126]][[322784111115452]][[322784104448786]][[322784114448785]][[322784117782118]][[322784107782119]]\n'+
'[[322784194448777]][[322784204448776]][[322784191115444]][[322784201115443]][[322784197782110]]'
var pokerface =
'[[436123243114871]][[436123236448205]][[436123233114872]][[436123246448204]]\n'+
'[[436123239781538]][[436123323114863]][[436123319781530]][[436123316448197]]\n'+
'[[436123313114864]][[436123326448196]][[436123426448186]][[436123423114853]]\n'+
'[[436123419781520]][[436123416448187]][[436123429781519]][[436123506448178]]\n'+
'[[436123516448177]][[436123513114844]][[436123519781510]][[436123523114843]]\n'+
'[[436123643114831]][[436123646448164]][[436123649781497]][[436123653114830]]\n'+
'[[436123639781498]][[436123733114822]][[436123726448156]][[436123729781489]]'
var miradafija = '[[416882258335470]][[416882271668802]][[416882268335469]][[416882261668803]][[416882265002136]][[416882385002124]]\n'+
'[[416882391668790]][[416882381668791]][[416882398335456]][[416882388335457]][[416882471668782]][[416882481668781]]\n'+
'[[416882485002114]][[416882475002115]][[416882478335448]][[416882565002106]][[416882568335439]][[416882578335438]]\n'+
'[[416882575002105]][[416882571668772]][[416882665002096]][[416882658335430]][[416882668335429]][[416882661668763]]\n'+
'[[416882655002097]][[416882735002089]][[416882728335423]][[416882731668756]][[416882741668755]][[416882738335422]]'
var ilied ='[[411142455612950]][[411142458946283]][[411142452279617]][[411142448946284]][[411142462279616]][[411142592279603]]\n'+
'[[411142598946269]][[411142595612936]][[411142588946270]][[411142602279602]][[411142722279590]][[411142725612923]]\n'+
'[[411142728946256]][[411142735612922]][[411142732279589]][[411142855612910]][[411142858946243]][[411142848946244]]\n'+
'[[411142845612911]][[411142852279577]][[411143108946218]][[411143098946219]][[411143102279552]][[411143105612885]]\n'+
'[[411143112279551]][[411143355612860]][[411143352279527]][[411143345612861]][[411143348946194]][[411143362279526]]'
var plz ='[[340078549419574]][[340078632752899]][[340078622752900]][[340078552752907]][[340078546086241]][[340079016086194]]\n'+
'[[340078982752864]][[340079002752862]][[340079009419528]][[340079019419527]][[340079216086174]][[340079219419507]]\n'+
'[[340079229419506]][[340079226086173]][[340079232752839]][[340079369419492]][[340079359419493]][[340079362752826]]\n'+
'[[340079366086159]][[340079376086158]][[340079819419447]][[340079816086114]][[340079839419445]][[340079812752781]]\n'+
'[[340079822752780]][[340080022752760]][[340080036086092]][[340080032752759]][[340080029419426]][[340080026086093]]'
var hitler = '[[364099893634444]][[364099910301109]][[364099926967774]][[364099933634440]][[364099953634438]]\n'+
'[[364099966967770]][[364099980301102]][[364099993634434]][[364100006967766]][[364100013634432]]\n'+
'[[364100023634431]][[364100033634430]][[364100050301095]][[364100070301093]][[364100086967758]]\n'+
'[[364100093634424]][[364100110301089]][[364100126967754]][[364100140301086]][[364100200301080]]\n'+
'[[364100213634412]][[364100223634411]][[364100230301077]][[364100243634409]][[364100250301075]]\n'+
'[[364100260301074]][[364100266967740]][[364100276967739]][[364100286967738]][[364100300301070]]'
  var hardcore = '[[259970010762373]][[259970014095706]][[259970017429039]][[259970024095705]][[259970020762372]][[259970154095692]][[259970167429024]]\n'+
'[[259970157429025]][[259970160762358]][[259970170762357]][[259970234095684]][[259970237429017]][[259970244095683]][[259970240762350]]\n'+
'[[259970247429016]][[259970310762343]][[259970317429009]][[259970324095675]][[259970320762342]][[259970327429008]][[259970424095665]]\n'+
'[[259970417428999]][[259970420762332]][[259970430762331]][[259970427428998]][[259970487428992]][[259970500762324]][[259970494095658]]\n'+
'[[259970490762325]][[259970497428991]][[259970574095650]][[259970577428983]][[259970584095649]][[259970587428982]][[259970580762316]]'
  var worthit = '[[239245462840234]][[239245459506901]][[239245466173567]][[239245469506900]]\n'+
'[[239245456173568]][[239245589506888]][[239245582840222]][[239245576173556]]\n'+
'[[239245586173555]][[239245579506889]][[239245659506881]][[239245666173547]]\n'+
'[[239245662840214]][[239245652840215]][[239245669506880]][[239245749506872]]\n'+
'[[239245746173539]][[239245736173540]][[239245742840206]][[239245739506873]]\n'+
'[[239245852840195]][[239245849506862]][[239245846173529]][[239245842840196]]'
  var bitchplease = '[[393242404033669]][[393242400700336]][[393242414033668]][[393242410700335]]\n'+
'[[393242407367002]][[393242547366988]][[393242560700320]][[393242557366987]]\n'+
'[[393242550700321]][[393242544033655]][[393242670700309]][[393242677366975]]\n'+
'[[393242680700308]][[393242684033641]][[393242674033642]][[393242864033623]]\n'+
'[[393242857366957]][[393242850700291]][[393242854033624]][[393242847366958]]'
  var potato = '[[355161337863812]][[355161344530478]][[355161341197145]][[355161334530479]][[355161347863811]][[355161451197134]][[355161454530467]]\n'+
'[[355161457863800]][[355161467863799]][[355161471197132]][[355161541197125]][[355161537863792]][[355161547863791]][[355161544530458]]\n'+
'[[355161551197124]][[355161637863782]][[355161634530449]][[355161641197115]][[355161624530450]][[355161627863783]][[355161741197105]]\n'+
'[[355161751197104]][[355161747863771]][[355161744530438]][[355161754530437]][[355161824530430]][[355161817863764]][[355161831197096]]\n'+
'[[355161827863763]][[355161821197097]][[355161911197088]][[355161921197087]][[355161924530420]][[355161914530421]][[355161927863753]]'
 var stopyou = '[[390771627613200]][[390771630946533]][[390771637613199]][[390771624279867]][[390771634279866]][[390771734279856]]\n'+
'[[390771737613189]][[390771747613188]][[390771744279855]][[390771740946522]][[390771807613182]][[390771824279847]]\n'+
'[[390771814279848]][[390771817613181]][[390771820946514]][[390771910946505]][[390771900946506]][[390771914279838]]\n'+
'[[390771904279839]][[390771907613172]][[390771997613163]][[390772004279829]][[390772010946495]][[390772007613162]]\n'+
'[[390772000946496]][[390772064279823]][[390772067613156]][[390772074279822]][[390772077613155]][[390772070946489]]'
 var notbad = '[[239289962835784]][[239289956169118]][[239289949502452]][[239289959502451]][[239289952835785]]\n'+
'[[239290072835773]][[239290066169107]][[239290076169106]][[239290079502439]][[239290069502440]]\n'+
'[[239290159502431]][[239290162835764]][[239290152835765]][[239290156169098]][[239290149502432]]\n'+
'[[239290249502422]][[239290252835755]][[239290236169090]][[239290239502423]][[239290246169089]]\n'+
'[[239290352835745]][[239290359502411]][[239290356169078]][[239290362835744]][[239290366169077]]'
 var badluck = '[[330214790365071]][[330214793698404]][[330214800365070]][[330214797031737]][[330214803698403]]\n'+
'[[330214907031726]][[330214910365059]][[330214903698393]][[330214900365060]][[330214897031727]]\n'+
'[[330214967031720]][[330214973698386]][[330214970365053]][[330214980365052]][[330214983698385]]\n'+
'[[330215063698377]][[330215060365044]][[330215057031711]][[330215053698378]][[330215067031710]]\n'+
'[[330215167031700]][[330215180365032]][[330215177031699]][[330215173698366]][[330215170365033]]\n'+
'[[330215250365025]][[330215243698359]][[330215253698358]][[330215247031692]][[330215257031691]]'
 var okay = '[[296238963769967]][[296238960436634]][[296238953769968]][[296238950436635]][[296238957103301]]\n'+
'[[296239070436623]][[296239077103289]][[296239073769956]][[296239080436622]][[296239083769955]]\n'+
'[[296239160436614]][[296239163769947]][[296239170436613]][[296239173769946]][[296239167103280]]\n'+
'[[296239240436606]][[296239243769939]][[296239237103273]][[296239247103272]][[296239250436605]]\n'+
'[[296239363769927]][[296239377103259]][[296239367103260]][[296239373769926]][[296239370436593]]\n'+
'[[296239473769916]][[296239463769917]][[296239460436584]][[296239467103250]][[296239470436583]]'
 var ultragay = '[[390815444275485]][[390815460942150]][[390815454275484]][[390815457608817]][[390815450942151]][[390815634275466]]\n'+
'[[390815637608799]][[390815644275465]][[390815640942132]][[390815647608798]][[390815800942116]][[390815810942115]]\n'+
'[[390815797608783]][[390815807608782]][[390815804275449]][[390815940942102]][[390815944275435]][[390815947608768]]\n'+
'[[390815954275434]][[390815950942101]][[390816090942087]][[390816080942088]][[390816094275420]][[390816084275421]]\n'+
'[[390816087608754]][[390816184275411]][[390816177608745]][[390816167608746]][[390816174275412]][[390816170942079]]\n'+
'[[390816267608736]][[390816270942069]][[390816277608735]][[390816274275402]][[390816284275401]][[390816384275391]]'
var trollface = '[[241123912651649]][[241123915984982]][[241123909318316]][[241123905984983]][[241123902651650]][[241124025984971]]\n'+
'[[241124022651638]][[241124032651637]][[241124029318304]][[241124019318305]][[241124192651621]][[241124199318287]]\n'+
'[[241124189318288]][[241124205984953]][[241124195984954]][[241124325984941]][[241124319318275]][[241124329318274]]\n'+
'[[241124335984940]][[241124345984939]][[241124559318251]][[241124572651583]][[241124565984917]][[241124562651584]]\n'+
'[[241124569318250]][[241124725984901]][[241124712651569]][[241124722651568]][[241124715984902]][[241124719318235]]\n'+
'[[241124785984895]][[241124789318228]][[241124792651561]][[241124795984894]][[241124799318227]][[241124942651546]]'
var pukingrainbows = '[[393321164025793]][[393321150692461]][[393321154025794]][[393321157359127]][[393321160692460]][[393321270692449]]\n'+
'[[393321264025783]][[393321267359116]][[393321274025782]][[393321277359115]][[393321380692438]][[393321384025771]]\n'+
'[[393321374025772]][[393321387359104]][[393321377359105]][[393321460692430]][[393321474025762]][[393321467359096]]\n'+
'[[393321464025763]][[393321470692429]][[393321577359085]][[393321584025751]][[393321587359084]][[393321574025752]]\n'+
'[[393321580692418]][[393321670692409]][[393321667359076]][[393321674025742]][[393321660692410]][[393321664025743]]'
var didthere = '[[290918420968688]][[290918017635395]][[290918024302061]][[290918027635394]][[290918030968727]][[290918117635385]][[290918124302051]]\n'+
'[[290918127635384]][[290918137635383]][[290918140968716]][[290918204302043]][[290918207635376]][[290918210968709]][[290918214302042]]\n'+
'[[290918217635375]][[290918300968700]][[290918294302034]][[290918287635368]][[290918290968701]][[290918297635367]][[290918424302021]]\n'+
'[[290918420968688]][[290918427635354]][[290918430968687]][[290918417635355]][[290918484302015]][[290918487635348]][[290918490968681]]\n'+
'[[290918494302014]][[290918497635347]][[290918600968670]][[290918597635337]][[290918587635338]][[290918594302004]][[290918590968671]]'
var motherofgod = '[[241155412648499]][[241155415981832]][[241155409315166]][[241155419315165]][[241155422648498]][[241155535981820]][[241155542648486]]\n'+
'[[241155545981819]][[241155549315152]][[241155539315153]][[241155619315145]][[241155629315144]][[241155625981811]][[241155632648477]]\n'+
'[[241155622648478]][[241155729315134]][[241155732648467]][[241155722648468]][[241155719315135]][[241155725981801]][[241155835981790]]\n'+
'[[241155839315123]][[241155825981791]][[241155829315124]][[241155832648457]][[241155922648448]][[241155909315116]][[241155905981783]]\n'+
'[[241155912648449]][[241155915981782]][[241155995981774]][[241155992648441]][[241156002648440]][[241156005981773]][[241155999315107]]'
var fuuu = '[[202651026498938]][[202651039832270]][[202651036498937]][[202651029832271]][[202651043165603]][[202651156498925]][[202651159832258]]\n'+
'[[202651166498924]][[202651163165591]][[202651153165592]][[202651223165585]][[202651236498917]][[202651233165584]][[202651226498918]]\n'+
'[[202651229832251]][[202651306498910]][[202651313165576]][[202651309832243]][[202651316498909]][[202651326498908]][[202651443165563]]\n'+
'[[202651449832229]][[202651436498897]][[202651446498896]][[202651439832230]][[202651496498891]][[202651493165558]][[202651499832224]]\n'+
'[[202651506498890]][[202651503165557]][[202651579832216]][[202651583165549]][[202651576498883]][[202651586498882]][[202651589832215]]'
var kiddingme = '[[224133361021814]][[224133351021815]][[224133347688482]][[224133357688481]][[224133354355148]]\n'+
'[[224133464355137]][[224133454355138]][[224133451021805]][[224133461021804]][[224133457688471]]\n'+
'[[224133541021796]][[224133547688462]][[224133544355129]][[224133537688463]][[224133534355130]]\n'+
'[[224133624355121]][[224133621021788]][[224133634355120]][[224133631021787]][[224133627688454]]\n'+
'[[224133717688445]][[224133714355112]][[224133724355111]][[224133711021779]][[224133721021778]]'
var fuckyou = '[[337827499603800]][[337827509603799]][[337827506270466]][[337827502937133]][[337827512937132]]\n'+
'[[337827636270453]][[337827642937119]][[337827639603786]][[337827646270452]][[337827632937120]]\n'+
'[[337827729603777]][[337827732937110]][[337827722937111]][[337827726270444]][[337827736270443]]\n'+
'[[337827799603770]][[337827796270437]][[337827802937103]][[337827792937104]][[337827806270436]]\n'+
'[[337827902937093]][[337827912937092]][[337827906270426]][[337827916270425]][[337827909603759]]'
var dickbutt = '[[337838712936012]][[337838709602679]][[337838716269345]][[337838719602678]][[337838706269346]]\n'+
'[[337838822936001]][[337838829602667]][[337838839602666]][[337838836269333]][[337838832936000]]\n'+
'[[337838936269323]][[337838929602657]][[337838942935989]][[337838939602656]][[337838932935990]]\n'+
'[[337839042935979]][[337839036269313]][[337839039602646]][[337839029602647]][[337839026269314]]\n'+
'[[337839156269301]][[337839162935967]][[337839166269300]][[337839159602634]][[337839169602633]]'
var gtfo = '[[268026366623404]][[268026373290070]][[268026369956737]][[268026376623403]][[268026383290069]][[268026483290059]]\n'+
'[[268026479956726]][[268026493290058]][[268026489956725]][[268026486623392]][[268026563290051]][[268026566623384]]\n'+
'[[268026569956717]][[268026576623383]][[268026579956716]][[268026656623375]][[268026659956708]][[268026646623376]]\n'+
'[[268026649956709]][[268026653290042]][[268026749956699]][[268026746623366]][[268026743290033]][[268026739956700]]\n'+
'[[268026736623367]][[268026833290024]][[268026819956692]][[268026826623358]][[268026829956691]][[268026823290025]]'
var reaction = '[[248735251890515]][[248735245223849]][[248735258557181]][[248735255223848]][[248735248557182]]\n'+
'[[248735351890505]][[248735358557171]][[248735355223838]][[248735365223837]][[248735361890504]]\n'+
'[[248735455223828]][[248735458557161]][[248735451890495]][[248735448557162]][[248735445223829]]\n'+
'[[248735541890486]][[248735531890487]][[248735535223820]][[248735538557153]][[248735545223819]]\n'+
'[[248735675223806]][[248735671890473]][[248735668557140]][[248735665223807]][[248735661890474]]'
var jackson = '[[224450100990140]][[224450094323474]][[224450097656807]][[224450087656808]]\n'+
'[[224450090990141]][[224450274323456]][[224450277656789]][[224450270990123]]\n'+
'[[224450267656790]][[224450264323457]][[224450347656782]][[224450350990115]]\n'+
'[[224450354323448]][[224450344323449]][[224450340990116]][[224450444323439]]\n'+
'[[224450434323440]][[224450440990106]][[224450430990107]][[224450437656773]]\n'+
'[[224450657656751]][[224450647656752]][[224450650990085]][[224450654323418]]'
var soclose = '[[268120616613979]][[268120619947312]][[268120623280645]][[268120626613978]][[268120629947311]]\n'+
'[[268120833280624]][[268120829947291]][[268120826613958]][[268120823280625]][[268120819947292]]\n'+
'[[268120923280615]][[268120913280616]][[268120916613949]][[268120909947283]][[268120919947282]]\n'+
'[[268121003280607]][[268121006613940]][[268121009947273]][[268121016613939]][[268121013280606]]\n'+
'[[268121109947263]][[268121099947264]][[268121096613931]][[268121106613930]][[268121103280597]]'
var megusta = '[[224875517614265]][[224875514280932]][[224875510947599]][[224875507614266]][[224875520947598]]\n'+
'[[224875624280921]][[224875630947587]][[224875620947588]][[224875627614254]][[224875634280920]]\n'+
'[[224875707614246]][[224875704280913]][[224875714280912]][[224875710947579]][[224875717614245]]\n'+
'[[224875790947571]][[224875784280905]][[224875780947572]][[224875797614237]][[224875777614239]]\n'+
'[[224875897614227]][[224875884280895]][[224875890947561]][[224875887614228]][[224875894280894]]'
var badass = '[[431474030212209]][[431474026878876]][[431474020212210]][[431474016878877]][[431474023545543]][[431474146878864]]\n'+
'[[431474160212196]][[431474153545530]][[431474150212197]][[431474156878863]][[431474233545522]][[431474240212188]]\n'+
'[[431474243545521]][[431474246878854]][[431474236878855]][[431474326878846]][[431474313545514]][[431474316878847]]\n'+
'[[431474320212180]][[431474323545513]][[431474443545501]][[431474440212168]][[431474430212169]][[431474436878835]]\n'+
'[[431474446878834]][[431474533545492]][[431474536878825]][[431474530212159]][[431474526878826]][[431474523545493]]'
var challenge = '[[341237112603485]][[341237119270151]][[341237115936818]][[341237109270152]][[341237122603484]][[341237225936807]]\n'+
'[[341237232603473]][[341237229270140]][[341237222603474]][[341237235936806]][[341237322603464]][[341237329270130]]\n'+
'[[341237325936797]][[341237332603463]][[341237319270131]][[341237392603457]][[341237395936790]][[341237399270123]]\n'+
'[[341237402603456]][[341237405936789]][[341237479270115]][[341237482603448]][[341237485936781]][[341237472603449]]\n'+
'[[341237475936782]][[341237552603441]][[341237555936774]][[341237559270107]][[341237562603440]][[341237565936773]]'
var no = '[[341191499274713]][[341191495941380]][[341191505941379]][[341191502608046]][[341191509274712]]\n'+
'[[341191609274702]][[341191602608036]][[341191599274703]][[341191595941370]][[341191605941369]]\n'+
'[[341191732608023]][[341191725941357]][[341191719274691]][[341191715941358]][[341191729274690]]\n'+
'[[341191912608005]][[341191902608006]][[341191929274670]][[341191895941340]][[341191925941337]]\n'+
'[[341192172607979]][[341192175941312]][[341192182607978]][[341192179274645]][[341192185941311]]\n'+
'[[341192319274631]][[341192315941298]][[341192309274632]][[341192305941299]][[341192312607965]]'
var alone = '[[203703696394411]][[203703689727745]][[203703693061078]][[203703699727744]][[203703703061077]][[203703789727735]]\n'+
'[[203703793061068]][[203703783061069]][[203703786394402]][[203703796394401]][[203703863061061]][[203703866394394]]\n'+
'[[203703856394395]][[203703853061062]][[203703859727728]][[203703926394388]][[203703923061055]][[203703919727722]]\n'+
'[[203703916394389]][[203703913061056]][[203704023061045]][[203704009727713]][[203704013061046]][[203704026394378]]\n'+
'[[203704019727712]][[203704106394370]][[203704099727704]][[203704103061037]][[203704096394371]][[203704093061038]]\n'+
'[[203704156394365]][[203704159727698]][[203704169727697]][[203704153061032]][[203704163061031]][[203704226394358]]'
var closeenough = '[[343967595659509]][[343967585659510]][[343967575659511]][[343967582326177]][[343967578992844]][[343967742326161]]\n'+
'[[343967735659495]][[343967732326162]][[343967728992829]][[343967725659496]][[343967828992819]][[343967832326152]]\n'+
'[[343967825659486]][[343967842326151]][[343967838992818]][[343967938992808]][[343967942326141]][[343967948992807]]\n'+
'[[343967945659474]][[343967952326140]][[343968082326127]][[343968092326126]][[343968098992792]][[343968102326125]]\n'+
'[[343968095659459]][[343968185659450]][[343968178992784]][[343968188992783]][[343968175659451]][[343968182326117]]'
var cerealguy = '[[402261879798388]][[402261869798389]][[402261873131722]][[402261883131721]][[402261876465055]][[402262013131708]]\n'+
'[[402262006465042]][[402262019798374]][[402262009798375]][[402262016465041]][[402262103131699]][[402262099798366]]\n'+
'[[402262096465033]][[402262106465032]][[402262109798365]][[402262173131692]][[402262183131691]][[402262176465025]]\n'+
'[[402262179798358]][[402262169798359]][[402262303131679]][[402262313131678]][[402262306465012]][[402262299798346]]\n'+
'[[402262309798345]][[402262389798337]][[402262376465005]][[402262379798338]][[402262383131671]][[402262386465004]]\n'+
'[[402262466464996]][[402262473131662]][[402262459798330]][[402262469798329]][[402262463131663]][[402262529798323]]'
var gurugamesh = '[[224961354272348]][[224961357605681]][[224961344272349]][[224961347605682]][[224961350939015]][[224961480939002]]\n'+
'[[224961494272334]][[224961490939001]][[224961487605668]][[224961484272335]][[224961564272327]][[224961570938993]]\n'+
'[[224961560938994]][[224961557605661]][[224961567605660]][[224961637605653]][[224961640938986]][[224961644272319]]\n'+
'[[224961650938985]][[224961647605652]][[224961730938977]][[224961737605643]][[224961727605644]][[224961724272311]]\n'+
'[[224961734272310]][[224961827605634]][[224961814272302]][[224961820938968]][[224961817605635]][[224961824272301]]'
var shick = '[[537261236300154]][[537261246300153]][[537261232966821]][[537261242966820]][[537261239633487]][[537261329633478]]\n'+
'[[537261346300143]][[537261309633480]][[537261336300144]][[537261339633477]][[537261626300115]][[537261629633448]]\n'+
'[[537261636300114]][[537261642966780]][[537261659633445]][[537262006300077]][[537262009633410]][[537262012966743]]\n'+
'[[537262019633409]][[537262022966742]][[537262319633379]][[537262306300047]][[537262316300046]][[537262309633380]]\n'+
'[[537262312966713]][[537262559633355]][[537262562966688]][[537262576300020]][[537262566300021]][[537262572966687]]'
var pleaseguy = 
'[[502987539725352]][[502987546392018]][[502987533058686]][[502987529725353]][[502987536392019]][[502987646392008]]\n'+
'[[502987643058675]][[502987636392009]][[502987639725342]][[502987649725341]][[502987749725331]][[502987753058664]]\n'+
'[[502987746391998]][[502987759725330]][[502987763058663]][[502987839725322]][[502987849725321]][[502987843058655]]\n'+
'[[502987846391988]][[502987856391987]][[502988063058633]][[502988049725301]][[502988036391969]][[502988039725302]]\n'+
'[[502988059725300]][[502988213058618]][[502988223058617]][[502988209725285]][[502988229725283]][[502988306391942]]\n'+
'[[502988466391926]][[502988423058597]][[502988433058596]][[502988419725264]][[502988429725263]][[502988603058579]]\n'
var nyan =
'[[387443044664892]][[387443034664893]][[387443047998225]][[387443041331559]][[387443037998226]][[387443141331549]]\n'+
'[[387443134664883]][[387443131331550]][[387443137998216]][[387443147998215]][[387443244664872]][[387443247998205]]\n'+
'[[387443251331538]][[387443254664871]][[387443257998204]][[387443364664860]][[387443351331528]][[387443367998193]]\n'+
'[[387443354664861]][[387443361331527]][[387443464664850]][[387443474664849]][[387443471331516]][[387443461331517]]\n'+
'[[387443467998183]][[387443541331509]][[387443551331508]][[387443554664841]][[387443547998175]][[387443544664842]]'
var trolldad = 
'[[293429370774853]][[293429377441519]][[293429394108184]][[293429384108185]]\n'+
'[[293429380774852]][[293429534108170]][[293429544108169]][[293429540774836]]\n'+
'[[293429547441502]][[293429537441503]][[293429614108162]][[293429620774828]]\n'+
'[[293429617441495]][[293429627441494]][[293429624108161]][[293429720774818]]\n'+
'[[293429724108151]][[293429727441484]][[293429717441485]][[293429714108152]]\n'+
'[[293429800774810]][[293429804108143]][[293429817441475]][[293429797441477]]'

 	spemotsInfo = [mean, 'http://graph.facebook.com/364837310227369/picture', feellikeasir, 'http://graph.facebook.com/419656334745466/picture', lol, 'http://graph.facebook.com/419656168078816/picture', fuckyeah, 'http://graph.facebook.com/419656144745485/picture', Asa7by, 'http://graph.facebook.com/419656004745499/picture', truestory, 'http://graph.facebook.com/419716378072795/picture', nothing, 'http://graph.facebook.com/419656348078798/picture', dontsay, 'http://graph.facebook.com/419716408072792/picture', fap, 'http://graph.facebook.com/419656094745490/picture', baww, 'http://graph.facebook.com/419715834739516/picture', somuch, 'http://graph.facebook.com/419715838072849/picture', yuno, 'http://graph.facebook.com/419656374745462/picture', inglip, 'http://graph.facebook.com/419715844739515/picture', pokerface, 'http://graph.facebook.com/419717194739380/picture', miradafija, 'http://graph.facebook.com/419656251412141/picture', ilied, 'http://graph.facebook.com/419656231412143/picture', plz, 'https://graph.facebook.com/419656024745497/picture', hitler, 'http://graph.facebook.com/364837346894032/picture', hardcore, 'http://graph.facebook.com/364838190227281/picture', worthit, 'http://graph.facebook.com/364842106893556/picture', bitchplease, 'http://graph.facebook.com/364837326894034/picture', potato, 'http://graph.facebook.com/364841996893567/picture', stopyou, 'http://graph.facebook.com/364838220227278/picture', notbad, 'http://graph.facebook.com/364838216893945/picture', badluck, 'http://graph.facebook.com/364837320227368/picture', okay, 'http://graph.facebook.com/364838226893944/picture', ultragay, 'http://graph.facebook.com/364842060226894/picture', trollface, 'http://graph.facebook.com/364842046893562/picture', pukingrainbows, 'http://graph.facebook.com/364842030226897/picture', didthere, 'http://graph.facebook.com/365368090174291/picture', motherofgod, 'http://graph.facebook.com/364838210227279/picture', fuuu, 'http://graph.facebook.com/365348903509543/picture', kiddingme, 'https://graph.facebook.com/370699836307783/picture', fuckyou, 'https://graph.facebook.com/370700066307760/picture', dickbutt, 'https://graph.facebook.com/370699962974437/picture', gtfo, 'http://graph.facebook.com/370700082974425/picture', reaction, 'http://graph.facebook.com/370699872974446/picture', jackson, 'http://graph.facebook.com/370699842974449/picture', soclose, 'http://graph.facebook.com/370700012974432/picture', megusta, 'http://graph.facebook.com/370699802974453/picture', badass, 'http://graph.facebook.com/370700169641083/picture', challenge, 'https://graph.facebook.com/370699906307776/picture', no, 'https://graph.facebook.com/370700192974414/picture', alone, 'https://graph.facebook.com/370700209641079/picture', closeenough, 'https://graph.facebook.com/370699936307773/picture', cerealguy, 'http://graph.facebook.com/370699892974444/picture', gurugamesh, 'http://graph.facebook.com/370700132974420/picture', shick, 'http://graph.facebook.com/shickshickeverywhere/picture', pleaseguy, 'http://graph.facebook.com/320646427995586/picture', nyan,  'http://graph.facebook.com/216396075039732/picture', trolldad, 'http://graph.facebook.com/221811257907076/picture'];
    spemotsTitle = ['mean', ' ', 'feellikeasir', ' ','lol', ' ','fuckyeah', ' ','Asa7by', ' ','truestory', ' ','nothing', ' ','dontsay', ' ','fap', ' ','baww', ' ','somuch', ' ','yuno', ' ','inglip', ' ','pokerface', ' ','miradafija', ' ','ilied', ' ','plz', ' ','hitler', ' ','hardcore', ' ','worthit', ' ', 'bitchplease', ' ','potato', ' ','stopyou', ' ','notbad', ' ','badluck', ' ','okay', ' ','ultragay', ' ','trollface',' ','pukingrainbows',' ','didthere',' ','motherofgod',' ','fuuu',' ','kiddingme',' ','fuckyou',' ','dickbutt',' ','gtfo',' ','reaction',' ','jackson',' ','soclose',' ','megusta',' ','badass',' ','challenge',' ','no',' ','alone',' ','closeenough',' ','cerealguy',' ','gurugamesh',' ','shick',' ','pleaseguy',' ','nyan',' ','trolldad'];
    headTag = document.getElementsByTagName('head')[0];
    if (headTag) {
		styleTag = document.createElement('style');
		styleTag.type = 'text/css';
		styleTag.innerHTML =
			'.chat_tab_emot_bar {padding-top: 2px; padding-bottom: 6px; line-height: 16px; padding-left: 2px; background:#EEEEEE none repeat scroll 0 0; border-style: solid; border-width: 0px 0px 1px 0px; border-color: #C9D0DA; position: static; }'+
			'.fbNubFlyoutInner {position:relative !important;bottom:0px !important;}' +
			'.chat_arrow { background-image: url("http://static.ak.fbcdn.net/rsrc.php/v1/zp/r/SBNTDM0S-7U.png"); background-position: 0 -48px; height: 5px; width: 9px; }';
		headTag.appendChild(styleTag);
	}
	
	ArrowStyleUp = 'cursor: pointer; position: absolute; right: 2px; -moz-transform: rotate(180deg); -webkit-transform: rotate(180deg);'
	ArrowStyleDown = 'cursor: pointer; position: absolute; right: 2px;'
	
	fEmotBarDom = document.createElement('div');
	fEmotBarDom.setAttribute('class','chat_tab_emot_bar');

	
	fEmotsListDom = document.createElement('div');
	fEmotsListDom.setAttribute('name','EmotsList');
	fEmotBarDom.appendChild(fEmotsListDom);
	
	
	for(i=0;i<spemotsInfo.length;i+=2) {
		var fEmotsDom = document.createElement('img');
		fEmotsDom.setAttribute('alt',spemotsInfo[i]);
		fEmotsDom.setAttribute('title',spemotsTitle[i]);
		fEmotsDom.setAttribute('src','' + spemotsInfo[i+1]);
		fEmotsDom.setAttribute('style','cursor: pointer;');
		fEmotsDom.setAttribute('class','emote_custom');
		fEmotsListDom.appendChild(fEmotsDom);
	}
	
	

	fArrow = document.createElement('i');
	fArrow.setAttribute('alt','');
	fArrow.setAttribute('class','img chat_arrow');
	fArrow.setAttribute('style',ArrowStyleUp);
	fEmotBarDom.appendChild(fArrow);
	
	var setting_visible = getValue('visible',true);
	
	document.addEventListener('DOMNodeInserted', fInsertedNodeHandler, false);

	function fInsertedNodeHandler(event) {
		if(event.target.getElementsByClassName && event.target.getElementsByClassName('fbNubFlyout fbDockChatTabFlyout')[0])
			fInsertEmotBar(event.target);
	}

	function fInsertEmotBar(fChatWrapper) {
		fChatToolBox = fChatWrapper.getElementsByClassName('fbNubFlyoutHeader')[0]
		fNewEmotBar = fEmotBarDom.cloneNode(true);
		setVisibility(fNewEmotBar);
		for(i=0;i<fNewEmotBar.firstChild.childNodes.length-2;i++) fNewEmotBar.firstChild.childNodes[i].addEventListener('click', fEmotClickHandler , false);

		fNewEmotBar.firstChild.childNodes[i].addEventListener('click' , fStyleClickHandler , false);
		fNewEmotBar.firstChild.childNodes[i+1].addEventListener('click' , fStyleClickHandler , false);
		
		fNewEmotBar.childNodes[1].addEventListener('click', fHideShowEmotBar , false);
		if(fChatToolBox.childNodes) fChatToolBox.insertBefore(fNewEmotBar,fChatToolBox.childNodes[1]);
	}

	function fEmotClickHandler(event){
		var fChatInput = event.target.parentNode.parentNode.parentNode.parentNode.getElementsByClassName('fbNubFlyoutFooter')[0].getElementsByClassName('inputContainer')[0].getElementsByClassName('uiTextareaAutogrow input')[0];
		var pos = getCursorPosition(fChatInput);
		
		var txtbef = ''; var txtaft = '';
		
		if (fChatInput.value.charAt(pos-1) != ' ' && pos-1 > 0) txtbef = ' ';
		if (fChatInput.value.charAt(pos) != ' ') txtaft = ' ';
		
		fChatInput.value = fChatInput.value.substring(0,pos) + txtbef + event.target.getAttribute('alt') + txtaft + fChatInput.value.substring(pos);
		createSelection(fChatInput,pos + event.target.getAttribute('alt').length + txtaft.length + txtbef.length,pos + event.target.getAttribute('alt').length + txtaft.length + txtbef.length);
	}
	
	function fStyleClickHandler(event){
		var fChatInput = event.target.parentNode.parentNode.parentNode.parentNode.getElementsByClassName('fbNubFlyoutFooter')[0].getElementsByClassName('inputContainer')[0].getElementsByClassName('uiTextareaAutogrow input')[0];
		
		var selectedText = fChatInput.value.substring(fChatInput.selectionStart, fChatInput.selectionEnd);
		
		var pos = getCursorPosition(fChatInput);
		var txtlen = selectedText.length;
		
		if (txtlen == 0) {
			fChatInput.value = fChatInput.value.substring(0,pos) + event.target.getAttribute('alt') + fChatInput.value.substring(pos);
			createSelection(fChatInput,pos + 1,pos + event.target.getAttribute('alt').length-1);
		}
		else {
			var txtbef = event.target.getAttribute('alt').charAt(0);
			var txtaft = event.target.getAttribute('alt').charAt(0);
			
			while (fChatInput.value.charAt(pos) == ' ') { pos += 1; txtlen -= 1; }
			while (fChatInput.value.charAt(pos+txtlen-1) == ' ') txtlen -= 1;
			
			if (fChatInput.value.charAt(pos-1) != ' ' && pos-1 > 0) txtbef = ' ' + txtbef;
			if (fChatInput.value.charAt(pos+txtlen) != ' ') txtaft += ' ';
			
			fChatInput.value = fChatInput.value.substring(0,pos) + txtbef + fChatInput.value.substring(pos,pos+txtlen) + txtaft + fChatInput.value.substring(pos + txtlen);
			
			createSelection(fChatInput, pos + txtlen + 2, pos + txtlen + 2);
		}
	}

	function fHideShowEmotBar(event){
		fChatBar = document.getElementsByName('EmotsList');
		if(fChatBar[0].getAttribute('style') == 'display: none;') {
			for(i=0;i<fChatBar.length;i++) {
				fChatBar[i].setAttribute('style','display: block;');
				fChatBar[i].parentNode.childNodes[1].setAttribute('style',ArrowStyleUp);
			}
		}
		else {
			for(i=0;i<fChatBar.length;i++) {
				fChatBar[i].setAttribute('style','display: none;');
				fChatBar[i].parentNode.childNodes[1].setAttribute('style',ArrowStyleDown);
			}
		}
		setValue('visible',!setting_visible);
		setting_visible = !setting_visible;
	}
	
	function setVisibility(DOM) {
		if(setting_visible) {
			DOM.firstChild.setAttribute('style','display: block;');
			DOM.childNodes[1].setAttribute('style',ArrowStyleUp);
		}
		else {
			DOM.firstChild.setAttribute('style','display: none;');
			DOM.childNodes[1].setAttribute('style',ArrowStyleDown);
		}
	}