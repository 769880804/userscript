// ==UserScript==
// @name           GF Power Tools - Italiano (The Original)
// @namespace      Tiestoale[ITA] & mikmeg
// @version        1.4a
// @description    Tools avanzato ITALIANO per God of Father
// @match          http://kocbottols.tiestoale.com/^
// @match          *://*/*
// @include        http://kocbottols.tiestoale.com/^
// @include        *://*
// ==/UserScript==
(function(){var Ba,Ca,Da,oa,Ea,T;function Ua(){var a=f("iframe_canvas");if(a){for(a.style.width="100%";(a=a.parentNode)!==null;)if(a.tagName=="DIV")a.style.width="100%";f("rightCol").style.display="none"}else setTimeout(Ua,1E3)}function Va(){var a=f("game_frame");if(a){a.style.width="100%";for(a.style.height="1000px";(a=a.parentNode)!==null;)if(a.tagName=="DIV")a.style.width="100%";f("main-nav").parentNode.removeChild(f("main-nav"));f("main-header").parentNode.removeChild(f("main-header"));f("promo-sidebar").style.display=
"none"}else setTimeout(Va,1E3)}function Wa(){var a;return a=(a=document.body.className.split(" "))&&a[0]?a[0].replace(/(platforms_|_game)/g,""):"google"}function Xa(){var a="",b;for(b=0;b<5;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(Math.random()*62));return a}function Fa(){return h("Creato da")+" Tiestoale, mikmeg, Ciccio[TeamDoa]"}function Ga(){var a=Wa();if(Ya())if(clearTimeout(Ha),a!="facebook"&&a!="kabam")U("Platform not found");else if(U("dtStartup"),
++Za,Za>10)$a("<B>"+h("Errore di Inizializzazione")+" "+ea+":</b><BR><BR>"+h("SWF non trovato"));else{try{if(f("castlemania_swf_container"))if(document.referrer===""||document.referrer===0||document.referrer===null||document.referrer===void 0){alert("Il tools non verr\u00e0 caricato!");return}else{var b=document.body.innerHTML,c=/playerId\s*=\s*'([^']+)'/.exec(b);/facebookId\s*=\s*'([^']+)'/.exec(b);Ba=(c=/sessionId\s*=\s*'([^']+)'/.exec(b))?c[1]:"";Ca=(c=/userId\s*=\s*'?([0-9]+)'?/.exec(b))?c[1]:
"";Da=(c=/gangster\s*=\s*'([^']+)'/.exec(b))?c[1]:"";oa=(c=/apiServer\s*=\s*'([^']+)'/.exec(b))?c[1]:"";Ea=oa.replace("/api","");T=(c=/locale\s*=\s*'([^']+)'/.exec(b))?c[1]:"";switch(T){case "it":W=".";break;case "de":ba=W=".";break;case "es":W=".";break;case "nl":case "da":W=".";ba="-";break;case "fr":W=" ";break;case "sv":W=" ";ba="-";break;case "en":W=",",Ia="."}}else{Ha=setTimeout(Ga,5E3);return}}catch(d){Ha=setTimeout(Ga,5E3);return}try{n.init({options:xb,log:[]}),pa.init(o.readManifest)}catch(e){$a("<B>"+
h("Non posso caricare")+" "+ea+"</b>"+e),U(ab(e,8,1))}}}function yb(){var a=Wa(),b,c,d,e=document.getElementsByTagName("object");try{if(a=="facebook"){for(d=0;d<e.length;d++)e[d].parentNode.style.margin="0px";f("ft").style.display="none";document.scrollTop="42px"}else if(a=="kabam"){c=document.getElementsByTagName("html");for(b=0;b<c.length;b++)c[b].style.overflow="hidden",c[b].style.backgroundColor="transparent";document.body.style.backgroundColor="black";f("content").style.textAlign="left"}f("castlemania_swf").width=
"760"}catch(g){}}function zb(){Xa();clearInterval(o.tickTimer);U("* "+ka+" "+h("Caricato"));if(n.options.ptWin.Pos.x<0)n.options.ptWin.Pos.x=0;if(n.options.ptWin.Pos.y<0)n.options.ptWin.Pos.y=0;V=new bb("dtmain",n.options.ptWin.Pos.x,n.options.ptWin.Pos.y,n.options.size.x,n.options.size.y,n.options.ptWin.Drag,function(){Q.hideTab();fa.show(false)});V.getMainDiv().innerHTML="<STYLE>"+cb+"</style>";Q.init(V.getMainDiv());n.options.ptWin.IsOpen=true;n.options.ptWin.IsOpen&&(V.show(true),Q.showTab());
X("* "+ka+" "+h("Caricato"));fa.init();window.addEventListener("beforeunload",n.save,false);Ja=true;db=C();o.tickTimer=setInterval(o.tick,1E3);setTimeout(yb,1E3)}function $a(a,b){var c="";b==void 0&&(c="<BR><BR>"+ea+" "+h("sar\u00e0 ricaricato tra 10 secondi"),setTimeout(qa,1E4));pop=new bb("dtfatal",200,300,401,300,true);pop.getMainDiv().innerHTML="<STYLE>"+cb+"</style><BR>"+ka+" "+a+c;pop.getTopDiv().innerHTML="<B><CENTER><FONT COLOR=#FFFFFF>Uh ohs</font></center></b>";pop.show(true);return pop}
function h(a,b){var c=a;b==void 0&&(b="");if(b!==""){var d=pa.xml.translations,b=b.toLowerCase(),a=a.toLowerCase();if(d&&d[b]&&d[b][a])switch(d=d[b][a],b){case "armory":case "buildings":case "cities":case "items":case "map":case "research":c=d.name;break;case "troops":c=d.name;break;case "jobs":c=d.title;break;case "common":c=d;break;default:c=d.name}}Ka[T]&&Ka[T][c]&&(c=Ka[T][c]);return c}function eb(a,b){var c;if(b.level&&b.level>o.player.level)return false;if(b.resources)for(c in b.resources)if(b.resources[c]>
0)if(c=="influence"){if(o.player.cities[a].figures[c]==void 0||o.player.cities[a].figures[c].current<b.resources[c])return false}else if(o.player.cities[a].resources[c]==void 0||o.player.cities[a].resources[c]<b.resources[c])return false;if(b.research)for(c in b.research)if(o.player.cities[a].research[c]==void 0||o.player.cities[a].research[c]<b.research[c])return false;if(b.units)for(c in b.units)if(o.player.cities[a].units[c]==void 0||o.player.cities[a].units[c]<b.units[c])return false;if(b.items)for(c in b.items)if(o.player.items[c]==
void 0||o.player.items[c]<b.items[c])return false;if(b.buildings)for(c in b.buildings)if(o.player.cities[a].neighborhoods.neighborhood.buildings[c]==void 0||o.player.cities[a].neighborhoods.neighborhood.buildings[c].level<b.buildings[c].level)return false;return true}function N(a,b,c){a[b]?a[b]+=c:a[b]=c}function La(a){var b=a instanceof Array?[]:{};for(i in a)ga(a[i])!="function"&&(b[i]=a[i]&&typeof a[i]=="object"?La(a[i]):a[i]);return b}function Y(a){return isNaN(a)?0:!a||a===""?0:u(a,10)}function Ma(){clearInterval(j.Options.timerInfo);
f("pbinfoUpdate").disabled=true;f("pboptsReadInfo").disabled=true;var a;for(a=0;a<o.player.cities.length;a++)v.addToRefresh(a)}function qa(){window.location.reload(true)}function Na(a,b,c,d){a=Math.abs(c-a);b=Math.abs(d-b);a>Z/2&&(a=Z-a);b>Z/2&&(b=Z-b);return Math.round(100*Math.sqrt(a*a+b*b))/100}function fb(a,b,c,d){if(b&&b.length!==0){gb("fuckruler",b);hb("ttTooltip",b);f("fuckruler").style.display="block";var e=f("ttTooltip");if(e){e.innerHTML=b;c==void 0&&(c=b.visualWidth());d==void 0&&(d=b.visualHeight());
f("fuckruler").style.display="none";if(e.style.width!=c+"px")e.style.width=c+"px";if(e.style.height!=d+"px")e.style.height=d+"px";b=u(a.clientX)+document.body.scrollLeft+10;a=u(a.clientY)+document.body.scrollTop;b+c>window.innerWidth&&(b-=20,b-=c,b<0&&(b=0));a+d>window.innerHeight&&(a-=d,a<0&&(a=0));e.style.display="block";e.style.top=a+"px";e.style.left=b+"px";e.focus()}}}function ib(){var a=f("ttTooltip");if(a)a.style.display="none"}function Ab(a,b){var c;if(!b||b.length===0)c=a;else if(a.indexOf("?")<
0?a+="?":a.substr(a.length-1)!="&"&&(a+="&"),ga(b=="object")){c=a;var d;d=[];for(var e in b)d.push(e+"="+encodeURI(b[e]));d=d.join("&");c+=d}else c=a+b;return c}function Bb(a,b,c,d,e,g,l){var s={onSuccess:function(a){if(a.status==200||a.status==304)f.indexOf(".xml")!==-1||f.startsWith("flash/")?g({status:a.status,ok:true,dat:a.responseText}):g({status:a.status,ok:true,dat:la.parse(a.responseText)})},onFailure:function(a){if(a.status===0)a.status=509;a.status>399?g({status:a.status,ok:false,errmsg:a.statusText+
" ("+a.status+")"}):a.status>200&&a.responseText?g({status:a.status,ok:false,dat:la.parse(a.responseText)}):a.status>0&&g({status:a.status,ok:false,errmsg:a.statusText})}},f=a;l==void 0&&(l=false);b!==""&&(f=f.replace("@@id1",b));c!==""&&(f=f.replace("@@id2",c));s.parameters={};for(var h in e)a=h,a=a.replace('"',"%22").replace(",","%2C").replace(":","%3A"),a=a.replace("[","%5B").replace("]","%5D").replace("_","%5F"),a=a.replace("{","%7B").replace("|","%7C").replace("}","%7D"),s.parameters[a]=e[h];
jb>0&&Math.random()*100<=jb?setTimeout(function(){g({status:999,ok:false,errmsg:"ERROR: Emulated"})},1500):(s.method=d,s.timeoutSecs=45,l?new kb(Ea+"/"+f,s):new kb(oa+"/"+f,s))}function kb(a,b){function c(a){if(a.readyState===4){clearTimeout(d);var c={responseText:a.responseText,status:a.status,statusText:a.statusText,ajax:a};if(a.status>=200&&a.status<300||a.status===304){if(b.onSuccess)b.onSuccess(c)}else if(b.onFailure)b.onFailure(c)}}var d=null,e="GET",g,l,s={},f=[],h;if(b.method=="POST"){for(l in b.parameters)f.push(l+
"="+b.parameters[l]);h=f.join("&")}else a=Ab(a,b.parameters);s.Accept=Oa?"*/*":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8,*/*;q=0.6,*/*;q=0.4";b.method&&(e=b.method.toUpperCase());e=="POST"&&(s["content-type"]="application/x-www-form-urlencoded",s["x-s3-aws"]=Cb("Draoumculiasis"+h+"LandCrocodile"+a+"Bevar-Asp"));if(GM_xmlhttpRequest)GM_xmlhttpRequest({method:b.method,url:a,data:b.method==="POST"?h:null,headers:s,ontimeout:b.timeoutSecs?b.timeoutSecs*1E3:0,onreadystatechange:c});
else{g=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");g.onreadystatechange=function(){if(g.readyState==4)if(clearTimeout(d),g.status>=200&&g.status<300||g.status==304){if(b.onSuccess)b.onSuccess({responseText:g.responseText,status:g.status,statusText:g.statusText,ajax:g})}else if(b.onFailure)b.onFailure({responseText:g.responseText,status:g.status,statusText:g.statusText,ajax:g})};g.open(b.method,a,true);for(l in s)g.setRequestHeader(l,s[l]);b.timeoutSecs&&(d=setTimeout(j,
b.timeoutSecs*1E3));e=="POST"?g.send(h):g.send();var j=function(){g.abort();if(b.onFailure)b.onFailure({responseText:null,status:599,statusText:"Timed Out",ajax:g})}}}function U(a){console.log(ea+": "+a)}function X(a){j.Help.tabDisabled||j.Help.log(a)}function lb(a){var b="";b+="<TABLE width=100%><TR>";b+="<TD><hr /></td>";b+='<TD style="width:1px; padding: 0 10px; white-space: nowrap;">'+a+"</td>";b+="<TD><hr /></td>";b+="</tr></table>";return b}function ra(a){var b;if(a===null)b={x:null,y:null,
width:null,height:null};else for(b={x:0,y:0,width:a.clientWidth,height:a.clientHeight};a.offsetParent!==null;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b}function bb(a,b,c,d,e,g,l,s){function h(){}function B(){z.focusMe()}function j(){z.setLayer(5)}function o(){z.setLayer(-5)}function A(){return{x:u(this.div.style.left),y:u(this.div.style.top)}}function w(a){z.div.style.left=a.x+"px";z.div.style.top=a.y+"px"}function p(){document.body.removeChild(z.div);ha.winDelete(z.prefix)}function q(a){var b;
b=a===null?ra(document.body):ra(a);a=(b.width-u(z.div.style.width))/2+b.x;b=(b.height-u(z.div.style.height))/2+b.y;a<0&&(a=0);b<0&&(b=0);z.div.style.left=a+"px";z.div.style.top=b+"px"}function R(a){z.dragger.setEnable(a);n.options.ptWin.Drag=a}function Eb(a){z.div.style.zIndex=""+(this.BASE_ZINDEX+a)}function v(){return u(z.div.style.zIndex)-this.BASE_ZINDEX}function y(){return f(this.prefix+"_top")}function C(){return f(this.prefix+"_main")}function D(a){a?(z.div.style.display="block",z.focusMe()):
z.div.style.display="none";return a}function E(a){return a.div.style.display=="block"?a.show(false):a.show(true)}var F=ha.get(a);if(F)F.show(false);else{this.BASE_ZINDEX=65E3;this.show=D;this.toggleHide=E;this.getTopDiv=y;this.getMainDiv=C;this.getLayer=v;this.setLayer=Eb;this.setEnableDrag=R;this.getLocation=A;this.setLocation=w;this.focusMe=j;this.unfocusMe=o;this.centerMe=q;this.destroy=p;this.setModal=h;this.div=document.createElement("div");this.prefix=a;this.onClose=l;var z=this;this.div.className=
"CPopuppa "+a+"_CPopuppa";this.div.id=a+"_otterz";s==void 0&&(s="#fff");this.div.style.background=s;this.div.style.zIndex=65E3;this.div.style.display="none";this.div.style.width=d+"px";this.div.style.height=e+"px";this.div.style.position="absolute";this.div.style.top=c+2+"px";this.div.style.left=b+2+"px";topClass=Pa===null?"CPopuppaTop "+a+"_CPopuppaTop":Pa+" "+a+"_"+Pa;b="";b+="<TABLE cellspacing=0 width=100% height=100%>";b+='<TR id="'+a+'_bar" class="'+topClass+'">';b+='<TD width=99% valign=bottom><SPAN id="'+
a+'_top"></span></td>';b+="</tr>";b+='<TR><TD height=100% valign=top class="CPopMain '+a+'_CPopMain" colspan=2 id="'+a+'_main"></td></tr>';b+="</table>";document.body.appendChild(this.div);this.div.innerHTML=b;this.dragger=new Fb(f(a+"_bar"),this.div,g);this.div.addEventListener("mousedown",B,false);ha.add(a,this);F=this}return F}function Fb(a,b,c){function d(a){a.body.removeEventListener("mousemove",a.moveHandler,true);a.body.removeEventListener("mouseout",a.outHandler,true);a.moving=false}var e=
this;this.setEnable=function(b){if(b!=e.enabled)b?(a.addEventListener("mousedown",e.downHandler,false),e.body.addEventListener("mouseup",e.upHandler,false)):(a.removeEventListener("mousedown",e.downHandler,false),e.body.removeEventListener("mouseup",e.upHandler,false)),e.enabled=b};this.setBoundRect=function(){this.boundRect=boundRect;this.bounds=null};this.dispEvent=function(a,b){U(a+" Button:"+b.button+" Screen:"+b.screenX+","+b.screenY+" client:"+b.clientX+","+b.clientY+" rTarget: "+b.relatedTarget)};
this.lastY=this.lastX=null;this.enabled=true;this.moving=false;this.theDiv=b;this.body=document.body;this.ce=a;this.moveHandler=(new function(a){this.handler=function(a){if(b.enabled&&!b.wentOut){var c=u(b.theDiv.style.top)+a.clientY-b.lastY,e=u(b.theDiv.style.left)+a.clientX-b.lastX;if(c<b.bounds.top)c=b.bounds.top,d(b);else if(e<b.bounds.left)e=b.bounds.left,d(b);else if(e>b.bounds.right)e=b.bounds.right,d(b);else if(c>b.bounds.bot)c=b.bounds.bot,d(b);b.theDiv.style.top=c+"px";b.theDiv.style.left=
e+"px";b.lastX=a.clientX;b.lastY=a.clientY}};var b=a}(this)).handler;this.outHandler=(new function(a){this.handler=function(a){a.button===0&&b.moveHandler(a)};var b=a}(this)).handler;this.upHandler=(new function(a){this.handler=function(a){a.button===0&&b.moving&&d(b)};var b=a}(this)).handler;this.downHandler=(new function(b){this.handler=function(b){if(c.bounds===null){c.clickableRect=ra(a);c.bodyRect=ra(document.body);if(c.boundRect===null)c.boundRect=c.clickableRect;c.bounds={top:10-c.clickableRect.height,
bot:c.bodyRect.height-25,left:40-c.clickableRect.width,right:c.bodyRect.width-25}}if(b.button===0&&c.enabled)c.body.addEventListener("mousemove",c.moveHandler,true),c.body.addEventListener("mouseout",c.outHandler,true),c.lastX=b.clientX,c.lastY=b.clientY,c.moving=true};var c=b}(this)).handler;this.bounds=this.bounds=this.boundRect=this.clickableRect=null;this.enabled=false;c===null&&(c=true);this.setEnable(c)}function ab(a,b,c,d){var e="",g,l;c===null&&(c=0);b===null&&(b=1);if(b<1)e="Inspect Error: Levels number must be > 0";
else if(a===null)e="ERROR: Object is NULL\n";else{var s="";for(l=0;l<c;l++)s+="  ";for(property in a)try{if(g=ga(a[property]),d===true&&g=="function"?e+=s+"("+g+") "+property+"[FUNCTION]\n":g!="function"&&(e+=s+"("+g+") "+property+(a[property]===null?": null":"")+" = "+a[property]+"\n"),g=="object"||g=="array")a[property]!==null&&c+1<b&&(e+=ab(a[property],b,c+1,d))}catch(f){l=typeof f=="string"?f:f.message?f.message:f.description?f.description:"Unknown",e+="(Error) "+property+": "+l+"\n"}e+="\n"}return e}
function ga(a){return a==void 0?"undefined":typeof a=="object"?a?a.constructor.toString().indexOf("Array")>=0&&typeof a.splice=="function"?"array":"object":"null":typeof a}function E(a){nStr=u(a)+"";for(a=/(\d+)(\d{3})/;a.test(nStr);)nStr=nStr.replace(a,"$1"+W+"$2");return nStr}function C(){return u((new Date).getTime()/1E3)+o.serverTimeOffset}function $(a,b){var c=u(a),d="",e=sa(d,c,86400,"d"),c=e.t;d+=e.ret;e=sa(d,c,3600,"h");c=e.t;d+=e.ret;e=sa(d,c,60,"m");c=e.t;d+=e.ret;b==void 0&&(b=false);e=
sa(d,c,1,"s",b);d+=e.ret;return d}function sa(a,b,c,d,e){var g={ret:"",t:b};e==void 0&&(e=false);if(b>=c||e)if(g.ret+=(a!==""?" ":"")+u(b/c)+d,g.ret=g.ret.replace(/ 0/," "),!e&&c>1)g.t=b%c;return g}function Cb(a){function b(a,b){return a<<b|a>>>32-b}function c(a){var b="",c,d;for(c=7;c>=0;c--)d=a>>>c*4&15,b+=d.toString(16);return b}var d,e,g=Array(80),l=1732584193,s=4023233417,f=2562383102,h=271733878,j=3285377520,n,o,w,p,q,a=function(a){var a=a.replace(/\r\n/g,"\n"),b="",c,d;for(c=0;c<a.length;c++)d=
a.charCodeAt(c),d<128?b+=String.fromCharCode(d):(d>127&&d<2048?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128));return b}(a);n=a.length;var u=[];for(d=0;d<n-3;d+=4)e=a.charCodeAt(d)<<24|a.charCodeAt(d+1)<<16|a.charCodeAt(d+2)<<8|a.charCodeAt(d+3),u.push(e);switch(n%4){case 0:d=2147483648;break;case 1:d=a.charCodeAt(n-1)<<24|8388608;break;case 2:d=a.charCodeAt(n-2)<<24|a.charCodeAt(n-1)<<16|32768;break;case 3:d=
a.charCodeAt(n-3)<<24|a.charCodeAt(n-2)<<16|a.charCodeAt(n-1)<<8|128}for(u.push(d);u.length%16!==14;)u.push(0);u.push(n>>>29);u.push(n<<3&4294967295);for(a=0;a<u.length;a+=16){for(d=0;d<16;d++)g[d]=u[a+d];for(d=16;d<=79;d++)g[d]=b(g[d-3]^g[d-8]^g[d-14]^g[d-16],1);e=l;n=s;o=f;w=h;p=j;for(d=0;d<=19;d++)q=b(e,5)+(n&o|~n&w)+p+g[d]+1518500249&4294967295,p=w,w=o,o=b(n,30),n=e,e=q;for(d=20;d<=39;d++)q=b(e,5)+(n^o^w)+p+g[d]+1859775393&4294967295,p=w,w=o,o=b(n,30),n=e,e=q;for(d=40;d<=59;d++)q=b(e,5)+(n&o|
n&w|o&w)+p+g[d]+2400959708&4294967295,p=w,w=o,o=b(n,30),n=e,e=q;for(d=60;d<=79;d++)q=b(e,5)+(n^o^w)+p+g[d]+3395469782&4294967295,p=w,w=o,o=b(n,30),n=e,e=q;l=l+e&4294967295;s=s+n&4294967295;f=f+o&4294967295;h=h+w&4294967295;j=j+p&4294967295}q=c(l)+c(s)+c(f)+c(h)+c(j);return q.toLowerCase()}function P(a,b,c,d,e,g,l,s,f,n,j){var o="";l==void 0&&(l="");s==void 0&&(s=false);f==void 0&&(f=false);n==void 0&&(n=false);j==void 0&&(j="");a&&(o+=b!==""?"<TR "+b+">":"<TR>");c&&(o+=d>0?"<TD colspan="+d+">":"<TD>");
n&&(o+="<CENTER>");o+="<INPUT id="+e+" type=checkbox"+(g===true?" CHECKED":"")+" />";l!==""&&(j!==""&&(o+="<FONT COLOR="+j+">"),l=="==MSGTABORDER"?(a=e.split("_"),o+=" ",o+=a[1]==ta?Qa:a[1]==mb?nb:a[1]==ob?pb:a[1]==qb?Ra:rb):o+=" "+h(l),j!==""&&(o+="</font>"));n&&(o+="</center>");s&&(o+="</td>");f&&(o+="</tr>");return o}function y(a,b,c,d,e,g,l,s,f,n,j,o,p){var w="";e==void 0&&(e="");g==void 0&&(g="");l==void 0&&(l="");s==void 0&&(s=false);f==void 0&&(f="");n==void 0&&(n=false);j==void 0&&(j=0);o==
void 0&&(o=false);p==void 0&&(p=false);s&&(w+=f!==""?"<TR "+f+">":"<TR>");n&&(w+=j>0?"<TD colspan="+j+">":"<TD>");d&&(w+="<CENTER>");w+="<INPUT id="+a+" type=submit";g!==""&&(w+=' style="'+g+'"');e!==""&&(w+=" class="+e);l!==""&&(w+=' ref="'+l+'"');b!==""&&(w+=' value="'+h(b)+'"');c&&(w+=" DISABLED");w+=" />";d&&(w+="</center>");o&&(w+="</td>");p&&(w+="</tr>");return w}function K(a,b,c,d,e,g,l,s,f,n,j,o,p){var w="";e==void 0&&(e="");g==void 0&&(g="");l==void 0&&(l=false);s==void 0&&(s=false);f==void 0&&
(f="");n==void 0&&(n=false);j==void 0&&(j=0);o==void 0&&(o=false);p==void 0&&(p=false);s&&(w+=f!==""?"<TR "+f+">":"<TR>");n&&(w+=j>0?"<TD colspan="+j+">":"<TD>");l&&(w+="<CENTER>");w+="<INPUT id="+a+" type=text";g!==""&&(w+=' style="'+g+'"');e!==""&&(w+=" class="+e);b!==""&&(w+=' value="'+h(b)+'"');c!==0&&(w+=" size="+c);d!==0&&(w+=" maxlength="+d);w+=" />";l&&(w+="</center>");o&&(w+="</td>");p&&(w+="</tr>");return w}function Sa(a,b,c,d,e,g,l,s,f,n){var j="";n==void 0&&(n=true);a&&(j+="<TR>");b&&
(j+="<TD>");j+="<SELECT id="+c;d!==0&&(j+=" size="+d);j+=">";for(a=0;a<e.length;a++)j+="<OPTION value="+e[a]+(e[a]==g?" selected":"")+">",j+=l===""?e[a]:n?h(l[a]):l[a],j+="</option>";j+="</select>";s&&(j+="</td>");f&&(j+="</tr>");return j}function hb(a,b){var c=f(a);c?c.innerHTML=b:(c=document.createElement("div"),c.id=a,c.style.overflow="hidden",c.style.display="none",c.style.position="absolute",c.style.zIndex=65535,c.className="xstooltip",c.innerHTML=b,document.body.firstChild?document.body.insertBefore(c,
document.body.firstChild):document.body.appendChild(c))}function gb(a,b){var c=f(a);c?c.innerHTML=b:(c=document.createElement("div"),c.id=a,c.className="xstooltip",c.style.position="absolute",c.style.visibility="none",c.style.height="auto",c.style.width="auto",c.innerHTML=b,document.body.firstChild?document.body.insertBefore(c,document.body.firstChild):document.body.appendChild(c))}function u(a){return parseInt(a,10)}function aa(a){return(a||"").toLowerCase().replace(/ /g,"-").replace(/_/g,"-")}function f(a){return document.getElementById(a)}
function Ya(){var a=[ua[0],ua[1],ua[2],ua[3]],b=true;try{ea!=a[0]&&(b=false)}catch(c){}try{ma!=a[1]&&(b=false)}catch(d){}try{Fa()!=h(a[2])+a[3]&&(b=false)}catch(e){}return b}function Gb(){function a(){alert("Disable Adblock ?");if(Ja){for(var a in j)delete j[a];V.show(false)}if((a=f("container"))&&a.style.display!="none")a.style.display="none"}function b(c){var d=f("adblocktest");!d||d==void 0||d==null?a():d.style.display=="none"|d.style.visibility=="hidden"?a():c<10&&setTimeout(function(){b(c+1)},
4E3)}b(0)}if(!/(pixelkabam|akamaihd|plugins|ai\.php|talkgadget|contactPicker|accounts|googleapis\.com\/static)/.test(window.location.href)){var W=",",Ia=":",ba="/",Z=750,ia=37,Hb=[1,60,3600],Ib=["Secondi","Minuti","Ore"],sb=[60,3600],tb=["Minuti","Ore"],va={SafeHouse:{resources:{cash:438857,food:114457,steel:114457,cement:114457},maxlevel:12},Apartment:{resources:{cash:500,food:100,steel:100,cement:100},maxlevel:12},CementFactory:{resources:{cash:600,food:500,steel:200,cement:200},maxlevel:12},Library:{resources:{cash:2500,
food:1500,steel:200,cement:200},maxlevel:12},FrontGate:{resources:{cash:1500,food:500,steel:1500,cement:500},level:5,maxlevel:12},Garage:{resources:{cash:2E3,food:300,steel:1E3,cement:300},level:9,maxlevel:12},GuardPost:{resources:{cash:1500,food:300,steel:300,cement:1E3},level:8,maxlevel:12},Warehouse:{resources:{cash:1500,food:1E3,steel:300,cement:300},level:4,maxlevel:12},SteelMill:{resources:{cash:600,food:200,steel:200,cement:500},maxlevel:12},Mansion:{resources:{cash:2500,food:300,steel:300,
cement:300},maxlevel:12},Vault:{resources:{cash:3E3,food:300,steel:300,cement:1E3},maxlevel:12},Restaurant:{resources:{cash:600,food:200,steel:500,cement:200},maxlevel:12},GuestHouse:{resources:{cash:2E3,food:500,steel:300,cement:300},level:6,maxlevel:12},Hideout:{resources:{cash:1200,food:500,steel:500,cement:500},maxlevel:12},Wall:{resources:{cash:6E3,food:1E3,steel:1E3,cement:6E3},maxlevel:12},Workshop:{resources:{cash:3E3,food:300,steel:1E3,cement:300},level:7,maxlevel:12},Armory:{resources:{cash:3E3,
food:300,steel:300,cement:1E3},level:3,maxlevel:12},Exchange:{resources:{cash:3E3,food:300,steel:300,cement:1E3},maxlevel:11},TheFoxyLadyClub:{level:23},DonasDepartmentStore:{},CliveTheater:{level:5},LarrysAutoBody:{level:11},GreenwichVillageCourtHouse:{buildings:{Mansion:{level:7}}},GreenwichVillageChurch:{buildings:{Mansion:{level:3}}},GreenwichVillageDocks:{buildings:{Mansion:{level:5}}},GreenwichVillageStation:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},
units:{},buildings:{},items:{}},BrooklynFirehouse:{buildings:{Mansion:{level:3}}},BrooklynFactory:{buildings:{Mansion:{level:5}}},BrooklynCemetery:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BrooklynBridge:{buildings:{Mansion:{level:7}}},Morgue:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Pharmacy:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},
level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Gym:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Hospital:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BlackMarket:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Laundromat:{resources:{cash:0,food:0,steel:0,cement:0,
influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},ShootingRange:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Haberdashery:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Headquarters:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},LawFirm:{resources:{cash:0,
food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingOne:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingTwo:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingThree:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingFour:{resources:{cash:0,
food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},DeputyMayorsOffice:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},ClipJoint:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}}},ub="BarbedWire,BoobyTrap,GuardDog,ArmedGuard,BodyGuard,UnnamedDefender".split(","),vb={Thug:{resources:{cash:750,food:281,steel:563,
cement:281,influence:10},bail:2250},Courier:{resources:{cash:500,food:188,steel:188,cement:375,influence:10}},Arsonist:{resources:{cash:1100,food:825,steel:413,cement:413,influence:10},bail:5100,research:{Logistics:1},buildings:{Hideout:2}},Bruiser:{resources:{cash:2700,food:2025,steel:1013,cement:1013,influence:20},bail:8100,research:{Corruption:6},buildings:{Workshop:3,Hideout:4}},Demolitionist:{resources:{cash:1700,food:638,steel:1275,cement:638,influence:20},bail:5100,research:{Proficiency:4},
buildings:{Garage:3,Hideout:3}},DeliveryTruck:{resources:{cash:3800,food:1425,steel:1425,cement:2850,influence:15},research:{Capacity:8,Mechanics:6},buildings:{Garage:2,Hideout:5}},Hitman:{resources:{cash:3800,food:1900,steel:1900,cement:1900,influence:30},bail:11400,research:{Proficiency:7,Corruption:7},buildings:{Garage:5,Hideout:6,Workshop:5}},TommyGunner:{resources:{cash:8500,food:6375,steel:3188,cement:3188,influence:40},bail:25500,research:{Corruption:10},buildings:{Hideout:8,Workshop:6}},Enforcer:{resources:{cash:5700,
food:2138,steel:4250,cement:2138,influence:30},bail:17100,research:{Proficiency:8},buildings:{Garage:6,Hideout:7}},Professional:{resources:{cash:13E3,food:4875,steel:9750,cement:4875,influence:40},bail:39E3,research:{Proficiency:12},buildings:{Garage:9,Hideout:9}},BarbedWire:{resources:{cash:1700,food:638,steel:638,cement:1275},research:{Logistics:4},buildings:{GuardPost:2,Wall:2}},BoobyTrap:{resources:{cash:2700,food:1013,steel:1013,cement:2025},research:{Logistics:8},buildings:{GuardPost:4,Wall:4}},
GuardDog:{resources:{cash:3800,food:1425,steel:1425,cement:2850},research:{Logistics:12},buildings:{GuardPost:6,Wall:6}},ArmedGuard:{resources:{cash:5700,food:2138,steel:2138,cement:4275},research:{Logistics:14},buildings:{GuardPost:7,Wall:7}},Sniper:{resources:{cash:15600,food:7800,steel:7800,cement:7800,influence:40},bail:46800,research:{Corruption:14,Proficiency:14},buildings:{Hideout:9,Workshop:9,Garage:9}},Butcher:{resources:{cash:17160,food:12870,steel:6435,cement:6435,influence:35},bail:51480,
research:{Corruption:16,Cooking:17},buildings:{Hideout:9,Workshop:9}},Bodyguard:{resources:{cash:17160,food:6435,steel:6435,cement:12870},research:{Logistics:16},buildings:{GuardPost:8,Wall:8}},UnnamedDefender:{resources:{cash:18876,food:7079,steel:7079,cement:14157},research:{Logistics:18},buildings:{GuardPost:9,Wall:9}},BlackWidow:{resources:{cash:18875,food:14157,steel:7079,cement:7079,influence:35},bail:56628,research:{Corruption:17},buildings:{Hideout:9,Workshop:9},items:{Contract:1}},Assassin:{resources:{cash:18876,
food:7079,steel:14157,cement:7079,influence:35},bail:56628,research:{Proficiency:17},buildings:{Garage:9,Hideout:9},items:{Contract:1}},Smuggler:{resources:{cash:20764,food:15573,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"GreenwichVillage"},Undertaker:{resources:{cash:20764,food:7785,steel:15573,cement:7785,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"Brooklin"},
Doctor:{resources:{cash:20764,food:20764,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"ParkAve"},LoanShark:{resources:{cash:20764,food:20764,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Favor:1},city:"AtlanticCity"},HatchetMan:{resources:{cash:20764,food:7786,steel:7786,cement:15573,influence:35},bail:62292,research:{Medicine:12,Muscle:12},
buildings:{Garage:9,Hideout:9,Workshop:9},items:{Favor:1},city:"Chinatown"},TriggerMan:{resources:{cash:18876,food:14157,steel:7079,cement:7079,influence:35},bail:56628,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"Capital"},CrookedCop:{resources:{cash:22840,food:17130,steel:8565,cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Hideout:10,Workshop:10},items:{Kickback:1},city:"GreenwichVillage"},DRC:{resources:{cash:22840,food:8565,steel:17130,
cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10},items:{Kickback:1},city:"Brooklin"},PIG:{resources:{cash:22840,food:8565,steel:8565,cement:17130,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Kickback:1},city:"ParkAve"},GMan:{resources:{cash:22840,food:8565,steel:8565,cement:17130,influence:35},research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Kickback:1},
city:"AtlanticCity"},Highbinder:{resources:{cash:22840,food:8565,steel:17130,cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Kickback:1},city:"Chinatown"}},D=["neighborhood","east","west","south","north"],na=0,wa=1,ea="GF PUPPACELO KABAM",ka=ea+" 1.4a",ma="http://gpt.tiestoale.com",jb=0,ta=1,qb=4,mb=8,ob=9,Ja=false,db=0,Oa=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,Qa="Info",Ra="Costr.",nb="Opz.",pb="Admin",rb="?",
j={},V,S,Pa="pbPoppTop";navigator.language.substring(0,2).toLowerCase();if(document.URL.search(/apps.facebook.com\/kabam_godfather/i)>=0)Ua();else if(document.URL.search(/the-godfather\/play/i)>=0)Va();else{Ba=null;Ca=null;Da=null;oa=null;Ea=null;T="en";var q={calls:{"bookmarks.json":{type:"GET",parms:{"bookmark[x]":0,"bookmark[y]":0,city_id:0}},"cities/@@id1/marches.json":{type:"POST",parms:{"march[units]":"","march[floor]":0,city_id:0,"march[x]":0,"march[y]":0,_method:"post"}},"cities/@@id1/marches/@@id2.json":{type:"POST",
parms:{city_id:0,_method:"delete"}},"cities/@@id1/wildernesses/@@id2/collect.json":{type:"POST",parms:{city_id:0,city_building_id:0}},"cities/@@id1.json":{type:"GET",parms:{}},"#cities/@@id1.json":{type:"POST",parms:{city_id:0,_method:"put",defended:0}},"cities/@@id1/npc_buildings/@@id2.json":{type:"POST",parms:{_method:"put",city_id:0,city_building_id:0}},"cities/@@id1/buildings/@@id2.json":{type:"POST",parms:{_method:"put",city_id:0,"city_building[neighborhood_id]":0}},"cities/@@id1/units.json":{type:"POST",
parms:{city_id:0,_method:"post","units[include_requirements]":false,"units[unit_type]":"","units[quantity]":0}},"cities/@@id1/cash_jail.json":{type:"GET",parms:{city_id:0}},"cities/@@id1/cash_jail/bail.json":{type:"POST",parms:{city_id:0,payment_method:"cash"}},"cities/@@id1/researches.json":{type:"POST",parms:{city_id:0,"research[research_type]":""}},"flash/man.kabam":{type:"GET",parms:{cachebreaker:0}},"locales/@@id1.xml":{type:"GET",parms:{}},"manifest/store_items.json":{type:"GET",parms:{_method:"get"}},
"map.json":{type:"GET",parms:{x:0,y:0,city_id:0}},"messages.json":{type:"POST",parms:{"message[subject]":"null","message[message]":"null",player_id:0,city_id:0}},"player.json":{type:"GET",parms:{}},"player_king_of_the_hills/bonus_families.json":{type:"GET",parms:{action:"index"}},"player_items/@@id1.json":{type:"POST",parms:{city_id:0,_method:"delete"}},"reports.json":{type:"GET",parms:{category:"all",count:90,page:1,city_id:0}},"reports/@@id1.json":{type:"GET",parms:{city_id:0}},"reports/bulk_delete.json":{type:"POST",
parms:{_method:"delete",ids:"",city_id:0}},"respect_rank.json":{type:"GET",parms:{page:0,family_id:0,count:10,city_id:0}},"territories.json":{type:"GET",parms:{}},"tournaments/@@id1.json":{type:"GET",parms:{page:0,city_id:0}},"minigames/index.json":{type:"GET",parms:{city_id:0}},"minigames/save_result.json":{type:"POST",parms:{minigame_timestamp:0,city_id:0}}},generalCall:function(a,b,c,d,e){var g,l,s=q.calls[a];e==void 0&&(e=false);l=e?{}:q.commonPars();for(g in s.parms)l[g]=s.parms[g];new Bb(a.replace(RegExp("#",
"g"),""),b,c,s.type,l,function(a){var b=q.resultError(a);a.ok=b.ok;a.errmsg=b.msg;o.setVarious(a);d&&d(a)},e)},commonPars:function(){var a={};a.user_id=Ca;a._session_id=Ba;a.gangster=Da;return a},checkRslt:function(a){var b=false;a.ok&&!a.dat.errors&&(b=true);return b},resultError:function(a,b){var c={ok:false,msg:""};b==void 0&&(b=false);if(q.checkRslt(a))if(b)c.ok=true;else if(a.dat.result){var d=a.dat.result;d.reason&&d.reason!==""?c.msg=d.reason:d.errors&&d.errors[0]!==""?c.msg=d.errors[0]:a.ok?
c.ok=true:c.msg=h("Errore")+" "+a.status}else a.ok?c.ok=true:c.msg=h("Errore")+" "+a.status;else c.msg=a.errmsg?a.errmsg:h("Errore")+" "+a.status;if(c.ok&&o.serverTimeOffset===0&&a.dat.timestamp)o.serverTimeOffset=a.dat.timestamp-(new Date).getTime()/1E3;return c}},wb="albertanastasiamaleunlocker,boxingticket,caneholdingfemaleunlocker,caneholdingmaleunlocker,caposafe,changealias,changeestatename,chosenrelocation,chosenrelocationbundle,familychange,harrystraussmaleunlocker,jackiediamondfemaleunlocker,mademansafe,manmadesafe,promoteguarantee1,promoteguarantee2,promoteguarantee3,promoteguarantee4,relocationprogram,shamrock,snowball".split(","),
L={store:{},useObject:function(a){q.calls["player_items/@@id1.json"].parms.city_id=v.getCityId(0);q.generalCall("player_items/@@id1.json",a,"",function(a){if(a.ok)a=a.dat.result,o.player.items=a.items,j.Various.type==da&&j.Various.showDiv()})},isUnusable:function(a){var b=false,c;for(c=0;c<wb.length;c++)if(a.toLowerCase()==wb[c]){b=true;break}return b},readStore:function(){L.store={};q.generalCall("manifest/store_items.json","","",function(a){if(a.ok)L.store.resources=a.dat.store.resources,L.store.speedup=
a.dat.store.speedup,L.store.packages=a.dat.store.packages,L.store.misc=a.dat.store.misc,L.store.general=a.dat.store.general;o.readInfoPlayer()})},getInventory:function(){var a={msg:"",els:[]},b,c,d;a.msg+="<DIV class=pbTitle><TABLE width=100%><TR><TD>"+h("my-items","common").toUpperCase()+"</td></tr></table></div>";for(b in L.store){d=L.getInventorySingle(b);a.msg+=d.msg;for(c=0;c<d.els.length;c++)a.els.push(d.els[c])}return a},getInventorySingle:function(a){var b={msg:"",els:[]},c,d,e,g=0;for(c=
0;c<L.store[a].length;c++)if(d=L.store[a][c],!(o.player.items[d.type]==void 0||o.player.items[d.type]===0)&&d.show_in_inventory!==false)e=d.usable===true&&!L.isUnusable(d.type),b.msg===""&&(b.msg+="<HR><DIV class=pbSubtitle>",b.msg+="<TABLE width=100%><TR><TD align=center>"+h(a,"common").toUpperCase()+"</td></tr></table>",b.msg+="<TABLE width=100%>"),g++,g%2!==0&&(g>1&&(b.msg+="</tr>"),b.msg+="<TR>"),b.msg+="<TD width=50%>",b.msg+="<TABLE width=100%><TR>",e?(b.msg+="<TD align=left>&nbsp;"+y("pbvarsItem_"+
d.type,h("use","common"),!e,false,"small")+"</td>",b.els.push("pbvarsItem_"+d.type)):b.msg+="<TD align=left>&nbsp;</td>",b.msg+="<TD align=left>&nbsp;"+h(d.type,"items")+" ("+E(o.player.items[d.type])+")&nbsp;</td>",b.msg+="</tr></table>",b.msg+="</td>";b.msg!==""&&(g%2!==0&&(b.msg+="<TD width=50%>&nbsp;</td>"),b.msg+="</tr></table></div>");return b}},G={msgs:[],total:0,page:0,msg:{},timer:null,type:"BattleReport",readed:[],readPage:function(a){var b=v.getCityId(0);a==void 0&&(a="all");G.msgs=[];
G.msg={};G.total=G.page=0;q.calls["reports.json"].parms.category=a;q.calls["reports.json"].parms.city_id=b;q.calls["reports.json"].parms.count=90;q.calls["reports.json"].parms.page=1;q.generalCall("reports.json","","",function(a){if(a.ok){var b=G,e,g;clearTimeout(b.timer);a=a.dat.result;b.total=a.total;b.page=a.page;for(e=0;e<a.report_notifications.length;e++)if(g=a.report_notifications[e],(b.type===""||g.report_type==b.type)&&b.readed.indexOf(g.id)==-1)g.created_at<db&&g.read_at!==null||G.msgs.push(g);
if(b.msgs.length!==0){if(b.type!=="")b.timer=setTimeout(b.readReports,500)}else if(n.options.inMarch&&o.marches.active===0)n.options.inMarch=false}})},readReports:function(){var a=G,b=a.msgs[0];clearTimeout(a.timer);if(b&&(a.readed.push(b.id),a.readReport(b.id),a.msgs.shift(),a.msgs.length>0))a.timer=setTimeout(a.readReports,500)},readReport:function(a){var b=v.getCityId(0);G.msg={};q.calls["reports/@@id1.json"].parms.city_id=b;q.generalCall("reports/@@id1.json",a,"",function(a){if(a.ok)a=a.dat.result,
G.msg=a.report,a=a.report_notification,a.report_type=="BattleReport"&&(j.Wave.addStatFromReport(G.msg,a.id),j.Gang.addStatFromReport(G.msg,a.id))})},deleteReport:function(a){var b=[];b.push(a);G.deleteReports(b)},deleteReports:function(a){var b=v.getCityId(0),a=a.join("|");a+="|";q.calls["reports/bulk_delete.json"].parms.city_id=b;q.calls["reports/bulk_delete.json"].parms.ids=a;q.generalCall("reports/bulk_delete.json","","",null)}},p={firstx:0,firsty:0,distx:0,disty:0,lastx:0,lasty:0,stepx:0,stepy:0,
radius:0,stepMax:0,targets:{},done:false,callback:null,retry:0,err:false,normalize:function(a){var b=a;a>749&&(b-=Z);a<0&&(b+=Z);return b},scan:function(a,b,c,d,e,g){e==void 0&&(e=a);g==void 0&&(g=b);p.done=p.err=false;p.retry=0;p.radius=c;p.stepMax=(p.radius-7)/15;p.targets={};p.targets.cities=[];p.targets.wilderness=[];p.targets.terrains={};p.callback=d;p.distx=e;p.disty=g;p.firstx=p.lastx=a;p.firsty=p.lasty=b;p.stepx=p.stepy=-p.stepMax;p.requestMap()},getSingleInfo:function(a,b){var c,d,e,g={id:0,
level:0,name:"",player:null,type_city:"",type:"",x:-1,y:-1,dist:0,ok:false},l=false;for(c=0;c<p.targets.wilderness.length;c++)if(d=p.targets.wilderness[c],d.x==a&&d.y==b){g.id=d.id;g.level=d.level;g.player=d.player;g.x=d.x;g.y=d.y;g.dist=d.dist;g.ok=true;break}for(c=0;c<p.targets.cities.length;c++)if(d=p.targets.cities[c],d.x==a&&d.y==b){g.player=d.player;g.id=d.id;g.name=d.name;g.type_city=d.type;g.x=d.x;g.y=d.y;g.dist=d.dist;g.ok=true;break}for(e in p.targets.terrains){for(c=0;c<p.targets.terrains[e].length;c++)if(d=
p.targets.terrains[e][c],d.x==a&&d.y==b){g.level=d.level;g.type=e;g.x=d.x;g.y=d.y;g.dist=d.dist;l=g.ok=true;break}if(l)break}return g},requestMap:function(){var a=v.getCityId(0);p.lastx=p.normalize(p.firstx+p.stepx*15);p.lasty=p.normalize(p.firsty+p.stepy*15);q.calls["map.json"].parms.x=p.lastx;q.calls["map.json"].parms.y=p.lasty;q.calls["map.json"].parms.city_id=a;q.generalCall("map.json","","",p.readMap)},readMap:function(a){p.done=false;if(a.ok){var b,c,d,e,g,l,s,f,h;p.retry=0;a=a.dat;p.targets.wilderness=
[];for(b=0;b<a.city_wildernesses.length;b++)e=a.city_wildernesses[b],p.targets.wilderness.push({id:e.id,level:e.level,player:e.player,x:e.x,y:e.y,dist:Na(p.distx,p.disty,e.x,e.y)});p.targets.cities=[];for(b=0;b<a.map_cities.length;b++)e=a.map_cities[b],p.targets.cities.push({id:e.id,name:e.name,player:e.player,"protected":e["protected"],protected_until:e.protected_until,type:e.type,use_common_buildings:e.use_common_buildings,x:e.x,y:e.y,dist:Na(p.distx,p.disty,e.x,e.y)});p.targets.terrains={};for(b=
0;b<a.terrain.length;b++)for(c=0;c<a.terrain[b].length;c++)if(d=a.terrain[b][c],l=d[0],l=="Blank"?(l=d[1],g=99):g=d[1],s=d[2],f=d[3],l!="City"){if(l=="CityScape"||l=="Slum"){h=false;for(d=0;d<p.targets.wilderness.length;d++)if(e=p.targets.wilderness[d],e.x==s&&e.y==f){h=true;break}if(h)continue;for(d=0;d<p.targets.cities.length;d++)if(e=p.targets.cities[d],e.x==s&&e.y==f){h=true;break}if(h)continue}p.targets.terrains[l]==void 0&&(p.targets.terrains[l]=[]);p.targets.terrains[l].push({id:s*1E3+f,level:g,
x:s,y:f,dist:Na(p.distx,p.disty,s,f)})}p.stepx++;if(p.stepx>=p.stepMax&&(p.stepx=-p.stepMax,p.stepy++,p.stepy>=p.stepMax))p.stepy=-p.stepMax,p.done=true}else p.retry++,p.done=p.err=p.retry>=10;p.done||setTimeout(p.requestMap,1E3);p.callback&&p.callback()}},pa={xml:{},init:function(a){pa.fetchLocale(function(b){a&&a(b)})},fetchLocale:function(a){var b=pa;q.generalCall("locales/@@id1.xml",T,"",function(c){if(c.ok){try{var d,e=c.dat,g=new XML.ObjTree;for(d=0;d<10;d++)e=e.replace(RegExp("<"+d,"g"),"<alpha_"+
d).replace(RegExp("</"+d,"g"),"</alpha_"+d);b.xml=g.parseXML(e)}catch(l){c.ok=false,c.errmsg=l.toString()}a&&a(c)}})}},xb={ptWin:{IsOpen:true,Drag:true,Pos:{x:760,y:93}},size:{x:500,y:800},_reset:{enabled:false,delay:10,unit:60},save:{enabled:false,delay:10,unit:60},blds:{enabled:false,ind:0,type:"",blden:[],bldcap:[],bldexp:[]},wave:{enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],units:[],floors:[],imperial:[]},gang:{enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],
en:[],coords:[],units:[],last:[],leven:[],dist:[],same:60},coll:{collen:[]},trps:{enabled:false,ind:0,type:"",trpen:[],tprqty:[]},resc:{enabled:false,ind:0,type:"",resen:[],rescap:[]},tips:true,inMarch:false,every6:false,tabEnabled:[],info:{enabled:true,delay:5,unit:60},flash:{enabled:false,delay:15,unit:60},tool:{enabled:false,delay:15,unit:60},TESTOPTION:{}},cb="div {margin:0 ! important}.incoming {font-weight:bold; font-size:24px; color:#FF0000;}div.pbTitle {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#6B7E8B}div.pbTitleRed {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FF0000; background-color:#6B7E8B}div.pbSubtitle {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#444}div.pbSubtitleRed {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FF0000; background-color:#444}div.pbAttack {border:1px solid; border-color:#FF0000; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#000000}div.pbInput {border:2px; background-color:#6B6258; padding:3px}div.pbStatBox {border:1px solid; border-color:white; background-color:#6B6258; padding:2px}div.short {height:7px;}.hiding {background-color: #21A121; color: white; padding-left: 10px; padding-right: 10px; margin-right: -2px;}.defending {background-color: #F80000; color: white; padding-left: 10px; padding-right: 10px; margin-right: -2px;}table.pbTabWrap {width: 100%;}table.pbTabWrap tr td {border:none; background:none; white-space:normal; padding: 1px 1px}table.pbTabPad {width: 100%;}table.pbTabPad tr td {border:none; background:none; white-space:nowrap; padding: 1px 1px}table.pbTab {width:100%;}table.pbTab tr td {border:none; background:none; white-space:nowrap; padding: 1px 1px;}table tr td.pbTabLeft {font-weight:bold; text-align:left; width: 20%;}table tr td.pbTabRight {text-align:right;}table.pbTabLined tr td {border-bottom:1px solid #ccc; background:none; white-space:nowrap; padding: 1px 4px 1px 4px;}table tr.pbTabHdr1 td {background-color:#dde#000000; font-weight:bold}table tr.pbTabHdr2 td {font-weight:bold}tr.pbMarchOther td {color:#CCCCCC}tr.pbMarchMine td {color:#00FF00}tr.pbMarchEncamp td {color:#FF9900}tr.pbMarchReturn td {color:#33CCFF}tr.pbPoppTop td { background-color:#000000; border:none; height: 21px;  padding:0px; }tr.pbretry_pbPoppTop td { background-color:#a00; color:#fff; border:none; height: 21px; padding:0px; }tr.pbOwned {background-color: #e80000; color:white}table.pbMainTab {empty-cells:show; margin-top:5px; }table.pbMainTab tr td a {color:inherit }table.pbMainTab tr td   {height:60%; empty-cells:show; padding: 0px 5px 0px 5px;  margin-top:5px; white-space:nowrap; border: 2px solid; border-style: none none solid none; }table.pbMainTab tr td.spacer {padding: 0px 1px; border:none;}table.pbMainTab tr td.sel    {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#FFFFFF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSel {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#6B7E8B; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selRed {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#FF0000; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelRed {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#FF0000; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selBlue {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#0000FF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelBlue {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#0000FF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selGreen {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#00FF00; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelGreen {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#00FF00; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}.CPopuppa .CPopMain { color:#FFFFFF; background-color:#000000; padding:6px; z-index:65000; left=700px;}.CPopuppa  {border:3px ridge #666 z-index:65000; left=700px;}input.butAttackOff {width:auto; background-color:#FF0000; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.butAttackOn {width:auto; background-color:#21A121; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.small {margin:0; padding:0; font-size:10px}input.smallGreen {margin:0; padding:0; color:#21A121; font-size:10px}input.smallRed {margin:0; padding:0; color:#FF0000; font-size:10px}input.smallBlue {margin:0; padding:0; color:#0000FF; font-size:10px}input.smallGrey {margin:0; padding:0; color:#909090; font-size:10px}input.smallBrown {margin:0; padding:0; color:#A0522D; font-size:10px}input.smallDisabled {margin:0; padding:0; color:#D8D8D8; font-size:10px}input.normalGreen {margin:0; padding:0; color:#21A121; font-size:13px}input.normalRed {margin:0; padding:0; color:#FF0000; font-size:13px}input.short {width:30px}input.megaButton {width:auto; background-color:#0044a0; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.megaButton:active {width:auto; background-color:black; color:white; font-weight:bold; cursor:hand; cursor:pointer; }input.megaButton:hover {width:auto; background-color:#770000; color:white; font-weight:bold; cursor:hand; cursor:pointer; }hr.thin {margin:0px; padding:0px}#ft ul.tabs li.tab a.toolbutOn {background-color:#900 ! important; color:white ! important}#ft ul.tabs li.tab a.toolbuttOff {background-color:#ffc ! important; color:black ! important}span.LinkWhite {color:#FFFFFF}span.boldRed {color:#FF0000; font-weight:bold}span.normalRed {color:#FF0000}span.boldGreen {color:#21A121; font-weight:bold}span.normalGreen {color:#21A121}span.toSpectral {color:#FF9900; font-weight:bold}span.toCity {color:#33CCFF; font-weight:bold}.xstooltip {font: normal 8pt sans-serif; padding: 3px; border: solid 1px; background: ivory; color: black}";
typeof JSON!=="object"&&(JSON={});(function(){function a(a){return a<10?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=s[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,s,h,j,n=g,o,p=d[a];p&&typeof p==="object"&&typeof p.toJSON==="function"&&(p=p.toJSON(a));typeof f==="function"&&(p=f.call(d,a,p));switch(typeof p){case "string":return b(p);case "number":return isFinite(p)?String(p):
"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";g+=l;o=[];if(Object.prototype.toString.apply(p)==="[object Array]"){j=p.length;for(e=0;e<j;e++)o[e]=c(e,p)||"null";h=o.length===0?"[]":g?"[\n"+g+o.join(",\n"+g)+"\n"+n+"]":"["+o.join(",")+"]";g=n;return h}if(f&&typeof f==="object"){j=f.length;for(e=0;e<j;e++)typeof f[e]==="string"&&(s=f[e],(h=c(s,p))&&o.push(b(s)+(g?": ":":")+h))}else for(s in p)Object.prototype.hasOwnProperty.call(p,s)&&(h=c(s,p))&&o.push(b(s)+(g?
": ":":")+h);h=o.length===0?"{}":g?"{\n"+g+o.join(",\n"+g)+"\n"+n+"}":"{"+o.join(",")+"}";g=n;return h}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,l,s={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,d){var e;l=g="";if(typeof d==="number")for(e=0;e<d;e++)l+=" ";else typeof d==="string"&&(l=d);if((f=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return c("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function c(a,d){var e,g,l=a[d];if(l&&typeof l==="object")for(e in l)Object.prototype.hasOwnProperty.call(l,e)&&(g=c(l,e),g!==void 0?l[e]=g:delete l[e]);return b.call(a,d,l)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();var la=JSON,Ha=null,Za=0,o={tickTimer:null,serverTimeOffset:0,marches:{total:0,encamped:0,retreating:0,marching:0,active:0},player:{},indcity:0,ntick:0,showInfo:false,readManifest:function(){q.calls["flash/man.kabam"].parms.cachebreaker=C();q.generalCall("flash/man.kabam","","",function(){L.readStore()},true)},readInfoPlayer:function(){q.generalCall("player.json",
"","",function(a){if(a.ok)o.player=a.dat,o.indcity=0,o.readNextCity()})},readNextCity:function(){function a(a){if(a.ok)o.player.cities[o.indcity]=a.dat.city,o.indcity++,setTimeout(o.readNextCity,2E3)}o.indcity>=o.player.cities.length?Ja||zb():q.generalCall("cities/@@id1.json",o.player.cities[o.indcity].id,"",a)},readCitySingle:function(a){q.generalCall("cities/@@id1.json",o.player.cities[a].id,"",function(b){if(b.ok)o.player.cities[a]=b.dat.city})},setVarious:function(a){if(a.ok){a=a.dat;if(a.energy)o.player.energy=
a.energy;if(a.respect)o.player.respect=a.respect;if(a.boosts)o.player.boosts=a.boosts;if(a.quests)o.player.quests=a.quests}},tick:function(){var a=o;a.ntick++;v.runCitiesRefresh();z.checkAndCountMarches();if(!n.options.inMarch&&o.marches.active!==0)n.options.inMarch=true;if(n.options.inMarch&&a.ntick%20===0)G.type="BattleReport",G.readPage()}},fa={timer:null,but:null,init:function(){var a=fa;if(!n.options.ptWin.IsOpen)clearInterval(a.timer),a.timer=setInterval(a.blink,1500)},show:function(a){var b=
fa;if(n.options.ptWin.IsOpen!=a)if(n.options.ptWin.IsOpen=a,V.show(a),clearInterval(b.timer),a){if(b.but)b.but.className="toolbuttOff"}else b.timer=setInterval(b.blink,1500)},setBlinkElement:function(a){fa.but=a},blink:function(){var a=fa;if(a.but)a.but.className=a.but.className=="toolbuttOff"?"toolbutOn":"toolbuttOff"}};Date.prototype.myString=function(){return this.toLocaleDateString()+" "+this.toLocaleTimeString()};Date.prototype.formatTime=function(){var a=this.getHours(),b=this.getMinutes(),
c=this.getSeconds();return(a<10?"0":"")+a+Ia+(b<10?"0":"")+b+Ia+(c<10?"0":"")+c};Date.prototype.formatDate=function(a){var b=this.getDate(),c=this.getMonth(),d=this.getFullYear();a==void 0&&(a="it");c++;switch(a){case "sv":case "en":a=d+ba+(c<10?"0":"")+c+ba+(b<10?"0":"")+b;break;default:a=(b<10?"0":"")+b+ba+(c<10?"0":"")+c+ba+d}return a};var Ka={it:{Info:"Info",Onda:"Onda",Gang:"Gang","Costr.":"Costr.",Raccogli:"Raccogli",Ruota:"Ruota",Varie:"Varie","Opz.":"Opz.","?":"?","Creato da":"Creato da",
"Errore di Inizializzazione":"Errore di Inizializzazione","SWF non trovato":"SWF non trovato","Non posso caricare":"Non posso caricare",Caricato:"Caricato","sar\u00e0 ricaricato tra 10 secondi":"sar\u00e0 ricaricato tra 10 secondi","Sommario di tutte le attivit\u00e0":"Sommario di tutte le attivit\u00e0","Buon gioco":"Buon gioco","Aggiorna Info":"Aggiorna Info","Ricarica GF":"Ricarica GF","Mostra Flash":"Mostra Flash","Nascondi Flash":"Nascondi Flash","Seleziona le tue preferenze e":"Seleziona le tue preferenze e",
"Questo tab ti informa sul nostro tool":"Questo tab ti informa sul nostro tool","Gruppo su Facebook":"Gruppo su Facebook","LOG AZIONI":"LOG AZIONI","Cancella Log":"Cancella Log",Errore:"Errore",CHIUDI:"CHIUDI","Non riprovare":"Non riprovare","Riprovo tra":"Riprovo tra","in automatico":"in automatico","Leggi Info ogni":"Leggi Info ogni","Leggi ORA":"Leggi ORA","Riavvia Flash ogni":"Riavvia Flash ogni","Riavvia ORA":"Riavvia ORA","Riavvia Tool ogni":"Riavvia Tool ogni",Secondi:"Secondi",Minuti:"Minuti",
Ore:"Ore",Giorni:"Giorni",Opzioni:"Opzioni","Ritardo tra attacchi":"Ritardo tra attacchi","Ritardo stesso obiettivo":"Ritardo stesso obiettivo","Elimina rapporti":"Elimina rapporti","Scan Mappa":"Scan Mappa","Scansione terminata":"Scansione terminata","Scansione gang di":"Scansione gang di",Distanza:"Distanza",Coordinate:"Coordinate","Ultimo attacco":"Ultimo attacco","Ultimi attacchi":"Ultimi attacchi","Raggiunto il limite massimo delle marce":"Raggiunto il limite massimo delle marce","Non hai abbastanza":"Non hai abbastanza",
"Troppe truppe":"Troppe truppe","Iniziate il":"Iniziate il","Tempo di esecuzione":"Tempo di esecuzione",Attacchi:"Attacchi",Abilita:"Abilita","Energia insufficiente":"Energia insufficiente","Nessuna truppa selezionata":"Nessuna truppa selezionata","Nessun obiettivo selezionato":"Nessun obiettivo selezionato","Raccogli dai tuoi slot":"Raccogli dai tuoi slot",neighborhood:"Centrale",east:"Est",west:"Ovest",south:"Sud",north:"Nord",Piano:"Piano",ogni:"ogni",packages:"Pacchi","le MURDER pi\u00f9 vicine entro una distanza di 37":"le MURDER pi\u00f9 vicine entro una distanza di 37",
"Copia in Onda":"Copia in Onda","In arrivo":"In arrivo"},en:{Info:"Info",Onda:"Wave",Gang:"Gang","Costr.":"Build",Raccogli:"Collect",Ruota:"Wheel",Varie:"Various","Opz.":"Opts","?":"?","Creato da":"Created by","Errore di Inizializzazione":"Error on Initializing","SWF non trovato":"SWF not found","Non posso caricare":"I can't load",Caricato:"Loaded","sar\u00e0 ricaricato tra 10 secondi":"will be reloaed in 10 seconds","Sommario di tutte le attivit\u00e0":"Summary of all activities","Buon gioco":"Good game",
"Aggiorna Info":"Update Info","Ricarica GF":"Reload GF","Mostra Flash":"Show Flash","Nascondi Flash":"Hide Flash","Seleziona le tue preferenze e":"Select your preferences and","Questo tab ti informa sul nostro tool":"These tab inform you about our tool","Gruppo su Facebook":"Facebook Group","LOG AZIONI":"ACTIONS LOG","Cancella Log":"Delete Log",Errore:"Error",CHIUDI:"CLOSE","Non riprovare":"Not Retry","Riprovo tra":"Retry in","in automatico":"automatically","Leggi Info ogni":"Read Info every","Leggi ORA":"Read NOW",
"Riavvia Flash ogni":"Restart Flash every","Riavvia ORA":"Restart NOW","Riavvia Tool ogni":"Restart Tool every",Secondi:"Seconds",Minuti:"Minutes",Ore:"Hours",Giorni:"Days",Opzioni:"Options","Ritardo tra attacchi":"Delay between attacks","Ritardo stesso obiettivo":"Delay same target","Elimina rapporti":"Delete reports","Scan Mappa":"Scan Map","Scansione terminata":"Scan finished","Scansione gang di":"Scan gang of",Distanza:"Distance",Coordinate:"Coordinates","Ultimo attacco":"Last attack","Ultimi attacchi":"Last attacks",
"Raggiunto il limite massimo delle marce":"Marches: reached maximum limit","Non hai abbastanza":"You don't have enough","Troppe truppe":"Too many troops","Iniziate il":"Started at","Tempo di esecuzione":"Run Time",Attacchi:"Attacks",Abilita:"Enable","Energia insufficiente":"Insufficient energy","Nessuna truppa selezionata":"No troops selected","Nessun obiettivo selezionato":"No target selected","Raccogli dai tuoi slot":"Collect from your slot",neighborhood:"Central",east:"East",west:"West",south:"South",
north:"North",Piano:"Floor",ogni:"every",packages:"packages","le MURDER pi\u00f9 vicine entro una distanza di 37":"the nearest MURDER in a distance of 37","Copia in Onda":"Copy to Wave","In arrivo":"Coming soon"},de:{Info:"Info",Onda:"Wellen",Gang:"Gang","Costr.":"Bauen",Raccogli:"Einsammeln",Ruota:"Rad",Varie:"Verschiedene","Opz.":"Optionen","?":"?","Creato da":"Erstellt von","Errore di Inizializzazione":"Ladefehler","SWF non trovato":"SWF nicht gefunden","Non posso caricare":"Nicht geladen",Caricato:"Geladen",
"sar\u00e0 ricaricato tra 10 secondi":"wird in 10 Sekunden neu geladen","Sommario di tutte le attivit\u00e0":"Uebersicht","Buon gioco":"Gutes Spiel","Aggiorna Info":"aktualisieren Info","Ricarica GF":"Nachladen GF","Mostra Flash":"Flash zeigen","Nascondi Flash":"Flash verbergen","Seleziona le tue preferenze e":"Waehle deine Einstellungen und","Questo tab ti informa sul nostro tool":"Diese Tab informieren Sie \u00fcber uns Tool","Gruppo su Facebook":"Facebook Gruppe","LOG AZIONI":"AKTIONEN LOG","Cancella Log":"Loesche Log",
Errore:"Fehler",CHIUDI:"SCHLIESSEN","Non riprovare":"Kein Neuversuch","Riprovo tra":"Neuversuch in","in automatico":"automatisch","Leggi Info ogni":"Infos einlesen alle","Leggi ORA":"JETZT neu einlesen","Riavvia Flash ogni":"Flash Neustart alle","Riavvia ORA":"JETZT neu starten","Riavvia Tool ogni":"Tool Neustart alle",Secondi:"Sekunden",Minuti:"Minuten",Ore:"Stunden",Giorni:"Tage",Opzioni:"Optionen","Ritardo tra attacchi":"Angiffs Zeitintervall","Ritardo stesso obiettivo":"Zeitintervall bei gleichen Zielen",
"Elimina rapporti":"Berichte loeschen","Scan Mappa":"Karte scannen","Scansione terminata":"Scan abgeschlossen","Scansione gang di":"Gangs scannen von",Distanza:"Distanz",Coordinate:"Koordinaten","Ultimo attacco":"Letzter Angriff","Ultimi attacchi":"Letzte Angriffe","Raggiunto il limite massimo delle marce":"Befehle: Maximum Limit erreicht","Non hai abbastanza":"Du hast nicht genug","Troppe truppe":"Zu viele Einheiten","Iniziate il":"Gestartet um","Tempo di esecuzione":"Laufzeit",Attacchi:"Angriffe",
Abilita:"Aktivieren","Energia insufficiente":"Unzureichende Energie","Nessuna truppa selezionata":"Keine Einheiten ausgewaehlt","Nessun obiettivo selezionato":"Kein Ziel ausgewaehlt","Raccogli dai tuoi slot":"Slots einsammeln",neighborhood:"Zentral",east:"Ost",west:"West",south:"Sued",north:"Nord",Piano:"Etage",ogni:"alle",packages:"Pakete","le MURDER pi\u00f9 vicine entro una distanza di 37":"die n\u00e4chsten MURDER in einer Entfernung von 37","Copia in Onda":"Kopieren auf Welle","In arrivo":"Kommt bald"},
fr:{Info:"Info",Onda:"Onde",Gang:"Gang","Costr.":"Constr.",Raccogli:"Collecter",Ruota:"Roue",Varie:"Plus","Opz.":"Opts","?":"?","Creato da":"Cr\u00e9\u00e9 par","Errore di Inizializzazione":"Erreur de initialisation","SWF non trovato":"SWF introuvable","Non posso caricare":"Je ne peux pas t\u00e9l\u00e9charger",Caricato:"Charg\u00e9","sar\u00e0 ricaricato tra 10 secondi":"sera recharg\u00e9e en 10 secondes","Sommario di tutte le attivit\u00e0":"R\u00e9sum\u00e9 de toutes les activit\u00e9s","Buon gioco":"Bon jeu",
"Aggiorna Info":"Mise \u00e0 jour Info","Ricarica GF":"Recharger GF","Mostra Flash":"Voir le Flash","Nascondi Flash":"Masquer le Flash","Seleziona le tue preferenze e":"S\u00e9lectionnez vos pr\u00e9f\u00e9rences et","Questo tab ti informa sul nostro tool":"Cet onglet vous informer sur notre tool","Gruppo su Facebook":"Groupe Facebook","LOG AZIONI":"JOURNAL DES ACTIONS","Cancella Log":"Effacer le journal",Errore:"Erreur",CHIUDI:"FERMER","Non riprovare":"Ne pas essayer","Riprovo tra":"Essayez \u00e0 nouveau dans",
"in automatico":"automatiquement","Leggi Info ogni":"Lire Info toutes les","Leggi ORA":"Lire Lire MAINTENANT","Riavvia Flash ogni":"Red\u00e9marrez Flash toutes les","Riavvia ORA":"Red\u00e9marrez MAINTENANT","Riavvia Tool ogni":"Red\u00e9marrez le Tool toutes les",Secondi:"Secondes",Minuti:"Minutes",Ore:"Heures",Giorni:"Jours",Opzioni:"Options","Ritardo tra attacchi":"Retard entre les attaques","Ritardo stesso obiettivo":"Retard m\u00eame objectif","Elimina rapporti":"Supprimer des rapports","Scan Mappa":"Balayage Carte",
"Scansione terminata":"Balayage termin\u00e9e","Scansione gang di":"Balayage de gang de",Distanza:"Distance",Coordinate:"Coordonn\u00e9es","Ultimo attacco":"Derni\u00e8re attaque","Ultimi attacchi":"Derni\u00e8res attaques","Raggiunto il limite massimo delle marce":"Marches: a atteint la limite maximale","Non hai abbastanza":"Vous ne avez pas assez de","Troppe truppe":"Trop de troupes","Iniziate il":"Commenc\u00e9 le","Tempo di esecuzione":"Dur\u00e9e",Attacchi:"Attaques",Abilita:"Activer","Energia insufficiente":"\u00c9nergie insuffisante",
"Nessuna truppa selezionata":"Aucune troupe choisie","Nessun obiettivo selezionato":"Aucune objectif s\u00e9lectionn\u00e9e","Raccogli dai tuoi slot":"Chercher \u00e0 votre slot",neighborhood:"Central",east:"Est",west:"Ouest",south:"Sud",north:"Nord",Piano:"\u00c9tage",ogni:"toutes les",packages:"Colis","le MURDER pi\u00f9 vicine entro una distanza di 37":"les plus proches MURDER dans une distance de 37","Copia in Onda":"Copie en Onde","In arrivo":"Vient"},nl:{"":""},es:{"":""},sv:{"":""},da:{"":""}},
v={citiesToRefresh:[],citiesExpansions:[],defendCity:function(a){var b=v.getCityId(a),a=!o.player.cities[a].defended;q.calls["#cities/@@id1.json"].parms.city_id=b;q.calls["#cities/@@id1.json"].parms.defended=a===true?1:0;q.generalCall("#cities/@@id1.json",b,"",function(a){if(a.ok){var a=a.dat,b=v.getCityIndById(a.city.id);o.player.cities[b]=a.city;j.Build.showInfo()}})},getUnits:function(a){var b={},a=o.player.cities[a],c,d;for(d in a.units)b[d]==void 0&&(b[d]={incity:0,inmarch:0,retreat:0,encamped:0}),
b[d].incity+=a.units[d];for(c=0;c<a.marches.length;c++)for(d in a.marches[c].units)switch(b[d]==void 0&&(b[d]={incity:0,inmarch:0,retreat:0,encamped:0}),a.marches[c].status){case "encamped":b[d].encamped+=a.marches[c].units[d];break;case "retreating":b[d].retreat+=a.marches[c].units[d];break;default:b[d].inmarch+=a.marches[c].units[d]}return b},remainingTimeToCollect:function(a,b){var c=C(),d=1,d=0;if(b!==0)if(n.options.every6)d=21600-u(c-b);else{var e=J.getBuildsByFirstHood(a);if(e.Mansion)d=e.Mansion.builds[0].level,
d=21600*(1-3*(d-1)/100)-u(c-b)}return d},assignExpansions:function(){var a,b,c=o.player.cities,d=v.citiesExpansions;d==void 0&&(d=[]);for(a=0;a<c.length;a++){d[a]==void 0&&(d[a]={});for(b=0;b<D.length;b++)c[a].neighborhoods[D[b]]&&d[a][D[b]]==void 0&&(d[a][D[b]]=true)}},addToRefresh:function(a){var b,c=-1;for(b=0;b<v.citiesToRefresh.length;b++)if(v.citiesToRefresh[b].index==a){c=b;break}c==-1&&v.citiesToRefresh.push({index:a,isRefresh:false})},readCityToRefresh:function(a,b){o.showInfo=b;o.readCitySingle(a);
b&&j.Options.setTimerInfo()},runCitiesRefresh:function(){var a,b=0,c=-1;for(a=0;a<v.citiesToRefresh.length;a++)v.citiesToRefresh[a].isRefresh||(c=a);for(a=0;a<v.citiesToRefresh.length;a++)if(!v.citiesToRefresh[a].isRefresh)v.citiesToRefresh[a].isRefresh=true,setTimeout(v.readCityToRefresh,b*2E3,a,v.citiesToRefresh[a].index==c),b++;v.citiesToRefresh=[]},getCityName:function(a){var b="",a=o.player.cities[a];b+=a.type!="Capital"?h(a.name,"cities"):h(a.type,"cities");return b},getCityTitle:function(a,
b){var c="",d=o.player.cities[a],e="";switch(b.tabLabel){case Qa:e="info";break;case Ra:e="blds"}c+="<TABLE width=100%><TR>";c+="<TD align=left>&nbsp;"+v.getCityName(a);b.expand&&(c+="&nbsp;"+y("pb"+e+"HideShow_"+a," "+(b.expand[a]===true?"-":"+")+" ",false,false,"small"));c+="</td>";c+="<TD align=center>";c+=y("pb"+e+"Defend_"+a,v.getCityDefended(a),false,false,v.getClassDefended(a),"border:none; font-weight:bold");c+="</td>";c+="<TD align=right>"+d.x+"/"+d.y+"&nbsp;</td>";c+="</tr><table>";return c},
getCityDefended:function(a){return h(o.player.cities[a].defended===true?"troops-defending":"troops-hide","common")},getClassDefended:function(a){return o.player.cities[a].defended===true?"defending":"hiding"},getCityIndById:function(a){var b=-1,c,d,e=o.player.cities;for(c=0;c<e.length;c++)if(d=e[c],d.id==a){b=c;break}return b},getCityIndByName:function(a){var b=-1,c,d,e=o.player.cities;for(c=0;c<e.length;c++)if(d=e[c],d.name==a){b=c;break}return b},getCityId:function(a){return o.player.cities[a].id},
getNeighId:function(a,b){b==void 0&&(b="neighborhood");return o.player.cities[a].neighborhoods[b].id}},F={addJob:function(a){var b=F.searchJobById(a.id),c,d=o.player.cities;b!=-1&&F.deleteJob(a.id);for(b=0;b<d.length;b++)if(c=d[b],c.id==a.city_id){c.jobs.push(a);break}},deleteJob:function(a){var b=F.searchJobById(a);if(b!=-1){a=u(b/100);b%=100;var c=o.player.cities[b],d=c.jobs[a];switch(d.queue){case "building":J.setLevelBuild(b,d.city_building_id,d.level)}c.jobs.splice(a,1)}},searchJobById:function(a){var b=
-1,c,d,e,g=o.player.cities;for(c=0;c<g.length;c++){e=g[c];for(d=0;d<e.jobs.length;d++)if(e.jobs[d]&&e.jobs[d].id==a){b=d*100+c;break}if(b!=-1)break}return b},getJobsByQueue:function(a,b){var c=[],d,e=o.player.cities[b];for(d=0;d<e.jobs.length;d++)(e.jobs[d]&&e.jobs[d].queue==a||a==="")&&c.push(e.jobs[d]);return c}},J={checkRequirements:function(a,b){var c=true,d=b.level,e=b.type,g=Math.pow(2,d);if(va[e]){c=La(va[e]);for(r in c.resources)c.resources[r]*=g;if(d==9){if(c.items==void 0)c.items={};c.items.DonsBlessing==
void 0&&(c.items.DonsBlessing=1)}else if(d>9){if(c.items==void 0)c.items={};c.items.DonsBlessing11==void 0&&(c.items.DonsBlessing11=1)}c=eb(a,c)}return c},setLevelBuild:function(a,b,c){a=J.getBuildById(a,b);if(a!==null)a.level=c},getBuildById:function(a,b){var c=null,d,e,g,l,s=false;for(d=0;d<D.length;d++){if((e=o.player.cities[a].neighborhoods[D[d]])&&e.buildings){l=e.buildings;for(e=0;e<l.length;e++)if(g=l[e],g.id==b){c=g;s=true;break}}if(s)break}return c},getBuildsByArea:function(a,b,c,d){var e=
{},a=o.player.cities[a].neighborhoods[b].buildings,g;c==void 0&&(c="");d==void 0&&(d=false);if(a){for(g=0;g<a.length;g++)if(b=a[g],!(b.slot==void 0||b.location==void 0)){if(d){if(b.unlocked!==true)continue}else if(b.unlocked!==void 0)continue;if(b.location==c||c===""){if(!e[b.type])e[b.type]={},e[b.type].builds=[];e[b.type].builds.push(b)}}for(g in e)e[g].builds.sort(function(a,b){return a.level-b.level})}return e},getBuildsByFirstHood:function(a,b,c){return J.getBuildsByArea(a,D[0],b,c)}},z={showMarchTooltip:function(a){z.showideMarchTooltip(a,
true)},hideMarchTooltip:function(a){z.showideMarchTooltip(a,false)},showideMarchTooltip:function(a,b){var c;for(c=window.event.srcElement;c.tagName!="TR"&&c.tagName!="TABLE";)c=c.parentNode;c.tagName=="TR"&&(c=c.getAttribute("ref"),b?fb(a,c,void 0):ib())},getTimerDelayMarch:function(a){var b;a?(a=n.options.wave.min,b=n.options.wave.max):(a=n.options.gang.min,b=n.options.gang.max);return Math.randRange(a*1E3,b*1E3)},checkAttack:function(a,b,c,d){var e=o.player.cities,g=0,l=0,s={ok:false,msg:""},f;
d==void 0&&(d=false);if(o.player.energy)l=o.player.energy;if(l===0)return c.showFeedback(h("Energia insufficiente")+"!"),s;for(l=0;l<e[b].marches.length;l++)(f=e[b].marches[l])&&f.status!="encamped"&&g++;g++;if(g>e[b].figures.marches.maximum)return c.showFeedback(h("Raggiunto il limite massimo delle marce")),s;g=0;for(l in a){f=e[b].units[l]?e[b].units[l]:0;if(a[l]>f){s.msg=v.getCityName(b)+" "+h("Non hai abbastanza")+" "+h(l,"troops")+"!";break}g+=a[l]}if(s.msg==="")if(g>e[b].figures.marches.maximum_troops)s.msg=
v.getCityName(b)+" "+h("Troppe truppe")+"!";else if(g===0)s.msg=v.getCityName(b)+" "+h("Nessuna truppa selezionata")+"!";s.msg!==""?d&&c.showFeedback(s.msg):s.ok=true;return s},getMarchFromJob:function(a){var b=null,c=v.getCityIndById(a.city_id),c=o.player.cities[c],d,e;for(d=0;d<c.marches.length;d++)if(e=c.marches[d],e.id==a.march_id){b=e;break}return b},recallMarch:function(a,b){q.calls["cities/@@id1/marches/@@id2.json"].parms.city_id=a;q.generalCall("cities/@@id1/marches/@@id2.json",a,b,function(a){if(a.ok){var a=
a.dat.result,b=v.getCityIndById(a.job.city_id);o.player.cities[b]=a.city}})},sendAttack:function(a,b,c,d,e,g,l){var s,H="{",B=1;l!=void 0&&(B=l);for(s in c)H!="{"&&(H+=","),H+='"'+s+'":'+c[s];H+="}";q.calls["cities/@@id1/marches.json"].parms["march[floor]"]=B;q.calls["cities/@@id1/marches.json"].parms["march[x]"]=a;q.calls["cities/@@id1/marches.json"].parms["march[y]"]=b;q.calls["cities/@@id1/marches.json"].parms["march[units]"]=H;q.calls["cities/@@id1/marches.json"].parms.city_id=d;q.generalCall("cities/@@id1/marches.json",
d,"",function(a){if(a.ok){var a=a.dat.result,b=v.getCityIndById(a.job.city_id),c=C();o.player.cities[b]=a.city;a=z.getMarchFromJob(a.job);if(g!=-1)n.options.gang.coords[b][g].time=c;else if(n.options.wave.imperial[b]===true)for(b=0;b<o.player.cities.length;b++)if(n.options.wave.imperial[b]===true&&(n.options.wave.en[b]=false,j.Wave.type==I&&j.Wave.indcityTroops==b))f("pbwaveCityChk_"+I).checked=false;j.Gang.type==O&&j.Gang.showDiv();a!==null?X(h("march","common")+" "+h("request-sent","common")+": "+
a.x+"/"+a.y):X(h("march","common")+" "+h("request-sent","common"));n.options.inMarch=true}else X(h("Errore")+" in "+h("march","common")+": "+a.errmsg)});e.showFeedback(h("march","common")+" "+h("request-sent","common")+": "+a+"/"+b)},getJobByMarch:function(a,b){var c=v.getCityIndById(a),c=F.getJobsByQueue("march",c),d,e=null;for(d=0;d<c.length;d++)if(c[d].march_id==b){e=c[d];break}return e},checkAndCountMarches:function(){var a=o.player.cities,b,c,d,e,g=C();o.marches={total:0,encamped:0,retreating:0,
marching:0,active:0};for(b=0;b<a.length;b++){o.marches.total+=a[b].marches.length;for(c=0;c<a[b].marches.length;c++)if(d=a[b].marches[c])if(d.status=="encamped")o.marches.encamped++;else if((e=z.getJobByMarch(a[b].id,d.id))&&!(e.run_at==void 0||isNaN(e.run_at)))if(e=u(e.run_at-g),e<=0){if(d.status=="marching")d.status="retreating",o.marches.retreating++,o.marches.active++}else d.status=="marching"?o.marches.marching++:o.marches.retreating++,o.marches.active++}},showTab:function(a){function b(a){var b=
a.target.id.split("_"),a=u(b[1]),b=u(b[2]);z.recallMarch(a,b)}var c=o.player.cities,d,e,g,l,s,H,B,p,q,A,w,Db=C(),ca=[];a==void 0&&(a=false);var R=f("pb"+(a===true?"wave":"gang")+"TabMarches");for(l=0;l<R.rows.length;l++){ca.push(R.rows[l].getAttribute("refid"));A=-1;for(d=0;d<c.length;d++){for(e=0;e<c[d].marches.length;e++)if(g=c[d].marches[e],g.id==ca[l]){A=l;break}if(A!=-1)break}A==-1&&(ca[l]=0)}for(l=R.rows.length-1;l>=0;l--)ca[l]===0&&R.deleteRow(l);ca=[];for(l=0;l<R.rows.length;l++)ca.push(R.rows[l].getAttribute("refid"));
for(d=0;d<c.length;d++){p=false;for(e=c[d].marches.length-1;e>=0;e--)if(g=c[d].marches[e]){A=-1;A=null;for(l=0;l<R.rows.length;l++)if(g.id==ca[l]){A=l;A=R.rows[l];break}A===null&&(A=R.insertRow(0),A.setAttribute("refid",g.id),A.insertCell(0),A.insertCell(1),A.insertCell(2),A.insertCell(3),A.insertCell(4));l=z.getJobByMarch(c[d].id,g.id);if(g.status!="encamped")if(!l||l.run_at==void 0||isNaN(l.run_at)){if(l="---",g.status=="marching")g.status="encamped",p=true}else l=u(l.run_at-Db),l<=0?(l="...",p=
true):l=$(l,true);else l="---";s="Attack";g.march_type=="Transport"||g.march_type=="TransportMarch"?s="Transport":g.march_type=="SpyMarch"&&(s="Tip-Off");g.destination_name?g.destination_name==c[d].name?(B=v.getCityName(d),g.status=="retreating"&&(s="Return")):(B=g.destination_name,g.status!="marching"&&(s="Encamp")):B="("+h(g.terrain_type,"map")+"-"+g.terrain_level+")";H="pbMarchOther";g.status=="encamped"?H="pbMarchEncamp":(q=a?n.options.wave.coords[d].x==g.x&&n.options.wave.coords[d].y==g.y:j.Gang.isInActiveList(d,
g.x,g.y))?H="pbMarchMine":g.destination_name&&(s=="Return"?H="pbMarchReturn":s=="Encamp"&&(H="pbMarchEncamp"));s="";for(w in g.units)s!==""&&(s+="<BR>"),s+=g.units[w]+" "+h(w,"troops");A.className=H;A.cells[0].innerHTML=g.x+"/"+g.y;A.cells[1].innerHTML=B;A.cells[2].innerHTML=h(g.status,"common");A.cells[3].innerHTML=l;A.setAttribute("ref",s);H=false;g.status=="marching"&&l!="..."&&l!="---"?H=true:g.status=="encamped"&&(H=true);l=A.cells[4].innerHTML;if(l===""&&H)g="pb"+(a===true?"wave":"gang")+"Recall_"+
c[d].id+"_"+g.id,l=y(g,h("recall","common"),false,false,"small"),A.cells[4].innerHTML=l,f(g).addEventListener("click",b,false);else if(l!==""&&!H)A.cells[4].innerHTML=""}p&&v.addToRefresh(d)}}},ja={injail:[],indcity:0,initJail:function(){var a;ja.injail=[];for(a=0;a<o.player.cities.length;a++)ja.injail.push({})},getInJail:function(a){var b=o.player.cities[a].id;ja.injail[a]={};Unit.indcity=a;q.calls["cities/@@id1/cash_jail.json"].parms.city_id=b;q.generalCall("cities/@@id1/cash_jail.json",b,"",function(a){if(a.ok)a=
a.dat.result,injail[Unit.indcity]=a.units})},bailOut:function(a,b){var c=o.player.cities[a].id,d;for(d in b)b[d]!==0&&(q.calls["cities/@@id1/cash_jail/bail.json"].parms["units["+d+"]"]=b[d]);Unit.indcity=a;q.calls["cities/@@id1/cash_jail/bail.json"].parms.city_id=c;q.generalCall("cities/@@id1/cash_jail/bail.json",c,"",function(a){a.ok&&ja.getInJail(Unit.indcity)})},checkRequirements:function(a,b,c){var d=true;if(vb[b]){b=La(vb[b]);for(r in b.resources)b.resources[r]*=c;for(r in b.items)b.items[r]*=
c;d=eb(a,b)}return d},train:function(a,b,c){a=o.player.cities[a].id;q.calls["cities/@@id1/units.json"].parms["units[unit_type]"]=b;q.calls["cities/@@id1/units.json"].parms["units[quantity]"]=c;q.calls["cities/@@id1/units.json"].parms.city_id=a;q.generalCall("cities/@@id1/units.json",a,"",function(a){if(a.ok){var a=a.dat.result,b=v.getCityIndById(a.city.id);o.player.cities[b]=a.city}})},isDefensive:function(a){var b=false,c;for(c=0;c<ub.length;c++)if(a==ub[c]){b=true;break}return b}};j.Info={tabOrder:ta,
tabLabel:Qa,tabDisabled:false,cont:null,todoTimer:null,inworkTimer:null,bannerTimer:null,toolTip:"",expand:[],init:function(a){var b=j.Info,c="";c+=h("Sommario di tutte le attivit\u00e0")+"<BR>";c+="<B>"+h("Buon gioco")+"!</b><BR>";b.toolTip=c;b.cont=a;c="";c+="<DIV id=pbinfoHead></div>";c+="<DIV id=pbinfoBody></div>";b.cont.innerHTML=c;b.expand=[];b.showHead();b.showBody();b.inworkTick()},showHead:function(){var a=j.Info,b="";b+="<DIV class=pbTitle>";b+=ka;b+="<BR>"+Fa();b+='<BR><a target=_website href="'+
ma+'"><span class=LinkWhite>'+ma+"</span></a>";b+='<iframe src="http://pagead2.googlesyndication.com/pagead/ads/banner/sponsor/" width="0" height="0" border="0" alt="adblocktest" id="adblocktest"></iframe>';b+="</div>";b+="<DIV id=pbinfoButt></div>";f("pbinfoHead").innerHTML=b;a.showButt();Gb()},showButt:function(){var a=j.Info,b="";b+="<TABLE width=100%><TR>";b+="<TD>"+y("pbinfoUpdate","Aggiorna Info",false,false,"small");b+=y("pbinfoReload","Ricarica GF",false,false,"small");b+="<BR>"+y("pbinfoToggleFlash",
"Nascondi Flash",false,false,"small")+"</td>";b+='<TD align=center><DIV id=pbinfoBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';b+="</tr></table>";f("pbinfoButt").innerHTML=b;f("pbinfoReload").addEventListener("click",qa,false);f("pbinfoUpdate").addEventListener("click",Ma,false);f("pbinfoToggleFlash").addEventListener("click",function(){var a=f("container"),b=f("pbinfoToggleFlash");
a.style.display=="none"?(a.style.display="block",b.value=h("Nascondi Flash")):(a.style.display="none",b.value=h("Mostra Flash"))},false);clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,3E4)},bannerTick:function(){if(f("pbinfoBanner"))f("pbinfoBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},showBody:function(){var a=j.Info,b="",c,d=o.player.cities;b+=
"<DIV id=pbinfoPlayer class=pbSubtitle></div>";for(c=0;c<d.length;c++)a.expand.length<c+1&&a.expand.push(true),b+="<DIV class=pbTitle id=pbinfodivtopcity_"+c+"></div>",b+="<DIV class=pbSubtitle id=pbinfodivcity_"+c+"></div>";f("pbinfoBody").innerHTML=b;a.showInfo();a.todoTick()},showInfo:function(){function a(a){var b=j.Info,c=a.target.id.split("_"),c=u(c[1]),d="none";b.expand[c]=!b.expand[c];b.expand[c]&&(d="block");a.target.value=" "+(b.expand[c]===true?"-":"+")+" ";f("pbinfodivcity_"+c).style.display=
d}function b(a){a=a.target.id.split("_");a=u(a[1]);v.defendCity(a)}var c=j.Info,d=o.player.cities,e,g;g="<TABLE width=100%><TR>";g+="<TD align=left>&nbsp;<B>"+h("name","common")+":</b> "+o.player.name+"</td>";g+="<TD align=center><B>"+h("respect","common")+":</b> "+E(o.player.respect)+"</td>";g+="<TD align=right><B>"+h("level","common")+":</b> "+o.player.level+"&nbsp;</td></tr>";o.player.alliance&&(g+="<TR><TD colspan=2 align=left>&nbsp;<B>"+h("crew","common")+":</b> "+o.player.alliance.name+"</td>",
g+="<TD align=right><B>"+h("rank","common")+":</b> "+o.player.alliance.rank+"&nbsp;</td></tr>");g+="</table>";f("pbinfoPlayer").innerHTML=g;f("pbinfoUpdate").disabled=false;if(f("pboptsReadInfo"))f("pboptsReadInfo").disabled=false;for(e=0;e<d.length;e++)f("pbinfodivtopcity_"+e).innerHTML=v.getCityTitle(e,c),g="<TABLE width=100%>",g+=c.showInfoByType("resources","common",d[e].resources,false),g+=c.showInfoByType("troops","troops",d[e].units,true,true,e),g+=c.showInfoByType("research","research",d[e].research),
g+=c.showInfoByType("cityscapes","map",d[e].wildernesses),g+=c.showInfoJobs("jobs","common",e),g+="</table>",f("pbinfodivcity_"+e).innerHTML=g,f("pbinfodivcity_"+e).style.display=c.expand[e]===true?"block":"none",f("pbinfoHideShow_"+e).addEventListener("click",a,false),f("pbinfoDefend_"+e).addEventListener("click",b,false)},showInfoJobs:function(a,b,c){function d(a,b,c,d,f){var j="",n=C(),o,p,q,v="";f==void 0&&(f=false);jobs=F.getJobsByQueue(b,d);if(jobs.length!==0)for(o=0;o<jobs.length;o++){j+="<TR>";
j+=o===0?"<TD align=left>"+h(a,"common").toUpperCase()+":</td>":"<TD></td>";j+="<TD align=left> ";f?(q=J.getBuildById(d,jobs[0].city_building_id),q!==null?(p=u(jobs[0].run_at-n),v=q.type):p=null):p=u(jobs[0].run_at-n);if(b=="research")v=jobs[0].research_type;switch(b){case "building":case "research":v!==""&&(j+=h(v,c),j+=" "+h("level","common").toLowerCase()+" "+jobs[0].level);break;case "units":case "defense_units":j+=jobs[0].quantity+" "+h(jobs[0].unit_type,c)}j+=p===null?h("unknown","common").toUpperCase():
p<=0?"":" ("+$(p)+")";j+="</td><tr>"}else j+="<TR>",j+="<TD align=left>"+h(a,"common").toUpperCase()+":</td>",j+="<TD align=left> <FONT COLOR=red>"+h("no","common")+"</font>",j+="</td><tr>";return j}b="";b+="<TR><TD colspan=2><HR></td></tr>";b+="<TR><TD colspan=2 align=center><B>"+h(a,"common").toUpperCase()+":</b></td></tr>";b+="<TR><TD colspan=2><TABLE width=100%>";b+=d("construction","building","buildings",c,true);b+=d("research","research","research",c);b+=d("training","units","troops",c);b+=
d("training-defensive","defense_units","troops",c);return b},showInfoByType:function(a,b,c,d,e,g){var l="";a=="troops"&&(c=v.getUnits(g));d==void 0&&(d=true);e==void 0&&(e=false);d&&(l+="<TR><TD colspan=2><HR></td></tr>");l+="<TR><TD colspan=2 align=center><B>"+h(a,"common").toUpperCase()+":</b></td></tr>";if(c){var f,d=g=0;l+="<TR><TD colspan=2>";l+="<TABLE width=100%>";a=="troops"&&(l+="<TR><TD></td><TD>",l+="<TABLE width=100%><TR>",l+="<TD align=right width=25%>"+h("city","common").toUpperCase()+
"&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#00FF00>"+h("marching","common").toUpperCase()+"</font>&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#33CCFF>"+h("retreating","common").toUpperCase()+"</font>&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#FF9900>"+h("encamped","common").toUpperCase()+"</font>&nbsp;</td>",l+="</tr></table>",l+="</td></tr>");for(f in c)e?l+="<TR>":(d++,d==1?(g!==0&&(l+="</tr>"),l+="<TR>",g++):d=0),a=="troops"?(l+="<TD align=left>&nbsp;<B>"+h(f,
b)+"</b></td>",l+="<TD>",l+="<TABLE width=100%><TR>",l+="<TD align=right width=25%>"+E(c[f].incity)+"&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#00FF00>"+E(c[f].inmarch)+"</font>&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#33CCFF>"+E(c[f].retreat)+"</font>&nbsp;</td>",l+="<TD align=right width=25%><FONT COLOR=#FF9900>"+E(c[f].encamped)+"</font>&nbsp;</td>",l+="</tr></table>",l+="</td>"):a=="cityscapes"?c[f].type&&(l+="<TD align=left>"+h(c[f].type,b)+" ("+c[f].x+"/"+c[f].y+")</td>",
l+="<TD align=left>"+h("level","common")+" "+c[f].level+"</td>"):e?(l+="<TD align=left>&nbsp;<B>"+h(f,b)+"</b></td>",l+="<TD align=right>"+E(c[f])+"&nbsp;</td>"):(l+="<TD width=50%>",l+="<TABLE width=100%><TR>",l+="<TD align=left>&nbsp;<B>"+h(f,b)+"</b></td>",l+="<TD align=right>"+E(c[f])+"&nbsp;</td>",l+="</tr></table>",l+="</td>"),e&&(l+="</tr>");!e&&d!==0&&(l+="<TD width=50%></td>",l+="</tr>");l+="</table>";l+="</td></tr>"}return l},todoTick:function(){var a=j.Info;clearTimeout(a.todoTimer);if(Ya())a.todoTimer=
setTimeout(a.todoTick,3E4)},inworkTick:function(){var a=j.Info,b=o.player.cities,c,d=C(),e;for(c=0;c<b.length;c++)for(k in b[c].jobs)e=u(b[c].jobs[k].run_at-d),e<=0&&F.deleteJob(b[c].jobs[k].id);a.showInfo();a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};var I=1;j.Wave={tabOrder:2,tabLabel:"Onda",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,curRunStart:0,readed:[],type:I,indcityTroops:0,indcityMurders:0,indcityStats:0,changefloor:true,feedTimer:null,
bannerTimer:null,murders:[],nrmurder:1,init:function(a){var b=j.Wave;b.toolTip="<BR><B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbwaveHead></div>";a+="<DIV id=pbwaveBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a=n.options.wave,b=false;a==void 0&&(a={enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],units:[],floors:[],imperial:[]},b=true);var c,d,e=o.player.cities,g=C();if(a.floors==
void 0)a.floors=[],b=true;if(a.imperial==void 0)a.imperial=[],b=true;for(c=0;c<e.length;c++){a.stat[c]==void 0&&(a.stat[c]={start_at:g,numAtt:0,resources:{},items:{}},b=true);if(a.stat[c].start_at==void 0||a.stat[c].start_at===0)a.stat[c].start_at=g,b=true;a.en[c]==void 0&&(a.en[c]=false,b=true);a.coords[c]==void 0&&(a.coords[c]={x:0,y:0},b=true);a.units[c]==void 0&&(a.units[c]={},b=true);a.floors[c]==void 0&&(a.floors[c]=1,b=true);a.imperial[c]==void 0&&(a.imperial[c]=1,b=true);if(!a.enabled&&!n.options.inMarch)for(d in a.units[c])e[c].units[d]==
void 0&&(delete a.units[c][d],b=true);for(d in e[c].units)a.units[c][d]==void 0&&(a.units[c][d]=0,b=true)}return b},showHead:function(){var a=j.Wave,b="";b+="<DIV class=pbTitle>"+y("pbwaveOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbwaveInWork style="height:200px; max-height:200px; overflow-y:auto;"><TABLE id=pbwaveTabMarches width=100%></table></div>';b+='<BR><DIV id=pbwaveFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";
b+="<DIV id=pbwaveButt></div>";f("pbwaveHead").innerHTML=b;a.setEnable(n.options.wave.enabled);f("pbwaveOnOff").addEventListener("click",function(){a.setEnable(!n.options.wave.enabled)},false);f("pbwaveInWork").addEventListener("mouseover",z.showMarchTooltip,false);f("pbwaveInWork").addEventListener("mouseout",z.hideMarchTooltip,false);a.showButt()},showButt:function(){function a(a){var b=j.Wave,a=a.target.id.split("_");b.type=u(a[1]);b.showDiv()}var b=j.Wave,c="";c+="<TABLE width=100%>";c+="<TR>";
c+="<TD>"+y("pbwaveBut_"+I,h("troops","common"),false,false,"small");c+=y("pbwaveBut_2",h("search","common")+" MURDER",false,false,"small");c+=y("pbwaveBut_3",h("Opzioni"),false,false,"small");c+=y("pbwaveBut_4",h("stats","common"),false,false,"small")+"</td>";c+='<TD align=center><DIV id=pbwaveBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';c+="</tr>";c+="</table>";f("pbwaveButt").innerHTML=
c;f("pbwaveBut_"+I).addEventListener("click",a,false);f("pbwaveBut_2").addEventListener("click",a,false);f("pbwaveBut_3").addEventListener("click",a,false);f("pbwaveBut_4").addEventListener("click",a,false);clearInterval(b.bannerTimer);b.bannerTimer=setInterval(b.bannerTick,3E4)},bannerTick:function(){if(f("pbwaveBanner"))f("pbwaveBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},
setEnable:function(a){var b=j.Wave;if(!b.tabDisabled){var c=f("pbwaveOnOff"),d=h("Onda").toUpperCase();clearTimeout(b.todoTimer);(n.options.wave.enabled=a)?(c.value=d+" ON",c.className="butAttackOn",b.curRunStart=C(),b.todoTick()):(b.curRunStart!==0&&(n.options.wave.runTime+=C()-b.curRunStart),c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=j.Wave,b="";b+='<DIV id=pbwaveTroops class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbwaveMurders class=pbStatBox style="display:none;"></div>';
b+='<DIV id=pbwaveOptions class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbwaveStats class=pbStatBox style="display:none;"></div>';f("pbwaveBody").innerHTML=b;a.showDiv()},showDiv:function(){var a=j.Wave;f("pbwaveTroops").style.display="none";f("pbwaveMurders").style.display="none";f("pbwaveOptions").style.display="none";f("pbwaveStats").style.display="none";switch(a.type){case I:f("pbwaveTroops").style.display="block";a.showTroops();break;case 2:f("pbwaveMurders").style.display="block";
a.showMurders();break;case 3:f("pbwaveOptions").style.display="block";a.showOptions();break;case 4:f("pbwaveStats").style.display="block",a.showStats()}},makeCitySelect:function(a,b){var c=o.player.cities,d="";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("city","common")+": ";if(c.length<2)d+=v.getCityName(0);else{d+="<SELECT id=pbwaveCity_"+b+">";for(i=0;i<c.length;i++)d+="<OPTION"+(a==i?" selected":"")+' value="'+i+'">'+v.getCityName(i)+"</option>";c.length>1&&b!=I&&(d+="<OPTION"+(a==999?" selected":
"")+' value="999">'+h("all","common")+"</option>");d+="</select>"}d+="</td>";b==I?(d+="<TD>"+h("deployedunits","common")+": <SPAN id=pbwaveTotal></span></td>",d+=P(false,"",true,0,"pbwaveCityChk_"+b,n.options.wave.en[a],h("Abilita"),true)):b==4&&(d+="<TD>"+y("pbwaveCityBut_"+b,h("delete","common")+" "+h("stats","common"),false,false)+"</td>");d+="</tr>";d+="</table>";return d},showTroops:function(){function a(a){var b=j.Wave;b.indcityTroops=u(a.target[a.target.selectedIndex].value);b.showTroops()}
function b(a){var b=j.Wave,c=n.options.wave,d=a.target.id.split("_"),e=b.indcityTroops,d=d[1],g=Y(a.target.value);if(g>=Z)a.target.value=g=Z-1;d=="X"?c.coords[e].x=g:c.coords[e].y=g;b.getInfoXY()}var c=j.Wave,d="",e=n.options.wave,g=c.indcityTroops;d+="<DIV class=pbTitle>"+h("troops","common").toUpperCase()+"</div>";d+=c.makeCitySelect(g,I);d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("target","common")+": X "+K("pbwaveTroops_X",e.coords[g].x,1,3,"normalGreen");d+=" / Y "+K("pbwaveTroops_Y",e.coords[g].y,
1,3,"normalGreen")+"<SPAN id=pbwaveDist></span></td>";d+="<TD id=pbwavetdFloor>"+h("Piano")+": "+K("pbwaveFloor",e.floors[g],1,2,"normalGreen")+"</td>";d+="</tr>";d+="</table>";d+="<DIV align=center class=pbStatBox id=pbwaveCoords></div>";d+="<DIV id=pbwaveTroopsCity></div>";f("pbwaveTroops").innerHTML=d;c.getTotalTroops();c.changefloor=false;c.getInfoXY();c.showTroopsCity();f("pbwaveCity_"+I)&&f("pbwaveCity_"+I).addEventListener("change",a,false);f("pbwaveCityChk_"+I).addEventListener("click",function(a){var b=
j.Wave;n.options.wave.en[b.indcityTroops]=a.target.checked;b.showTroopsCity()},false);f("pbwaveTroops_X").addEventListener("change",b,false);f("pbwaveTroops_Y").addEventListener("change",b,false);f("pbwaveFloor").addEventListener("change",function(a){var b=n.options.wave,c=j.Wave.indcityTroops,d=Y(a.target.value);if(d>10)a.target.value=d=10;else if(d<1)a.target.value=d=1;b.floors[c]=d},false)},getTotalTroops:function(){var a=0,b=j.Wave.indcityTroops,c="",d=n.options.wave.units[b],e=o.player.cities,
g;for(g in d)a+=d[g];a>e[b].figures.marches.maximum_troops&&(c+="<FONT COLOR=#FF0000>");c+=E(a);a>e[b].figures.marches.maximum_troops&&(c+="</font>");c+="/"+E(e[b].figures.marches.maximum_troops);f("pbwaveTotal").innerHTML=c},showTroopsCity:function(){function a(a){var b=j.Wave,c=n.options.wave,d=a.target.id.split("_"),e=b.indcityTroops,d=d[1],g=Y(a.target.value),f=o.player.cities[e].units[d];if(g>f)a.target.value=g=f;c.units[e][d]=g;b.getTotalTroops()}var b="",c=n.options.wave,d=j.Wave.indcityTroops,
e,g;e=[];if(c.en[d]){b+="<TABLE width=100%>";for(g in c.units[d])b+="<TR>",b+="<TD>"+h(g,"troops")+"</td>",b+="<TD>"+K("pbwaveTroops_"+g,c.units[d][g],1,6,"normalGreen")+"</td>",e.push("pbwaveTroops_"+g),b+="</tr>";b+="</table>"}f("pbwaveTroopsCity").innerHTML=b;if(c.en[d])for(b=0;b<e.length;b++)f(e[b]).addEventListener("change",a,false)},getInfoXY:function(){var a=j.Wave.indcityTroops,b=n.options.wave;p.scan(b.coords[a].x,b.coords[a].y,7,function(){var a=j.Wave,b=a.indcityTroops,e=n.options.wave,
g="",l="";if(p.done){var s=p.getSingleInfo(e.coords[b].x,e.coords[b].y);if(s.ok){var o=s.level==99;l+="&nbsp;<B>"+h("Distanza")+": </b>"+s.dist;if(s.player!==null){if(!s.player.alliance||s.player.alliance.name==="")s.player.alliance=null;g+="<B>";g+=s.type_city!==""?s.type_city!="Capital"?h(s.name,"cities"):h(s.type_city,"cities"):h(s.type,"map");g+="</b>";s.level!==0&&(g+=" "+h("level","common")+" <B>"+s.level+"</b>");s.player.alliance!==null&&(g+=" "+h("crew","common")+": "+s.player.alliance.name);
g+="<BR>"+h("player","common")+": <B>"+s.player.name+"</b>";g+=" "+h("level","common")+": <B>"+s.player.level+"</b>";g+=" "+h("respect","common")+": <B>"+E(s.player.respect)+"</b>"}else g+="<B>"+h(s.type,"map")+"</b> "+h("level","common")+" <B>"+(s.level==99?"1-10":s.level)+"</b>";if(!o||a.changefloor)f("pbwaveFloor").value=e.floors[b]=1;e.imperial[b]=o;f("pbwavetdFloor").style.display=o===true?"block":"none"}}f("pbwaveCoords").innerHTML=g;f("pbwaveDist").innerHTML=l;a.changefloor=true},o.player.cities[a].x,
o.player.cities[a].y)},enableButtonForMurders:function(a){a==void 0&&(a=true);if(f("pbwaveBut_"+I))f("pbwaveBut_"+I).disabled=!a;if(f("pbwaveBut_2"))f("pbwaveBut_2").disabled=!a;if(f("pbwaveBut_3"))f("pbwaveBut_3").disabled=!a;if(f("pbwaveBut_4"))f("pbwaveBut_4").disabled=!a;if(f("pbwaveMurdersSearch"))f("pbwaveMurdersSearch").disabled=!a},showMurders:function(){function a(a){var b=j.Wave;b.indcityStats=u(a.target[a.target.selectedIndex].value);b.murders=[];b.nrmurder=1;f("pbwaveMurdersSel").selectedIndex=
0;b.showMurdersCity()}function b(){var a=j.Wave;if(!p.err){var b,c,d,e=p.targets.terrains.BossGang;if(e)for(b=0;b<e.length;b++)if(e[b].level==a.nrmurder){d=false;for(c=0;c<a.murders.length;c++)if(a.murders[c].id==e[b].id){d=true;break}d||a.murders.push({id:e[b].id,terrain:e[b]})}}p.done&&(a.murders.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;c===0&&(c=a.terrain.level-b.terrain.level);return c}),a.showMurdersCity(),a.enableButtonForMurders(),a.showFeedback(h("search","common")+" MURDER OK!"))}
var c=j.Wave,d="",e=h("search","common")+" "+h("le MURDER pi\u00f9 vicine entro una distanza di 37"),g=c.indcityMurders;d+="<DIV class=pbTitle>"+e.toUpperCase()+"</div>";d+=c.makeCitySelect(g,2);d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("search","common")+" "+h("level","common")+": ";d+="<SELECT id=pbwaveMurdersSel>";d+='<OPTION value="1" selected>1</option>';d+='<OPTION value="2">2</option>';d+="</select>&nbsp;"+y("pbwaveMurdersSearch",h("search","common"),false,false);d+="</td>";d+="</tr>";
d+="</table>";d+="<DIV id=pbwaveMurdersCity></div>";f("pbwaveMurders").innerHTML=d;f("pbwaveCity_2")&&f("pbwaveCity_2").addEventListener("change",a,false);f("pbwaveMurdersSel").addEventListener("change",function(a){var b=j.Wave;b.nrmurder=u(a.target[a.target.selectedIndex].value);b.showMurdersCity()},false);f("pbwaveMurdersSearch").addEventListener("click",function(){var a=j.Wave;a.murders=[];a.showFeedback(h("search","common")+" MURDER "+a.nrmurder,false);a.enableButtonForMurders(false);p.scan(o.player.cities[g].x,
o.player.cities[g].y,ia,b,o.player.cities[g].x,o.player.cities[g].y)},false);c.showMurdersCity()},showMurdersCity:function(){function a(a){var b=j.Wave,c=n.options.wave,d=a.target.id.split("_"),a=b.indcityMurders,b=b.murders[u(d[1])];c.coords[a].x=b.terrain.x;c.coords[a].y=b.terrain.y}var b=j.Wave,c="",d,e,g=[];b.murders.length!==0&&(c+="<TABLE width=100%>",c+="<TR>",c+="<TD>"+h("Distanza")+"</td>",c+="<TD>"+h("Coordinate")+"</td>",c+="<TD>"+h("level","common")+"</td>",c+="<TD>&nbsp;</td>",c+="</tr>");
for(d=0;d<b.murders.length;d++)e=b.murders[d],c+="<TR>",c+="<TD>"+e.terrain.dist+"</td>",c+="<TD>"+e.terrain.x+"/"+e.terrain.y+"</td>",c+="<TD>"+e.terrain.level+"</td>",c+="<TD>"+y("pbwaveMurderBut_"+d,h("Copia in Onda"),false,false)+"</td>",g.push("pbwaveMurderBut_"+d),c+="</tr>";b.murders.length!==0&&(c+="</table>");f("pbwaveMurdersCity").innerHTML=c;for(d=0;d<b.murders.length;d++)f(g[d]).addEventListener("click",a,false)},showOptions:function(){var a="",b=n.options.wave;a+="<DIV class=pbTitle>"+
h("Opzioni").toUpperCase()+"</div>";a+="<TABLE width=100%>";a+="<TR>";a+="<TD>"+h("Ritardo tra attacchi")+":</td>";a+="<TD>"+h("from","common")+" "+K("pbwaveOpts_min",b.min,1,3,"normalGreen")+"</td>";a+="<TD>"+h("to","common")+" "+K("pbwaveOpts_max",b.max,1,3,"normalGreen")+" "+h("Secondi").toLowerCase()+"</td>";a+="</tr>";a+="<TR>";a+="<TD>"+h("Elimina rapporti")+":</td>";a+=P(false,"",true,2,"pbwaveOpts_DelRep",b.delrep,"",true);a+="</tr>";a+="</table>";f("pbwaveOptions").innerHTML=a;f("pbwaveOpts_min").addEventListener("change",
function(a){var b=Y(a.target.value),e=n.options.wave,g=a.target.id.split("_")[1];if(b===0){switch(g){case "min":b=optsDefaults.min}if(b!==0)a.target.value=b}switch(g){case "min":e.min=b,e.max=u(b*1.5),f("pbwaveOpts_max").value=e.max}},false);f("pbwaveOpts_max").disabled=true;f("pbwaveOpts_DelRep").addEventListener("click",function(a){n.options.wave.delrep=a.target.checked},false)},showStats:function(){function a(a){var b=j.Wave;b.indcityStats=u(a.target[a.target.selectedIndex].value);b.showStatsCity()}
var b=j.Wave,c="";c+="<DIV class=pbTitle>"+h("stats","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityStats,4);c+="<DIV id=pbwaveStatsCity></div>";f("pbwaveStats").innerHTML=c;f("pbwaveCity_4")&&f("pbwaveCity_4").addEventListener("change",a,false);f("pbwaveCityBut_4").addEventListener("click",function(a){var b=j.Wave;a.target.disabled=true;switch(b.indcityStats){case 999:b.clearStatsAll();break;default:b.clearStatsSingle(b.indcityStats)}a.target.disabled=false;b.showStatsCity()},false);
b.showStatsCity()},showStatsCity:function(){var a=j.Wave,b,c,d="";switch(a.indcityTargets){case 999:c=a.getStatsAll();break;default:c=a.getStatsSingle(a.indcityStats)}var e=n.options.wave.runTime;n.options.wave.enabled&&(e+=C()-a.curRunStart);d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("Iniziate il")+"</td>";d+="<TD align=center>"+h("Tempo di esecuzione")+"</td>";d+="<TD align=right>"+h("Attacchi")+"</td>";d+="</tr>";d+="<TR>";d+="<TD>";c.start_at!==0&&(a=new Date(c.start_at*1E3),d+=a.formatDate(T)+
" "+a.formatTime());d+="</td>";d+="<TD align=center>"+$(e,true)+"</td>";d+="<TD align=right>"+E(c.numAtt)+"</td>";d+="</tr>";d+="</table>";d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("resources","common")+":</td>";for(b in c.resources)d+="<TD align=right>"+h(b,"common")+"</td>";d+="</tr>";d+="<TR>";d+="<TD>"+h("quantity","common")+":</td>";for(b in c.resources)d+="<TD align=right>"+E(c.resources[b])+"</td>";d+="</tr>";d+="<TR>";d+="<TD>"+h("per-hour","common")+":</td>";for(b in c.resources)e===
0?d+="<TD align=right>---</td>":(a=u(c.resources[b]*3600/e),d+="<TD align=right>"+E(a)+"</td>");d+="</tr>";d+="</table>";d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD width=50%>"+h("items","common")+":</td>";d+="<TD width=50%></td>";d+="</tr>";for(b in c.items)d+="<TR>",d+="<TD width=50%>",d+=h(aa(b),"items")==aa(b)?h(aa(b),"armory"):h(aa(b),"items"),d+="</td>",d+="<TD width=50%>"+E(c.items[b])+" ("+h("per-hour","common")+": ",e===0?d+="<TD align=right>---</td>":(a=u(c.items[b]*3600/e),d+=E(a)),
d+=")",d+="</td>",d+="</tr>";d+="</table>";f("pbwaveStatsCity").innerHTML=d},todoTick:function(){var a=j.Wave,b=z.getTimerDelayMarch(true),c=o.player.cities,d=n.options.wave,e,g=0;clearTimeout(a.todoTimer);for(e=0;e<c.length;e++)d.en[e]&&(setTimeout(a.doAttack,g*1E3,e),g++);a.todoTimer=setTimeout(a.todoTick,b)},doAttack:function(a){var b=j.Wave,c={},d=n.options.wave.units[a],e;for(e in d)d[e]!==0&&(c[e]=d[e]);d=z.checkAttack(c,a,b,true);e=n.options.wave;var g=v.getCityId(a);d.ok&&z.sendAttack(e.coords[a].x,
e.coords[a].y,c,g,b,-1,e.floors[a]);return d},addStatFromReport:function(a,b){var c=j.Wave,d=v.getCityIndByName(a.attacker.city_name),e=n.options.wave;if(a.spoils&&!(a.attacker.name!=o.player.name||c.readed.indexOf(b)!=-1||d==-1||e.coords[d].x!=a.location.x||e.coords[d].y!=a.location.y)){c.readed.push(b);if(a.spoils.resources)for(r in a.spoils.resources)N(e.stat[d].resources,r,u(a.spoils.resources[r])),N(o.player.cities[d].resources,r,u(a.spoils.resources[r]));if(a.spoils.items){for(r=0;r<a.spoils.items.length;r++)N(e.stat[d].items,
a.spoils.items[r],1),N(o.player.items,a.spoils.items[r],1);j.Various.type==da&&j.Various.showDiv()}e.stat[d].numAtt++;c.type==4&&d==c.indcityStats&&c.showStats();e.delrep&&G.deleteReport(b)}},clearStatsSingle:function(a){var b=n.options.wave,c=C();b.stat[a]={start_at:c,numAtt:0,resources:{},items:{}};if(o.player.cities.length<2)n.options.wave.runTime=0},clearStatsAll:function(){var a=j.Wave,b,c=o.player.cities;b=C();a.curRunStart=b;for(b=0;b<c.length;b++)a.clearStatsSingle(b);n.options.wave.runTime=
0},getStatsSingle:function(a){var b,c={start_at:0,numAtt:0,resources:{},items:{}},a=n.options.wave.stat[a];c.start_at=a.start_at;c.numAtt+=a.numAtt;for(b in a.resources)N(c.resources,b,u(a.resources[b]));for(b in a.items)N(c.items,b,u(a.items[b]));return c},getStatsAll:function(){var a,b,c,d=o.player.cities,e={start_at:0,numAtt:0,resources:{},items:{}};for(a=0;a<d.length;a++){c=n.options.wave.stat[a];if(e.start_at===0||c.start_at<e.start_at&&c.start_at!==0)e.start_at=c.start_at;e.numAtt+=c.numAtt;
for(b in c.resources)N(e.resources,b,u(c.resources[b]));for(b in c.items)N(e.items,b,u(c.items[b]))}return e},showFeedback:function(a,b){var c=j.Wave;b==void 0&&(b=true);clearTimeout(c.feedTimer);f("pbwaveFeedback").innerHTML=a;if(a!==""&&b)c.feedTimer=setTimeout(c.showFeedback,5E3,"")},inworkTick:function(){var a=j.Wave;clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.type==I&&a.showTroops();z.showTab(true);a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};var M=
1,O=3;j.Gang={tabOrder:3,tabLabel:"Gang",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,curRunStart:0,readed:[],type:M,indcityTroops:0,indcityTargets:0,indcityStats:0,indcity:0,saveEnabled:false,tgts:[],feedTimer:null,bannerTimer:null,init:function(a){var b=j.Gang;b.toolTip="<BR><B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbgangHead></div>";a+="<DIV id=pbgangBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a=
n.options.gang,b=false;a==void 0&&(a={enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],last:[],units:[],leven:[],dist:[],same:60},b=true);var c,d,e,g=o.player.cities,f=C();if(a.last==void 0)a.last=[],b=true;for(c=0;c<g.length;c++){if(a.stat[c]==void 0||a.stat[c].length){a.stat[c]={start_at:f,resources:{},items:{},numAtt:[]};for(d=0;d<10;d++)a.stat[c].numAtt.push(0);b=true}if(a.stat[c].start_at==void 0||a.stat[c].start_at===0)a.stat[c].start_at=f,b=true;if(a.stat[c].resources==
void 0)a.stat[c].resources={},b=true;if(a.stat[c].items==void 0)a.stat[c].items={},b=true;for(e in a.stat[c].items)for(d=0;d<10;d++)a.stat[c].items[e][d]==void 0&&(a.stat[c].items[e][d]=0,b=true);if(a.stat[c].numAtt==void 0){a.stat[c].numAtt=[];for(d=0;d<10;d++)a.stat[c].numAtt.push(0);b=true}a.en[c]==void 0&&(a.en[c]=false,b=true);a.last[c]==void 0&&(a.last[c]={x:-1,y:-1},b=true);a.coords[c]==void 0&&(a.coords[c]=[],b=true);if(a.units[c]==void 0||a.units[c].length)a.units[c]={},b=true;if(!a.enabled&&
!n.options.inMarch)for(e in a.units[c])if(ja.isDefensive(e)||g[c].units[e]==void 0)delete a.units[c][e],b=true;for(e in g[c].units)if(!ja.isDefensive(e)){a.units[c][e]==void 0&&(a.units[c][e]=[]);for(d=0;d<10;d++)a.units[c][e][d]==void 0&&(a.units[c][e][d]=0,b=true)}if(a.leven[c]==void 0){a.leven[c]=[];for(d=0;d<10;d++)a.leven[c][d]=false;b=true}for(d=0;d<10;d++)a.leven[c][d]==void 0&&(a.leven[c][d]=false,b=true);if(a.dist[c]==void 0){a.dist[c]=[];for(d=0;d<10;d++)a.dist[c][d]=ia;b=true}for(d=0;d<
10;d++)if(a.dist[c][d]==void 0||a.dist[c][d]==30)a.dist[c][d]=ia,b=true}return b},enableButtonForScan:function(a){var b=j.Gang;a==void 0&&(a=true);a?b.saveEnabled&&b.setEnable(true):(b.saveEnabled=n.options.gang.enabled,b.saveEnabled&&b.setEnable(false));if(f("pbgangBut_"+M))f("pbgangBut_"+M).disabled=!a;if(f("pbgangBut_2"))f("pbgangBut_2").disabled=!a;if(f("pbgangBut_"+O))f("pbgangBut_"+O).disabled=!a;if(f("pbgangBut_4"))f("pbgangBut_4").disabled=!a;if(f("pbgangOptsScan"))f("pbgangOptsScan").disabled=
!a},setEnable:function(a){var b=j.Gang;if(!b.tabDisabled){var c=f("pbgangOnOff"),d=h("Gang").toUpperCase();clearTimeout(b.todoTimer);(n.options.gang.enabled=a)?(c.value=d+" ON",c.className="butAttackOn",b.curRunStart=C(),b.todoTick()):(b.curRunStart!==0&&(n.options.gang.runTime+=C()-b.curRunStart),c.value=d+" OFF",c.className="butAttackOff")}},showHead:function(){var a=j.Gang,b="";b+="<DIV class=pbTitle>"+y("pbgangOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbgangInWork style="height:200px; max-height:200px; overflow-y:auto;"><TABLE id=pbgangTabMarches width=100%></table></div>';
b+='<BR><DIV id=pbgangFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";b+="<DIV id=pbgangButt></div>";f("pbgangHead").innerHTML=b;a.setEnable(n.options.gang.enabled);f("pbgangOnOff").addEventListener("click",function(){a.setEnable(!n.options.gang.enabled)},false);f("pbgangInWork").addEventListener("mouseover",z.showMarchTooltip,false);f("pbgangInWork").addEventListener("mouseout",z.hideMarchTooltip,false);a.showButt()},showButt:function(){function a(a){var b=
j.Gang,a=a.target.id.split("_");b.type=u(a[1]);b.showDiv()}var b=j.Gang,c="";c+="<TABLE width=100%>";c+="<TR>";c+="<TD>"+y("pbgangBut_"+M,h("troops","common"),false,false,"small");c+=y("pbgangBut_2",h("Opzioni"),false,false,"small");c+=y("pbgangBut_"+O,h("target","common"),false,false,"small");c+=y("pbgangBut_4",h("stats","common"),false,false,"small")+"</td>";c+='<TD align=center><DIV id=pbgangBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';
c+="</tr>";c+="</table>";f("pbgangButt").innerHTML=c;f("pbgangBut_"+M).addEventListener("click",a,false);f("pbgangBut_2").addEventListener("click",a,false);f("pbgangBut_"+O).addEventListener("click",a,false);f("pbgangBut_4").addEventListener("click",a,false);clearInterval(b.bannerTimer);b.bannerTimer=setInterval(b.bannerTick,3E4)},bannerTick:function(){if(f("pbgangBanner"))f("pbgangBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},
showBody:function(){var a=j.Gang,b="";b+='<DIV id=pbgangTroops class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbgangOptions class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbgangTargets class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbgangStats class=pbStatBox style="display:none;"></div>';f("pbgangBody").innerHTML=b;a.showDiv();a.checkMap()},showDiv:function(){var a=j.Gang;f("pbgangTroops").style.display="none";f("pbgangOptions").style.display="none";f("pbgangTargets").style.display=
"none";f("pbgangStats").style.display="none";switch(a.type){case M:f("pbgangTroops").style.display="block";a.showTroops();break;case 2:f("pbgangOptions").style.display="block";a.showOptions();break;case O:f("pbgangTargets").style.display="block";a.showTargets();break;case 4:f("pbgangStats").style.display="block",a.showStats()}},makeCitySelect:function(a,b){var c=o.player.cities,d="";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("city","common")+": ";if(c.length<2)d+=v.getCityName(0);else{d+="<SELECT id=pbgangCity_"+
b+">";for(i=0;i<c.length;i++)d+="<OPTION"+(a==i?" selected":"")+' value="'+i+'">'+v.getCityName(i)+"</option>";c.length>1&&b!=M&&(d+="<OPTION"+(a==999?" selected":"")+' value="999">'+h("all","common")+"</option>");d+="</select>"}d+="</td>";b==M?d+=P(false,"",true,0,"pbgangCityChk_"+b,n.options.gang.en[a],h("Abilita"),true):b==4?d+="<TD>"+y("pbgangCityBut_"+b,h("delete","common")+" "+h("stats","common"),false,false)+"</td>":b==O&&(d+="<TD>"+y("pbgangCityBut_"+b,h("delete","common")+" "+h("Ultimi attacchi"),
false,false)+"</td>");d+="</tr>";d+="</table>";return d},showTroops:function(){function a(a){var b=j.Gang;b.indcityTroops=u(a.target[a.target.selectedIndex].value);f("pbgangCityChk_"+M).checked=n.options.gang.en[b.indcityTroops];b.showTroopsCity()}var b=j.Gang,c="";c+="<DIV class=pbTitle>"+h("troops","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityTroops,M);c+="<DIV id=pbgangTroopsCity></div>";f("pbgangTroops").innerHTML=c;f("pbgangCity_"+M)&&f("pbgangCity_"+M).addEventListener("change",
a,false);f("pbgangCityChk_"+M).addEventListener("click",function(a){var b=j.Gang;n.options.gang.en[b.indcityTroops]=a.target.checked;b.showTroopsCity()},false);b.showTroopsCity()},showTroopsCity:function(){function a(a){var b=n.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,c=u(c[1]);b.leven[e][c]=a.target.checked}function b(a){var b=n.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,c=u(c[1]),g=Y(a.target.value);if(g<1||g>ia)a.target.value=g=ia;b.dist[e][c]=g}function c(a){var b=
n.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,g=u(c[1]),c=c[2],f=Y(a.target.value),l=o.player.cities[e].units[c];if(f>l)a.target.value=f=l;b.units[e][c][g]=f}var d=j.Gang,e="",g=n.options.gang,l=d.indcityTroops,s,p,q,v,y;p=[];q=[];v=[];if(g.en[l]){e+="<TABLE width=100%>";e+="<TR>";e+="<TD></td>";e+="<TD colspan=10>"+lb(h("level","common"))+"</td>";e+="</tr>";e+="<TR>";e+="<TD></td>";for(s=0;s<10;s++)e+="<TD align=center>"+(s+1)+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+h("Abilita")+"</td>";
for(s=0;s<10;s++)e+="<TD align=center>",e+=P(false,"",false,0,"pbgangTroopsChk_"+s,g.leven[l][s],"",false),e+="</td>",p.push("pbgangTroopsChk_"+s);e+="</tr>";e+="<TR>";e+="<TD>"+h("Distanza")+"</td>";for(s=0;s<10;s++)e+="<TD>"+K("pbgangTroopsDist_"+s,g.dist[l][s],1,2,"normalGreen")+"</td>",q.push("pbgangTroopsDist_"+s);e+="</tr>";e+="<TR>";e+="<TD>&nbsp;</td>";e+="<TD colspan=10></td>";e+="</tr>";for(y in g.units[l]){e+="<TR>";e+="<TD>"+h(y,"troops")+"</td>";for(s=0;s<10;s++)e+="<TD>"+K("pbgangTroops_"+
s+"_"+y,g.units[l][y][s],1,6,"normalGreen")+"</td>",v.push("pbgangTroops_"+s+"_"+y);e+="</tr>"}e+="</table>"}f("pbgangTroopsCity").innerHTML=e;if(g.en[l]){for(s=0;s<p.length;s++)f(p[s]).addEventListener("click",a,false);for(s=0;s<q.length;s++)f(q[s]).addEventListener("change",b,false);for(s=0;s<v.length;s++)f(v[s]).addEventListener("change",c,false)}},showOptions:function(){function a(a){var b=Y(a.target.value),c=n.options.gang,d=a.target.id.split("_")[1];if(b===0){switch(d){case "min":b=optsDefaults.min;
break;case "max":b=optsDefaults.max;break;case "same":b=optsDefaults.same}if(b!==0)a.target.value=b}switch(d){case "min":c.min=b;break;case "max":if(b<c.min)b=c.min,a.target.value=b;c.max=b;break;case "same":c.same=b}}var b=j.Gang,c="",d=n.options.gang;c+="<DIV class=pbTitle>"+h("Opzioni").toUpperCase()+"</div>";c+="<TABLE width=100%>";c+="<TR>";c+="<TD>"+h("Ritardo tra attacchi")+":</td>";c+="<TD>"+h("from","common")+" "+K("pbgangOpts_min",d.min,1,3,"normalGreen")+"</td>";c+="<TD>"+h("to","common")+
" "+K("pbgangOpts_max",d.max,1,3,"normalGreen")+" "+h("Secondi").toLowerCase()+"</td>";c+="</tr>";c+="<TR>";c+="<TD>"+h("Ritardo stesso obiettivo")+":</td>";c+="<TD colspan=2>"+K("pbgangOpts_same",d.same,1,3,"normalGreen")+" "+h("minuti").toLowerCase()+"</td>";c+="</tr>";c+="<TR>";c+="<TD>"+h("Elimina rapporti")+":</td>";c+=P(false,"",true,2,"pbgangOpts_DelRep",d.delrep,"",true);c+="</tr>";c+="<TR>";c+="<TD colspan=3></td>";c+="</tr>";c+="<TR>";c+="<TD colspan=3>"+y("pbgangOptsScan","Scan Mappa",
false,false)+"</td>";c+="</tr>";c+="</table>";f("pbgangOptions").innerHTML=c;f("pbgangOpts_min").addEventListener("change",a,false);f("pbgangOpts_max").addEventListener("change",a,false);f("pbgangOpts_same").addEventListener("change",a,false);f("pbgangOpts_DelRep").addEventListener("click",function(a){n.options.gang.delrep=a.target.checked},false);f("pbgangOptsScan").addEventListener("click",b.scanMap,false)},checkMap:function(){var a=j.Gang,b=o.player.cities,c=n.options.gang.last,d,e=false;for(d=
0;d<b.length;d++)if(c[d].x==-1||c[d].x!=b[d].x||c[d].y!=b[d].y){e=true;break}e&&a.scanMap()},scanMap:function(){var a=j.Gang;a.enableButtonForScan(false);n.options.gang.coords=[];a.indcity=0;a.readMap()},readMap:function(){var a=j.Gang,b=o.player.cities;a.indcity>=b.length?(a.type==O&&a.showTargets(),a.enableButtonForScan(),a.showFeedback(h("Scansione terminata")+"!")):(n.options.gang.coords[a.indcity]=[],a.showFeedback(h("Scansione gang di")+" "+v.getCityName(a.indcity),false),p.scan(b[a.indcity].x,
b[a.indcity].y,ia,function(){var a=j.Gang;if(!p.err){var b,e,g,f,h=a.indcity,H=p.targets.terrains.Gang;for(b=0;b<H.length;b++){f=n.options.gang.coords[h].length;g=false;for(e=0;e<f;e++)if(n.options.gang.coords[h][e].id==H[b].id){g=true;break}g||n.options.gang.coords[h].push({id:H[b].id,time:0,ind:h,opt:f,terrain:H[b]})}}if(p.done)b=o.player.cities,n.options.gang.last[a.indcity]=p.err?{x:-1,y:-1}:{x:b[a.indcity].x,y:b[a.indcity].y},a.indcity++,setTimeout(a.readMap,2E3)}))},showTargets:function(){function a(a){var b=
j.Gang;b.indcityTargets=u(a.target[a.target.selectedIndex].value);b.showTargetsCity()}var b=j.Gang,c="";c+="<DIV class=pbTitle>"+h("target","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityTargets,O);c+="<DIV id=pbgangTargetsCity></div>";f("pbgangTargets").innerHTML=c;f("pbgangCity_"+O)&&f("pbgangCity_"+O).addEventListener("change",a,false);f("pbgangCityBut_"+O).addEventListener("click",function(){var a=j.Gang,b=a.indcityTargets,c=n.options.gang,f,h,p=o.player.cities;switch(b){case 999:for(f=
0;f<p.length;f++)for(h=0;h<c.coords[b].length;h++)c.coords[f][h].time=0;break;default:for(h=0;h<c.coords[b].length;h++)c.coords[b][h].time=0}a.showTargetsCity()},false);b.showTargetsCity()},showTargetsCity:function(){function a(a){a=a.target.id.split("_");a=u(a[1]);b.doAttack(a,true)}var b=j.Gang,c=0,d,e,g="",l=C();b.tgts=[];switch(b.indcityTargets){case 999:b.getAllActiveTargets();break;default:b.getActiveTargetsCity(b.indcityTargets)}b.tgts.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;
c===0&&(c=a.terrain.level-b.terrain.level);c===0&&(c=a.ind-b.ind);c===0&&(c=a.time-b.time);return c});g+="<TABLE width=100%>";g+="<TR>";g+="<TD>"+h("Distanza")+"</td>";g+="<TD>"+h("Coordinate")+"</td>";g+="<TD>"+h("level","common")+"</td>";g+="<TD colspan=2>"+h("Ultimo attacco")+"</td>";g+="</tr>";for(d=0;d<b.tgts.length;d++)e=b.tgts[d],c++,g+="<TR>",g+="<TD>"+e.terrain.dist+"</td>",g+="<TD>"+e.terrain.x+"/"+e.terrain.y+"</td>",g+="<TD>"+e.terrain.level+"</td>",e=e.time===0?0:l-e.time,g+="<TD>",g+=
e===0?"---":$(e),g+="</td>",g+="<TD>"+y("pbgangTargets_"+d,h("attack","common"),false,false)+"</td>",g+="</tr>";g+="</table>";f("pbgangTargetsCity").innerHTML=g;for(d=0;d<b.tgts.length;d++)f("pbgangTargets_"+d).addEventListener("click",a,false)},getAllActiveTargets:function(){var a=j.Gang,b=o.player.cities;for(i=0;i<b.length;i++)a.getActiveTargetsCity(i)},getActiveTargetsCity:function(a){var b=j.Gang,c=n.options.gang,d,e;if(c.en[a])for(d=0;d<c.coords[a].length;d++)e=c.coords[a][d],c.leven[a][e.terrain.level-
1]&&e.terrain.dist<=c.dist[a][e.terrain.level-1]&&b.tgts.push(e)},showStats:function(){function a(a){var b=j.Gang;b.indcityStats=u(a.target[a.target.selectedIndex].value);b.showStatsCity()}var b=j.Gang,c="";c+="<DIV class=pbTitle>"+h("stats","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityStats,4);c+="<DIV id=pbgangStatsCity></div>";f("pbgangStats").innerHTML=c;f("pbgangCity_4")&&f("pbgangCity_4").addEventListener("change",a,false);f("pbgangCityBut_4").addEventListener("click",function(a){var b=
j.Gang;a.target.disabled=true;switch(b.indcityStats){case 999:b.clearStatsAll();break;default:b.clearStatsSingle(b.indcityStats)}a.target.disabled=false;b.showStatsCity()},false);b.showStatsCity()},showStatsCity:function(){var a=j.Gang,b,c,d,e="";switch(a.indcityTargets){case 999:d=a.getStatsAll();break;default:d=a.getStatsSingle(a.indcityStats)}b=n.options.gang.runTime;n.options.gang.enabled&&(b+=C()-a.curRunStart);e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+h("Iniziate il")+"</td>";e+=
"<TD align=center>"+h("Tempo di esecuzione")+"</td>";e+="<TD align=right>"+h("Attacchi")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>";d.start_at!==0&&(a=new Date(d.start_at*1E3),e+=a.formatDate(T)+" "+a.formatTime());e+="</td>";e+="<TD align=center>"+$(b,true)+"</td>";e+="<TD align=right>"+E(d.totAtt)+"</td>";e+="</tr>";e+="</table>";e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+h("resources","common")+":</td>";for(c in d.resources)e+="<TD align=right>"+h(c,"common")+"</td>";e+="</tr>";e+="<TR>";
e+="<TD>"+h("quantity","common")+":</td>";for(c in d.resources)e+="<TD align=right>"+E(d.resources[c])+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+h("per-hour","common")+":</td>";for(c in d.resources)b===0?e+="<TD align=right>---</td>":(a=u(d.resources[c]*3600/b),e+="<TD align=right>"+E(a)+"</td>");e+="</tr>";e+="</table>";e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD width=20%></td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";e+="<TD>"+lb(h("level","common"))+"</td>";e+="</tr></table>";e+=
"</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%></td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=1;b<11;b++)e+="<TD align=right width=10%>"+b+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%>"+h("Attacchi")+"</td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=0;b<10;b++)e+="<TD align=right width=10%>"+E(d.numAtt[b])+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%>"+h("items","common")+":</td>";e+="<TD width=80%></td>";e+=
"</tr>";for(c in d.items){e+="<TR>";e+="<TD width=20%>";e+=h(aa(c),"items")==aa(c)?h(aa(c),"armory"):h(aa(c),"items");e+="</td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=0;b<10;b++)e+="<TD align=right width=10%>"+E(d.items[c][b])+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>"}e+="</table>";f("pbgangStatsCity").innerHTML=e},todoTick:function(){var a=j.Gang,b=z.getTimerDelayMarch(false),c=n.options.gang,d=C(),e=n.options.gang.same*60+1,g,f;clearTimeout(a.todoTimer);if(c.enabled){a.getAllActiveTargets();
a.tgts.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;c===0&&(c=a.terrain.level-b.terrain.level);c===0&&(c=a.ind-b.ind);c===0&&(c=b.time-a.time);return c});for(c=0;c<a.tgts.length;c++)if(f=a.tgts[c],!(f.time!==0&&u(d-f.time)<e)&&(g=a.doAttack(c),g.ok||g.msg===""))break;if(!g.ok&&g.msg==="")g.msg=h("Nessuna truppa selezionata")+" "+h("or","common")+" "+h("Nessun obiettivo selezionato")+"!",a.showFeedback(g.msg);a.todoTimer=setTimeout(a.todoTick,b)}},doAttack:function(a,b){b==void 0&&(b=false);
var c=j.Gang,d=c.tgts[a],e=d.terrain.level-1,g={},f=n.options.gang.units[d.ind],h;for(h in f)f[h][e]!==0&&(g[h]=f[h][e]);e=z.checkAttack(g,d.ind,c,b);f=v.getCityId(d.ind);e.ok&&z.sendAttack(d.terrain.x,d.terrain.y,g,f,c,d.opt);return e},addStatFromReport:function(a,b){var c=j.Gang,d=v.getCityIndByName(a.attacker.city_name),e=a.location.level-1,g=n.options.gang,f;if(a.spoils&&!(a.attacker.name!=o.player.name||c.readed.indexOf(b)!=-1||a.location.terrain!="Gang"||d==-1)){c.readed.push(b);if(a.spoils.resources)for(r in a.spoils.resources)N(g.stat[d].resources,
r,u(a.spoils.resources[r])),N(o.player.cities[d].resources,r,u(a.spoils.resources[r]));if(a.spoils.items){for(r=0;r<a.spoils.items.length;r++){f=a.spoils.items[r];if(g.stat[d].items[f]==void 0){g.stat[d].items[f]=[];for(i=0;i<10;i++)g.stat[d].items[f].push(0)}g.stat[d].items[f][e]++;N(o.player.items,a.spoils.items[r],1)}j.Various.type==da&&j.Various.showDiv()}g.stat[d].numAtt[e]++;c.type==4&&d==c.indcityStats&&c.showStats();g.delrep&&G.deleteReport(b)}},clearStatsSingle:function(a){var b=n.options.gang,
c=C();b.stat[a]={start_at:c,resources:{},items:{},numAtt:[]};for(c=0;c<10;c++)b.stat[a].numAtt.push(0);if(o.player.cities.length<2)b.runTime=0},clearStatsAll:function(){var a=j.Gang,b,c=o.player.cities;b=C();a.curRunStart=b;for(b=0;b<c.length;b++)a.clearStatsSingle(b,false);n.options.gang.runTime=0},getStatsSingle:function(a){var b,c,d={start_at:0,totAtt:0,numAtt:[],resources:{},items:{}};for(b=0;b<10;b++)d.numAtt.push(0);a=n.options.gang.stat[a];d.start_at=a.start_at;for(c in a.resources)N(d.resources,
c,u(a.resources[c]));for(b=0;b<10;b++)d.totAtt+=a.numAtt[b],d.numAtt[b]+=a.numAtt[b];for(c in a.items){d.items[c]=[];for(b=0;b<10;b++)d.items[c].push(a.items[c][b])}return d},getStatsAll:function(){var a,b,c,d,e=o.player.cities,g={start_at:0,totAtt:0,numAtt:[],resources:{},items:{}};for(b=0;b<10;b++)g.numAtt.push(0);for(a=0;a<e.length;a++){d=n.options.gang.stat[a];if(g.start_at===0||d.start_at<g.start_at&&d.start_at!==0)g.start_at=d.start_at;for(c in d.resources)N(g.resources,c,u(d.resources[c]));
for(b=0;b<10;b++)g.totAtt+=d.numAtt[b],g.numAtt[b]+=d.numAtt[b];for(c in d.items){if(g.items[c]==void 0){g.items[c]=[];for(b=0;b<10;b++)g.items[c].push(0)}for(b=0;b<10;b++)g.items[c][b]+=d.items[c][b]}}return g},showFeedback:function(a,b){var c=j.Gang;b==void 0&&(b=true);clearTimeout(c.feedTimer);f("pbgangFeedback").innerHTML=a;if(a!==""&&b)c.feedTimer=setTimeout(c.showFeedback,5E3,"")},isInActiveList:function(a,b,c){var a=j.Gang,d,e,g=false;a.getActiveTargetsCity(d);for(d=0;d<a.tgts.length;d++)if(e=
a.tgts[d],e.terrain.x==b&&e.terrain.y==c){g=true;break}return g},inworkTick:function(){var a=j.Gang;clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.type==M&&a.showTroops();a.type==O&&a.showTargets();z.showTab();a.inworkTimer=setTimeout(a.inworkTick,5E3)},hide:function(){},show:function(){}};j.Build={tabOrder:qb,tabLabel:Ra,tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,expand:[],feedTimer:null,bannerTimer:null,init:function(a){var b=j.Build;b.toolTip="<BR><B>"+h("Buon gioco")+
"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbbldsHead></div>";a+="<DIV id=pbbldsBody></div>";b.cont.innerHTML=a;b.expand=[];b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a,b,c,d,e,g=o.player.cities,f=n.options,h=false;v.assignExpansions();if(f.blds==void 0)f.blds={},f.blds.enabled=false,f.blds.ind=0,f.blds.type="",f.blds.blden=[],f.blds.bldcap=[],f.blds.bldexp=[],h=true;if(f.blds.bldexp==void 0)f.blds.bldexp=[],h=true;for(a=0;a<g.length;a++)for(e in f.blds.blden[a]==
void 0&&(f.blds.blden[a]={},h=true),f.blds.bldcap[a]==void 0&&(f.blds.bldcap[a]={},h=true),f.blds.bldexp[a]==void 0&&(f.blds.bldexp[a]={},h=true),v.citiesExpansions[a])for(b in d=J.getBuildsByArea(a,e),d)if(e==D[0]?c=b:(c=b+e,f.blds.blden[a][c]!==void 0&&delete f.blds.blden[a][c],f.blds.bldcap[a][c]!==void 0&&delete f.blds.bldcap[a][c],f.blds.bldexp[a][c]!==void 0&&delete f.blds.bldexp[a][c],c=e+b),f.blds.blden[a][c]==void 0&&(f.blds.blden[a][c]=false,h=true),f.blds.bldcap[a][c]==void 0&&(f.blds.bldcap[a][c]=
0,h=true),f.blds.bldexp[a][c]==void 0||f.blds.bldexp[a][c]==="")f.blds.bldexp[a][c]=e,h=true;return h},showHead:function(){var a=j.Build,b="";b+="<DIV class=pbTitle>"+y("pbbldsOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbbldsInWork style="height:200px; max-height:200px; overflow-y:auto;"></div>';b+='<BR><DIV id=pbbldsFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";b+="<TABLE width=100%>";b+="<TR>";b+='<TD align=center><DIV id=pbbldsBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';
b+="</tr>";b+="</table>";f("pbbldsHead").innerHTML=b;a.setEnable(n.options.blds.enabled);f("pbbldsOnOff").addEventListener("click",function(){a.setEnable(!n.options.blds.enabled)},false);clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,3E4)},bannerTick:function(){if(f("pbbldsBanner"))f("pbbldsBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},setEnable:function(a){var b=
j.Build;if(!b.tabDisabled){var c=f("pbbldsOnOff"),d=h("construction","common").toUpperCase();clearTimeout(b.todoTimer);(n.options.blds.enabled=a)?(c.value=d+" ON",c.className="butAttackOn",b.todoTick()):(c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=j.Build,b="",c,d=o.player.cities;for(c=0;c<d.length;c++)a.expand.length<c+1&&a.expand.push(true),b+="<DIV class=pbTitle id=pbbldsdivtopcity_"+c+"></div>",b+="<DIV class=pbSubtitle id=pbbldsdivcity_"+c+"></div>";f("pbbldsBody").innerHTML=
b;a.showInfo()},showInfo:function(){function a(a){var b=a.target.id.split("_"),c=u(b[1]);n.options.blds.blden[c][b[2]]=a.target.checked}function b(a){var b=a.target.id.split("_"),c=u(b[1]);n.options.blds.bldcap[c][b[2]]=u(a.target[a.target.selectedIndex].value)}function c(a,b,c,d){var e="",g=n.options.blds,f=J.getBuildsByArea(a,D[d],b),l,j;e+="<B>&nbsp;"+h(b,"common").toUpperCase()+"</b>";e+="<TABLE id=pbblds_"+b+"_"+a+" width=100%>";for(l in f)if(j=f[l],j.builds.length!==0&&va[l]){b=D[d]+l;d===0&&
(b=l);if(g.bldcap[a][b]===0||g.bldcap[a][b]<j.builds[0].level)g.bldcap[a][b]=j.builds[0].level;e+=P(true,"valign=top",true,0,"pbbldsChk_"+a+"_"+b,g.blden[a][b],h(l,"buildings"),true);e+="<TD><SELECT id=pbbldsSel_"+a+"_"+b+">";for(j=1;j<va[l].maxlevel+1;j++)e+="<OPTION"+(g.bldcap[a][b]==j?" selected":"")+' value="'+j+'">'+j+"</option>";e+="</select></td>";e+="</tr>";c.push({en:"pbbldsChk_"+a+"_"+b,cap:"pbbldsSel_"+a+"_"+b})}e+="</table>";return e}function d(a){var b=j.Build,c=a.target.id.split("_"),
c=u(c[1]),d="none";b.expand[c]=!b.expand[c];b.expand[c]&&(d="block");a.target.value=" "+(b.expand[c]===true?"-":"+")+" ";f("pbbldsdivcity_"+c).style.display=d}function e(a){var b=a.target.id.replace("pbbldsHideShow_",""),c=a.target.value==" - "?" + ":" - ";if(f(b))f(b).style.display=f(b).style.display=="none"?"block":"none";a.target.value=c}function g(a){a=a.target.id.split("_");a=u(a[1]);v.defendCity(a)}var l=j.Build,s="",p,q,z,C,A,w=[],F=o.player.cities;for(p=0;p<F.length;p++){f("pbbldsdivtopcity_"+
p).innerHTML=v.getCityTitle(p,l);s="";z=Object.size(v.citiesExpansions[p])>1;for(q=0;q<D.length;q++)if(v.citiesExpansions[p][D[q]]!==void 0&&v.citiesExpansions[p][D[q]]){if(z){C="+";A=f("pbbldsHideShow_pbbldsExp_"+p+"_"+q);if(!A||A.style.display!="none")C="-";s+="<DIV class=pbTitle>"+h("neighborhood-"+D[q],"common");s+="&nbsp;"+y("pbbldsHideShow_pbbldsExp_"+p+"_"+q," "+C+" ",false,false,"small");s+="</div>"}s+="<TABLE id=pbbldsExp_"+p+"_"+q+" width=100%><TR>";s+="<TD width="+(q===0?50:100)+'% style="text-align:left; vertical-align:top;">'+
c(p,"neighborhood",w,q)+"</td>";q===0&&(s+='<TD width=50% style="text-align:left; vertical-align:top;">'+c(p,"compound",w,q)+"</td>");s+="</tr></table>"}f("pbbldsdivcity_"+p).innerHTML=s;f("pbbldsdivcity_"+p).style.display=l.expand[p]===true?"block":"none";f("pbbldsHideShow_"+p).addEventListener("click",d,false);f("pbbldsDefend_"+p).addEventListener("click",g,false);if(z)for(q=0;q<D.length;q++)v.citiesExpansions[p][D[q]]!==void 0&&v.citiesExpansions[p][D[q]]&&f("pbbldsHideShow_pbbldsExp_"+p+"_"+q).addEventListener("click",
e,false)}for(p=0;p<w.length;p++)f(w[p].en).addEventListener("click",a,false),f(w[p].cap).addEventListener("change",b,false)},checkJobs:function(a){var b,c,d,e,g=C();d=F.getJobsByQueue("building",a);for(b=d.length-1;b>=0;b--)e=d[b],c=u(e.run_at-g),c<=0?F.deleteJob(e.id):(c=J.getBuildById(a,e.city_building_id),c===null&&F.deleteJob(e.id))},todoTick:function(){var a=j.Build,b=5E3,c=n.options.blds;if(c.ind>=o.player.cities.length)c.ind=0,c.type="";var d=c.type,e=c.ind,g,f,h,p,q,u=false,y=false;clearTimeout(a.todoTimer);
a.checkJobs(e);if(F.getJobsByQueue("building",e).length===0){var A;for(g=0;g<D.length;g++){if(v.citiesExpansions[e][D[g]]!==void 0&&v.citiesExpansions[e][D[g]])for(f in A=J.getBuildsByArea(e,D[g]),A){q=A[f];h=D[g]+f;g===0&&(h=f);if(d===""||h==d){u=true;c.type=h;if(d!=="")continue;d=h}if(u&&c.blden[e][h]&&q.builds.length!==0){c.type=h;for(p=0;p<q.builds.length;p++)if(q.builds[p].level<c.bldcap[e][h]&&J.checkRequirements(e,q.builds[p])){a.doWork(e,q.builds[p],D[g]);y=true;break}if(y)break}}if(y)break}}if(!y){c.ind++;
if(c.ind>=o.player.cities.length)c.ind=0;c.type="";o.player.cities.length<2&&(b=3E3)}a.todoTimer=setTimeout(a.todoTick,b)},doWork:function(a,b,c){var d=b.id,e=v.getCityId(a);q.calls["cities/@@id1/buildings/@@id2.json"].parms["city_building[neighborhood_id]"]=v.getNeighId(a,c);q.calls["cities/@@id1/buildings/@@id2.json"].parms.city_id=e;q.generalCall("cities/@@id1/buildings/@@id2.json",e,d,function(a){if(a.ok){var a=a.dat.result,c=v.getCityIndById(a.city.id);o.player.cities[c]=a.city;X(h("build","common")+
" "+h(b.type,"buildings")+" "+h("level","common")+" "+(b.level+1))}else X(h("Errore")+" in "+h("build","common")+": "+a.errmsg)})},showFeedback:function(a){var b=j.Build;clearTimeout(b.feedTimer);f("pbbldsFeedback").innerHTML=a;if(a!=="")b.feedTimer=setTimeout(b.showFeedback,5E3,"")},inworkTick:function(){var a=j.Build,b="",c=o.player.cities,d,e,g,l,s,n,p=C();clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.showInfo();for(d=0;d<c.length;d++)a.checkJobs(d);b+="<TABLE class=pbTab>";for(d=0;d<c.length;d++){b+=
"<TR><TD align=left>";b+=v.getCityName(d);b+="</td>";g=F.getJobsByQueue("building",d);for(e=0;e<g.length;e++)s=g[e],n=u(s.run_at-p),l=J.getBuildById(d,s.city_building_id),b+="<TD align=left>",b+=h(l.type,"buildings")+" "+h("level","common")+" "+s.level,b+="</td>",b+="<TD align=right>("+$(n)+")</td>";g.length===0&&(b+="<TD align=left><FONT COLOR=red>"+h("no","common")+"</font></td><TD></td>");b+="</tr>"}b+="</table>";f("pbbldsInWork").innerHTML=b;a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},
show:function(){}};j.Collect={tabOrder:5,tabLabel:"Raccogli",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,bannerTimer:null,init:function(a){var b=j.Collect;b.toolTip=h("Raccogli dai tuoi slot")+"<BR><B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbcollHead></div>";a+="<DIV id=pbcollBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a,b,c,d,e,g,f=o.player.cities,h=n.options,j=false;if(h.coll==
void 0)h.coll={},h.coll.collen=[],h.coll.scapes=[],j=true;if(h.coll.scapes==void 0)h.coll.scapes=[],j=true;for(a=0;a<f.length;a++){h.coll.collen[a]==void 0&&(h.coll.collen[a]={},j=true);h.coll.scapes[a]==void 0&&(h.coll.scapes[a]={},j=true);c=J.getBuildsByFirstHood(a,"",true);for(b in c)h.coll.collen[a][b]==void 0&&(h.coll.collen[a][b]=false,j=true);for(b in h.coll.scapes[a]){d=u(b/1E3);e=u(b)%1E3;g=false;for(c=0;c<f[a].wildernesses.length;c++)if(f[a].wildernesses[c].x==d&&f[a].wildernesses[c].y==
e){g=true;break}g||(delete h.coll.scapes[a][b],j=true)}for(b=0;b<f[a].wildernesses.length;b++)c=""+(f[a].wildernesses[b].x*1E3+f[a].wildernesses[b].y),h.coll.scapes[a][c]==void 0&&(h.coll.scapes[a][c]=false,j=true)}return j},showHead:function(){var a=j.Collect,b="";b+="<DIV class=pbTitle>"+h("collect","common").toUpperCase()+"</div>";b+="<TABLE width=100%>";b+="<TR>";b+='<TD align=center><DIV id=pbcollBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';
b+="</tr>";b+="</table>";b+="<DIV id=pbcollInWork></div>";f("pbcollHead").innerHTML=b;clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,3E4)},bannerTick:function(){if(f("pbcollBanner"))f("pbcollBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},checkJobs:function(){var a=j.Collect,b=o.player.cities,c,d,e,g,f=C();a.clearDefaultData();for(a=0;a<b.length;a++){c=
J.getBuildsByFirstHood(a,"",true);for(d in c)e=F.getJobsByQueue("collection"+d,a),e.length!==0&&(g=u(e[0].run_at-f),g<=0&&F.deleteJob(e[0].id));e=F.getJobsByQueue("city_scape_collect",a);for(d=0;d<e.length;d++)g=u(e[d].run_at-f),g<=0&&F.deleteJob(e[d].id)}},showBody:function(){var a=j.Collect;f("pbcollBody").innerHTML="";a.todoTick()},todoTick:function(){var a=j.Collect,b=o.player.cities,c,d,e,g,f,h,p,q=C(),y=0,z=n.options.coll;clearTimeout(a.todoTimer);a.checkJobs();for(c=0;c<b.length;c++){f=J.getBuildsByFirstHood(c,
"",true);for(d in f)if(z.collen[c][d]&&(h=f[d],h.builds.length!==0)){g=F.getJobsByQueue("collection"+d,c);if(p=g.length!==0)e=u(g[0].run_at-q),e<=0&&(p=false);p||(setTimeout(a.doWork,y*3E3,v.getCityId(c),h.builds[0].id),y++)}g=F.getJobsByQueue("city_scape_collect",c);for(d=0;d<b[c].wildernesses.length;d++)if(f=b[c].wildernesses[d],p=""+(f.x*1E3+f.y),z.scapes[c][p]){p=false;for(e=0;e<g.length;e++)if(g[e].x==f.x&&g[e].y==f.y){p=true;e=u(g[e].run_at-q);e<=0&&(p=false);break}p||f.last_collected_at!=void 0&&
(p=v.remainingTimeToCollect(c,f.last_collected_at)>=0);p||(setTimeout(a.doWork,y*3E3,v.getCityId(c),f.id,true),y++)}}a.todoTimer=setTimeout(a.todoTick,(y+2)*3E3)},doWork:function(a,b,c){c==void 0&&(c=false);c=c?"cities/@@id1/wildernesses/@@id2/collect.json":"cities/@@id1/npc_buildings/@@id2.json";q.calls[c].parms.city_building_id=b;q.calls[c].parms.city_id=a;q.generalCall(c,a,b,function(a){if(a.ok){var b=j.Collect,a=a.dat.result,c,f;a.job?(c=a.job.queue.replace("collection",""),f=a.city_id):(c="",
f=a.city.id);f=v.getCityIndById(f);var n="";a.job?(o.player.cities[f].resources=a.resources,F.addJob(a.job),n=h(c,"buildings")):(o.player.cities[f]=a.city,n=h("cityscapes","common"));X(h("collect","common")+" "+h("from","common")+" "+n);b.showBody()}else X(h("Errore")+" in "+h("collect","common")+": "+a.errmsg)})},inworkTick:function(){function a(a){var b=a.target.id.split("_"),c=u(b[1]);n.options.coll.collen[c][b[2]]=a.target.checked}function b(a){var b=j.Collect,a=a.target.id.split("_");b.doWork(a[1],
a[2])}function c(a){var b=a.target.id.split("_"),c=u(b[1]);n.options.coll.scapes[c][b[2]]=a.target.checked}function d(a){var b=j.Collect,a=a.target.id.split("_");b.doWork(a[1],a[2],true)}function e(a){var b=a.target.id.split("_"),a=u(b[1])!==0,c=u(b[2]),b=o.player.cities,d,e,g;if(c===0)for(c=0;c<b.length;c++)for(d in e=J.getBuildsByFirstHood(c,"",true),e)g=e[d],g.builds.length!==0&&(n.options.coll.collen[c][d]=a);else for(c=0;c<b.length;c++){e=b[c].wildernesses;for(d=0;d<e.length;d++)g=""+(e[d].x*
1E3+e[d].y),n.options.coll.scapes[c][g]=a}}var g=j.Collect,l="",p=o.player.cities,q,B,z,D,A,w,E,G,I=C();clearTimeout(g.inworkTimer);g.checkJobs();l+="<DIV class=pbSubtitle>";l+="<TABLE width=100%>";l+="<TR><TD colspan=4 align=center>&nbsp;";q=h("from","common")+" "+h("construction","common");l+="<DIV class=pbTitle>"+q.toUpperCase()+" ";l+=y("pbcollSel_1_0",h("select","common")+" "+h("all","common"),false,false,"small")+" ";l+=y("pbcollSel_0_0","De"+h("select","common")+" "+h("all","common"),false,
false,"small");l+="</div>";l+="</td></tr>";for(q=0;q<p.length;q++)for(B in z=J.getBuildsByFirstHood(q,"",true),z)A=z[B],A.builds.length!==0&&(l+="<TR><TD align=left>&nbsp;"+h(B,"buildings")+"</td>",l+="<TD align=center>",D=F.getJobsByQueue("collection"+B,q),l+=y("pbcollBut_"+v.getCityId(q)+"_"+A.builds[0].id,h("collect","common"),D.length!==0,false,"small")+"</td>",D.length!==0?(G=u(D[0].run_at-I),l+="<TD align=left>&nbsp;("+$(G)+")</td>"):l+="<TD>&nbsp;</td>",l+="<TD align=right>"+P(false,"",false,
0,"pbcollChk_"+q+"_"+B,n.options.coll.collen[q][B])+" "+h("collect","common")+" "+h("in automatico")+"&nbsp;</td></tr>");l+="<TR><TD colspan=4 align=center>&nbsp;";q=h("from","common")+" "+h("cityscapes","common");l+="<DIV class=pbTitle>"+q.toUpperCase()+" ";l+=y("pbcollSel_1_1",h("select","common")+" "+h("all","common"),false,false,"small")+" ";l+=y("pbcollSel_0_1","De"+h("select","common")+" "+h("all","common"),false,false,"small");l+="</div>";l+="</td></tr>";for(q=0;q<p.length;q++){w=p[q].wildernesses;
D=F.getJobsByQueue("city_scape_collect",q);for(B=0;B<w.length;B++){A=""+(w[B].x*1E3+w[B].y);E=false;for(z=0;z<D.length;z++)if(D[z].x==w[B].x&&D[z].y==w[B].y){E=true;G=u(D[z].run_at-I);break}!E&&w[B].last_collected_at&&(G=v.remainingTimeToCollect(q,w[B].last_collected_at),E=G>0);l+="<TR><TD align=left>&nbsp;"+h("cityscapes","common")+": "+w[B].x+"/"+w[B].y+"</td>";l+="<TD align=center>";l+=y("pbcollScapesBut_"+v.getCityId(q)+"_"+w[B].id,h("collect","common"),E,false,"small")+"</td>";l+=E?"<TD align=left>&nbsp;("+
$(G)+")</td>":"<TD>&nbsp;</td>";l+="<TD align=right>"+P(false,"",false,0,"pbcollScapesChk_"+q+"_"+A,n.options.coll.scapes[q][A])+" "+h("collect","common")+" "+h("in automatico")+"&nbsp;</td></tr>"}}l+="</table>";l+="</div>";f("pbcollInWork").innerHTML=l;g.inworkTimer=setTimeout(g.inworkTick,2500);for(q=0;q<p.length;q++){w=p[q].wildernesses;z=J.getBuildsByFirstHood(q,"",true);for(B in z)A=z[B],A.builds.length!==0&&(f("pbcollBut_"+v.getCityId(q)+"_"+A.builds[0].id).addEventListener("click",b,false),
f("pbcollChk_"+q+"_"+B).addEventListener("click",a,false));for(B=0;B<w.length;B++)A=""+(w[B].x*1E3+w[B].y),f("pbcollScapesBut_"+v.getCityId(q)+"_"+w[B].id).addEventListener("click",d,false),f("pbcollScapesChk_"+q+"_"+A).addEventListener("click",c,false)}f("pbcollSel_1_0").addEventListener("click",e,false);f("pbcollSel_0_0").addEventListener("click",e,false);f("pbcollSel_1_1").addEventListener("click",e,false);f("pbcollSel_0_1").addEventListener("click",e,false)},hide:function(){},show:function(){}};
var da=0;j.Various={tabOrder:7,tabLabel:"Varie",tabDisabled:false,cont:null,toolTip:"",type:da,todoTimer:null,inworkTimer:null,bannerTimer:null,init:function(a){var b=j.Various;b.toolTip=h("Buon gioco")+"!</b><BR>";b.cont=a;a="";a+="<DIV id=pbvarsHead></div>";a+="<DIV id=pbvarsBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},showHead:function(){var a=j.Various,b="";b+="<DIV class=pbTitle>"+h("Varie").toUpperCase()+"</div>";b+="<DIV id=pbvarsButt></div>";f("pbvarsHead").innerHTML=b;a.showButt()},
showButt:function(){var a=j.Various,b="";b+="<TABLE width=100%>";b+="<TR>";b+="<TD>"+y("pbvarsBut_"+da,h("my-items","common"),false,false,"small")+"</td>";b+='<TD align=center><DIV id=pbvarsBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';b+="</tr>";b+="</table>";f("pbvarsButt").innerHTML=b;f("pbvarsBut_"+da).addEventListener("click",function(a){var b=j.Various,a=a.target.id.split("_");
b.type=u(a[1]);b.showDiv()},false);clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,3E4)},bannerTick:function(){if(f("pbvarsBanner"))f("pbvarsBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},showDiv:function(){var a=j.Various;f("pbvarsItems").style.display="none";switch(a.type){case da:f("pbvarsItems").style.display="block",a.showItems()}},showBody:function(){var a=
j.Various,b="";b+='<DIV id=pbvarsItems class=pbStatBox style="display:none;"></div>';f("pbvarsBody").innerHTML=b;a.showDiv()},showItems:function(){function a(a){a=a.target.id.split("_");L.useObject(a[1])}var b=L.getInventory(),c;f("pbvarsItems").innerHTML=b.msg;for(c=0;c<b.els.length;c++)f(b.els[c]).addEventListener("click",a,false)},inworkTick:function(){var a=j.Various;clearTimeout(a.inworkTimer);a.inworkTimer=setTimeout(a.inworkTick,5E3)},hide:function(){},show:function(){}};j.Options={tabOrder:mb,
tabLabel:nb,tabDisabled:false,cont:null,toolTip:"",timerInfo:null,timerFlash:null,timerTool:null,bannerTimer:null,init:function(a){var b=j.Options;b.toolTip=h("Seleziona le tue preferenze e")+"<BR><B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pboptsHead></div>";a+="<DIV id=pboptsBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},clearDefaultData:function(){var a=n.options,b=o.player.cities.length*5;if(a.info==void 0)a.info={},a.info.enabled=true,a.info.delay=
5,a.info.unit=60;if(a.info.delay*a.info.unit<b)a.info.delay=b,a.info.unit=1;if(a.flash==void 0)a.flash={},a.flash.enabled=false,a.flash.delay=15,a.flash.unit=60;if(a.tool==void 0)a.tool={},a.tool.enabled=false,a.tool.delay=15,a.tool.unit=60},showHead:function(){var a=j.Options,b="";b+="<DIV class=pbTitle>"+h("Caratteristiche").toUpperCase()+"</div>";f("pboptsHead").innerHTML=b;clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,3E4)},bannerTick:function(){if(f("pboptsBanner"))f("pboptsBanner").innerHTML=
'<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},setTimerInfo:function(){var a=j.Options,b=n.options.info;clearInterval(a.timerInfo);if(b.enabled)a.timerInfo=setInterval(Ma,b.delay*b.unit*1E3)},setTimerFlash:function(){var a=j.Options,b=n.options.flash;clearInterval(a.timerFlash);if(b.enabled)a.timerFlash=setInterval(a.resetFlash,b.delay*b.unit*1E3)},setTimerTool:function(){var a=j.Options,
b=n.options.tool;clearTimeout(a.timerTool);if(b.enabled)a.timerTool=setTimeout(qa,b.delay*b.unit*1E3)},resetFlash:function(){var a=j.Options,b=f("container");b.style.display=="none"?b.style.display="block":(b.style.display="none",setTimeout(a.resetFlash,1E3))},showBody:function(){function a(a){var b=a.target.id.replace("pbopts",""),a=a.target.checked;switch(b){case "Info":n.options.info.enabled=a;d.setTimerInfo();break;case "Flash":n.options.flash.enabled=a;d.setTimerFlash();break;case "Tool":n.options.tool.enabled=
a;d.setTimerTool();break;case "Every6":n.options.every6=a}}function b(a){var b=a.target.id.replace("pboptsDelay",""),c=Y(a.target.value),e=o.player.cities.length*5;switch(b){case "Info":if(c<e&&n.options.info.unit==1)a.target.value=c=e;n.options.info.delay=c;d.setTimerInfo();break;case "Flash":n.options.flash.delay=c;d.setTimerFlash();break;case "Tool":n.options.tool.delay=c,d.setTimerTool()}}function c(a){var b=a.target.id.replace("pboptsUnit",""),a=u(a.target[a.target.selectedIndex].value),c=o.player.cities.length*
5;switch(b){case "Info":if(a==1&&n.options.info.delay<c)f("pboptsDelayInfo").value=n.options.info.delay=c;n.options.info.unit=a;d.setTimerInfo();break;case "Flash":n.options.flash.unit=a;d.setTimerFlash();break;case "Tool":n.options.tool.unit=a,d.setTimerTool()}}var d=j.Options,e="";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsInfo",n.options.info.enabled)+" "+h("Leggi Info ogni")+"&nbsp;</td>";e+="<TD>"+K("pboptsDelayInfo",n.options.info.delay,1,2,"normalGreen")+"</td>";
e+=Sa(false,true,"pboptsUnitInfo",1,Hb,n.options.info.unit,Ib,true);e+="<TD>"+y("pboptsReadInfo",h("Leggi ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsFlash",n.options.flash.enabled)+" "+h("Riavvia Flash ogni")+"&nbsp;</td>";e+="<TD>"+K("pboptsDelayFlash",n.options.flash.delay,1,2,"normalGreen")+"</td>";e+=Sa(false,true,"pboptsUnitFlash",1,sb,n.options.flash.unit,tb,true);e+="<TD>"+y("pboptsResetFlash",h("Riavvia ORA"),false,false,"small")+"</td>";e+=
"</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsTool",n.options.tool.enabled)+" "+h("Riavvia Tool ogni")+"&nbsp;</td>";e+="<TD>"+K("pboptsDelayTool",n.options.tool.delay,1,2,"normalGreen")+"</td>";e+=Sa(false,true,"pboptsUnitTool",1,sb,n.options.tool.unit,tb,true);e+="<TD>"+y("pboptsResetTool",h("Riavvia ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,4,"pboptsEvery6",n.options.every6)+" "+h("collect","common")+" "+h("from","common")+" "+h("cityscapes","common")+
" "+h("ogni")+" 6 "+h("Ore")+"&nbsp;</td>";e+="</tr>";e+="<TR>";e+='<TD colspan=4 align=center><DIV id=pboptsBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></td>';e+="</tr>";e+="</table>";f("pboptsBody").innerHTML=e;d.setTimerInfo();d.setTimerFlash();d.setTimerTool();f("pboptsInfo").addEventListener("click",a,false);f("pboptsDelayInfo").addEventListener("change",b,false);f("pboptsUnitInfo").addEventListener("change",
c,false);f("pboptsReadInfo").addEventListener("click",Ma,false);f("pboptsFlash").addEventListener("click",a,false);f("pboptsDelayFlash").addEventListener("change",b,false);f("pboptsUnitFlash").addEventListener("change",c,false);f("pboptsResetFlash").addEventListener("click",d.resetFlash,false);f("pboptsTool").addEventListener("click",a,false);f("pboptsDelayTool").addEventListener("change",b,false);f("pboptsUnitTool").addEventListener("change",c,false);f("pboptsResetTool").addEventListener("click",
qa,false);f("pboptsEvery6").addEventListener("click",a,false)},hide:function(){},show:function(){}};j.Help={tabOrder:10,tabLabel:rb,tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,bannerTimer:null,logTab:null,maxEntries:500,saveEntries:200,state:null,type:na,init:function(a){var b=j.Help;b.toolTip=h("Questo tab ti informa sul nostro tool")+".<BR><B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;a="";a+="<DIV id=pbhelpHead></div>";a+="<DIV id=pbhelpBody></div>";b.cont.innerHTML=a;b.showHead();
b.showBody()},showHead:function(){var a=j.Help,b="";b+="<DIV class=pbTitle>"+h("Help").toUpperCase()+"</div>";b+="<DIV id=pbhelpButt></div>";b+='<CENTER><DIV id=pbhelpBanner><iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe></div></center>';b+="<HR>";b+="<DIV id=pbhelpCont></div>";f("pbhelpHead").innerHTML=b;a.showButt()},showButt:function(){function a(a){var b=j.Help,a=a.target.id.split("_");
switch(u(a[1])){case na:b.showHelp();break;case wa:b.showLog()}}var b=j.Help,c="";c+=y("pbhelp_"+na,"?",false,false,"small")+"&nbsp;";c+=y("pbhelp_"+wa,"Log",false,false,"small");f("pbhelpButt").innerHTML=c;b.showHelp();b.todoTick();f("pbhelp_"+na).addEventListener("click",a,false);f("pbhelp_"+wa).addEventListener("click",a,false);clearInterval(b.bannerTimer);b.bannerTimer=setInterval(b.bannerTick,3E4)},bannerTick:function(){if(f("pbhelpBanner"))f("pbhelpBanner").innerHTML='<iframe src=https://gamespowerita.com/Ads/Tools/Tools.php width="320" marginwidth="0" marginheight="0" height="50" scrolling="no" frameborder="0"></iframe>'},
showBody:function(){f("pbhelpBody").innerHTML=""},todoTick:function(){var a=j.Help;clearTimeout(a.todoTimer);a.todoTimer=setTimeout(a.todoTick,3E4)},showLog:function(){var a=j.Help,b;b="";a.type=wa;b+="<DIV class=pbTitle>"+h("LOG AZIONI")+" ";b+=y("pbhelpDelete","Cancella Log",false,false);b+="<TABLE cellpadding=0 cellspacing=0 id=pbhelpTabLog class=pbTabLined><TR><TD></td><TD width=95%></td></table></div>";f("pbhelpCont").innerHTML=b;a.logTab=f("pbhelpTabLog");a.state=1;if(ga(n.log)=="array")for(b=
0;b<n.log.length;b++)a._addTab(n.log[b].msg,n.log[b].ts);f("pbhelpDelete").addEventListener("click",function(){var a=j.Help,b,e=a.logTab.rows.length;n.log=[];for(b=0;b<e;b++)a.logTab.deleteRow(0)},false)},_addTab:function(a,b){var c=j.Help;if(c.state==1)c.logTab.rows.length>=c.maxEntries&&c.logTab.deleteRow(c.maxEntries-1),c=c.logTab.insertRow(0),c.vAlign="top",c.insertCell(0).innerHTML=b,c.insertCell(1).innerHTML=a},log:function(a){var b=j.Help,c=(new Date).toLocaleTimeString();for(b._addTab(a,c);n.log.length>=
b.saveEntries;)n.log.shift();n.log.push({msg:a,ts:c})},showHelp:function(){var a="";j.Help.type=na;a+="<div class=pbTitle>";a+=ka;a+="<br>"+Fa();a+='<br><a target=_website href="'+ma+'"><span class=LinkWhite>'+ma+"</span></a>";a+="</div>";a+="<div class=pbTitle>"+h("Gruppo su Facebook")+"</div>";a+='<CENTER><a target=_facebook href="http://www.facebook.com/groups/437218926346533/"><span class=LinkWhite>http://www.facebook.com/groups/437218926346533/</span></a></center>';f("pbhelpCont").innerHTML=
a},inworkTick:function(){var a=j.Info;a.inworkTimer=setTimeout(a.inworkTick,1E4)},hide:function(){},show:function(){}};var n={cookieName:"Kabamfuck",serverID:function(){if(Ta===null){var a=/^[a-zA-Z]+([0-9]+)\./.exec(document.location.hostname);Ta=a?a[1]:"??"}return Ta}(),names:[],init:function(a){var b=n,c;for(c in a)b[c]=b.readMergeOptions(c,a[c]),b.names.push(c);a=n.options;if(a.inMarch==void 0)a.inMarch=false;if(a.every6==void 0)a.every6=false;if(a.tabEnabled.length===0){a.tabEnabled[0]=false;
for(i=ta;i<=10;i++)a.tabEnabled[i]=true}else for(i=ta;i<=10;i++)a.tabEnabled[i]==void 0&&(a.tabEnabled[i]=true)},save:function(){var a=n,b,c;b=j.Wave;c=a.options.wave;!b.tabDisabled&&c.enabled&&b.curRunStart!==0&&(c.runTime+=C()-b.curRunStart);b=j.Gang;c=a.options.gang;!b.tabDisabled&&c.enabled&&b.curRunStart!==0&&(c.runTime+=C()-b.curRunStart);U("===========  Data.onUnload");if(V)a.options.ptWin.Pos=V.getLocation();for(b=0;b<a.names.length;b++)try{Oa?localStorage.setItem(a.names[b],la.stringify(a[a.names[b]])):
GM_setValue(a.names[b]+"_"+a.serverID,la.stringify(a[a.names[b]]))}catch(d){U(d)}},readMergeOptions:function(a,b){var c=n,d;U("==========  Load preference");try{d=Oa?localStorage.getItem(a):GM_getValue(a+"_"+c.serverID)}catch(e){d=null}if(d===null)return b;opts=la.parse(d);if(ga(b)=="array")b=b.concat(opts);else if(ga(opts)=="object")for(k in opts)b[k]=opts[k];return b},getCookie:function(a){var b=document.cookie.indexOf(a+"="),c=null;if(b>=0){c=document.cookie.indexOf(";",b);if(c<0)c=document.cookie.length;
c=unescape(document.cookie.substring(b+a.length+1,c))}return c}};j.Wheel={tabOrder:6,tabLabel:"Ruota",tabDisabled:true,cont:null,toolTip:"",timestamp:null,init:function(a){var b=j.Wheel;b.toolTip="<B>"+h("Buon gioco")+"!</b><BR>";b.cont=a;a="";a+="<DIV id=pbwheeHead></div>";a+="<DIV id=pbwheeBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},showHead:function(){var a="";a+="<DIV class=pbTitle>"+h("Ruota").toUpperCase()+"</div>";f("pbwheeHead").innerHTML=a},showBody:function(){function a(a){var c=
j.Wheel,g="",l,a=a.dat.result;c.timestamp=a.minigame_timestamp;a=a.prize_list;for(l in a)a[l].type!=void 0&&a[l].type!=null&&(g+="<BR>"+h(a[l].type,"items"));g+="<BR><BR>"+y("pbwheeSave",h("save","common"),false,false);f("pbwheePrizeDiv").innerHTML=g;f("pbwheeSave").addEventListener("click",b,false)}function b(){var a=j.Wheel;q.calls["minigames/save_result.json"].parms.city_id=v.getCityId(0);q.calls["minigames/save_result.json"].parms.minigame_timestamp=a.timestamp;q.generalCall("minigames/save_result.json",
"","",function(a){var b="",c,a=a.dat.result,a=a.item_won;for(c in a)a[c].name!=null&&a[c].name!=void 0&&(b+=b===""?h("you-won","common")+": ":", ",b+=h(a[c].name,"items"));f("pbwheePrizeDiv").innerHTML+="<BR>"+b})}var c="";c+=y("pbwheeTurn",h("spin","common"),false,false);c+="<BR><BR>";c+="<DIV id=pbwheePrizeDiv></div>";f("pbwheeBody").innerHTML=c;f("pbwheeTurn").addEventListener("click",function(){f("pbwheePrizeDiv").innerHTML="";q.calls["minigames/index.json"].parms.city_id=v.getCityId(0);q.generalCall("minigames/index.json",
"","",a)},false)},hide:function(){},show:function(){}};j.Admin={tabOrder:ob,tabLabel:pb,tabDisabled:true,cont:null,toolTip:"",fam:0,totpage:0,currpage:0,totplayer:0,contp:0,lead:null,init:function(a){var b=j.Admin;b.toolTip="ADMIN TAB";b.cont=a;var a=o.player.cities,c,d="";d+="<TABLE width=100%><TR><TD>";d+="Famiglia: ";d+="<select id=ptAdminFam>";d+="<option value=0>Corleone</option>";d+="<option value=1>Tattaglia</option>";d+="<option value=2>Stracci</option>";d+="<option value=3>Barzini</option>";
d+="<option value=4>Cuneo</option>";d+="</select>";d+="</td><TD>";d+='Da pagina <INPUT id=ptAdminFPage type=text size=4 value="1" >';d+="</td></tr><TR><TD>";d+="Citt\u00e0: ";d+="<select id=ptAdminCity>";for(c=0;c<a.length;c++)d+='<option value="'+v.getCityId(c)+'">'+a[c].name+"</option>";d+="</select>";d+="</td></tr></table>";d+="<BR>Oggetto:";d+="<BR><INPUT id=ptAdminSub type=text size=65 >";d+="<BR>Messaggio:";d+="<BR><textarea id=ptAdminMess rows=20 cols=70></textarea>";d+="<BR><BR>";d+='<input type=button id=ptAdminTest value="TEST" />';
d+=' - <input type=button id=ptAdminSend value="INVIA" />';d+="<BR><BR>";d+='<div style="width:auto; max-width:350px; height:auto;" id=ptAdminProgress></div>';b.cont.innerHTML=d;f("ptAdminTest").addEventListener("click",b.testMess,false);f("ptAdminSend").addEventListener("click",b.checkSendMess,false)},checkSendMess:function(){confirm(h("Vuoi inviare il messaggio a tutti?"))&&t.sendMess()},getVarsMess:function(){var a={family_id:0,page:0,city_id:0,subject:"",message:""};a.family_id=f("ptAdminFam").value;
a.page=f("ptAdminFPage").value;a.city_id=f("ptAdminCity").value;a.subject=f("ptAdminSub").value;a.message=f("ptAdminMess").value;return a},sendMess:function(){var a=j.Admin,b=getVarsMess();q.calls["respect_rank.json"].parms.page=b.page;q.calls["respect_rank.json"].parms.family_id=b.family_id;q.calls["respect_rank.json"].parms.count=10;q.calls["respect_rank.json"].parms.city_id=b.city_id;q.generalCall("respect_rank.json","","",a.firstScan)},firstScan:function(a){var b=j.Admin,a=a.dat;b.totpage=a.total_pages;
b.currpage=a.page;f("ptAdminProgress").innerHTML=b.currpage+"/"+b.totpage;b.whileSend()},whileSend:function(){var a=j.Admin;if(a.currpage>a.totpage)f("ptAdminProgress").innerHTML=a.currpage+"/"+a.totpage+"<BR><BR>FINITO!";else{var b=a.currpage,c=getVarsMess();f("ptAdminProgress").innerHTML=a.currpage+"/"+a.totpage;q.calls["respect_rank.json"].parms.page=b;q.calls["respect_rank.json"].parms.family_id=c.family_id;q.calls["respect_rank.json"].parms.count=10;q.calls["respect_rank.json"].parms.city_id=
c.city_id;q.generalCall("respect_rank.json","","",a.parseRslt)}},parseRslt:function(a){var b=j.Admin,a=a.dat;b.contp=0;b.lead=a.leaderboard;b.totplayer=b.lead.length;b.parsePlayer()},parsePlayer:function(){var a=j.Admin;if(a.contp>=a.totplayer)a.currpage++,a.WhileSend();else{var b=a.lead[a.contp].id;f("ptAdminProgress").innerHTML+="<BR>Invio mess a: ("+b+")";a.ajaxMessage(b)}},ajaxMessage:function(a){var b=j.Admin,c=getVarsMess();q.calls["messages.json"].parms["message[subject]"]=c.subject;q.calls["messages.json"].parms["message[message]"]=
c.message;q.calls["messages.json"].parms.player_id=a;q.calls["messages.json"].parms.city_id=c.city_id;q.generalCall("messages.json","","",b.endAjaxMessage)},endAjaxMessage:function(){var a=j.Admin;a.contp++;a.parsePlayer()},testMess:function(){var a=j.Admin,b=o.player.id,c=getVarsMess();q.calls["messages.json"].parms["message[subject]"]=c.subject;q.calls["messages.json"].parms["message[message]"]=c.message;q.calls["messages.json"].parms.player_id=b;q.calls["messages.json"].parms.city_id=c.city_id;
q.generalCall("messages.json","","",a.resultTest)},resultTest:function(){alert("SEND")},hide:function(){},show:function(){}};var Ta=null,Q={tabList:{},currentTab:null,init:function(a){var b=Q,c=[],d,e;for(e in j){if(!j[e].tabDisabled&&j[e].tabOrder!==null)j[e].tabDisabled=!n.options.tabEnabled[j[e].tabOrder];if(!j[e].tabDisabled)b.tabList[e]={},b.tabList[e].name=e,b.tabList[e].obj=j[e],b.tabList[e].label=j[e].tabLabel!==null?j[e].tabLabel:e,j[e].tabOrder!==null?c.push([j[e].tabOrder,b.tabList[e]]):
c.push([1E3,b.tabList[e]]),b.tabList[e].div=document.createElement("div")}c.sort(function(a,b){return a[0]-b[0]});var g="";S=Xa();g+="<TABLE cellspacing=0 class=pbMainTab><TR>";for(d=0;d<c.length;d++)g+="<TD class=spacer></td><TD class=notSel id="+S+c[d][1].name+" ><A><SPAN>"+h(c[d][1].label)+"</span></a></td>";g+="<TD id=ptdmainVer class=spacer align=center><FONT COLOR=#FFFFFF>v 1.4a</font></td>";g+="</tr></table>";g+="<div id=docSwfPlyr></div>";V.getTopDiv().innerHTML=g;b.currentTab=null;hb("ttTooltip",
"");gb("fuckruler","");for(e in b.tabList){if(b.tabList[e].name==n.options.currentTab)b.currentTab=b.tabList[e];f(S+e).addEventListener("click",this.e_clickedTab,false);d=b.tabList[e].div;d.style.display="none";d.style.height="100%";d.style.maxWidth="auto";d.style.overflowX="auto";a.appendChild(d);try{b.tabList[e].obj.init(d),b.tabList[e].obj.toolTip&&(f(S+e).addEventListener("mouseover",this.showTooltip,false),f(S+e).addEventListener("mouseout",this.hideTooltip,false))}catch(l){d.innerHTML="INIT ERROR: "+
l}}if(b.currentTab===null)b.currentTab=c[0][1];b.setTabStyle(f(S+b.currentTab.name),true);b.currentTab.div.style.display="block"},showTooltip:function(a){Q.showTabTooltip(a,n.options.tips)},hideTooltip:function(a){Q.showTabTooltip(a,false)},showTabTooltip:function(a,b){var c=Q,d=a.target.id.substring(S.length);(c=c.tabList[d])&&c.obj.toolTip&&(b?fb(a,c.obj.toolTip,void 0):ib())},hideTab:function(){Q.currentTab.obj.hide()},showTab:function(){Q.currentTab.obj.show()},setTabStyle:function(a,b){a.className=
b?"sel":"notSel"},e_clickedTab:function(a){var b=Q;(a=b.tabList[a.target.parentNode.parentNode.id.substring(S.length)])&&b.tab_clicked(a)},tab_clicked:function(a){var b=Q;if(b.currentTab.name!=a.name)b.setTabStyle(f(S+a.name),true),b.setTabStyle(f(S+b.currentTab.name),false),b.currentTab.obj.hide(),b.currentTab.div.style.display="none",b.currentTab=a,a.div.style.display="block",n.options.currentTab=a.name;a.obj.show()}},ha={wins:{},get:function(a){return ha.wins[a]},add:function(a,b){ha.wins[a]=b},
winDelete:function(a){delete ha.wins[a]}};Array.prototype.compare=function(a){var b=true,c;if(this.length!=a.length)b=false;else for(c=0;c<a.length;c++){if(this[c].compare&&!this[c].compare(a[c])){b=false;break}if(this[c]!==a[c]){b=false;break}}return b};String.prototype.entityTrans={"&":"&","<":"<",">":">",'"':'"'};String.prototype.htmlEntities=function(){var a=this.toString();for(k in this.entityTrans)a=a.split(k).join(this.entityTrans[k]);return a};String.prototype.stripTags=function(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,
"")};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()};if(String.trim==void 0)String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")};String.prototype.startsWith=function(a){return this.indexOf(a)===0};String.prototype.endsWith=function(a){return this.match(a+"$")==a};String.prototype.visualWidth=function(){var a=f("fuckruler");a.innerHTML=this;return a.clientWidth+1};String.prototype.visualHeight=function(){var a=
f("fuckruler");a.innerHTML=this;return a.clientHeight+1};Object.size=function(a){var b=0,c;for(c in a)b++;return b};Math.randRange=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};typeof XML=="undefined"&&(XML=function(){});XML.ObjTree=function(){return this};XML.ObjTree.VERSION="0.24";XML.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n';XML.ObjTree.prototype.attr_prefix="-";XML.ObjTree.prototype.overrideMimeType="text/xml";XML.ObjTree.prototype.parseXML=function(a){var b=
"",c="";if(window.DOMParser){if(c=new DOMParser,a=c.parseFromString(a,"application/xml"))b=a.documentElement}else if(window.ActiveXObject)c=new ActiveXObject("Microsoft.XMLDOM"),c.async=false,c.loadXML(a),b=c.documentElement;return c=b?this.parseDOM(b):""};XML.ObjTree.prototype.parseHTTP=function(a,b,c){var d={},e;for(e in b)d[e]=b[e];if(!d.method)d.method=typeof d.postBody=="undefined"&&typeof d.postbody=="undefined"&&typeof d.parameters=="undefined"?"get":"post";if(c){d.asynchronous=true;var f=
this,h=d.onComplete;d.onComplete=function(a){var b;a&&a.responseXML&&a.responseXML.documentElement?b=f.parseDOM(a.responseXML.documentElement):a&&a.responseText&&(b=f.parseXML(a.responseText));c(b,a);h&&h(a)}}else d.asynchronous=false;var j,n;if(typeof HTTP!=="undefined"&&HTTP.Request){if(d.uri=a,a=new HTTP.Request(d))j=a.transport}else if(typeof q!=="undefined"&&q.Request&&(a=new q.Request(a,d)))j=a.transport;c?n=j:j&&j.responseXML&&j.responseXML.documentElement?n=this.parseDOM(j.responseXML.documentElement):
j&&j.responseText&&(n=this.parseXML(j.responseText));return n};XML.ObjTree.prototype.parseDOM=function(a){var b;if(a){this.__force_array={};if(this.force_array)for(b=0;b<this.force_array.length;b++)this.__force_array[this.force_array[b]]=1;b=this.parseElement(a);this.__force_array[a.nodeName]&&(b=[b]);if(a.nodeType!==11){var c={};c[a.nodeName]=b;b=c}}else b="";return b};XML.ObjTree.prototype.parseElement=function(a){var b,c,d,e;if(a.nodeType==7)b={};else if(a.nodeType==3||a.nodeType==4)b=a.nodeValue.match(/[^\x00-\x20]/)===
null?{}:a.nodeValue;else{var f={};if(a.attributes&&a.attributes.length){b={};for(c=0;c<a.attributes.length;c++)if(d=a.attributes[c].nodeName,typeof d==="string"&&(e=a.attributes[c].nodeValue))d=this.attr_prefix+d,typeof f[d]=="undefined"&&(f[d]=0),f[d]++,this.addNode(b,d,f[d],e)}if(a.childNodes&&a.childNodes.length){d=true;b&&(d=false);for(c=0;c<a.childNodes.length&&d;c++)e=a.childNodes[c].nodeType,e==3||e==4||(d=false);if(d){b||(b="");for(c=0;c<a.childNodes.length;c++)b+=a.childNodes[c].nodeValue}else{b||
(b={});for(c=0;c<a.childNodes.length;c++)if(d=a.childNodes[c].nodeName,typeof d==="string"&&(e=this.parseElement(a.childNodes[c])))typeof f[d]=="undefined"&&(f[d]=0),f[d]++,this.addNode(b,d,f[d],e)}}}return b};XML.ObjTree.prototype.addNode=function(a,b,c,d){this.__force_array[b]?(c==1&&(a[b]=[]),a[b][a[b].length]=d):c==1?a[b]=d:c==2?a[b]=[a[b],d]:a[b][a[b].length]=d};XML.ObjTree.prototype.writeXML=function(a){return this.xmlDecl+this.hash_to_xml(null,a)};XML.ObjTree.prototype.hash_to_xml=function(a,
b){var c=[],d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=b[e];e.charAt(0)!==this.attr_prefix?c[c.length]=typeof f=="undefined"||f===null?"<"+e+" />":typeof f=="object"&&f.constructor==Array?this.array_to_xml(e,f):typeof f=="object"?this.hash_to_xml(e,f):this.scalar_to_xml(e,f):d[d.length]=" "+e.substring(1)+'="'+this.xml_escape(f)+'"'}var d=d.join(""),h;return h=typeof a=="undefined"||a===null?c.join(""):c.length>0?h.match(/\n/)?"<"+a+d+">\n"+h+"</"+a+">\n":"<"+a+d+">"+h+"</"+a+">\n":"<"+a+d+" />\n"};
XML.ObjTree.prototype.array_to_xml=function(a,b){var c=[],d;for(d=0;d<b.length;d++){var e=b[d];c[c.length]=typeof e=="undefined"||e===null?"<"+a+" />":typeof e=="object"&&e.constructor==Array?this.array_to_xml(a,e):typeof e=="object"?this.hash_to_xml(a,e):this.scalar_to_xml(a,e)}return c.join("")};XML.ObjTree.prototype.scalar_to_xml=function(a,b){return a=="#text"?this.xml_escape(b):"<"+a+">"+this.xml_escape(b)+"</"+a+">\n"};XML.ObjTree.prototype.xml_escape=function(a){return String(a).replace(/&/g,
"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var xa=["GF PUPPACELO KABAM","http://gpt.tiestoale.com","Creato da"," Tiestoale, mikmeg, Ciccio[TeamDoa]"],ya=[xa[0],xa[1],xa[2],xa[3]],za=[ya[0],ya[1],ya[2],ya[3]],Aa=[za[0],za[1],za[2],za[3]],ua=[Aa[0],Aa[1],Aa[2],Aa[3]];(function(){var a=true;window.location.href.indexOf("godfather.wonderhill.com")<
0&&(U("In questa finestra non verr\u00e0 eseguito il GF PUPPACELO KABAM"),a=false);return a})()&&Ga()}}})();