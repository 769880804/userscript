// ==UserScript==
// @name            iWin
// @namespace       iWin
// @description     修正官方網站不想解決的問題
// @include         https://bet.i-win.com.tw/SBP2Web/*
// @include         http://www.i-win.com.tw/*
// @auther          Zac
// @version         0.9.8
// ==/UserScript==

function main(){window.oddsChangeDisplay=function(a,b){var c=document.getElementById("odds_display_"+a+"_"+b),d=parent.document.getElementById("middlearea"),e=document.documentElement;"none"===c.style.display?(setOddsOpen(a,b),d.style.height=e.scrollHeight+80+"px"):(setOddsClose(a,b),d.style.height=440>e.scrollHeight?"460px":e.scrollHeight+20+"px")};window.oddsChangeAll=function(){var a=document.getElementById("btn_displayodds"),b=document.getElementsByName("openCheck_cnf"),c=document.getElementsByName("openCheck_uncnf"),
d,e=0,f,g=document.documentElement,h=parent.document.getElementById("middlearea");if(-1<a.src.indexOf("img/display_allodds.gif")){e=0;for(f=b.length;e<f;e+=1)d=b[e].value,setOddsOpen("cnf",d);e=0;for(f=c.length;e<f;e+=1)d=c[e].value,setOddsOpen("uncnf",d);h.style.height=g.scrollHeight+20+"px";a.src="img/close_allodds.gif"}else{e=0;for(f=b.length;e<f;e+=1)d=b[e].value,setOddsClose("cnf",d);e=0;for(f=c.length;e<f;e+=1)d=c[e].value,setOddsClose("uncnf",d);h.style.height=440>g.scrollHeight?"460px":g.scrollHeight+
20+"px";a.src="img/display_allodds.gif"}};window.showAllUpCalcDlg=function(a,b,c,d){""===d&&(d=document.getElementById("poolCode").value);a="calculate.do?method=allupList&sportsCode="+document.getElementById("sportCode").value+"&poolCode="+d+"&matchNum="+a+"&matchPoolID="+b+"&combination="+c;window.open(a,"newtab","height=390,width=780,left="+(screen.AvailWidth-780)/2+",top="+(screen.AvailHeight-390)/2+",status=yes,toolbar=no,menubar=no,location=no,resizable=no").focus()};window.initFormulas=function(){Ext.Ajax.request({url:"calculate.do?method=ajaxFormulaList",
method:"post",success:function(a){for(var a=Ext.util.JSON.decode(a.responseText),b=document.getElementById("formula"),c=b.options.length=0;c<a.length;c++){var d=new Option(a[c].formulaName,a[c].formulaName);b.add(d,-1)}},failure:function(a){alert("ERROR:"+a.responseText)}})};window.calcOk=function(){var a=document.getElementById("formula").value,b=document.getElementById("singleMoney").value;""===document.getElementById("betNumber").value&&(document.getElementById("betNumber").value=document.getElementById("formula").value.substring(document.getElementById("formula").value.indexOf("x")+
1));var c=document.getElementById("betNumber").value;""===a?alert("\u5fc5\u9808\u9078\u64c7\u904e\u95dc\u6a21\u5f0f!"):""===b||0===parseInt(b)?alert("\u5fc5\u9808\u8f38\u5165\u6bcf\u7d44\u5408\u91d1\u984d,\u4e26\u4e14\u5fc5\u9808\u5927\u65bc0!"):0!=parseInt(b)%10||100>a.substring(a.indexOf("x")+1)*b||1E5<a.substring(a.indexOf("x")+1)*b?(alert("\u6bcf\u7d44\u5408\u91d1\u984d\u9700\u70ba10\u7684\u500d\u6578\uff0c\u4e14\u7e3d\u6295\u6ce8\u91d1\u984d\u5fc5\u9808\u5927\u65bc100\uff0c\u5c0f\u65bc10\u842c"),
tenInteger(document.getElementById("singleMoney"))):Ext.Ajax.request({url:"calculate.do?method=ajaxAllUpCalc",params:{formula:a,singleMoney:b,betNumber:c},method:"post",success:function(d){d=Ext.util.JSON.decode(d.responseText);typeof d=="string"&&d.indexOf("error:")!=-1?alert("ERROR:"+d.substring(d.indexOf(":")+1)):setCalcResValue(d.totalBetNumber,d.singleBetMoney,d.totalBetMoney,d.winBetNumber,d.winBetMoney,d.payoffMoney)},failure:function(d){alert("ERROR:"+d.responseText)}})};window.setCalcResValue=
function(a,b,c,d,e,f){document.getElementById("td_totalBetNumber").innerHTML=a;document.getElementById("td_singleBetMoney").innerHTML="NT$"+convert1000(b);document.getElementById("td_totalBetMoney").innerHTML="NT$"+convert1000(c);document.getElementById("td_winBetNumber").innerHTML=d;document.getElementById("td_winBetMoney").innerHTML="NT$"+convert1000(e);document.getElementById("td_payoffMoney").innerHTML="NT$"+convert1000(f)};window.convert1000=function(a){a=""+a;if(3>=a.length)return a;for(var b=
a.length,c=[],d="",e=1;0<b-3*e;e++)if(c[e-1]=a.substring(a.length-3),a=a.substring(0,a.length-3),3>=a.length){c[e]=a;break}for(e=c.length-1;0<=e;e--)d+=c[e],0!=e&&(d+=",");return d};window.successChecked=function(a,b){Ext.Ajax.request({url:"calculate.do?method=ajaxAllUpSuccessChanged",params:{itemid:a,checked:b},method:"post",success:function(a){Ext.util.JSON.decode(a.responseText)},failure:function(a){alert("ERROR:"+a.responseText)}})};window.changeBetNumber=function(a){document.getElementById("betNumber").value=
a.substring(a.indexOf("x")+1);var b=document.getElementById("singleMoney").value,c=document.getElementById("betNumber").value;""===b?alert("\u5fc5\u9808\u8f38\u5165\u6bcf\u7d44\u5408\u91d1\u984d,\u4e26\u4e14\u5fc5\u9808\u5927\u65bc0!"):0!==parseInt(b)%10||100>a.substring(a.indexOf("x")+1)*b||1E5<a.substring(a.indexOf("x")+1)*b?(alert("\u6bcf\u7d44\u5408\u91d1\u984d\u9700\u70ba10\u7684\u500d\u6578\uff0c\u4e14\u7e3d\u6295\u6ce8\u91d1\u984d\u5fc5\u9808\u5927\u65bc100\uff0c\u5c0f\u65bc10\u842c"),tenInteger(document.getElementById("singleMoney"))):
Ext.Ajax.request({url:"calculate.do?method=ajaxAllUpCalc",params:{formula:a,singleMoney:b,betNumber:c},method:"post",success:function(a){a=Ext.util.JSON.decode(a.responseText);"string"===typeof a&&-1!==a.indexOf("error:")?alert("ERROR:"+a.substring(a.indexOf(":")+1)):setCalcResValue(a.totalBetNumber,a.singleBetMoney,a.totalBetMoney,a.winBetNumber,a.winBetMoney,a.payoffMoney)},failure:function(a){alert("ERROR:"+a.responseText)}})};window.deleteItem=function(a,b){console.log(a);var c={url:"calculate.do?method=ajaxDeleteItem",
params:{itemid:b},method:"post",success:function(d){Ext.util.JSON.decode(d.responseText)&&(document.getElementById("betingTable").children[0].removeChild(a),initFormulas())},failure:function(a){alert("ERROR:"+a.responseText)}};window.confirm("\u60a8\u78ba\u8a8d\u8981\u522a\u9664\u6b64\u6295\u6ce8\u9805\u55ce?")&&Ext.Ajax.request(c)};window.bodyLoad=function(){var a=location.search,b=/sportsId=\d{1}/gi,c=b.exec(a)[0],b=/\d{1}/,c=b.exec(c)[0];console.log(b.exec(a)[0]);console.log(c);document.getElementById("middlearea").src=
"/SBP2Web/matchquery.do?method=matchResult&sportsId="+c;window.focus()};window.changeMiddlePage=function(a){""!==a?window.location=a:document.getElementById("middlearea").src=""};window.changeSportsPage=function(a,b){3===a?window.location="http://sd.i-win.com.tw/":""!==b?window.location=b:document.getElementById("middlearea").src=""};window.changeLink=function(a){var b=document.getElementById("bsLink"),c=document.getElementById("bkLink"),d=document.getElementById("fbLink");if(null!==b){var e=b.href.indexOf("menu=");
b.href=b.href.substring(0,e+5)+a}null!==c&&(b=c.href.indexOf("menu="),c.href=c.href.substring(0,b+5)+a);null!==d&&(c=d.href.indexOf("menu="),d.href=d.href.substring(0,c+5)+a)}}
(function(){var a=document.createElement("script");a.appendChild(document.createTextNode("("+main+")();"));(document.body||document.head||document.documentElement).appendChild(a);var b=document.getElementById("middlearea");b.onload=function(){var a,c=0,f,g,h;a=b.contentDocument.documentElement.scrollHeight;b.style.height=480<a?a+100+"px":"480px";a=b.contentDocument.getElementsByName("betCheck_CRS_img");for(c=0;c<a.length;c+=1)f=a[c].getAttribute("onclick"),g=/betCheck_CRS_\d+/,h='"'+f.match(g)[0]+
'"',f=f.replace(g,h),a[c].setAttribute("onclick",f)};var c=document.getElementById("hotmatchid");c.onload=function(){var a=c.contentDocument.documentElement.scrollHeight;c.style.height=365<a?a+50+"px":"365px"}})();
function setOddsOpen(a,b){var c=document.getElementById("oddsBtn_"+a+"_"+b),d=document.getElementById("odds_display_"+a+"_"+b),e=document.getElementById("openCheck_"+a+"_"+b);null!==c&&null!==d&&(d.style.display="",c.src="img/icon_hide.gif",c.alt="\u9ede\u6b64\u6536\u8d77",e.checked=!0)}
function setOddsClose(a,b){var c=document.getElementById("oddsBtn_"+a+"_"+b),d=document.getElementById("odds_display_"+a+"_"+b),e=document.getElementById("openCheck_"+a+"_"+b);null!==c&&null!==d&&(d.style.display="none",c.src="img/icon_display.gif",c.alt="\u8a73\u7d30\u8ce0\u7387",e.checked=!1)};