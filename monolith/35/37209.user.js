/*
  (c) Arphen Lin, arphenlin@gmail.com
	
  Usage: (1) Add a mark on the page with [Ctrl + MouseClick]
         (2) Go to a mark with a key press: 0, 1, ...	9, a, b, ... z
         (3) Next mark key: +, ]
         (4) Prev mark key: -, [
*/

// ==UserScript==
// @name          Page Mark
// @description   Add marks on the page
// @version       2009-01-30
// @namespace
// @include       *
// @exclude       
// ==/UserScript==


/*
 * jQuery JavaScript Library v1.3
 */
(function(){var t=this,p,bg=t.jQuery,bh=t.$,d=t.jQuery=t.$=function(a,c){return new d.fn.init(a,c)},bi=/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,bj=/^.[^:#\[\.,]*$/;d.fn=d.prototype={init:function(a,c){a=a||document;if(a.nodeType){this[0]=a;this.length=1;this.context=a;return this}if(typeof a==="string"){var b=bi.exec(a);if(b&&(b[1]||!c)){if(b[1])a=d.clean([b[1]],c);else{var f=document.getElementById(b[3]);if(f){if(f.id!=b[3])return d().find(a);var g=d(f);g.context=document;g.selector=a;return g}a=[]}}else return d(c).find(a)}else if(d.isFunction(a))return d(document).ready(a);if(a.selector&&a.context){this.selector=a.selector;this.context=a.context}return this.setArray(d.makeArray(a))},selector:"",jquery:"1.3",size:function(){return this.length},get:function(a){return a===p?d.makeArray(this):this[a]},pushStack:function(a,c,b){var f=d(a);f.prevObject=this;f.context=this.context;if(c==="find")f.selector=this.selector+(this.selector?" ":"")+b;else if(c)f.selector=this.selector+"."+c+"("+b+")";return f},setArray:function(a){this.length=0;Array.prototype.push.apply(this,a);return this},each:function(a,c){return d.each(this,a,c)},index:function(a){return d.inArray(a&&a.jquery?a[0]:a,this)},attr:function(c,b,f){var g=c;if(typeof c==="string")if(b===p)return this[0]&&d[f||"attr"](this[0],c);else{g={};g[c]=b}return this.each(function(a){for(c in g)d.attr(f?this.style:this,c,d.prop(this,g[c],f,a,c))})},css:function(a,c){if((a=='width'||a=='height')&&parseFloat(c)<0)c=p;return this.attr(a,c,"curCSS")},text:function(a){if(typeof a!=="object"&&a!=null)return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(a));var c="";d.each(a||this,function(){d.each(this.childNodes,function(){if(this.nodeType!=8)c+=this.nodeType!=1?this.nodeValue:d.fn.text([this])})});return c},wrapAll:function(c){if(this[0]){var b=d(c,this[0].ownerDocument).clone();if(this[0].parentNode)b.insertBefore(this[0]);b.map(function(){var a=this;while(a.firstChild)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(function(){d(this).contents().wrapAll(a)})},wrap:function(a){return this.each(function(){d(this).wrapAll(a)})},append:function(){return this.domManip(arguments,true,function(a){if(this.nodeType==1)this.appendChild(a)})},prepend:function(){return this.domManip(arguments,true,function(a){if(this.nodeType==1)this.insertBefore(a,this.firstChild)})},before:function(){return this.domManip(arguments,false,function(a){this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,false,function(a){this.parentNode.insertBefore(a,this.nextSibling)})},end:function(){return this.prevObject||d([])},push:[].push,find:function(c){if(this.length===1&&!/,/.test(c)){var b=this.pushStack([],"find",c);b.length=0;d.find(c,this[0],b);return b}else{var f=d.map(this,function(a){return d.find(c,a)});return this.pushStack(/[^+>] [^+>]/.test(c)?d.unique(f):f,"find",c)}},clone:function(b){var f=this.map(function(){if(!d.support.noCloneEvent&&!d.isXMLDoc(this)){var a=this.cloneNode(true),c=document.createElement("div");c.appendChild(a);return d.clean([c.innerHTML])[0]}else return this.cloneNode(true)});var g=f.find("*").andSelf().each(function(){if(this[A]!==p)this[A]=null});if(b===true)this.find("*").andSelf().each(function(i){if(this.nodeType==3)return;var b=d.data(this,"events");for(var h in b)for(var handler in b[h])d.event.add(g[i],h,b[h][handler],b[h][handler].data)});return f},filter:function(b){return this.pushStack(d.isFunction(b)&&d.grep(this,function(a,c){return b.call(a,c)})||d.multiFilter(b,d.grep(this,function(a){return a.nodeType===1})),"filter",b)},closest:function(c){var b=d.expr.match.POS.test(c)?d(c):null;return this.map(function(){var a=this;while(a&&a.ownerDocument){if(b?b.index(a)>-1:d(a).is(c))return a;a=a.parentNode}})},not:function(a){if(typeof a==="string")if(bj.test(a))return this.pushStack(d.multiFilter(a,this,true),"not",a);else a=d.multiFilter(a,this);var c=a.length&&a[a.length-1]!==p&&!a.nodeType;return this.filter(function(){return c?d.inArray(this,a)<0:this!=a})},add:function(a){return this.pushStack(d.unique(d.merge(this.get(),typeof a==="string"?d(a):d.makeArray(a))))},is:function(a){return!!a&&d.multiFilter(a,this).length>0},hasClass:function(a){return!!a&&this.is("."+a)},val:function(c){if(c===p){var b=this[0];if(b){if(d.nodeName(b,'option'))return(b.attributes.value||{}).specified?b.value:b.text;if(d.nodeName(b,"select")){var f=b.selectedIndex,g=[],h=b.options,j=b.type=="select-one";if(f<0)return null;for(var k=j?f:0,l=j?f+1:h.length;k<l;k++){var m=h[k];if(m.selected){c=d(m).val();if(j)return c;g.push(c)}}return g}return(b.value||"").replace(/\r/g,"")}return p}if(typeof c==="number")c+='';return this.each(function(){if(this.nodeType!=1)return;if(d.isArray(c)&&/radio|checkbox/.test(this.type))this.checked=(d.inArray(this.value,c)>=0||d.inArray(this.name,c)>=0);else if(d.nodeName(this,"select")){var a=d.makeArray(c);d("option",this).each(function(){this.selected=(d.inArray(this.value,a)>=0||d.inArray(this.text,a)>=0)});if(!a.length)this.selectedIndex=-1}else this.value=c})},html:function(a){return a===p?(this[0]?this[0].innerHTML:null):this.empty().append(a)},replaceWith:function(a){return this.after(a).remove()},eq:function(a){return this.slice(a,+a+1)},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments),"slice",Array.prototype.slice.call(arguments).join(","))},map:function(b){return this.pushStack(d.map(this,function(a,c){return b.call(a,c,a)}))},andSelf:function(){return this.add(this.prevObject)},domManip:function(b,f,g){if(this[0]){var h=(this[0].ownerDocument||this[0]).createDocumentFragment(),j=d.clean(b,(this[0].ownerDocument||this[0]),h),k=h.firstChild,l=this.length>1?h.cloneNode(true):h;if(k)for(var m=0,o=this.length;m<o;m++)g.call(u(this[m],k),m>0?l.cloneNode(true):h);if(j)d.each(j,bk)}return this;function u(a,c){return f&&d.nodeName(a,"table")&&d.nodeName(c,"tr")?(a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody"))):a}}};d.fn.init.prototype=d.fn;function bk(a,c){if(c.src)d.ajax({url:c.src,async:false,dataType:"script"});else d.globalEval(c.text||c.textContent||c.innerHTML||"");if(c.parentNode)c.parentNode.removeChild(c)}function E(){return+new Date}d.extend=d.fn.extend=function(){var a=arguments[0]||{},c=1,b=arguments.length,f=false,g;if(typeof a==="boolean"){f=a;a=arguments[1]||{};c=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(b==c){a=this;--c}for(;c<b;c++)if((g=arguments[c])!=null)for(var h in g){var j=a[h],k=g[h];if(a===k)continue;if(f&&k&&typeof k==="object"&&!k.nodeType)a[h]=d.extend(f,j||(k.length!=null?[]:{}),k);else if(k!==p)a[h]=k}return a};var bl=/z-?index|font-?weight|opacity|zoom|line-?height/i,Q=document.defaultView||{},R=Object.prototype.toString;d.extend({noConflict:function(a){t.$=bh;if(a)t.jQuery=bg;return d},isFunction:function(a){return R.call(a)==="[object Function]"},isArray:function(a){return R.call(a)==="[object Array]"},isXMLDoc:function(a){return a.documentElement&&!a.body||a.tagName&&a.ownerDocument&&!a.ownerDocument.body},globalEval:function(a){a=d.trim(a);if(a){var c=document.getElementsByTagName("head")[0]||document.documentElement,b=document.createElement("script");b.type="text/javascript";if(d.support.scriptEval)b.appendChild(document.createTextNode(a));else b.text=a;c.insertBefore(b,c.firstChild);c.removeChild(b)}},nodeName:function(a,c){return a.nodeName&&a.nodeName.toUpperCase()==c.toUpperCase()},each:function(a,c,b){var f,g=0,h=a.length;if(b){if(h===p){for(f in a)if(c.apply(a[f],b)===false)break}else for(;g<h;)if(c.apply(a[g++],b)===false)break}else{if(h===p){for(f in a)if(c.call(a[f],f,a[f])===false)break}else for(var j=a[0];g<h&&c.call(j,g,j)!==false;j=a[++g]){}}return a},prop:function(a,c,b,f,g){if(d.isFunction(c))c=c.call(a,f);return typeof c==="number"&&b=="curCSS"&&!bl.test(g)?c+"px":c},className:{add:function(b,f){d.each((f||"").split(/\s+/),function(a,c){if(b.nodeType==1&&!d.className.has(b.className,c))b.className+=(b.className?" ":"")+c})},remove:function(a,c){if(a.nodeType==1)a.className=c!==p?d.grep(a.className.split(/\s+/),function(className){return!d.className.has(c,className)}).join(" "):""},has:function(a,c){return d.inArray(c,(a.className||a).toString().split(/\s+/))>-1}},swap:function(a,c,b){var f={};for(var g in c){f[g]=a.style[g];a.style[g]=c[g]}b.call(a);for(var g in c)a.style[g]=f[g]},css:function(b,f,g){if(f=="width"||f=="height"){var h,j={position:"absolute",visibility:"hidden",display:"block"},k=f=="width"?["Left","Right"]:["Top","Bottom"];function l(){h=f=="width"?b.offsetWidth:b.offsetHeight;var a=0,c=0;d.each(k,function(){a+=parseFloat(d.curCSS(b,"padding"+this,true))||0;c+=parseFloat(d.curCSS(b,"border"+this+"Width",true))||0});h-=Math.round(a+c)}if(d(b).is(":visible"))l();else d.swap(b,j,l);return Math.max(0,h)}return d.curCSS(b,f,g)},curCSS:function(b,f,g){var h,j=b.style;if(f=="opacity"&&!d.support.opacity){h=d.attr(j,"opacity");return h==""?"1":h}if(f.match(/float/i))f=I;if(!g&&j&&j[f])h=j[f];else if(Q.getComputedStyle){if(f.match(/float/i))f="float";f=f.replace(/([A-Z])/g,"-$1").toLowerCase();var k=Q.getComputedStyle(b,null);if(k)h=k.getPropertyValue(f);if(f=="opacity"&&h=="")h="1"}else if(b.currentStyle){var l=f.replace(/\-(\w)/g,function(a,c){return c.toUpperCase()});h=b.currentStyle[f]||b.currentStyle[l];if(!/^\d+(px)?$/i.test(h)&&/^\d/.test(h)){var m=j.left,o=b.runtimeStyle.left;b.runtimeStyle.left=b.currentStyle.left;j.left=h||0;h=j.pixelLeft+"px";j.left=m;b.runtimeStyle.left=o}}return h},clean:function(m,o,u){o=o||document;if(typeof o.createElement==="undefined")o=o.ownerDocument||o[0]&&o[0].ownerDocument||document;if(!u&&m.length===1&&typeof m[0]==="string"){var w=/^<(\w+)\s*\/?>$/.exec(m[0]);if(w)return[o.createElement(w[1])]}var s=[],x=[],n=o.createElement("div");d.each(m,function(f,g){if(typeof g==="number")g+='';if(!g)return;if(typeof g==="string"){g=g.replace(/(<(\w+)[^>]*?)\/>/g,function(a,c,b){return b.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?a:c+"></"+b+">"});var h=d.trim(g).toLowerCase();var j=!h.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!h.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||h.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!h.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!h.indexOf("<td")||!h.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!h.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||!d.support.htmlSerialize&&[1,"div<div>","</div>"]||[0,"",""];n.innerHTML=j[1]+g+j[2];while(j[0]--)n=n.lastChild;if(!d.support.tbody){var k=!h.indexOf("<table")&&h.indexOf("<tbody")<0?n.firstChild&&n.firstChild.childNodes:j[1]=="<table>"&&h.indexOf("<tbody")<0?n.childNodes:[];for(var l=k.length-1;l>=0;--l)if(d.nodeName(k[l],"tbody")&&!k[l].childNodes.length)k[l].parentNode.removeChild(k[l])}if(!d.support.leadingWhitespace&&/^\s/.test(g))n.insertBefore(o.createTextNode(g.match(/^\s*/)[0]),n.firstChild);g=d.makeArray(n.childNodes)}if(g.nodeType)s.push(g);else s=d.merge(s,g)});if(u){for(var v=0;s[v];v++){if(d.nodeName(s[v],"script")&&(!s[v].type||s[v].type.toLowerCase()==="text/javascript")){x.push(s[v].parentNode?s[v].parentNode.removeChild(s[v]):s[v])}else{if(s[v].nodeType===1)s.splice.apply(s,[v+1,0].concat(d.makeArray(s[v].getElementsByTagName("script"))));u.appendChild(s[v])}}return x}return s},attr:function(b,f,g){if(!b||b.nodeType==3||b.nodeType==8)return p;var h=!d.isXMLDoc(b),j=g!==p;f=h&&d.props[f]||f;if(b.tagName){var k=/href|src|style/.test(f);if(f=="selected"&&b.parentNode)b.parentNode.selectedIndex;if(f in b&&h&&!k){if(j){if(f=="type"&&d.nodeName(b,"input")&&b.parentNode)throw"type property can't be changed";b[f]=g}if(d.nodeName(b,"form")&&b.getAttributeNode(f))return b.getAttributeNode(f).nodeValue;if(f=="tabIndex"){var l=b.getAttributeNode("tabIndex");return l&&l.specified?l.value:b.nodeName.match(/^(a|area|button|input|object|select|textarea)$/i)?0:p}return b[f]}if(!d.support.style&&h&&f=="style")return d.attr(b.style,"cssText",g);if(j)b.setAttribute(f,""+g);var m=!d.support.hrefNormalized&&h&&k?b.getAttribute(f,2):b.getAttribute(f);return m===null?p:m}if(!d.support.opacity&&f=="opacity"){if(j){b.zoom=1;b.filter=(b.filter||"").replace(/alpha\([^)]*\)/,"")+(parseInt(g)+''=="NaN"?"":"alpha(opacity="+g*100+")")}return b.filter&&b.filter.indexOf("opacity=")>=0?(parseFloat(b.filter.match(/opacity=([^)]*)/)[1])/100)+'':""}f=f.replace(/-([a-z])/ig,function(a,c){return c.toUpperCase()});if(j)b[f]=g;return b[f]},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,"")},makeArray:function(a){var c=[];if(a!=null){var b=a.length;if(b==null||typeof a==="string"||d.isFunction(a)||a.setInterval)c[0]=a;else while(b)c[--b]=a[b]}return c},inArray:function(a,c){for(var b=0,f=c.length;b<f;b++)if(c[b]===a)return b;return-1},merge:function(a,c){var b=0,f,g=a.length;if(!d.support.getAll){while((f=c[b++])!=null)if(f.nodeType!=8)a[g++]=f}else while((f=c[b++])!=null)a[g++]=f;return a},unique:function(a){var c=[],b={};try{for(var f=0,g=a.length;f<g;f++){var h=d.data(a[f]);if(!b[h]){b[h]=true;c.push(a[f])}}}catch(e){c=a}return c},grep:function(a,c,b){var f=[];for(var g=0,h=a.length;g<h;g++)if(!b!=!c(a[g],g))f.push(a[g]);return f},map:function(a,c){var b=[];for(var f=0,g=a.length;f<g;f++){var h=c(a[f],f);if(h!=null)b[b.length]=h}return b.concat.apply([],b)}});var D=navigator.userAgent.toLowerCase();d.browser={version:(D.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,'0'])[1],safari:/webkit/.test(D),opera:/opera/.test(D),msie:/msie/.test(D)&&!/opera/.test(D),mozilla:/mozilla/.test(D)&&!/(compatible|webkit)/.test(D)};d.each({parent:function(a){return a.parentNode},parents:function(a){return d.dir(a,"parentNode")},next:function(a){return d.nth(a,2,"nextSibling")},prev:function(a){return d.nth(a,2,"previousSibling")},nextAll:function(a){return d.dir(a,"nextSibling")},prevAll:function(a){return d.dir(a,"previousSibling")},siblings:function(a){return d.sibling(a.parentNode.firstChild,a)},children:function(a){return d.sibling(a.firstChild)},contents:function(a){return d.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:d.makeArray(a.childNodes)}},function(b,f){d.fn[b]=function(a){var c=d.map(this,f);if(a&&typeof a=="string")c=d.multiFilter(a,c);return this.pushStack(d.unique(c),b,a)}});d.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,g){d.fn[f]=function(){var b=arguments;return this.each(function(){for(var a=0,c=b.length;a<c;a++)d(b[a])[g](this)})}});d.each({removeAttr:function(a){d.attr(this,a,"");if(this.nodeType==1)this.removeAttribute(a)},addClass:function(a){d.className.add(this,a)},removeClass:function(a){d.className.remove(this,a)},toggleClass:function(a,c){if(typeof c!=="boolean")c=!d.className.has(this,a);d.className[c?"add":"remove"](this,a)},remove:function(a){if(!a||d.filter(a,[this]).length){d("*",this).add([this]).each(function(){d.event.remove(this);d.removeData(this)});if(this.parentNode)this.parentNode.removeChild(this)}},empty:function(){d(">*",this).remove();while(this.firstChild)this.removeChild(this.firstChild)}},function(a,c){d.fn[a]=function(){return this.each(c,arguments)}});function B(a,c){return a[0]&&parseInt(d.curCSS(a[0],c,true),10)||0}var A="jQuery"+E(),bm=0,S={};d.extend({cache:{},data:function(a,c,b){a=a==t?S:a;var f=a[A];if(!f)f=a[A]=++bm;if(c&&!d.cache[f])d.cache[f]={};if(b!==p)d.cache[f][c]=b;return c?d.cache[f][c]:f},removeData:function(a,c){a=a==t?S:a;var b=a[A];if(c){if(d.cache[b]){delete d.cache[b][c];c="";for(c in d.cache[b])break;if(!c)d.removeData(a)}}else{try{delete a[A]}catch(e){if(a.removeAttribute)a.removeAttribute(A)}delete d.cache[b]}},queue:function(a,c,b){if(a){c=(c||"fx")+"queue";var f=d.data(a,c);if(!f||d.isArray(b))f=d.data(a,c,d.makeArray(b));else if(b)f.push(b)}return f},dequeue:function(a,c){var b=d.queue(a,c),f=b.shift();if(!c||c==="fx")f=b[0];if(f!==p)f.call(a)}});d.fn.extend({data:function(a,c){var b=a.split(".");b[1]=b[1]?"."+b[1]:"";if(c===p){var f=this.triggerHandler("getData"+b[1]+"!",[b[0]]);if(f===p&&this.length)f=d.data(this[0],a);return f===p&&b[1]?this.data(b[0]):f}else return this.trigger("setData"+b[1]+"!",[b[0],c]).each(function(){d.data(this,a,c)})},removeData:function(a){return this.each(function(){d.removeData(this,a)})},queue:function(c,b){if(typeof c!=="string"){b=c;c="fx"}if(b===p)return d.queue(this[0],c);return this.each(function(){var a=d.queue(this,c,b);if(c=="fx"&&a.length==1)a[0].call(this)})},dequeue:function(a){return this.each(function(){d.dequeue(this,a)})}});(function(){var L=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|[^[\]]+)+\]|\\.|[^ >+~,(\[]+)+|[>+~])(\s*,\s*)?/g,M=0,T=Object.prototype.toString;var r=function(a,c,b,f){b=b||[];c=c||document;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!a||typeof a!=="string"){return b}var g=[],h,j,k,l,m,o,u=true;L.lastIndex=0;while((h=L.exec(a))!==null){g.push(h[1]);if(h[2]){o=RegExp.rightContext;break}}if(g.length>1&&q.match.POS.exec(a)){if(g.length===2&&q.relative[g[0]]){var w="",s;while((s=q.match.POS.exec(a))){w+=s[0];a=a.replace(q.match.POS,"")}j=r.filter(w,r(/\s$/.test(a)?a+"*":a,c))}else{j=q.relative[g[0]]?[c]:r(g.shift(),c);while(g.length){var x=[];a=g.shift();if(q.relative[a])a+=g.shift();for(var n=0,v=j.length;n<v;n++){r(a,j[n],x)}j=x}}}else{var y=f?{expr:g.pop(),set:G(f)}:r.find(g.pop(),g.length===1&&c.parentNode?c.parentNode:c);j=r.filter(y.expr,y.set);if(g.length>0){k=G(j)}else{u=false}while(g.length){var z=g.pop(),C=z;if(!q.relative[z]){z=""}else{C=g.pop()}if(C==null){C=c}q.relative[z](k,C,U(c))}}if(!k){k=j}if(!k){throw"Syntax error, unrecognized expression: "+(z||a);}if(T.call(k)==="[object Array]"){if(!u){b.push.apply(b,k)}else if(c.nodeType===1){for(var n=0;k[n]!=null;n++){if(k[n]&&(k[n]===true||k[n].nodeType===1&&bn(c,k[n]))){b.push(j[n])}}}else{for(var n=0;k[n]!=null;n++){if(k[n]&&k[n].nodeType===1){b.push(j[n])}}}}else{G(k,b)}if(o){r(o,c,b,f)}return b};r.matches=function(a,c){return r(a,null,null,c)};r.find=function(a,c){var b,f;if(!a){return[]}for(var g=0,h=q.order.length;g<h;g++){var j=q.order[g],f;if((f=q.match[j].exec(a))){var k=RegExp.leftContext;if(k.substr(k.length-1)!=="\\"){f[1]=(f[1]||"").replace(/\\/g,"");b=q.find[j](f,c);if(b!=null){a=a.replace(q.match[j],"");break}}}}if(!b){b=c.getElementsByTagName("*")}return{set:b,expr:a}};r.filter=function(a,c,b,f){var g=a,h=[],j=c,k,l;while(a&&c.length){for(var m in q.filter){if((k=q.match[m].exec(a))!=null){var o=q.filter[m],u=null,w=0,s,x;l=false;if(j==h){h=[]}if(q.preFilter[m]){k=q.preFilter[m](k,j,b,h,f);if(!k){l=s=true}else if(k===true){continue}else if(k[0]===true){u=[];var n=null,v;for(var y=0;(v=j[y])!==p;y++){if(v&&n!==v){u.push(v);n=v}}}}if(k){for(var y=0;(x=j[y])!==p;y++){if(x){if(u&&x!=u[w]){w++}s=o(x,k,w,u);var z=f^!!s;if(b&&s!=null){if(z){l=true}else{j[y]=false}}else if(z){h.push(x);l=true}}}}if(s!==p){if(!b){j=h}a=a.replace(q.match[m],"");if(!l){return[]}break}}}a=a.replace(/\s*,\s*/,"");if(a==g){if(l==null){throw"Syntax error, unrecognized expression: "+a;}else{break}}g=a}return j};var q=r.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,c){for(var b=0,f=a.length;b<f;b++){var g=a[b];if(g){var h=g.previousSibling;while(h&&h.nodeType!==1){h=h.previousSibling}a[b]=typeof c==="string"?h||false:h===c}}if(typeof c==="string"){r.filter(c,a,true)}},">":function(a,c,b){if(typeof c==="string"&&!/\W/.test(c)){c=b?c:c.toUpperCase();for(var f=0,g=a.length;f<g;f++){var h=a[f];if(h){var j=h.parentNode;a[f]=j.nodeName===c?j:false}}}else{for(var f=0,g=a.length;f<g;f++){var h=a[f];if(h){a[f]=typeof c==="string"?h.parentNode:h.parentNode===c}}if(typeof c==="string"){r.filter(c,a,true)}}},"":function(a,c,b){var f="done"+(M++),g=V;if(!c.match(/\W/)){var h=c=b?c:c.toUpperCase();g=W}g("parentNode",c,f,a,h,b)},"~":function(a,c,b){var f="done"+(M++),g=V;if(typeof c==="string"&&!c.match(/\W/)){var h=c=b?c:c.toUpperCase();g=W}g("previousSibling",c,f,a,h,b)}},find:{ID:function(a,c){if(c.getElementById){var b=c.getElementById(a[1]);return b?[b]:[]}},NAME:function(a,c){return c.getElementsByName?c.getElementsByName(a[1]):null},TAG:function(a,c){return c.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,c,b,f,g){a=" "+a[1].replace(/\\/g,"")+" ";for(var h=0;c[h];h++){if(g^(" "+c[h].className+" ").indexOf(a)>=0){if(!b)f.push(c[h])}else if(b){c[h]=false}}return false},ID:function(a){return a[1].replace(/\\/g,"")},TAG:function(a,c){for(var b=0;!c[b];b++){}return U(c[b])?a[1]:a[1].toUpperCase()},CHILD:function(a){if(a[1]=="nth"){var c=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(a[2]=="even"&&"2n"||a[2]=="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=(c[1]+(c[2]||1))-0;a[3]=c[3]-0}a[0]="done"+(M++);return a},ATTR:function(a){var c=a[1];if(q.attrMap[c]){a[1]=q.attrMap[c]}if(a[2]==="~="){a[4]=" "+a[4]+" "}return a},PSEUDO:function(a,c,b,f,g){if(a[1]==="not"){if(a[3].match(L).length>1){a[3]=r(a[3],null,null,c)}else{var h=r.filter(a[3],c,b,true^g);if(!b){f.push.apply(f,h)}return false}}else if(q.match.POS.test(a[0])){return true}return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===true},checked:function(a){return a.checked===true},selected:function(a){a.parentNode.selectedIndex;return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,c,b){return!!r(b[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toUpperCase()==="BUTTON"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,c){return c===0},last:function(a,c,b,f){return c===f.length-1},even:function(a,c){return c%2===0},odd:function(a,c){return c%2===1},lt:function(a,c,b){return c<b[3]-0},gt:function(a,c,b){return c>b[3]-0},nth:function(a,c,b){return b[3]-0==c},eq:function(a,c,b){return b[3]-0==c}},filter:{CHILD:function(a,c){var b=c[1],f=a.parentNode;var g="child"+f.childNodes.length;if(f&&(!f[g]||!a.nodeIndex)){var h=1;for(var j=f.firstChild;j;j=j.nextSibling){if(j.nodeType==1){j.nodeIndex=h++}}f[g]=h-1}if(b=="first"){return a.nodeIndex==1}else if(b=="last"){return a.nodeIndex==f[g]}else if(b=="only"){return f[g]==1}else if(b=="nth"){var k=false,l=c[2],m=c[3];if(l==1&&m==0){return true}if(l==0){if(a.nodeIndex==m){k=true}}else if((a.nodeIndex-m)%l==0&&(a.nodeIndex-m)/l>=0){k=true}return k}},PSEUDO:function(a,c,b,f){var g=c[1],h=q.filters[g];if(h){return h(a,b,c,f)}else if(g==="contains"){return(a.textContent||a.innerText||"").indexOf(c[3])>=0}else if(g==="not"){var j=c[3];for(var b=0,k=j.length;b<k;b++){if(j[b]===a){return false}}return true}},ID:function(a,c){return a.nodeType===1&&a.getAttribute("id")===c},TAG:function(a,c){return(c==="*"&&a.nodeType===1)||a.nodeName===c},CLASS:function(a,c){return c.test(a.className)},ATTR:function(a,c){var b=q.attrHandle[c[1]]?q.attrHandle[c[1]](a):a[c[1]]||a.getAttribute(c[1]),f=b+"",g=c[2],h=c[4];return b==null?false:g==="="?f===h:g==="*="?f.indexOf(h)>=0:g==="~="?(" "+f+" ").indexOf(h)>=0:!c[4]?b:g==="!="?f!=h:g==="^="?f.indexOf(h)===0:g==="$="?f.substr(f.length-h.length)===h:g==="|="?f===h||f.substr(0,h.length+1)===h+"-":false},POS:function(a,c,b,f){var g=c[2],h=q.setFilters[g];if(h){return h(a,b,c,f)}}}};for(var X in q.match){q.match[X]=RegExp(q.match[X].source+/(?![^\[]*\])(?![^\(]*\))/.source)}var G=function(a,c){a=Array.prototype.slice.call(a);if(c){c.push.apply(c,a);return c}return a};try{Array.prototype.slice.call(document.documentElement.childNodes)}catch(e){G=function(a,c){var b=c||[];if(T.call(a)==="[object Array]"){Array.prototype.push.apply(b,a)}else{if(typeof a.length==="number"){for(var f=0,g=a.length;f<g;f++){b.push(a[f])}}else{for(var f=0;a[f];f++){b.push(a[f])}}}return b}}(function(){var f=document.createElement("form"),g="script"+(new Date).getTime();f.innerHTML="<input name='"+g+"'/>";var h=document.documentElement;h.insertBefore(f,h.firstChild);if(!!document.getElementById(g)){q.find.ID=function(a,c){if(c.getElementById){var b=c.getElementById(a[1]);return b?b.id===a[1]||b.getAttributeNode&&b.getAttributeNode("id").nodeValue===a[1]?[b]:p:[]}};q.filter.ID=function(a,c){var b=a.getAttributeNode&&a.getAttributeNode("id");return a.nodeType===1&&b&&b.nodeValue===c}}h.removeChild(f)})();(function(){var h=document.createElement("div");h.appendChild(document.createComment(""));if(h.getElementsByTagName("*").length>0){q.find.TAG=function(a,c){var b=c.getElementsByTagName(a[1]);if(a[1]==="*"){var f=[];for(var g=0;b[g];g++){if(b[g].nodeType===1){f.push(b[g])}}b=f}return b}}h.innerHTML="<a href='#'></a>";if(h.firstChild.getAttribute("href")!=="#"){q.attrHandle.href=function(a){return a.getAttribute("href",2)}}})();if(document.querySelectorAll)(function(){var H=r;r=function(a,c,b,f){c=c||document;if(!f&&c.nodeType===9){try{return G(c.querySelectorAll(a),b)}catch(e){}}return H(a,c,b,f)};r.find=H.find;r.filter=H.filter;r.selectors=H.selectors;r.matches=H.matches})();if(document.documentElement.getElementsByClassName){q.order.splice(1,0,"CLASS");q.find.CLASS=function(a,c){return c.getElementsByClassName(a[1])}}function W(a,c,b,f,g,h){for(var j=0,k=f.length;j<k;j++){var l=f[j];if(l){l=l[a];var m=false;while(l&&l.nodeType){var o=l[b];if(o){m=f[o];break}if(l.nodeType===1&&!h)l[b]=j;if(l.nodeName===c){m=l;break}l=l[a]}f[j]=m}}}function V(a,c,b,f,g,h){for(var j=0,k=f.length;j<k;j++){var l=f[j];if(l){l=l[a];var m=false;while(l&&l.nodeType){if(l[b]){m=f[l[b]];break}if(l.nodeType===1){if(!h)l[b]=j;if(typeof c!=="string"){if(l===c){m=true;break}}else if(r.filter(c,[l]).length>0){m=l;break}}l=l[a]}f[j]=m}}}var bn=document.compareDocumentPosition?function(a,c){return a.compareDocumentPosition(c)&16}:function(a,c){return a!==c&&(a.contains?a.contains(c):true)};var U=function(a){return a.documentElement&&!a.body||a.tagName&&a.ownerDocument&&!a.ownerDocument.body};d.find=r;d.filter=r.filter;d.expr=r.selectors;d.expr[":"]=d.expr.filters;r.selectors.filters.hidden=function(a){return"hidden"===a.type||d.css(a,"display")==="none"||d.css(a,"visibility")==="hidden"};r.selectors.filters.visible=function(a){return"hidden"!==a.type&&d.css(a,"display")!=="none"&&d.css(a,"visibility")!=="hidden"};r.selectors.filters.animated=function(c){return d.grep(d.timers,function(a){return c===a.elem}).length};d.multiFilter=function(a,c,b){if(b){a=":not("+a+")"}return r.matches(a,c)};d.dir=function(a,c){var b=[],f=a[c];while(f&&f!=document){if(f.nodeType==1)b.push(f);f=f[c]}return b};d.nth=function(a,c,b,f){c=c||1;var g=0;for(;a;a=a[b])if(a.nodeType==1&&++g==c)break;return a};d.sibling=function(a,c){var b=[];for(;a;a=a.nextSibling){if(a.nodeType==1&&a!=c)b.push(a)}return b};return;t.Sizzle=r})();d.event={add:function(g,h,j,k){if(g.nodeType==3||g.nodeType==8)return;if(g.setInterval&&g!=t)g=t;if(!j.guid)j.guid=this.guid++;if(k!==p){var l=j;j=this.proxy(l);j.data=k}var m=d.data(g,"events")||d.data(g,"events",{}),o=d.data(g,"handle")||d.data(g,"handle",function(){return typeof d!=="undefined"&&!d.event.triggered?d.event.handle.apply(arguments.callee.elem,arguments):p});o.elem=g;d.each(h.split(/\s+/),function(a,c){var b=c.split(".");c=b.shift();j.type=b.slice().sort().join(".");var f=m[c];if(d.event.specialAll[c])d.event.specialAll[c].setup.call(g,k,b);if(!f){f=m[c]={};if(!d.event.special[c]||d.event.special[c].setup.call(g,k,b)===false){if(g.addEventListener)g.addEventListener(c,o,false);else if(g.attachEvent)g.attachEvent("on"+c,o)}}f[j.guid]=j;d.event.global[c]=true});g=null},guid:1,global:{},remove:function(h,j,k){if(h.nodeType==3||h.nodeType==8)return;var l=d.data(h,"events"),m,o;if(l){if(j===p||(typeof j==="string"&&j.charAt(0)=="."))for(var u in l)this.remove(h,u+(j||""));else{if(j.type){k=j.handler;j=j.type}d.each(j.split(/\s+/),function(a,c){var b=c.split(".");c=b.shift();var f=RegExp("(^|\\.)"+b.slice().sort().join(".*\\.")+"(\\.|$)");if(l[c]){if(k)delete l[c][k.guid];else for(var g in l[c])if(f.test(l[c][g].type))delete l[c][g];if(d.event.specialAll[c])d.event.specialAll[c].teardown.call(h,b);for(m in l[c])break;if(!m){if(!d.event.special[c]||d.event.special[c].teardown.call(h,b)===false){if(h.removeEventListener)h.removeEventListener(c,d.data(h,"handle"),false);else if(h.detachEvent)h.detachEvent("on"+c,d.data(h,"handle"))}m=null;delete l[c]}}})}for(m in l)break;if(!m){var w=d.data(h,"handle");if(w)w.elem=null;d.removeData(h,"events");d.removeData(h,"handle")}}},trigger:function(a,c,b,f){var g=a.type||a;if(!f){a=typeof a==="object"?a[A]?a:d.extend(d.Event(g),a):d.Event(g);if(g.indexOf("!")>=0){a.type=g=g.slice(0,-1);a.exclusive=true}if(!b){a.stopPropagation();if(this.global[g])d.each(d.cache,function(){if(this.events&&this.events[g])d.event.trigger(a,c,this.handle.elem)})}if(!b||b.nodeType==3||b.nodeType==8)return p;a.result=p;a.target=b;c=d.makeArray(c);c.unshift(a)}a.currentTarget=b;var h=d.data(b,"handle");if(h)h.apply(b,c);if((!b[g]||(d.nodeName(b,'a')&&g=="click"))&&b["on"+g]&&b["on"+g].apply(b,c)===false)a.result=false;if(!f&&b[g]&&!a.isDefaultPrevented()&&!(d.nodeName(b,'a')&&g=="click")){this.triggered=true;try{b[g]()}catch(e){}}this.triggered=false;if(!a.isPropagationStopped()){var j=b.parentNode||b.ownerDocument;if(j)d.event.trigger(a,c,j,true)}},handle:function(a){var c,b;a=arguments[0]=d.event.fix(a||t.event);var f=a.type.split(".");a.type=f.shift();c=!f.length&&!a.exclusive;var g=RegExp("(^|\\.)"+f.slice().sort().join(".*\\.")+"(\\.|$)");b=(d.data(this,"events")||{})[a.type];for(var h in b){var j=b[h];if(c||g.test(j.type)){a.handler=j;a.data=j.data;var k=j.apply(this,arguments);if(k!==p){a.result=k;if(k===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[A])return a;var c=a;a=d.Event(c);for(var b=this.props.length,f;b;){f=this.props[--b];a[f]=c[f]}if(!a.target)a.target=a.srcElement||document;if(a.target.nodeType==3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement==a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){var g=document.documentElement,h=document.body;a.pageX=a.clientX+(g&&g.scrollLeft||h&&h.scrollLeft||0)-(g.clientLeft||0);a.pageY=a.clientY+(g&&g.scrollTop||h&&h.scrollTop||0)-(g.clientTop||0)}if(!a.which&&((a.charCode||a.charCode===0)?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button)a.which=(a.button&1?1:(a.button&2?3:(a.button&4?2:0)));return a},proxy:function(a,c){c=c||function(){return a.apply(this,arguments)};c.guid=a.guid=a.guid||c.guid||this.guid++;return c},special:{ready:{setup:Y,teardown:function(){}}},specialAll:{live:{setup:function(a,c){d.event.add(this,c[0],Z)},teardown:function(a){if(a.length){var c=0,b=RegExp("(^|\\.)"+a[0]+"(\\.|$)");d.each((d.data(this,"events").live||{}),function(){if(b.test(this.type))c++});if(c<1)d.event.remove(this,a[0],Z)}}}}};d.Event=function(a){if(!this.preventDefault)return new d.Event(a);if(a&&a.type){this.originalEvent=a;this.type=a.type;this.timeStamp=a.timeStamp}else this.type=a;if(!this.timeStamp)this.timeStamp=E();this[A]=true};function N(){return false}function O(){return true}d.Event.prototype={preventDefault:function(){this.isDefaultPrevented=O;var a=this.originalEvent;if(!a)return;if(a.preventDefault)a.preventDefault();a.returnValue=false},stopPropagation:function(){this.isPropagationStopped=O;var a=this.originalEvent;if(!a)return;if(a.stopPropagation)a.stopPropagation();a.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=O;this.stopPropagation()},isDefaultPrevented:N,isPropagationStopped:N,isImmediatePropagationStopped:N};var ba=function(a){var c=a.relatedTarget;while(c&&c!=this)try{c=c.parentNode}catch(e){c=this}if(c!=this){a.type=a.data;d.event.handle.apply(this,arguments)}};d.each({mouseover:'mouseenter',mouseout:'mouseleave'},function(a,c){d.event.special[c]={setup:function(){d.event.add(this,a,ba,c)},teardown:function(){d.event.remove(this,a,ba)}}});d.fn.extend({bind:function(a,c,b){return a=="unload"?this.one(a,c,b):this.each(function(){d.event.add(this,a,b||c,b&&c)})},one:function(c,b,f){var g=d.event.proxy(f||b,function(a){d(this).unbind(a,g);return(f||b).apply(this,arguments)});return this.each(function(){d.event.add(this,c,g,f&&b)})},unbind:function(a,c){return this.each(function(){d.event.remove(this,a,c)})},trigger:function(a,c){return this.each(function(){d.event.trigger(a,c,this)})},triggerHandler:function(a,c){if(this[0]){var b=d.Event(a);b.preventDefault();b.stopPropagation();d.event.trigger(b,c,this[0]);return b.result}},toggle:function(c){var b=arguments,f=1;while(f<b.length)d.event.proxy(c,b[f++]);return this.click(d.event.proxy(c,function(a){this.lastToggle=(this.lastToggle||0)%f;a.preventDefault();return b[this.lastToggle++].apply(this,arguments)||false}))},hover:function(a,c){return this.mouseenter(a).mouseleave(c)},ready:function(a){Y();if(d.isReady)a.call(document,d);else d.readyList.push(a);return this},live:function(a,c){var b=d.event.proxy(c);b.guid+=this.selector+a;d(document).bind(bb(a,this.selector),this.selector,b);return this},die:function(a,c){d(document).unbind(bb(a,this.selector),c?{guid:c.guid+this.selector+a}:null);return this}});function Z(f){var g=RegExp("(^|\\.)"+f.type+"(\\.|$)"),h=true,j=[];d.each(d.data(this,"events").live||[],function(a,c){if(g.test(c.type)){var b=d(f.target).closest(c.data)[0];if(b)j.push({elem:b,fn:c})}});d.each(j,function(){if(!f.isImmediatePropagationStopped()&&this.fn.call(this.elem,f,this.fn.data)===false)h=false});return h}function bb(a,c){return["live",a,c.replace(/\./g,"`").replace(/ /g,"|")].join(".")}d.extend({isReady:false,readyList:[],ready:function(){if(!d.isReady){d.isReady=true;if(d.readyList){d.each(d.readyList,function(){this.call(document,d)});d.readyList=null}d(document).triggerHandler("ready")}}});var bc=false;function Y(){if(bc)return;bc=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);d.ready()},false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);d.ready()}});if(document.documentElement.doScroll&&!t.frameElement)(function(){if(d.isReady)return;try{document.documentElement.doScroll("left")}catch(error){setTimeout(arguments.callee,0);return}d.ready()})()}d.event.add(t,"load",d.ready)}d.each(("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error").split(","),function(c,b){d.fn[b]=function(a){return a?this.bind(b,a):this.trigger(b)}});d(t).bind('unload',function(){for(var a in d.cache)if(a!=1&&d.cache[a].handle)d.event.remove(d.cache[a].handle.elem)});(function(){d.support={};var c=document.documentElement,b=document.createElement("script"),f=document.createElement("div"),g="script"+(new Date).getTime();f.style.display="none";f.innerHTML='   <link/><table></table><a href="/a" style="color:red;float:left;opacity:.5;">a</a><select><option>text</option></select><object><param/></object>';var h=f.getElementsByTagName("*"),j=f.getElementsByTagName("a")[0];if(!h||!h.length||!j){return}d.support={leadingWhitespace:f.firstChild.nodeType==3,tbody:!f.getElementsByTagName("tbody").length,objectAll:!!f.getElementsByTagName("object")[0].getElementsByTagName("*").length,htmlSerialize:!!f.getElementsByTagName("link").length,style:/red/.test(j.getAttribute("style")),hrefNormalized:j.getAttribute("href")==="/a",opacity:j.style.opacity==="0.5",cssFloat:!!j.style.cssFloat,scriptEval:false,noCloneEvent:true,boxModel:null};b.type="text/javascript";try{b.appendChild(document.createTextNode("window."+g+"=1;"))}catch(e){}c.insertBefore(b,c.firstChild);if(t[g]){d.support.scriptEval=true;delete t[g]}c.removeChild(b);if(f.attachEvent&&f.fireEvent){f.attachEvent("onclick",function(){d.support.noCloneEvent=false;f.detachEvent("onclick",arguments.callee)});f.cloneNode(true).fireEvent("onclick")}d(function(){var a=document.createElement("div");a.style.width="1px";a.style.paddingLeft="1px";document.body.appendChild(a);d.boxModel=d.support.boxModel=a.offsetWidth===2;document.body.removeChild(a)})})();var I=d.support.cssFloat?"cssFloat":"styleFloat";d.props={"for":"htmlFor","class":"className","float":I,cssFloat:I,styleFloat:I,readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",tabindex:"tabIndex"};d.fn.extend({_load:d.fn.load,load:function(b,f,g){if(typeof b!=="string")return this._load(b);var h=b.indexOf(" ");if(h>=0){var j=b.slice(h,b.length);b=b.slice(0,h)}var k="GET";if(f)if(d.isFunction(f)){g=f;f=null}else if(typeof f==="object"){f=d.param(f);k="POST"}var l=this;d.ajax({url:b,type:k,dataType:"html",data:f,complete:function(a,c){if(c=="success"||c=="notmodified")l.html(j?d("<div/>").append(a.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(j):a.responseText);if(g)l.each(g,[a.responseText,c,a])}});return this},serialize:function(){return d.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?d.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password/i.test(this.type))}).map(function(b,f){var g=d(this).val();return g==null?null:d.isArray(g)?d.map(g,function(a,c){return{name:f.name,value:a}}):{name:f.name,value:g}}).get()}});d.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(c,b){d.fn[b]=function(a){return this.bind(b,a)}});var bo=E();d.extend({get:function(a,c,b,f){if(d.isFunction(c)){b=c;c=null}return d.ajax({type:"GET",url:a,data:c,success:b,dataType:f})},getScript:function(a,c){return d.get(a,null,c,"script")},getJSON:function(a,c,b){return d.get(a,c,b,"json")},post:function(a,c,b,f){if(d.isFunction(c)){b=c;c={}}return d.ajax({type:"POST",url:a,data:c,success:b,dataType:f})},ajaxSetup:function(a){d.extend(d.ajaxSettings,a)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return t.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(b){b=d.extend(true,b,d.extend(true,{},d.ajaxSettings,b));var f,g=/=\?(&|$)/g,h,j,k=b.type.toUpperCase();if(b.data&&b.processData&&typeof b.data!=="string")b.data=d.param(b.data);if(b.dataType=="jsonp"){if(k=="GET"){if(!b.url.match(g))b.url+=(b.url.match(/\?/)?"&":"?")+(b.jsonp||"callback")+"=?"}else if(!b.data||!b.data.match(g))b.data=(b.data?b.data+"&":"")+(b.jsonp||"callback")+"=?";b.dataType="json"}if(b.dataType=="json"&&(b.data&&b.data.match(g)||b.url.match(g))){f="jsonp"+bo++;if(b.data)b.data=(b.data+"").replace(g,"="+f+"$1");b.url=b.url.replace(g,"="+f+"$1");b.dataType="script";t[f]=function(a){j=a;z();C();t[f]=p;try{delete t[f]}catch(e){}if(u)u.removeChild(w)}}if(b.dataType=="script"&&b.cache==null)b.cache=false;if(b.cache===false&&k=="GET"){var l=E();var m=b.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+l+"$2");b.url=m+((m==b.url)?(b.url.match(/\?/)?"&":"?")+"_="+l:"")}if(b.data&&k=="GET"){b.url+=(b.url.match(/\?/)?"&":"?")+b.data;b.data=null}if(b.global&&!d.active++)d.event.trigger("ajaxStart");var o=/^(\w+:)?\/\/([^\/?#]+)/.exec(b.url);if(b.dataType=="script"&&k=="GET"&&o&&(o[1]&&o[1]!=location.protocol||o[2]!=location.host)){var u=document.getElementsByTagName("head")[0];var w=document.createElement("script");w.src=b.url;if(b.scriptCharset)w.charset=b.scriptCharset;if(!f){var s=false;w.onload=w.onreadystatechange=function(){if(!s&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){s=true;z();C();u.removeChild(w)}}}u.appendChild(w);return p}var x=false;var n=b.xhr();if(b.username)n.open(k,b.url,b.async,b.username,b.password);else n.open(k,b.url,b.async);try{if(b.data)n.setRequestHeader("Content-Type",b.contentType);if(b.ifModified)n.setRequestHeader("If-Modified-Since",d.lastModified[b.url]||"Thu, 01 Jan 1970 00:00:00 GMT");n.setRequestHeader("X-Requested-With","XMLHttpRequest");n.setRequestHeader("Accept",b.dataType&&b.accepts[b.dataType]?b.accepts[b.dataType]+", */*":b.accepts._default)}catch(e){}if(b.beforeSend&&b.beforeSend(n,b)===false){if(b.global&&!--d.active)d.event.trigger("ajaxStop");n.abort();return false}if(b.global)d.event.trigger("ajaxSend",[n,b]);var v=function(a){if(n.readyState==0){if(y){clearInterval(y);y=null;if(b.global&&!--d.active)d.event.trigger("ajaxStop")}}else if(!x&&n&&(n.readyState==4||a=="timeout")){x=true;if(y){clearInterval(y);y=null}h=a=="timeout"?"timeout":!d.httpSuccess(n)?"error":b.ifModified&&d.httpNotModified(n,b.url)?"notmodified":"success";if(h=="success"){try{j=d.httpData(n,b.dataType,b)}catch(e){h="parsererror"}}if(h=="success"){var c;try{c=n.getResponseHeader("Last-Modified")}catch(e){}if(b.ifModified&&c)d.lastModified[b.url]=c;if(!f)z()}else d.handleError(b,n,h);C();if(b.async)n=null}};if(b.async){var y=setInterval(v,13);if(b.timeout>0)setTimeout(function(){if(n){if(!x)v("timeout");if(n)n.abort()}},b.timeout)}try{n.send(b.data)}catch(e){d.handleError(b,n,null,e)}if(!b.async)v();function z(){if(b.success)b.success(j,h);if(b.global)d.event.trigger("ajaxSuccess",[n,b])}function C(){if(b.complete)b.complete(n,h);if(b.global)d.event.trigger("ajaxComplete",[n,b]);if(b.global&&!--d.active)d.event.trigger("ajaxStop")}return n},handleError:function(a,c,b,f){if(a.error)a.error(c,b,f);if(a.global)d.event.trigger("ajaxError",[c,a,f])},active:0,httpSuccess:function(a){try{return!a.status&&location.protocol=="file:"||(a.status>=200&&a.status<300)||a.status==304||a.status==1223}catch(e){}return false},httpNotModified:function(a,c){try{var b=a.getResponseHeader("Last-Modified");return a.status==304||b==d.lastModified[c]}catch(e){}return false},httpData:function(a,c,b){var f=a.getResponseHeader("content-type"),g=c=="xml"||!c&&f&&f.indexOf("xml")>=0,h=g?a.responseXML:a.responseText;if(g&&h.documentElement.tagName=="parsererror")throw"parsererror";if(b&&b.dataFilter)h=b.dataFilter(h,c);if(typeof h==="string"){if(c=="script")d.globalEval(h);if(c=="json")h=t["eval"]("("+h+")")}return h},param:function(b){var f=[];function g(a,c){f[f.length]=encodeURIComponent(a)+'='+encodeURIComponent(c)};if(d.isArray(b)||b.jquery)d.each(b,function(){g(this.name,this.value)});else for(var h in b)if(d.isArray(b[h]))d.each(b[h],function(){g(h,this)});else g(h,d.isFunction(b[h])?b[h]():b[h]);return f.join("&").replace(/%20/g,"+")}});var P={},bd=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function F(a,c){var b={};d.each(bd.concat.apply([],bd.slice(0,c)),function(){b[this]=a});return b}d.fn.extend({show:function(a,c){if(a){return this.animate(F("show",3),a,c)}else{for(var b=0,f=this.length;b<f;b++){var g=d.data(this[b],"olddisplay");this[b].style.display=g||"";if(d.css(this[b],"display")==="none"){var h=this[b].tagName,j;if(P[h]){j=P[h]}else{var k=d("<"+h+" />").appendTo("body");j=k.css("display");if(j==="none")j="block";k.remove();P[h]=j}this[b].style.display=d.data(this[b],"olddisplay",j)}}return this}},hide:function(a,c){if(a){return this.animate(F("hide",3),a,c)}else{for(var b=0,f=this.length;b<f;b++){var g=d.data(this[b],"olddisplay");if(!g&&g!=="none")d.data(this[b],"olddisplay",d.css(this[b],"display"));this[b].style.display="none"}return this}},_toggle:d.fn.toggle,toggle:function(c,b){var f=typeof c==="boolean";return d.isFunction(c)&&d.isFunction(b)?this._toggle.apply(this,arguments):c==null||f?this.each(function(){var a=f?c:d(this).is(":hidden");d(this)[a?"show":"hide"]()}):this.animate(F("toggle",3),c,b)},fadeTo:function(a,c,b){return this.animate({opacity:c},a,b)},animate:function(u,w,s,x){var n=d.speed(w,s,x);return this[n.queue===false?"each":"queue"](function(){var k=d.extend({},n),l,m=this.nodeType==1&&d(this).is(":hidden"),o=this;for(l in u){if(u[l]=="hide"&&m||u[l]=="show"&&!m)return k.complete.call(this);if((l=="height"||l=="width")&&this.style){k.display=d.css(this,"display");k.overflow=this.style.overflow}}if(k.overflow!=null)this.style.overflow="hidden";k.curAnim=d.extend({},u);d.each(u,function(a,c){var b=new d.fx(o,k,a);if(/toggle|show|hide/.test(c))b[c=="toggle"?m?"show":"hide":c](u);else{var f=c.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),g=b.cur(true)||0;if(f){var h=parseFloat(f[2]),j=f[3]||"px";if(j!="px"){o.style[a]=(h||1)+j;g=((h||1)/b.cur(true))*g;o.style[a]=g+j}if(f[1])h=((f[1]=="-="?-1:1)*h)+g;b.custom(g,h,j)}else b.custom(g,c,"")}});return true})},stop:function(c,b){var f=d.timers;if(c)this.queue([]);this.each(function(){for(var a=f.length-1;a>=0;a--)if(f[a].elem==this){if(b)f[a](true);f.splice(a,1)}});if(!b)this.dequeue();return this}});d.each({slideDown:F("show",1),slideUp:F("hide",1),slideToggle:F("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(b,f){d.fn[b]=function(a,c){return this.animate(f,a,c)}});d.extend({speed:function(a,c,b){var f=typeof a==="object"?a:{complete:b||!b&&c||d.isFunction(a)&&a,duration:a,easing:b&&c||c&&!d.isFunction(c)&&c};f.duration=d.fx.off?0:typeof f.duration==="number"?f.duration:d.fx.speeds[f.duration]||d.fx.speeds._default;f.old=f.complete;f.complete=function(){if(f.queue!==false)d(this).dequeue();if(d.isFunction(f.old))f.old.call(this)};return f},easing:{linear:function(a,c,b,f){return b+f*a},swing:function(a,c,b,f){return((-Math.cos(a*Math.PI)/2)+0.5)*f+b}},timers:[],timerId:null,fx:function(a,c,b){this.options=c;this.elem=a;this.prop=b;if(!c.orig)c.orig={}}});d.fx.prototype={update:function(){if(this.options.step)this.options.step.call(this.elem,this.now,this);(d.fx.step[this.prop]||d.fx.step._default)(this);if((this.prop=="height"||this.prop=="width")&&this.elem.style)this.elem.style.display="block"},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var c=parseFloat(d.css(this.elem,this.prop,a));return c&&c>-10000?c:parseFloat(d.curCSS(this.elem,this.prop))||0},custom:function(b,f,g){this.startTime=E();this.start=b;this.end=f;this.unit=g||this.unit||"px";this.now=this.start;this.pos=this.state=0;var h=this;function j(a){return h.step(a)}j.elem=this.elem;d.timers.push(j);if(j()&&d.timerId==null){d.timerId=setInterval(function(){var a=d.timers;for(var c=0;c<a.length;c++)if(!a[c]())a.splice(c--,1);if(!a.length){clearInterval(d.timerId);d.timerId=null}},13)}},show:function(){this.options.orig[this.prop]=d.attr(this.elem.style,this.prop);this.options.show=true;this.custom(this.prop=="width"||this.prop=="height"?1:0,this.cur());d(this.elem).show()},hide:function(){this.options.orig[this.prop]=d.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var c=E();if(a||c>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var b=true;for(var f in this.options.curAnim)if(this.options.curAnim[f]!==true)b=false;if(b){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(d.css(this.elem,"display")=="none")this.elem.style.display="block"}if(this.options.hide)d(this.elem).hide();if(this.options.hide||this.options.show)for(var g in this.options.curAnim)d.attr(this.elem.style,g,this.options.orig[g])}if(b)this.options.complete.call(this.elem);return false}else{var h=c-this.startTime;this.state=h/this.options.duration;this.pos=d.easing[this.options.easing||(d.easing.swing?"swing":"linear")](this.state,h,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update()}return true}};d.extend(d.fx,{speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){d.attr(a.elem.style,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null)a.elem.style[a.prop]=a.now+a.unit;else a.elem[a.prop]=a.now}}});if(document.documentElement["getBoundingClientRect"])d.fn.offset=function(){if(!this[0])return{top:0,left:0};if(this[0]===this[0].ownerDocument.body)return d.offset.bodyOffset(this[0]);var be=this[0].getBoundingClientRect(),bf=this[0].ownerDocument,J=bf.body,K=bf.documentElement,bp=K.clientTop||J.clientTop||0,bq=K.clientLeft||J.clientLeft||0,br=be.top+(self.pageYOffset||d.boxModel&&K.scrollTop||J.scrollTop)-bp,bs=be.left+(self.pageXOffset||d.boxModel&&K.scrollLeft||J.scrollLeft)-bq;return{top:br,left:bs}};else d.fn.offset=function(){if(!this[0])return{top:0,left:0};if(this[0]===this[0].ownerDocument.body)return d.offset.bodyOffset(this[0]);d.offset.initialized||d.offset.initialize();var a=this[0],c=a.offsetParent,b=a,f=a.ownerDocument,g,h=f.documentElement,j=f.body,k=f.defaultView,l=k.getComputedStyle(a,null),m=a.offsetTop,o=a.offsetLeft;while((a=a.parentNode)&&a!==j&&a!==h){g=k.getComputedStyle(a,null);m-=a.scrollTop,o-=a.scrollLeft;if(a===c){m+=a.offsetTop,o+=a.offsetLeft;if(d.offset.doesNotAddBorder&&!(d.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(a.tagName)))m+=parseInt(g.borderTopWidth,10)||0,o+=parseInt(g.borderLeftWidth,10)||0;b=c,c=a.offsetParent}if(d.offset.subtractsBorderForOverflowNotVisible&&g.overflow!=="visible")m+=parseInt(g.borderTopWidth,10)||0,o+=parseInt(g.borderLeftWidth,10)||0;l=g}if(l.position==="relative"||l.position==="static")m+=j.offsetTop,o+=j.offsetLeft;if(l.position==="fixed")m+=Math.max(h.scrollTop,j.scrollTop),o+=Math.max(h.scrollLeft,j.scrollLeft);return{top:m,left:o}};d.offset={initialize:function(){if(this.initialized)return;var a=document.body,c=document.createElement('div'),b,f,g,h,j,k,l=a.style.marginTop,m='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"cellpadding="0"cellspacing="0"><tr><td></td></tr></table>';j={position:'absolute',top:0,left:0,margin:0,border:0,width:'1px',height:'1px',visibility:'hidden'};for(k in j)c.style[k]=j[k];c.innerHTML=m;a.insertBefore(c,a.firstChild);b=c.firstChild,f=b.firstChild,h=b.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(f.offsetTop!==5);this.doesAddBorderForTableAndCells=(h.offsetTop===5);b.style.overflow='hidden',b.style.position='relative';this.subtractsBorderForOverflowNotVisible=(f.offsetTop===-5);a.style.marginTop='1px';this.doesNotIncludeMarginInBodyOffset=(a.offsetTop===0);a.style.marginTop=l;a.removeChild(c);this.initialized=true},bodyOffset:function(a){d.offset.initialized||d.offset.initialize();var c=a.offsetTop,b=a.offsetLeft;if(d.offset.doesNotIncludeMarginInBodyOffset)c+=parseInt(d.curCSS(a,'marginTop',true),10)||0,b+=parseInt(d.curCSS(a,'marginLeft',true),10)||0;return{top:c,left:b}}};d.fn.extend({position:function(){var a=0,c=0,b;if(this[0]){var f=this.offsetParent(),g=this.offset(),h=/^body|html$/i.test(f[0].tagName)?{top:0,left:0}:f.offset();g.top-=B(this,'marginTop');g.left-=B(this,'marginLeft');h.top+=B(f,'borderTopWidth');h.left+=B(f,'borderLeftWidth');b={top:g.top-h.top,left:g.left-h.left}}return b},offsetParent:function(){var a=this[0].offsetParent||document.body;while(a&&(!/^body|html$/i.test(a.tagName)&&d.css(a,'position')=='static'))a=a.offsetParent;return d(a)}});d.each(['Left','Top'],function(c,b){var f='scroll'+b;d.fn[f]=function(a){if(!this[0])return null;return a!==p?this.each(function(){this==t||this==document?t.scrollTo(!c?a:d(t).scrollLeft(),c?a:d(t).scrollTop()):this[f]=a}):this[0]==t||this[0]==document?self[c?'pageYOffset':'pageXOffset']||d.boxModel&&document.documentElement[f]||document.body[f]:this[0][f]}});d.each(["Height","Width"],function(c,b){var f=c?"Left":"Top",g=c?"Right":"Bottom";d.fn["inner"+b]=function(){return this[b.toLowerCase()]()+B(this,"padding"+f)+B(this,"padding"+g)};d.fn["outer"+b]=function(a){return this["inner"+b]()+B(this,"border"+f+"Width")+B(this,"border"+g+"Width")+(a?B(this,"margin"+f)+B(this,"margin"+g):0)};var h=b.toLowerCase();d.fn[h]=function(a){return this[0]==t?document.compatMode=="CSS1Compat"&&document.documentElement["client"+b]||document.body["client"+b]:this[0]==document?Math.max(document.documentElement["client"+b],document.body["scroll"+b],document.documentElement["scroll"+b],document.body["offset"+b],document.documentElement["offset"+b]):a===p?(this.length?d.css(this[0],h):null):this.css(h,typeof a==="string"?a:a+"px")}})})();
	
function addStyle(s){var n=document.createElement('style');n.type='text/css';n.appendChild(document.createTextNode(s));document.getElementsByTagName('head')[0].appendChild(n);}

// ============================================================================================================

MARKERS = function(){
	var _markers = {};
	var _idx = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];
	var _len = 0;
	var _selectIdx = 0;
	var _getIdx = function(){
		return _idx[_len];
	};
	var _getIdxByIdx = function(idx){
		for(var i=0; i<_idx.length; i++){
			if(_idx[i]===idx){
				return i;
			}
		}
	};

	return {
		add: function(obj){
			_markers[_idx[_len]] = obj;
			_len++;
		},
		getIdx: function(){
			return _getIdx();
		},
		getBy: function(idx){
			var marker = _markers[idx];
			if(marker){
				_selectIdx = _getIdxByIdx(idx);
			}
			return marker;
		},
		getPrev: function(){
			var marker = _markers[_idx[_selectIdx-1]];
			if(marker){
				_selectIdx--;
			}
			return marker;
		},
		getNext: function(){
			var marker = _markers[_idx[_selectIdx+1]];
			if(marker){
				_selectIdx++;
			}
			return marker;
		}
	};
}();

function gotoMarker(div){
	if(div === undefined) { return; }
	var x = parseInt(div.style.left, 10);
	var y = parseInt(div.style.top, 10)-20;
	window.scrollTo(x, y);
}

function newMarker(idx){
	$('#pmbar').append('<span id="span_'+idx+'">[ '+idx+' ]</span>');
	$('#span_'+idx).click(function(e){
		var idx = this.id.replace('span_', '');
		var div = MARKERS.getBy(idx);
		gotoMarker(div);
	});
}

function monitorMouseClick(){
	$(document).click(function(e){
		//console.log(e);
		/*console.log('button=%d, ctrlKey=%s, clientXY:(%s,%s), pageXY:(%s,%s), screenXY:(%s,%s)',
			e.button,
			e.ctrlKey,
			e.clientX, e.clientY,
			e.pageX, e.pageY,
			e.screenX, e.screenY);
		*/

		// Ctrl + left-click
		if(e.ctrlKey && e.button===0){
			var idx = MARKERS.getIdx();
			if(idx === undefined){
				alert('marker full');
				return;
			}
			var id = 'mark_' + idx;
			$('body').append('<div id="'+id+'" class="mark">'+idx+'</div>');
			var div = $('#'+id)[0];
			div.style.left = e.pageX + 'px';
			div.style.top = e.pageY + 'px';

			// add to toolbar
			newMarker(idx);

			MARKERS.add(div);
		}
	});
}

function monitorKeyPress(){
	$(document).keypress(function(e){
		//console.log(e);
		var div = null;
		// +: 43, -:45, [: 91, ]: 93
		if(e.charCode===43 || e.charCode===45 || e.charCode===91 || e.charCode===93){		
			if(e.charCode===43 || e.charCode===93){
				div = MARKERS.getNext();
			}else{
				div = MARKERS.getPrev();
			}
		}else{
			var idx = String.fromCharCode(e.charCode);
			div = MARKERS.getBy(idx);
		}
		gotoMarker(div);
	});
}

// ============================================================================================================

// create styles
addStyle('div.mark,div#pmbar{font:14px "arial" bold;z-index:1000;opacity:.50;filter:alpha(opacity=50);-moz-opacity:0.5;cursor:default}div#pmbar{position:fixed;left:0;top:0;border:0;background:transparent;width:100%;text-align:right;padding:0}div#pmbar,div#pmbar span{margin:0}div#pmbar span{background:#def;padding:0 0 0 5px;cursor:pointer;color:blue}div.mark{background:yellow;position:absolute;border:solid 2px red;color:red;padding:0 5px;text-align:center}');

// toolbar
$('body').append('<div id="pmbar"></div>');

monitorMouseClick();
monitorKeyPress();
