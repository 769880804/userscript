// ==UserScript==
// @name            IMO.IM Boost
// @version         2.8
// @author          Michael J Scarchilli & Bunnies... lots and lots of bunnies!
// @namespace       http://www.mikevision.com
// @description     Fit more friends on the page, choose your own background color! This userscript makes the IMO.IM user experience more enjoyable.
// @icon            https://i.imgur.com/Nit7DZt.png
// @include         https://o.imo.im/*
// @updateURL	    https://userscripts.org/scripts/source/136532.user.js
// @downloadURL	    https://userscripts.org/scripts/source/136532.user.js
// @grant           none
// 
// ==/UserScript==

function addJQuery(e){var t=document.createElement("script");t.setAttribute("src","https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js");t.addEventListener("load",function(){var t=document.createElement("script");t.textContent="("+e.toString()+")();";document.body.appendChild(t)},false);document.body.appendChild(t)}function main(){jQuery.noConflict();(function(e){jQuery(document).ready(function(){var t=function(){function t(){if(document.getElementById("main")){n();e("#body").unbind();e(document).unbind()}}function n(){var t=document.createElement("div");var n=document.getElementById("main");var o=s("imoBoost");if(!o){r("imoBoost","SteelBlue",2020);o="SteelBlue";n.style.backgroundColor="SteelBlue"}else{n.style.backgroundColor=o}t.innerHTML='<a href="http://userscripts.org/scripts/show/136532" target="_blank"></a>';t.id="imoBoostIcon";document.getElementsByTagName("body")[0].appendChild(t);e('span.title:contains("Discussions"),span.title:contains("Chat groups"),span.title:contains("Blocked")').closest("div.buddygroup").hide();e('span.translation_span:contains("Preferences")').closest("div").attr("id","prefBtn");e("#prefBtn").click(function(){function m(t){var t=e("#dropListChoices li.selected").attr("id");r("imoBoost",t,2020);y()}function g(){y();n.style.backgroundColor=o}function y(){o=s("imoBoost");e(document).unbind();e(t).unbind();e("#backgroundColorSet").remove()}var t=document.querySelector(".save-button");var u=o.replace(/([a-z])([A-Z])/g,"$1 $2");var a;e(".preference-widget").prepend('<div class="pref-section" id="backgroundColorSet"><div class="pref-section-title"><span class="translation_span">Background Color</span></div><div class="pref-option"><div id="dropList"><div id="dropListTop"><div id="dropChoice"><span class="swatch" style="background-color:'+o+';"></span>'+u+'</div><div id="dropArrow"><div class="top"></div><div class="arrow"></div><div class="bottom"></div></div></div><div id="dropListBottom"><ul id="dropListChoices"></ul></div></div></div></div>');var f=document.getElementById("dropList");var l=document.getElementById("dropListTop");var c=document.getElementById("dropListBottom");var h=document.getElementById("dropChoice");var p=document.getElementById("dropListChoices");var d=document.getElementById("dropListChoices").getElementsByTagName("li");var v=["Alice Blue","Antique White","Aqua","Aqua Marine","Azure","Beige","Bisque","Black","Blanched Almond","Blue","Blue Violet","Brown","Burly Wood","Cadet Blue","Chartreuse","Chocolate","Coral","Cornflower Blue","Cornsilk","Crimson","Cyan","Dark Blue","Dark Cyan","Dark Golden Rod","Dark Gray","Dark Khaki","Dark Magenta","Dark Olive Green","Dark Orange","Dark Orchid","Dark Red","Dark Salmon","Dark Sea Green","Dark Slate Blue","Dark Slate Gray","Dark Turquoise","Dark Violet","Deep Pink","Dim Gray","Dodger Blue","Fire Brick","Floral White","Forest Green","Fuchsia","Gainsboro","Gold","Golden Rod","Gray","Green","Green Yellow","Honey Dew","Hot Pink","Indian Red","Indigo","Ivory","Khaki","Lavender","Lavender Blush","Lawn Green","Lemon Chiffon","Light Blue","Light Coral","Light Cyan","Light Golden Rod Yellow","Light Gray","Light Green","Light Pink","Light Salmon","Light Sea Green","Light Sky Blue","Light Slate Gray","Light Steel Blue","Light Yellow","Lime","Lime Green","Linen","Magenta","Maroon","Medium Aqua Marine","Medium Blue","Medium Orchid","Medium Purple","Medium Sea Green","Medium Slate Blue","Medium Spring Green","Medium Turquoise","Medium Violet Red","Midnight Blue","Mint Cream","Misty Rose","Moccasin","Navajo White","Navy","Old Lace","Olive","Olive Drab","Orange","Orange Red","Orchid","Pale Golden Rod","Pale Green","Pale Turquoise","Pale Violet Red","Papaya Whip","Peach Puff","Plum","Pink","Powder Blue","Purple","Red","Rosy Brown","Royal Blue","Saddle Brown","Salmon","Sandy Brown","Sea Green","Sea Shell","Sienna","Silver","Sky Blue","Slate Blue","Slate Grey","Snow","Spring Green","Steel Blue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","White Smoke","Yellow","#333"];for(i=0;i<v.length;i++){a=v[i].replace(/ /g,"");e(p).append(e('<li id="'+a+'"></li>').html('<span style="background-color:'+a+';border:1px #555 solid;display:inline-block;height:9px;margin:0 3px -1px 6px;width:14px;"></span>'+v[i]))}document.getElementById(o).setAttribute("class","selected");l.onclick=function(){c.style.display="block";document.onclick=function(){c.style.display="none"};f.onclick=function(e){e.stopPropagation()}};e(d).bind("click",function(){for(i=0;i<d.length;i++){d[i].removeAttribute("class")}this.setAttribute("class","selected");n.style.backgroundColor=this.id;h.innerHTML="<span>"+this.innerHTML+"</span>";c.style.display="none"});e(".cancel-button, .sprite_icn_close_2, .modal-popup-overlay").bind("click",function(){g()});t.onclick=function(){m()};e(document).bind("keydown",function(e){if(e.keyCode===13){m()}})})}function r(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i}function s(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("="));r=i[t].substr(i[t].indexOf("=")+1);n=n.replace(/^\s+|\s+$/g,"");if(n==e){return unescape(r)}}}e(document).bind("keydown",function(e){if(e.keyCode===13){setTimeout(t,500)}});e("#splash_imo_signin").bind("click",function(){setTimeout(t,500)});setTimeout(t,1e3)};t()})})(jQuery);var e=document.createElement("style");e.type="text/css";e.title="IMO.IM Boost";var t=document.createTextNode('.me span.na{color:#D35900;} .bk0 span.na{color:#0163B3;}div.bar.white{background-color:#f0f0f0;height:22px;line-height:22px;font-size:14px;}div#buddypanel .collapsed{background-color:#f0f0f0;}div#buddypanel div.bar.white .button img.sprite_icn_expand{margin:3px 0;}div#buddypanel div.bar.white .button img.sprite_icn_collapse{margin:3px 0}div#buddypanel div.blist-container{font-size:12px;background-color:#fff;box-shadow:0 5px 10px #E5E5E5;}div#buddypanel div.blist-container .buddyitem{height:17px;line-height:17px;padding-left:10px;}div#buddypanel div.blist-container .buddyitem .buddyimg{margin:-1px 10px 0 10px;}.buddygrouplist{padding-left:0;}.convlogitem{padding:4px}.convlog .ts-container{width:57px;}.ms span{line-height:17px;}#window_container .floatingwindowholder div.focused div.titlebar{background-color:#333;color:#fff;}#window_container .floatingwindowholder div.floatingwindow div.titlebar div.titleicon{padding:5 0;}.focused .convpanel div.convmain div.convbottom{background-color:#333;color:#fff;}div#imo div#window_container div.floatingwindowholder div.floatingwindow{border-color:#eee; border-radius:5px;}.convlog{border-color:#333;  bottom:68px; height:auto;}.convpanel .convbuttons{border:1px #333 solid;}.convpanel div.convmain{border:1px #333 solid;}.sprite_btn_send,#play{display:none;}.convpanel div.convmain div.convbottom div.convinput{right:0;height:50px;}.convpanel div.convmain div.convbottom{height:70px;}#window_container .floatingwindowholder div.floatingwindow div.windowbody .convpanel .convmain .convbottom{opacity:1;}div#imo div#window_container div.floatingwindowholder, div#imo div#window_container div.floatingwindowholder div.floatingwindow{min-height:340px; border-radius:5px; border-width:1px;}div.floatingwindowholder{min-width:365px !important;}div#imo div#window_container div.floatingwindowholder div.floatingwindow{box-shadow:2px 2px 20px 2px #000;}.convlog-msgs .na:after{content: ":" ;}.sys_offline{padding:2px 0;}.convpanel div.convmain div.convbottom div.convinput div.convinput-text-container textarea{height:49px;}.convpanel div.convmain div.convbottom div.convinput div.convinput-text-container{right:3px;}.convlog .ts-container, .convlog .ts{font-size:9px;}.voiceim_toggle{display:none;} \n/* dropList */ \n*{margin:0;padding:0}ul,li{list-style:none;margin:0;padding:0}#backgroundColorSet{height:45px;}#dropList{font-family:arial,helvetica,sans-serif;font-size:14px;left:0;margin:0;position:relative;top:0;width:200px}#dropListTop{background-color:#fff;height:20px;position:absolute;width:100%}#dropChoice{background-color:#fff;border-color:#abadb3 transparent #e3e9ef #e2e3ea;border-radius:2px;border-style:solid;border-width:1px;height:18px;left:0;line-height:18px;position:absolute;top:0;width:100%}#dropArrow{border-color:#abadb3 #dbdfe6 #e3e9ef transparent;border-radius:0 2px 2px 0;border-style:solid;border-width:1px;height:16px;padding:1px;position:absolute;right:-2px;top:0;width:14px}#dropArrow .arrow{border-style:solid;border-width:4px 4px 0;border-color:#000 transparent transparent;height:0;left:50%;margin:-2px 0 0 -4px;position:relative;top:50%;width:0}#dropArrow .top{float:left;height:50%;width:100%}#dropArrow .bottom{width:100%;height:50%;float:left}#dropList:hover #dropChoice{border-color:#5794bf transparent #c7e2f1 #c5daed}#dropList:hover #dropArrow{border-color:#5794bf #3c7fb1 #3c7fb1}#dropList:hover #dropArrow .top{background-color:#EAF6FD;background-image:-ms-linear-gradient(top,#EAF6FD 0,#D9F0FC 100%);background-image:-moz-linear-gradient(top,#EAF6FD 0,#D9F0FC 100%);background-image:-o-linear-gradient(top,#EAF6FD 0,#D9F0FC 100%);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#EAF6FD),color-stop(1,#D9F0FC));background-image:-webkit-linear-gradient(top,#EAF6FD 0,#D9F0FC 100%);background-image:linear-gradient(to bottom,#EAF6FD 0,#D9F0FC 100%)}#dropList:hover #dropArrow .bottom{background-color:#BCE5FC;background-image:-ms-linear-gradient(top,#BCE5FC 0,#A9DBF6 100%);background-image:-moz-linear-gradient(top,#BCE5FC 0,#A9DBF6 100%);background-image:-o-linear-gradient(top,#BCE5FC 0,#A9DBF6 100%);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#BCE5FC),color-stop(1,#A9DBF6));background-image:-webkit-linear-gradient(top,#BCE5FC 0,#A9DBF6 100%);background-image:linear-gradient(to bottom,#BCE5FC 0,#A9DBF6 100%)}#dropListBottom{background-color:#fff;border-color:#b2b2b2 #000 #000 #b2b2b2;border-radius:2px;border-style:solid;border-width:1px 1px 1px 2px;display:none;height:322px;overflow-x:hidden;position:absolute;top:20px;width:100%}#dropListChoices{}#dropListChoices li{cursor:pointer;height:16px;line-height:16px;}#dropListChoices li a{color:#00f;display:block;text-decoration:none;width:100%}#dropListChoices li a:hover{color:#fff}#dropListChoices li:hover{background-color:#39f;color:#fff}.selected{background-color:#e0edff;}.swatch{border:1px #555 solid;display:inline-block;height:9px;margin:0 3px -1px 6px;width:14px;}#imoBoostIcon{width:31px;height:10px;position:absolute;top:25px;left:68px;z-index:9999;}#imoBoostIcon a{width:31px;height:10px;position:absolute;top:0;left:0; background:url(https://i.imgur.com/Nit7DZt.png) no-repeat scroll -1px -19px / 33px 33px transparent;}');e.appendChild(t);document.getElementsByTagName("head")[0].appendChild(e)}addJQuery(main)