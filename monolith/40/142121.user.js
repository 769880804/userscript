// ==UserScript==
// @name          Viet User 2
// @namespace     2222.2P.com/userscripts
// @description	  Adds a viet character creator to a page.
// @include
// ==/UserScript==
// Notes: 'reverse-algebra' to VNI so instead of a1 type 1a. Strict key needs highest number first eg 61a (except for 89d).
 // The strict keys allow:
// 1a 2a 3a 4a 5a 6a 7a 8a etc.
// 61a 71a 81a etc.
// _del last character
// _^ lift last character's case
// Space character
// Return to overwrite without character-change to caret following

// Strict keys does not enable:
// 16a a61 a16 - alternate algebra
// Accent toggling and changing
// F12 flat tones

function meload() {

	var area = document.createElement("p");

	area.innerHTML = "<label id='pollo'>  <table> <tbody> <tr> <th colspan='2'>VN Strict Keys</th> </tr> <tr> <td colspan='3'> <textarea autofocus='autofocus' rows='5' cols='35' id='disp' onkeyup='getcode();' ></textarea></td> </tr> <td> <tr> <td> <input onclick='buttons(this.value)' type='button' value='b' /> <input onclick='buttons(this.value)' type='button' value='c' /> <input onclick='buttons(this.value)' type='button' value='d' /> <input onclick='buttons(this.value)' type='button' value='f' /> <input onclick='buttons(this.value)' type='button' value='g' /> <input onclick='buttons(this.value)' type='button' value='h' /> <input onclick='buttons(this.value)' type='button' value='j' /> <input onclick='buttons(this.value)' type='button' value='k' /> <input onclick='buttons(this.value)' type='button' value='l' /> <input onclick='buttons(this.value)' type='button' value='m' /> <input onclick='buttons(this.value)' type='button' value='n' /> <input onclick='buttons(this.value)' type='button' value='&#xa0;' /> <input onclick='uppersB()'  type='button' value='^_' />  </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='p' /> <input onclick='buttons(this.value)' type='button' value='q' /> <input onclick='buttons(this.value)' type='button' value='r' /> <input onclick='buttons(this.value)' type='button' value='s' /> <input onclick='buttons(this.value)' type='button' value='t' /> <input onclick='buttons(this.value)' type='button' value='u' /> <input onclick='buttons(this.value)' type='button' value='v' /> <input onclick='buttons(this.value)' type='button' value='w' /> <input onclick='buttons(this.value)' type='button' value='x' /> <input onclick='buttons(this.value)' type='button' value='z' /> <input onclick='buttons(this.value)' type='button' value='đ' /> <input onclick='buttons(this.value)' type='button' value='₫' /> <input onclick='removeChars()'  type='button' value='_<' />  </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='a' /> <input onclick='buttons(this.value)' type='button' value='â' /> <input onclick='buttons(this.value)' type='button' value='ă' /> <input onclick='buttons(this.value)' type='button' value='e' /> <input onclick='buttons(this.value)' type='button' value='ê' /> <input onclick='buttons(this.value)' type='button' value='i' /> <input onclick='buttons(this.value)' type='button' value='o' /> <input onclick='buttons(this.value)' type='button' value='ô' /> <input onclick='buttons(this.value)' type='button' value='ơ' /> <input onclick='buttons(this.value)' type='button' value='u' /> <input onclick='buttons(this.value)' type='button' value='ư' /> <input onclick='buttons(this.value)' type='button' value='y' /> </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='á' /> <input onclick='buttons(this.value)' type='button' value='ấ' /> <input onclick='buttons(this.value)' type='button' value='ắ' /> <input onclick='buttons(this.value)' type='button' value='é' /> <input onclick='buttons(this.value)' type='button' value='ế' /> <input onclick='buttons(this.value)' type='button' value='í' /> <input onclick='buttons(this.value)' type='button' value='ó' /> <input onclick='buttons(this.value)' type='button' value='ố' /> <input onclick='buttons(this.value)' type='button' value='ớ' /> <input onclick='buttons(this.value)' type='button' value='ú' /> <input onclick='buttons(this.value)' type='button' value='ứ' /> <input onclick='buttons(this.value)' type='button' value='ý' /> </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='à' /> <input onclick='buttons(this.value)' type='button' value='ầ' /> <input onclick='buttons(this.value)' type='button' value='ằ' /> <input onclick='buttons(this.value)' type='button' value='è' /> <input onclick='buttons(this.value)' type='button' value='ề' /> <input onclick='buttons(this.value)' type='button' value='ì' /> <input onclick='buttons(this.value)' type='button' value='ò' /> <input onclick='buttons(this.value)' type='button' value='ờ' /> <input onclick='buttons(this.value)' type='button' value='ồ' /> <input onclick='buttons(this.value)' type='button' value='ù' /> <input onclick='buttons(this.value)' type='button' value='ừ' /> <input onclick='buttons(this.value)' type='button' value='ỳ' /> </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='ả' /> <input onclick='buttons(this.value)' type='button' value='ẩ' /> <input onclick='buttons(this.value)' type='button' value='ẳ' /> <input onclick='buttons(this.value)' type='button' value='ẻ' /> <input onclick='buttons(this.value)' type='button' value='ể' /> <input onclick='buttons(this.value)' type='button' value='ỉ' /> <input onclick='buttons(this.value)' type='button' value='ỏ' /> <input onclick='buttons(this.value)' type='button' value='ổ' /> <input onclick='buttons(this.value)' type='button' value='ở' /> <input onclick='buttons(this.value)' type='button' value='ủ' /> <input onclick='buttons(this.value)' type='button' value='ử' /> <input onclick='buttons(this.value)' type='button' value='ỷ' /> </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='ã' /> <input onclick='buttons(this.value)' type='button' value='ẫ' /> <input onclick='buttons(this.value)' type='button' value='ẵ' /> <input onclick='buttons(this.value)' type='button' value='ẽ' /> <input onclick='buttons(this.value)' type='button' value='ễ' /> <input onclick='buttons(this.value)' type='button' value='ĩ' /> <input onclick='buttons(this.value)' type='button' value='õ' /> <input onclick='buttons(this.value)' type='button' value='ỗ' /> <input onclick='buttons(this.value)' type='button' value='ỡ' /> <input onclick='buttons(this.value)' type='button' value='ũ' /> <input onclick='buttons(this.value)' type='button' value='ữ' /> <input onclick='buttons(this.value)' type='button' value='ỹ' /> </td> </tr> <tr> <td> <input onclick='buttons(this.value)' type='button' value='ạ' /> <input onclick='buttons(this.value)' type='button' value='ậ' /> <input onclick='buttons(this.value)' type='button' value='ặ' /> <input onclick='buttons(this.value)' type='button' value='ẹ' /> <input onclick='buttons(this.value)' type='button' value='ệ' /> <input onclick='buttons(this.value)' type='button' value='ị' /> <input onclick='buttons(this.value)' type='button' value='ọ' /> <input onclick='buttons(this.value)' type='button' value='ộ' /> <input onclick='buttons(this.value)' type='button' value='ợ' /> <input onclick='buttons(this.value)' type='button' value='ụ' /> <input onclick='buttons(this.value)' type='button' value='ự' /> <input onclick='buttons(this.value)' type='button' value='ỵ' /> </td> </tr> </tbody> </table></label>";

	document.body.appendChild(area);
	var todocss = document.getElementById("pollo");
	todocss.style.position = "fixed";
	todocss.style.bottom = "1px";
	todocss.style.left = "1px";
	todocss.style.backgroundColor = "black";
	//-----append script and function
	//------------------------------------------------------

	var areb = document.createElement("script");
	var myattrib5 = 'type';
	var newVal5 = "text/javascript";
	areb.setAttribute(myattrib5, newVal5);

	areb.innerHTML = "function getcode() {\n var doco = document.getElementById('disp').value; var holds = doco.length; if (holds < 2) {\n firststrings();\n};\n if (holds >= 2 && holds < 3) {\n secondstrings();\n};\n if (holds >= 3 && holds < 4) {\n thirdstrings();\n };\n if (holds >= 4) {\n fourthstrings();\n }\n }\n function firststrings() {\n var strings = document.getElementById('disp').value;\n if (isNaN(strings) == true) {\n uppersB();\n }\n }\n function secondstrings() {\n var keyBox2 = new Array('1a', '2a', '3a', '4a', '5a', '6a', '7a', '9d', '1e', '2e', '3e', '4e', '5e', '6e', '1i', '2i', '3i', '4i', '5i', '1o', '2o', '3o', '4o', '5o', '6o', '7o', '1u', '2u', '3u', '4u', '5u', '7u', '1y', '2y', '3y', '4y', '5y');\n var charBox2 = new Array('á', 'à', 'ả', 'ã', 'ạ', 'â', 'ă', 'đ', 'é', 'è', 'ẻ', 'ẽ', 'ẹ', 'ê', 'í', 'ì', 'ỉ', 'ĩ', 'ị', 'ó', 'ò', 'ỏ', 'õ', 'ọ', 'ô', 'ơ', 'ú', 'ù', 'ủ', 'ũ', 'ụ', 'ư', 'ý', 'ỳ', 'ỷ', 'ỹ', 'ỵ');\n var qold, defer, leavy;\n var stringText = document.getElementById('disp').value;\n var qold = stringText.substring(stringText.length - 2);\n if (qold.slice(0, 1) == 8) {\n if (isNaN(qold.slice(1)) == true) {\n defer = true;\n var newString = stringText.slice(-2);\n var newstri = newString.slice(-1);\n document.getElementById('disp').value = newstri;\n uppersB();\n }\n } else {\n defer = false;\n }\n if (keyBox2.indexOf(qold) > -1) {\n var newString = stringText.substring(0, stringText.length - 2);\n var indexkey2 = keyBox2.indexOf(qold);\n var althat = charBox2[indexkey2];\n if (althat != undefined) {\n document.getElementById('disp').value = newString + althat;\n buttons();\n if (defer == true) {\n uppersB();\n };\n}\n}\n}\n function thirdstrings() {\n var keyBox = new Array('61a', '62a', '63a', '64a', '65a', '71a', '72a', '73a', '74a', '75a', '61e', '62e', '63e', '64e', '65e', '61o', '62o', '63o', '64o', '65o', '71o', '72o', '73o', '74o', '75o', '71u', '72u', '73u', '74u', '75u');\n var keyBox2 = new Array('1a', '2a', '3a', '4a', '5a', '6a', '7a', '9d', '1e', '2e', '3e', '4e', '5e', '6e', '1i', '2i', '3i', '4i', '5i', '1o', '2o', '3o', '4o', '5o', '6o', '7o', '1u', '2u', '3u', '4u', '5u', '7u', '1y', '2y', '3y', '4y', '5y');\n var charBox = new Array('ấ', 'ầ', 'ẩ', 'ẫ', 'ậ', 'ắ', 'ằ', 'ẳ', 'ẵ', 'ặ', 'ế', 'ề', 'ể', 'ễ', 'ệ', 'ố', 'ồ', 'ổ', 'ỗ', 'ộ', 'ớ', 'ờ', 'ở', 'ỡ', 'ợ', 'ứ', 'ừ', 'ử', 'ữ', 'ự');\n var charBox2 = new Array('á', 'à', 'ả', 'ã', 'ạ', 'â', 'ă', 'đ', 'é', 'è', 'ẻ', 'ẽ', 'ẹ', 'ê', 'í', 'ì', 'ỉ', 'ĩ', 'ị', 'ó', 'ò', 'ỏ', 'õ', 'ọ', 'ô', 'ơ', 'ú', 'ù', 'ủ', 'ũ', 'ụ', 'ư', 'ý', 'ỳ', 'ỷ', 'ỹ', 'ỵ');\n var pold, heavy, qold, defer, leavy;\n var stringText = document.getElementById('disp').value;\n var pold = stringText.substring(stringText.length - 3);\n if (keyBox.indexOf(pold) > -1) {\n var newStr = stringText.substring(0, stringText.length - 3);\n var indexkey = keyBox.indexOf(pold);\n var asthat = charBox[indexkey];\n document.getElementById('disp').value = newStr + asthat;\n } else {\n if (pold.slice(0, 1) == 8) {\n defer = true;\nleavy = 3;\n qold = pold.slice(1);\n} else {\n leavy = 2;\n defer = false; qold = pold.slice(1);\n }\n if (keyBox2.indexOf(qold) > -1) {\n var newString = stringText.substring(0, stringText.length - leavy);\n if (leavy == 3) {\n newString.slice(1);\n }\n var indexkey2 = keyBox2.indexOf(qold);\n var althat = charBox2[indexkey2];\n if (althat != undefined) {\n document.getElementById('disp').value = newString + althat;\n if (defer == true) {\n uppersB();\n };\n }\n };\n };\n }\n function fourthstrings() {\n var keyBox = new Array('61a', '62a', '63a', '64a', '65a', '71a', '72a', '73a', '74a', '75a', '61e', '62e', '63e', '64e', '65e', '61o', '62o', '63o', '64o', '65o', '71o', '72o', '73o', '74o', '75o', '71u', '72u', '73u', '74u', '75u');\n var keyBox2 = new Array('1a', '2a', '3a', '4a', '5a', '6a', '7a', '9d', '1e', '2e', '3e', '4e', '5e', '6e', '1i', '2i', '3i', '4i', '5i', '1o', '2o', '3o', '4o', '5o', '6o', '7o', '1u', '2u', '3u', '4u', '5u', '7u', '1y', '2y', '3y', '4y', '5y');\n var charBox = new Array('ấ', 'ầ', 'ẩ', 'ẫ', 'ậ', 'ắ', 'ằ', 'ẳ', 'ẵ', 'ặ', 'ế', 'ề', 'ể', 'ễ', 'ệ', 'ố', 'ồ', 'ổ', 'ỗ', 'ộ', 'ớ', 'ờ', 'ở', 'ỡ', 'ợ', 'ứ', 'ừ', 'ử', 'ữ', 'ự');\n var charBox2 = new Array('á', 'à', 'ả', 'ã', 'ạ', 'â', 'ă', 'đ', 'é', 'è', 'ẻ', 'ẽ', 'ẹ', 'ê', 'í', 'ì', 'ỉ', 'ĩ', 'ị', 'ó', 'ò', 'ỏ', 'õ', 'ọ', 'ô', 'ơ', 'ú', 'ù', 'ủ', 'ũ', 'ụ', 'ư', 'ý', 'ỳ', 'ỷ', 'ỹ', 'ỵ');\n var pold, heavy, qold, defer, leavy;\n var stringText = document.getElementById('disp').value;\n var hold = stringText.substring(stringText.length - 4);\n if (hold.slice(0, 1) == 8) {\n defer = true;\n heavy = 4;\n pold = hold.slice(1);\n } else {\n heavy = 3;\n defer = false;\n pold = hold.slice(1);\n }\n if (keyBox.indexOf(pold) > -1) {\n var newStr = stringText.substring(0, stringText.length - heavy);\n if (heavy == 4) {\n newStr.slice(1);\n}\n var indexkey = keyBox.indexOf(pold);\n var asthat = charBox[indexkey];\n document.getElementById('disp').value = newStr + asthat;\n if (defer == true) {\n uppersB();\n };\n } else {\n if (pold.slice(0, 1) == 8) {\n defer = true;\n leavy = 3;\n qold = pold.slice(1);\n } else {\n leavy = 2;\ndefer = false;\n qold = pold.slice(1);\n}\n if (keyBox2.indexOf(qold) > -1) {\n var newString = stringText.substring(0, stringText.length - leavy);\n if (leavy == 3) {\n newString.slice(1);\n }\n var indexkey2 = keyBox2.indexOf(qold);\n var althat = charBox2[indexkey2];\n if (althat != undefined) {\n document.getElementById('disp').value = newString + althat;\n if (defer == true) {\n uppersB();\n };\n }\n };\n };\n }\n function buttons(as) { var currentstring = document.getElementById('disp'); (as != undefined) ? as = as : as = ''; describe = currentstring.value + as; currentstring.value = describe; var doco = currentstring.value; var holds = doco.length; if (holds < 2){ firststrings()}; };\n function uppersB() {\n var currentstri = document.getElementById('disp').value;\n var newChar = currentstri.charAt(currentstri.length - 1)\n var upstart = newChar.toUpperCase();\n var newStrings = currentstri.slice(0, -1) + upstart;\n document.getElementById('disp').value = newStrings;\n }\n function removeChars() {\n var currents = document.getElementById('disp').value;\n document.getElementById('disp').value = currents.substr(0, currents.length - 1);\n }\n";
		document.body.appendChild(areb);

}

meload();

