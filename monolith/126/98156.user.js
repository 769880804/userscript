// ==UserScript==
// @name        rr2t
// @namespace   http://www.renren.com/igrass
// @version     1.0.0
// @copyright   2011+, zac
// @author      zac
// @include     http://renren.com/*
// @include     http://*.renren.com/*
// @exclude     http://*.renren.com/ajaxproxy*
// @exclude     http://wpi.renren.com/*
// @exclude     http://dj.renren.com/*
// @description Add a ignore list for renren.com(人人网).
// @homepage    http://www.renren.com/igrass
// @run-at      document-start
// ==/UserScript==


var version="1.0.0";if(!GM_setValue){function GM_setValue(b,d){localStorage.setItem(b,d)}}if(!GM_getValue){function GM_getValue(d,e){var b=localStorage.getItem(d);if(b=="false"){b=false}if(!b&&b!==false){return e}return b}}if(!GM_addStyle){function GM_addStyle(b){var d=document.createElement("style");d.type="text/css";d.innerHTML="/* <![CDATA[ */\n"+b+"\n/* ]]> */";document.getElementsByTagName("head")[0].appendChild(d)}}if(!GM_xmlhttpRequest){function GM_xmlhttpRequest(f,b,e){window[e]=f.onload;f.url+="&"+b+"="+e;var d=document.createElement("script");d.type="text/javascript";d.src=f.url;document.body.appendChild(d)}}function $(b){return document.getElementById(b)}function n(b){return document.getElementsByName(b)}function create(b){return document.createElement(b)}function createText(b){return document.createTextNode(b)}function c(b,d){return(d||document).getElementsByClassName(b)}function t(b,d){return(d||document).getElementsByTagName(b)}function x(d,f,e,b){return document.evaluate(d,f||document,null,e||7,b)}function remove(d){if(d.snapshotItem){for(var b=0;b<d.snapshotLength;b++){remove(d.snapshotItem(b))}}else{if(d[0]){while(d[0]){remove(d[0])}}else{d.parentNode.removeChild(d)}}}function append(f,d,e){if(f.snapshotItem){for(var b=0;b<f.snapshotLength;b++){append(f.snapshotItem(b),d,e)}}else{if(f[0]){for(var b=0;b<f.length;b++){append(f[b],d,e)}}else{if(e&&d.firstChild){d.insertBefore(f,d.firstChild)}else{d.appendChild(f)}}}}function clear(b){while(b.firstChild){remove(b.firstChild)}}function before(d,b){b.parentNode.insertBefore(d,b)}function after(d,b){b.nextSibling?before(d,b.nextSibling):append(d,b.parentNode)}function prev(b){var d=b.previousSibling;if(d){if(d.tagName){return d}return prev(d)}}function next(b){var d=b.nextSibling;if(d){if(d.tagName){return d}return next(d)}}function gm(b,d){return GM_getValue(b,d)}function getTld(e){var d=e.split(".");if(d.length<3){return e}var f=["aero","asia","cat","coop","int","com","net","org","gov","edu","biz","info","name","jobs","mil","mobi","museum","pro","tel","travel"];var b=d[d.length-2]+"."+d[d.length-1];if(f.hasGot(d[d.length-2])){b=d[d.length-3]+"."+b}return b}Array.prototype.hasGot=function(d){for(var b=0;b<this.length;b++){if(this[b]==d){return true}}return false};var renren={me:"",unconcernedListConfig:"rr2t-unconcernedList",getConfig:function(){if(""==this.me){var b=x('//div[@class="site-menu-user-info"]/p[@class="name-and-icons"]/a[@class="name"]');if(b.snapshotLength>0){alert(b.snapshotLength);a=b.snapshotItem(0);tmp=a.getAttribute("href");p=tmp.indexOf("id=");this.me=tmp.substring(p+3);alert(this.me)}}return this.me+this.unconcernedListConfig},getPid:function(b){pos=b.indexOf("(");return b.substring(0,pos)},clearUnconcernedList:function(){return GM_setValue(this.unconcernedListConfig,"")},getUnconcernedList:function(){str=gm(this.unconcernedListConfig,"");if(""!=str){return str.split(",")}else{return new Array()}},setUnconcernedList:function(b){return GM_setValue(this.unconcernedListConfig,b.toString())},addUnconcernedId:function(b,e){var f=b+"("+e+")";var d=this.getUnconcernedList();for(i=0;i<d.length;++i){if(0==d[i].indexOf(b)){return}}d.push(f);return this.setUnconcernedList(d)},delUnconcernedId:function(b){tmp=this.getUnconcernedList();for(i=0;i<tmp.length;++i){if(0==tmp[i].indexOf(b)){tmp.splice(i,1);return this.setUnconcernedList(tmp)}}},getResultsByCondition:function(d){var b="//td[@class='f' or starts-with(@class, 'f ')]/../../../self::*##cond##|//table[@id>0]##cond##";if(d){return x(b.replace(/##cond##/g,"["+d+"]"))}else{return x(b.replace(/##cond##/g,""))}},resultCnt:function(){return this.getResultsByCondition(false).snapshotLength},related:function(){return $("rs")},info:function(){return $("tool")},sideBarContainer:function(){var b;if((b=c("r"))&&b[0]){return b[0].parentNode}},sideBar:function(){var b;if(b=this.get("sideBarContainer")){return b.parentNode.parentNode.parentNode.parentNode}},msg2:function(b){return x("//a[@namecard="+b+"]/../..")},msg:function(b){return x("//figure[@data-id="+b+"]/../..")},promotions:function(){return x("//a[text()='推广']/../../../../..")},sponsors:function(){return x("//td[starts-with(@id, 'taw')]/ancestor::table")},brands:function(){return x("//a[text()='品牌推广']/ancestor::table[1]")},keyword:function(){return n("wd")[0].value},tip:function(){return x("//div[@id='wrapper']/p[starts-with(@style, 'margin:')]")},body:function(){return document.body},service:function(){return x("//div[@id='wrapper']/div[starts-with(@style, 'background:')]")},pagination:function(){return c("p")[0]},get:function(name,refresh){var ret;var code="      if (this._name == null || refresh) {        this._name = this.name();      }      ret = this._name;    ";eval(code.replace(/name/g,name));return ret}};var image={loading:"data:image/gif;base64,R0lGODlhIgAiAPQAADk5OVJSUlpaWmtra3t7e4SEhIyMjJSUlJycnKWlpa2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAgFAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAIgAiAAAFhiAljmRJLYmprqx4AG1cBgb5yjjVCDacxxKBYnT7lQoI0mBA9BlHEOToIYC4nE9RNCUa1CjFLLTAdQQmYKyYshUJkodAVhFBQwkpB2OtSygYEVMFVnwjDSh0hSwSDX6EiioOj5CUJRIPEJiamJATERESn6CflaWmp6ipqqusra6vsLGys6ohACH5BAgFAAAALAAAAAAiACIAhCEhISkpKVpaWmNjY2tra3Nzc4SEhIyMjJSUlKWlpa2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWTICWOZElJiqmuZkMqAiurUPHG4wNEM2ukIsWAJAj0SBPSwzASjiQA15HyUCRFEoPUKSIApqNF4kpBALkUwAIctoqWSW4BQGYv3BTDmhs4sEsKQAx%2BCjYJABBTDg91EwprKCQJBGwQixIjjg5%2FLBAPDhF1nCwRDw%2BJoz0SmKmtrq%2BwsbKztLW2t7i5uru8vb6%2FwL4hACH5BAgFAAAALAAAAAAiACIAhCEhISkpKTk5OUJCQkpKSlJSUlpaWmNjY3Nzc4SEhIyMjJSUlJycnK2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWT4CWOZCk6ZqqaFAkha5xSjJuQiiHHTTRCt1FBsltNGj%2BYaKEriiQTUoXRugBHB%2BSoEpBFoiMHRPQSPQqVEQUg2H3VNWswobxMAIOiBTrqXR43FQU%2BdnhOFxZvFxFIEAsXDE0SAASHIntRFYRmPpMFliOJVSkAn6BOQaeqq6ytrq%2BwsbKztLW2t7i5uru8vb6%2FwIchACH5BAgFAAAALAAAAAAiACIAhCEhIUJCQlJSUlpaWnNzc4SEhIyMjJSUlJycnKWlpa2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWVICWOZCk2Zqqu4qOwcDk55JOQShGvTzS6JMNrl3o8frdWwUc0TR6T1pCCMJAag2YL0kpKCtyTYEqUHClASm6kGBy0I4fPJiqcGQOyFnKEvBYFUW0IcCQTTCIONHiEJBIMhSUSAo0iDAEAABKRJEwSCpkBBJwmDgKZBIikJAUBOquwsbKztLW2t7i5uru8vb6%2FwMHCsCEAIfkECAUAAAAsAAAAACIAIgCEISEhKSkpQkJCWlpaY2Nja2tre3t7hISEjIyMlJSUnJycra2ttbW1vb29xsbGzs7O1tbW3t7e5%2Bfn7%2B%2Fv9%2Ff3%2F%2F%2F%2FAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYlgJY5kKU5mqq7nw76vBJGRAt%2FV5I4Ng8OyEWUh%2Bb0mM5FjQaIcjKWgSFE8GRJQkk70YJ4O2OxISrXaxKNJpNKlVCSHM7oUcbzjpQdhPsKfHAMDT3wVDVwGgQluhCIQBAMFcowiDAlrk5g4CZucnIt8AgEAogClAAiZqaqrrK2ur7CxsrO0tbavIQAh%2BQQIBQAAACwAAAAAIgAiAIQhISEpKSlKSkpra2t7e3uEhISMjIyUlJScnJylpaWtra21tbW9vb3GxsbOzs7W1tbe3t7n5%2Bfv7%2B%2F39%2Ff%2F%2F%2F8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFjCAljmRpnmiqriwbPW1cOpJsS7AtQxA5KbqUYzL6LYInSI4iURyRpkeN6YSaIg6RJMGwmiTEZte3tHJJkAOh4BVlmY8CIVH2QhCFArBdYiQafIE6BwaFBgSIBGNehAYIj48Lb4KUIgkElSQKAAADPZkUCgEAAgagFAwCnAOnEQsARKeys7S1tre4uYEhACH5BAgFAAAALAAAAAAiACIAhCEhIUJCQkpKSlJSUlpaWmNjY2tra4yMjJSUlJycnK2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWEICWOZGmeaKqubOu%2BcCzP6EOvk2Pf6PRAvN4vePIBiSVjMkIcjiILRYIoEU0gUsaRGGEkFI4JcvRg7MboVYOxbrjd1WDiQK%2FTGen8ArFNPwoDBVNoYhQPCQQDCExBCgANIzmJBkQEAA4lEINBlph5IgMAZ3mhfWkCAKZoAQCfrq%2BwsS8hACH5BAgFAAAALAAAAAAiACIAhCEhIUJCQkpKSlJSUlpaWnNzc4SEhIyMjJSUlJycnKWlpa2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWCYCWOZGmeaKqubOu%2BcCzPdG3feK7T1D5SkcfDN4E8IhId0Jj0SZC%2BaCoCqVqrucVCse0qHNLdgxGuPAwFxoQoghgMCUhOMmiMIgjDYVEzgBMDfCMTDQY1AQMiCQR2OggAaxWLgjkAlAuBOgUAJIAIcwCNIgsEOgIBZZuRUqFlPWUsIQAh%2BQQIBQAAACwAAAAAIgAiAIQxMTFSUlJaWlpjY2Nzc3OEhISMjIyUlJScnJylpaWtra21tbW9vb3GxsbOzs7W1tbe3t7n5%2Bfv7%2B%2F39%2Ff%2F%2F%2F8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgSAljmRpnmiqrmzrvnAsz3Rt33iu73zv%2F8DgSRIhGosTHOTBbDIjwhvEAYQkFI2kD6JIMCA5BwEqiiwU2BqDmiiARxKrLHCgHAQiRIFsA9QlAVQUenw0fiIFBCN6En11FA4BfAgEWjOHIgMIJHo1mHYCljefFIE6pAZ4OaQ8B28uIQAh%2BQQIBQAAACwAAAAAIgAiAIQhISEpKSlCQkJSUlJaWlpjY2Nra2tzc3N7e3uEhISMjIyUlJScnJylpaWtra21tbW9vb3GxsbW1tbe3t7n5%2Bfv7%2B%2F39%2Ff%2F%2F%2F8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFkOAljmRpnmiqrmzrvnAsz3Rt33iu73zv%2F8CgcEgcVShAS0QyqfwskigSR2k4RRaKJDJtRRqkyOQCcXSxkhfgcHEg2gpR%2BSqDAJAOw2WSmEKsMwIDInkiCg4jfxYxEwAPhAUiDwmLkg6VLgwBIw6RIglpIw9gamyQnAk1diSdIxYJYzMBnoQEJAsLOg62T4gvIQAh%2BQQIBQAAACwAAAAAIgAiAIQhISFaWlpjY2Nzc3N7e3uEhISMjIycnJylpaWtra21tbW9vb3GxsbOzs7W1tbe3t7n5%2Bfv7%2B%2F39%2Ff%2F%2F%2F8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFkeAkjmRpnmiqrmzrvnAsz3Rt33iu73zv%2F8CgcEgs2hpAAiCCkjQkM6Vi4kiQHJDJw8GEDQDWycAwSSwmjKm20W19DyJIAHmYPhLdbVv1Hi0CIgdnZQ4jD2wrXwgkAXATCGoNYSJ6KgCOIg0BUBOCIwhZhkgvAgWfkwyTMhEBg2WuEqA0miQIqgqjOAquPQy5LSEAIfkECAUAAAAsAAAAACIAIgCEISEhMTExOTk5SkpKWlpaY2Nja2trc3Nze3t7hISEjIyMnJycra2ttbW1vb29xsbGzs7O1tbW3t7e5%2Bfn7%2B%2Fv9%2Ff3%2F%2F%2F%2FAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABY%2BgJY5kaZ5oqq5s675wLM90bd94ru987%2F%2FAoHCIexgWPUQAIHjoJgYAoAARVXADaeMqigwit2ZJQkhYJNURhTuTDMyWRMPiAEvAs0m5m7gywBURbC8TAwgjC0gWDXgREzEUBAdqCXh%2FIhNpL5IkEHCLeBYRFDYJDCOXInc1EocjjJ2DMAqnqKFntzapPoIwIQAh%2BQQIBQAAACwAAAAAIgAiAIQ5OTlSUlJaWlpra2t7e3uEhISMjIyUlJScnJylpaWtra29vb3GxsbOzs7W1tbe3t7n5%2Bfv7%2B%2F39%2Ff%2F%2F%2F8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFguAkjmRpnmiqrmzrvnAsz3Rt33iu73zv%2F0DYAUAsEgO4xWHJZAaDEsSi9zAEBI7dYRAYNEQPnEEgIGRFiYLkJmhESOnsI6xLEOiK7%2BNtQxToDwkiDhB9fyMKDGCFNH50ExAKfA58M4cjCwojlDoSeZuMOBCCIw%2BhN4kknD%2BrPhGVLSEAIfkECAUAAAAsAAAAACIAIgCEISEhKSkpQkJCWlpaY2Nja2trc3Nze3t7hISEjIyMlJSUpaWlra2ttbW1vb29xsbG1tbW3t7e5%2Bfn7%2B%2Fv9%2Ff3%2F%2F%2F%2FAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYRgJY5kaZ5oqq5s675wLM90bd94HgMOpZcEAAAB%2BZEMAYDAYRw9BkJmszI5LKY%2FCmPL5eIYA4K4QC4ksOhRhCH9NRIIRUQ3YSAQDIloflPciyMODDhyJYJ6FBM%2FDguKFRB6OQ0MjhMPOow%2Be3w3k5oVFBCONwyfFRKAUw%2BRTaFoq2mxNyEAIfkECAUAAAAsAAAAACIAIgCEISEhWlpaY2Njc3Nze3t7hISEjIyMnJycpaWlra2ttbW1vb29xsbGzs7O1tbW3t7e5%2Bfn7%2B%2Fv9%2Ff3%2F%2F%2F%2FAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYLgJI5kaZ5oqq5s675wLJPAMLdIfbOHvqsK3w%2B1ABCGokakFBQgAwFBgxRkIBcF6AIiWiJFEoMgMHB8TQ1D4swmOQ4IBFyOWA8bi8RCwc8v2oApDwxmbQ0JCQpcXxIMdQ5eEkiICYsiD4U%2FSiWYXm2dgaCAmJKjkIETDpaorK2ur4AhACH5BAgFAAAALAAAAAAiACIAhCEhITExMTk5OVJSUlpaWmNjY2tra3Nzc3t7e4SEhIyMjJycnKWlpa2trbW1tb29vcbGxs7OztbW1t7e3ufn5%2B%2Fv7%2Ff39%2F%2F%2F%2FwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWM4CWOZGmeaKqurDCw8PkAVWyPgHGrRD06gF3qMKCMKgCEEHUgGEWFwBKFKIoggMj0VJ2IArqpwktKDCQXiGLLSCQivkuCYNmSGu4FOm03QdoJZH0mFQ5ag4gnEg4ODYyODQ%2BDFhKVlpaJmTAWFHGJFJaefRMSEROidqQRdZoXEqytsbKztLW2t7i5tCEAOw%3D%3D"};var logo='<span class="rr2t-logo"><span class="rr2t-logo-r">r</span><span class="rr2t-logo-r">r</span><span class="rr2t-logo-2">2</span><span class="rr2t-logo-t">t</span></span>';var shadow={_getInst:function(){if(!this._created){this._addCss();var d=create("div");d.id="rr2t-shadow";var b=this;d.addEventListener("click",function(){b.hide()},false);append(d,renren.get("body"));this._inst=d;this._created=true}return this._inst},_addCss:function(){GM_addStyle("#rr2t-shadow {      background: #000;      opacity: .5;      position: fixed;      z-index: 1000;      top: 0;      left: 0;    }")},setBox:function(b){this._box=b;return this},getBox:function(){if(this._box){return this._box}var b={message:"box has not been set"};throw b},show:function(){this._getInst().style.display=this.getBox().style.display="block";this._inst.style.width=screen.availWidth+"px";this._inst.style.height=screen.availHeight+"px";this.getBox().style.top=document.documentElement.clientHeight/2-this.getBox().clientHeight/2+"px";this.getBox().style.left=document.documentElement.clientWidth/2-this.getBox().clientWidth/2+"px";return this},hide:function(){this._getInst().style.display=this.getBox().style.display="none";return this}};var util={notice:function(b){var d=create("div");d.className="rr2t-notice";d.innerHTML=b;if(!this.noticeCss){this.noticeCss="        .rr2t-notice {          text-align: center;          background: #dfd;          border: 1px solid #cec;          -moz-border-radius: 10px;          border-radius: 10px;          padding: 10px;          margin: 0 10px 10px;          color: #090;          width: 539px;        }      ";GM_addStyle(this.noticeCss)}after(d,renren.get("sideBar"))},firstRun:true,createSidePanel:function(e){if(!renren.sideBar2){return}var b=e.title;var d=renren.get("sideBar2");var g=create("div");g.className="rr2t-sidePanel";e.body=g;var f=create("h3");e.header=f;append(createText(b),f);append(f,g);append(g,d,true);if(this.firstRun){GM_addStyle("        .rr2t-sidePanel {          width: 300px;          margin-bottom: 10px;          border: 1px solid #EFF2FA;          -moz-box-shadow: 1px 1px 1px #ddd;          -webkit-box-shadow: 1px 1px 1px #ddd;          box-shadow: 1px 1px 1px #ddd;          font-size: 10pt;        }        .rr2t-sidePanel > h3 {          background: #EFF2FA;          margin: 0;          padding: 5px;          font-size: 11pt;        }        .rr2t-no-content-msg {          text-align: center        }      ");this.firstRun=false}return g},createLoadingImage:function(){var img=create("img");with(img){alt="loading";src=image.loading}return img}};var modules={unconcernedCleaner:{name:"移除不被关注的",cid:0,config:"rr2t-removeUnconcerned",enable:function(){return gm(this.config,true)},run2:function(){if(renren.msg("231113064").snapshotLength>0){remove(renren.msg("231113064"))}},getAddFunction:function(b,d){return function(){renren.addUnconcernedId(b,d)}},run:function(){tmp=x('//article[@class="a-feed"]');if(tmp.snapshotLength>0){for(var b=0;b<tmp.snapshotLength;b++){one=tmp.snapshotItem(b);id=one.getAttribute("id");child=x(".//aside/figure[@data-id]",$(id));pid=child.snapshotItem(0).getAttribute("data-id");pname=child.snapshotItem(0).getAttribute("data-name");lis=x('.//menu[@class="feed-dropmenu"]/menu/li',$(id));if(lis.snapshotLength>=3){continue}a=x('.//a[@class="delete"]',$(id)).snapshotItem(0);if(a==null){continue}a.addEventListener("click",this.getAddFunction(pid,pname),false)}}var d=renren.getUnconcernedList();for(b=0;b<d.length;++b){if(renren.msg(renren.getPid(d[b])).snapshotLength>0){remove(renren.msg(renren.getPid(d[b])))}}}}};var initSteps={config:{groups:[{title:"功能",color:"#fdd"},{title:"名单",color:"#ddd"},{title:"关于",color:"#dff"}],btn:function(){if(!this._btn){this._btn=create("div");with(this._btn){className="menu";innerHTML=logo;innerHTML='<div class="menu-title"><a id="global_inbox_link" accesskey="9" stats="Hd_msg" href="javascript:;"><span>rr2t</span></a></div>';addEventListener("click",function(){shadow.setBox(initSteps.config.panel()).show();initSteps.config.about();initSteps.config.idList()},false)}}return this._btn},about:function(){if(!this._about){var helpBody=x(".//table[last()]/tbody[1]",this.options()).snapshotItem(0);var p=create("p");this._about=p;with(p){innerHTML=logo+'<br /><a target="_blank"  href="http://userscripts.org/scripts/show/98156">  脚本发布页(userscripts.org)</a><br /><a href="mailto:baiqi2piao@qq.com">  联系作者(baiqi2piao)</a>'}var tr=create("tr");append(tr,helpBody,true);var td=create("td");append(td,tr);var td=create("td");append(td,tr);append(p,td)}},getDelFunction:function(b){return function(){renren.delUnconcernedId(b)}},idList:function(){if(!this._idList){var helpBody=x(".//table[last()-1]/tbody[1]",this.options()).snapshotItem(0);var p=create("p");this._idList=p;var btnTr=create("tr");var loadTr=create("tr");var listTr=create("tr");append(btnTr,helpBody);append(loadTr,helpBody);append(listTr,helpBody);var clearA=create("a");with(clearA){innerHTML="清除名单";href="javascript:;";addEventListener("click",function(){renren.clearUnconcernedList()},false)}var loadA=create("a");with(loadA){innerHTML="载入名单";href="javascript:;";addEventListener("click",function(){var idListDiv=$("rr2t-config-idListDiv");idListDiv.innerHTML="";initSteps.config.listTable=create("p");initSteps.config.listTable.style.cssText="							background: #fe8; 		          border: 1px solid #cec; 		          -moz-border-radius: 10px; 		          border-radius: 15px; 		          padding: 10px 20px 10px 20px; 		          margin: 10px 10px 10px 10px;		          color: #090; 		          width:320px; 		          height:200px; 		          overflow-y:auto;";var people=renren.getUnconcernedList();for(i=0;i<people.length;++i){initSteps.config.oneline=create("rr2tidline");append(initSteps.config.oneline,initSteps.config.listTable);var a=create("a");a.href="http://www.renren.com/profile.do?id="+renren.getPid(people[i]);a.target="_blank";a.innerHTML=people[i];append(a,initSteps.config.oneline);var a=create("a");with(a){href="javascript:;";innerHTML="删除";style.cssText="float: right;";var pid=people[i];addEventListener("click",initSteps.config.getDelFunction(renren.getPid(pid)),false)}append(a,initSteps.config.oneline);var br=create("br");append(br,initSteps.config.oneline)}append(initSteps.config.listTable,idListDiv)},false)}var listDiv=create("div");listDiv.id="rr2t-config-idListDiv";var p=create("p");append(p,listDiv);p.innerHTML="请点击载入名单载入";var td=create("td");append(td,btnTr);append(clearA,td);var td=create("td");append(td,loadTr);append(loadA,td);var td=create("td");append(td,listTr);append(listDiv,td)}},panel:function(){if(!this._panel){this._panel=create("div");this._panel.id="rr2t-panel";append(this._panel,renren.get("body"));var d=create("form");d.id="rr2t-config-form";append(d,this._panel);var b="#rr2t-panel {          width: 420px;          height: 420px;          border: 1px solid #ccf;          background: #fff;          position: fixed;          z-index: 2000;          -moz-border-radius: 10px;          -webkit-border-radius: 10px;          border-radius: 10px;          padding: 20px;        }        #rr2t-config-form > div {          height: 350px; clear: both; padding: 10px;          -moz-box-shadow: 1px 1px 1px #aaa;          -webkit-box-shadow: 1px 1px 1px #aaa;          box-shadow: 1px 1px 1px #aaa;        }        #rr2t-config-form ul {          list-style: none; font-size: 9pt; margin: 0; padding: 0;        }        #rr2t-config-form li {          float: left;        }        #rr2t-config-form li a {          text-decoration: none; color: #666; text-align: center; width: 50px;          display: block; padding:4px;          -moz-border-radius: 4px 4px 0 0;          border-radius: 4px 4px 0 0;        }        .rr2t-config-tab-focus {          color: #000 !important;          -moz-box-shadow: 1px 0px 0px #aaa;          -webkit-box-shadow: 1px 0px 0px #aaa;          box-shadow: 1px 0px 0px #aaa;          margin-right: 1px;        }        #rr2t-config-form li a:hover,        #rr2t-config-form li a:focus,        .rr2t-config-tab-focus {          font-weight: bold;        }        #rr2t-config-form table {          display: none;        }        .rr2t-config-table-selected {          display: table !important;        }        #rr2t-config-form td {          padding: 3px 0;        }//        #rr2t-config-form td > a {//          color: #0a0; margin: 0 3px;//        }//        #rr2t-config-form td > a:hover {//          color: #0e0; cursor: help;//        }        .rr2t-config-help td > a {          color: #0a0; margin: 0 3px;        }        .rr2t-config-help td > a:hover {          color: #0e0; cursor: help;        }        #rr2t-config-form td textarea {          display: block; font-size: 9pt; width:300px; height: 80px;        }        #rr2t-config-form fieldset {          margin: 5px;        }        #rr2t-config-form legend {          font-size: 9pt; color: #666;        }        #rr2t-config-form fieldset p {          margin: 0; font-size: 9pt; color: #333;        }        #rr2t-config-form > button {          float: right; margin: 10px;        }        #rr2t-config-form > p {          font-size:8pt; color: #666;        }        #rr2t-config-form > div > table > tbody > tr > td > p {          font-size:9pt; line-height: 200%;        }        #rr2t-config-form > div > table > tbody > tr > td > p > a {          margin: 0;        }";GM_addStyle(b);append(initSteps.config.tabs(),d);append(initSteps.config.options(),d);append(initSteps.config.closeBtn(),d);append(initSteps.config.tip(),d);initSteps.config.closeBtn().focus()}return this._panel},fieldset:function(){if(!this._fieldset){this._fieldset=create("fieldset");var d=create("legend");d.innerHTML="帮助";append(d,this._fieldset);var b=create("p");append(b,this._fieldset)}return this._fieldset},tip:function(){if(!this._tip){this._tip=create("p");this._tip.innerHTML="如果您不想立刻刷新页面，请点击灰色阴影部分"}return this._tip},selectTab:function(b){if(this._selectedTab){this._selectedTab.className=""}b.className="rr2t-config-tab-focus";this._selectedTab=b},tabs:function(){if(!this._tabs){this._tabs=create("ul");var config=initSteps.config;var groups=config.groups;for(var i=0;i<groups.length;i++){var group=groups[i];var li=create("li");append(li,this._tabs);var a=create("a");append(a,li);with(a){href="javascript:void(0)";innerHTML=group.title;className="rr2t-config-tab";setAttribute("order",i);style.backgroundColor=group.color;addEventListener("click",function(){config.selectTab(this);t("p",config.fieldset())[0].innerHTML="";var options=config.options();var order=this.getAttribute("order");config.selectTable(options.tables[order]);options.style.background=groups[order].color;config.closeBtn().focus()},false)}if(i==0){config.selectTab(a)}}}return this._tabs},selectTable:function(b){if(this._selectedTable){this._selectedTable.className=""}b.className="rr2t-config-table-selected";this._selectedTable=b},options:function(){if(!this._options){this._options=create("div");var b=initSteps.config;var d=b.groups;this._options.style.background=d[0].color;for(var h=0;h<d.length;h++){var m=create("table");append(m,this._options);var j=create("tbody");append(j,m)}for(h in modules){var l=modules[h];var e=l.enable||l.value||l.content;if(l.config&&e){var k=create("tr");append(k,t("tbody",this._options)[l.cid]);if(l.enable){var f=create("td");append(f,k);append(b.createCheckbox(l),f)}if(l.name){var f=create("td");append(f,k);append(b.createLabel(l),f)}if(l.value){append(b.createTextbox(l),k.lastChild)}if(l.help){after(b.createHelpIcon(l),l.label)}if(l.content){var g=create("tr");append(create("td"),g);append(create("td"),g);append(b.createTextarea(l),g.lastChild);after(g,k);g.lastChild.style.padding=0}}}this._options.tables=t("table",this._options);b.selectTable(this._options.tables[0])}return this._options},closeBtn:function(){if(!this._closeBtn){var config=initSteps.config;this._closeBtn=create("button");with(this._closeBtn){innerHTML="刷新页面";type="button";addEventListener("click",function(){location.reload()},false)}}return this._closeBtn},createCheckbox:function(b){b.checkbox=create("input");b.checkbox.type="checkbox";b.checkbox.id=b.config;b.checkbox.checked=b.enable();b.checkbox.addEventListener("change",function(){GM_setValue(b.config,this.checked)},false);if(b.dependsOn){b.checkbox.disabled=!b.dependsOn().checkbox.checked;b.dependsOn().checkbox.addEventListener("change",function(){b.checkbox.checked=b.enable();b.label.style.color=this.checked?"#000":"#999";b.checkbox.disabled=!this.checked},false)}return b.checkbox},createLabel:function(mod){mod.label=create("label");with(mod.label){htmlFor=mod.config;innerHTML=mod.name}if(mod.dependsOn){mod.label.style.color=mod.dependsOn().checkbox.checked?"#000":"#999"}return mod.label},createTextbox:function(mod){mod.textbox=create("input");with(mod.textbox){type="text";value=mod.value();disabled=!mod.enable();addEventListener("blur",function(){GM_setValue(mod.config2,this.value)},false);switch(mod.valueType){case"string":style.width="250px";break;case"number":style.width="40px";break;default:}}mod.checkbox.addEventListener("change",function(){mod.textbox.disabled=!this.checked},false);if(mod.dependsOn){mod.dependsOn().checkbox.addEventListener("change",function(){mod.textbox.disabled=!mod.enable()||mod.checkbox.disabled},false)}return mod.textbox},createTextarea:function(mod){mod.textarea=create("textarea");with(mod.textarea){innerHTML=mod.content();disabled=!mod.enable();mod.checkbox.addEventListener("change",function(){mod.textarea.disabled=!this.checked},false);addEventListener("blur",function(){GM_setValue(mod.config2,this.value)},false)}return mod.textarea},createHelpIcon:function(mod){mod.helpIcon=create("a");with(mod.helpIcon){href="javascript:void(0)";innerHTML="[?]";title="点击显示帮助";addEventListener("click",function(){var content=mod.help;if(mod.dependsOn){content+="<br />依赖于【"+mod.dependsOn().name+"】模块"}t("p",initSteps.config.fieldset())[0].innerHTML=content},false)}return mod.helpIcon},enable:function(){return true},firstRun:true,run:function(){if(c("nav-other").length){if(this.firstRun){append(this.btn(),c("nav-other")[0],true);this.firstRun=false}}}}};var app={run:function(){for(i in modules){var b=modules[i];b.init&&b.init();b.enable()&&b.run()}}};for(i in initSteps){var step=initSteps[i];step.enable()&&step.run()}setInterval(app.run,5000);