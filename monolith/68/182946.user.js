// ==UserScript==
// @name         Grooveshark ComfortZone
// @namespace    http://userscripts.org/scripts/show/182946
// @homepage     https://github.com/frissdiegurke/grooveshark-comfortzone
// @version      0.0.7
// @description  Some improvements for grooveshark.
// @license      CC0 1.0 (Public Domain)
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFCQAABQkBSFsRaQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAKbSURBVDiNZZPNS1RhFMZ/753p486MkwplNYXBHZkoJpUJzQGlhWFhKAwktGojqVQuRAJd+B9Ii9q0cqtOLRqRyEwEVzJREUSgppUVROV8Yd5R7z0t7phfB57N+zzPew6H5yAi7AREq8B4CceW4bCpaR7zwYPH2VDoygxEq/bpt411umN0WYCAJw+nV1pabq3Ozs5KX1+fOJzxEur0LZ8bQKk2Fywn4dt5OLIGrXNwIQUQi10NNjU9f9fVVXUGSv3wqRHySaXaKkVGLQ0A3kw45nM/4f5rWC6CL16AdDq/aRgn3GVlwXW4+w5OpR3tmwkATaloGJYuQ5EJN+fgkAWvT8KjizBqrK6adjx+/fzU1Nc0eDfhznsIZGDpslLRsAa/BsHWoGUedMuZaMMFoo4eXTrd1nbyTDL5PZdIfEo73AEbri06nl+DGqQrwbMO1X/4XxsupRTDw8NksyvakycPfWCpbf5sBnwmpCs1yJVA6d9tcs4Pltbb20sgEKCxsZHycp8PhoPsqmITciVusDSwC7+nD8LTUDgcpqenh4aGBlKpFLZtA28DUGrCtWVHa7rB0tzgy8KPknv3sjU3bjR5PnwIUF9fTz6fp7Ozk8nJSXRdL3R9ZcBvDwSy8NsHxSkgNALI4uKirK2ticfjkenpafH7/RKJRKSjo0Pi8bjMzMxIc3OzOCHbQmikEF1lRyIRicViAsj4+PguodfrlYGBAUkkElJTU1N4VzZEqwoxrhjbaRgaGtrTCenv7xfDMAqRRqBiTEQoJHG+FQIft/aby+XYW5lMhmQyycLCAo52vhXYeUy1fqh4Bu7N7u5u0XV91wQul0va229bSoWeQa1/3zXuuMrqsrLaqWDw0jfQTQfHP0PwBdRV79X/A8k0WV4NuDZeAAAAAElFTkSuQmCC
// @icon64       data:image/png;base64,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
// @updateURL    http://userscripts.org/scripts/source/182946.meta.js
// @downloadURL  http://userscripts.org/scripts/source/182946.user.js
// @match        http://grooveshark.com/*
// @include      http://grooveshark.com/*
// @match        https://grooveshark.com/*
// @include      https://grooveshark.com/*
// @match        http://*.grooveshark.com/*
// @include      http://*.grooveshark.com/*
// @match        https://*.grooveshark.com/*
// @include      https://*.grooveshark.com/*
// @grant        unsafeWindow
// @grant        GM_info
// @require      http://code.jquery.com/jquery-2.0.3.min.js
// ==/UserScript==

/*
 * Development-version in coffee-script: https://github.com/frissdiegurke/grooveshark-comfortzone
 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=[].slice;return window.top!==window.self?null:(b=this,a={_scope:this,debug:!0,gmInfo:("undefined"!=typeof GM_info&&null!==GM_info?GM_info.script:void 0)||{version:"",name:"Grooveshark ComfortZone"},settings:null,dom:{comfortZone:$('<div id="comfort-zone">\n  <div id="comfort-nav">\n    <ul>\n      <li><a data-target="#lyrics-tab" class=\'comfort-nav-link active\'>Lyrics<div class="arrow" /></a></li>\n      <!--<li><a data-target="#settings-tab" class=\'comfort-nav-link\'>Settings<div class="arrow" /></a></li>/-->\n    </ul>\n  </div>\n  <div id="comfort-content">\n    <div id="settings-tab" style=\'height: 0; visibility: hidden;\'>\n      Settings not implemented yet :*(\n    </div>\n    <div id="lyrics-tab">\n      <div id="lyrics-header" />\n      <div id="lyrics-nav">\n        <a class="first inactive">&lt;&lt;</a><a class="prev inactive">&lt;</a><a class="next inactive">&gt;</a>\n      </div>\n      <div id="lyrics">No active song.</div>\n      <div id="lyrics-footer" />\n    </div>\n  </div>\n</div>'),lyrics:{header:null,navigation:null,content:null,footer:null}},lyrics:{all:{},song:{},visible:{}},song:null,lyricsSources:[{order:0,name:"magistrix",url:"http://www.magistrix.de",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@class=\'lyric-content text-center col-md-8\']/p" AND charset="utf-8"'},{order:1,name:"Songlyrics.com",url:"http://www.songlyrics.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//p[@id=\'songLyricsDiv\']/node()" AND charset="utf-8"'},{order:1,name:"LyricsMania",url:"http://www.lyricsmania.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'songlyrics_h\']/*" AND charset="utf-8"'},{order:1,name:"LyricsBox",url:"http://www.lyricsbox.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@style=\'font:12px arial\']/*" AND charset="utf-8"'},{order:1,name:"AZLyrics",url:"http://www.azlyrics.com/lyrics/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@style=\'margin-left:10px;margin-right:10px;\']/*" AND charset="utf-8"'},{order:1,name:"LetsSingIt",url:"http://artists.letssingit.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'lyrics\']/*" AND charset="utf-8"'},{order:1,name:"metrolyrics",url:"http://www.metrolyrics.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'lyrics-body-text\']/*" AND charset="utf-8"'},{order:2,name:"Lyrics Wikia",url:"http://lyrics.wikia.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@class=\'lyricbox\']/p" AND charset="utf-8"'},{order:2,name:"LyricsFreak",url:"http://www.lyricsfreak.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'content_h\']/*" AND charset="iso-8859-1"'},{order:3,name:"Lyricsmode",url:"http://www.lyricsmode.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//p[@id=\'lyrics_text\']" AND charset="utf-8"'},{order:3,name:"eLyrics",url:"http://www.elyrics.net/read/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@class=\'ly\']/p[1]" AND charset="utf-8"'},{order:3,name:"sing365",url:"http://www.sing365.com/music/lyric.nsf",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@class=\'content_1\']/div[@style=\'font-size: 14px;\']" AND charset="utf-8"'},{order:4,name:"Lyrics.com",url:"http://www.lyrics.com/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'lyric_space\']/*" AND charset="utf-8"'},{order:5,name:"LyricsFreak Print",url:"http://www.lyricsfreak.com/print.php",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//pre" AND charset="iso-8859-1"'},{order:5,name:"golyr",url:"http://www.golyr.de/",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'lyrics\']/p" AND charset="utf-8"'},{order:5,name:"SongMeanings",url:"http://www.songmeanings.net/songs/view",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'textblock\']/*" AND charset="utf-8"'},{order:5,name:"Songtexte.com",url:"http://www.songtexte.com/songtexte",query:'SELECT * FROM html WHERE url="$URL$" AND xpath="//div[@id=\'lyrics\']/*" AND charset="utf-8"'}]},l={log:function(){return a.debug?console.log.apply(console,["ComfortZone: LOG:"].concat(w.call(arguments))):void 0},info:function(){return a.debug?console.info.apply(console,["ComfortZone: INFO:"].concat(w.call(arguments))):void 0},error:function(){return a.debug?console.error.apply(console,["ComfortZone: ERROR:"].concat(w.call(arguments))):void 0},idCounter:0,GS:null,Grooveshark:null,lyricsTexts:{noSong:"No active song.",noLyrics:"No lyrics found.",searching:"Searching lyrics..."},onInit:[],editMode:!1,songIndex:-1,win:null},o=function(){return $("<style type=\"text/css\">\n  #page-wrapper, #stage {\n    background: black !important;\n    -webkit-transition: none !important;\n    transition: none !important;\n  }\n  #theme-wall {\n    display: none !important;\n  }\n  .queue-song .remove, .queue-song .play, .queue-song .options {\n    display: block !important;\n  }\n  .queue-song .play, .queue-song .options, .queue-song .remove {\n    opacity: 0.01;\n  }\n  .queue-small .queue-song .remove {\n    opacity: 0.3;\n  }\n  .queue-song:hover .remove, .queue-song:hover .play, .queue-song:hover .options {\n    opacity: 1;\n  }\n  #page {\n    margin: 0 auto 30px 30px !important;\n    float: left;\n  }\n  #comfort-zone {\n    float: left;\n    min-width: 200px;\n    background: white;\n    margin: 1px 1px 1px 21px;\n    padding: 0;\n    border-radius: 4px;\n  }\n  #comfort-content {\n    padding: 1em;\n  }\n  #lyrics-header {\n    font-size: 16pt;\n    font-style: oblique;\n    font-weight: bold;\n    color: #f77f00;\n  }\n  #lyrics-header>span {\n    font-size: 12pt;\n    font-weight: normal;\n  }\n  #lyrics-nav {\n    font-size: 12pt;\n    font-weight: normal;\n    float: right;\n  }\n  #lyrics-nav a {\n    margin-left: 0.5em;\n  }\n  #lyrics-nav a.inactive {\n    color: grey !important;\n    text-decoration: none !important;\n    cursor: default;\n  }\n  #lyrics {\n    margin-top: 0.3em;\n    clear: both;\n  }\n  #lyrics, #lyrics * {\n    color: #666 !important;\n  }\n  #lyrics-footer {\n    margin-top: 1em;\n    font-style: initial;\n    color: #f77f00;\n  }\n  #lyrics-footer:before {\n    content: 'provided by ';\n  }\n</style><style type=\"text/css\">\n  #comfort-nav {position:relative;width:100%;height:33px;border-bottom:1px solid #aaa;background:rgba(0,0,0,0.025);background-color:#f5f5f5;text-align:center;*zoom:1;border-radius:3px 3px 0 0;box-shadow:inset 0 1px 0 0 #f5f5f5;background-color:#ebebeb;background-image:-moz-linear-gradient(top, #f5f5f5, #ddd);background-image:-ms-linear-gradient(top, #f5f5f5, #ddd);background-image:-webkit-gradient(linear, 0 0, 0 100%, from(#f5f5f5), to(#ddd));background-image:-webkit-linear-gradient(top, #f5f5f5, #ddd);background-image:linear-gradient(top, #f5f5f5, #ddd);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.Gradient(startColorstr='#fff5f5f5', endColorstr='#ffdddddd', GradientType=0);*zoom:1}\n  #comfort-nav:before,#comfort-nav:after{display:table;content:\"\"}\n  #comfort-nav:after{clear:both}\n  #comfort-nav ul{display:inline-block;position:relative;height:33px;margin:0;list-style:none;zoom:1;*display:inline}\n  #comfort-nav li{position:relative;display:block;height:33px;float:left;user-select:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}\n  #comfort-nav li:before{position:absolute;display:block;top:8px;left:0px;height:18px;width:1px;background:#f5f5f5;z-index:10;content:''}\n  #comfort-nav li:after{position:absolute;display:block;top:8px;right:0px;height:18px;width:1px;background:#cbcbcb;z-index:10;content:''}\n  #comfort-nav li:last-child:after,#comfort-nav li:first-child:before{display:none}\n  #comfort-nav .comfort-nav-link{position:relative;display:block;height:33px;padding:0 15px 0 15px;line-height:33px;color:#333;text-shadow:0 1px 1px #f1f1f1;text-decoration:none;font-weight:bold;font-size:12px;z-index:20;outline:none;user-select:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}\n  #comfort-nav .comfort-nav-link:hover{color:#666;text-decoration:none;text-shadow:0 1px 0 #f5f5f5}\n  #comfort-nav .comfort-nav-link.active{height:32px;margin:0 -1px 0 -1px;border:solid 1px #3b3b3b;z-index:30;background-color:#5c5c5c;background-image:-moz-linear-gradient(top, #555, #666);background-image:-ms-linear-gradient(top, #555, #666);background-image:-webkit-gradient(linear, 0 0, 0 100%, from(#555), to(#666));background-image:-webkit-linear-gradient(top, #555, #666);background-image:linear-gradient(top, #555, #666);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.Gradient(startColorstr='#ff555555', endColorstr='#ff666666', GradientType=0);box-shadow:inset 0 1px 4px 0 rgba(0,0,0,0.3);color:#fff;text-decoration:none;text-shadow:0 1px 0 #3b3b3b}\n  #comfort-nav .comfort-nav-link.active .arrow{display:block}\n  #comfort-nav .comfort-nav-link.active:before,#comfort-nav .comfort-nav-link.active:after{display:none}\n  #comfort-nav .arrow{display:none;position:relative;background:#FFF}\n  #comfort-nav .arrow:after{position:absolute;height:0;width:0;left:50%;bottom:100%;margin-left:-5px;border:solid transparent;border-width:5px;border-bottom-color:#FFF;content:\" \";pointer-events:none}\n  #comfort-nav .arrow:before{position:absolute;height:0;width:0;left:50%;bottom:100%;margin-left:-6px;border:solid transparent;border-width:6px;border-bottom-color:#3b3b3b;content:\" \";pointer-events:none}\n</style>").appendTo("head"),a.dom.comfortZone.insertAfter("#page"),a.dom.lyrics.header=$("#lyrics-header"),a.dom.lyrics.navigation=$("#lyrics-nav"),a.dom.lyrics.content=$("#lyrics"),a.dom.lyrics.footer=$("#lyrics-footer")},l.onInit.push(function(){return l.log("adding style"),o()}),i=function(){var a,b;return $("#lightbox-header").length?(a=$("#lightbox-footer-right>a"),(null!=(b=a.data("translate-text"))?b.search(/^LB_INTERACTION_TIME/):void 0)>=0?(l.log("blocking interaction-timeout"),a[0].click()):void 0):window.setTimeout(i,10)},l.onInit.push(function(){return l.log("adding interaction-timeout listener"),l.GS.on("lightbox:open",function(){return l.log("lightbox:open triggered"),i()})}),h=function(a,c,d,e,f){var g;return null==f&&(f=b),g="jsonpCb_"+l.idCounter++,l.win[g]=function(a){return d.call(f,a),delete l.win[g]},$.ajax({url:a,data:c,dataType:"jsonp",jsonp:"callback",jsonpCallback:g,complete:function(a,b){return e.call(f,a,b)},timeout:1e4})},c=[0,0],f=[0,0],d=0,q=function(b){return l.log("show lyrics",b),null!=b?(a.lyrics.visible=b,a.dom.lyrics.content.html(b.element),a.dom.lyrics.header.html(b.title).show(),a.dom.lyrics.footer.html('<a href="'+b.site.url+'">'+b.site.name+"</a>").show(),null==b.url&&a.dom.lyrics.footer.prepend("[saved] ")):g(),n()},g=function(){return a.dom.lyrics.content.html(l.lyricsTexts.noLyrics),a.dom.lyrics.header.hide().html(""),a.dom.lyrics.footer.hide().html(""),a.lyrics.visible=null},e=function(b,e,g,i,j){var k,m,n,o,p,q,r,s;if(null==j&&(j=!1),l.songIndex=-1,!j&&null!=a.lyrics.all[b.songID]){s=a.lyrics.all[b.songID],r=0;for(o in s)r++;if(r){e(),l.log("no need to fetch, using",s);for(q in s)g(s[q]);return i(),null}}return a.lyricsSources.length?(e(),m=d=l.idCounter++,c=[a.lyricsSources.length,0],f=[0,0],n=this,p=!1,k=!1,l.log("searching lyrics for",b),$.each(a.lyricsSources,function(a,e){return m!==d?null:h("http://ajax.googleapis.com/ajax/services/search/web?v=1.0",{q:""+b.artistName+" "+b.songName+" site:"+e.url},function(a){var h,j,n,o,q;return m!==d?null:(n=null!=(o=a.responseData)?o.results:void 0,(null!=n?n.length:void 0)?(f[0]++,h={url:null!=(q=n[0])?q.unescapedUrl:void 0,site:e,title:""+b.artistName+" <span>"+b.songName+"</span>",element:null,saved:!1},j=e.query.replace(/\$URL\$/,h.url),l.log("yql-query: "+j),$.ajax({url:"http://query.yahooapis.com/v1/public/yql",method:"POST",timeout:7e3,data:{q:j},success:function(a,b,c){var e;return m!==d?null:(e=c.responseText)?(h.element=$("results",e).html(),h.element.trim()?g.call(CZ._scope,h):void 0):null},complete:function(){return m!==d?(p||i.call(CZ._scope,!0),p=!0,null):(f[1]++,c[0]===c[1]&&f[0]===f[1]?i.call(CZ._scope):void 0)}})):(c[0]===c[1]&&f[0]===f[1]&&(k||i.call(CZ.scope),k=!0),null))},function(){return m!==d?(p||i.call(CZ._scope,!0),p=!0,null):c[1]++},n)})):(e(),i(),null)},u=function(b){var c;return null==(null!=b?b.song:void 0)?(a.song=null,a.lyrics.song=null,g(),a.dom.lyrics.content.html(l.lyricsTexts.noSong)):b.song.songID!==(null!=(c=a.song)?c.songID:void 0)?t(b.song):void 0},t=function(b){return l.log("song change, new song:",b),e(b,function(){return g(),a.song=b,a.dom.lyrics.content.text(l.lyricsTexts.searching),a.lyrics.visible=null,a.lyrics.all[b.songID]=a.lyrics.song={},a.songIndex=-1,n()},function(b){var c;return l.log("found lyrics",b),a.lyrics.song[b.saved?"saved":b.site.name]=b,c=a.lyrics.visible,(null==c||b.site.order<c.site.order&&!c.saved||b.saved)&&(l.songIndex=b.saved?-1:a.lyricsSources.indexOf(b.site),q(b)),n()},function(c){return c?(l.log("song-change interrupted"),delete a.lyrics.all[b.songID]):(l.log("song-change completed"),null==a.lyrics.visible?g():void 0)})},p=function(){return null==a.lyrics.song?null:(l.songIndex=-1,null!=a.lyrics.song.saved?q(a.lyrics.song.saved):r())},s=function(){var b;return b=m(),null!=b?(l.songIndex=b,q(b>=0?a.lyrics.song[a.lyricsSources[b].name]:a.lyrics.song.saved)):void 0},r=function(){var b;return b=k(),null!=b?(l.songIndex=b,q(a.lyrics.song[a.lyricsSources[b].name])):void 0},m=function(){var b;if(null==a.lyrics.song||-1===l.songIndex)return null;for(b=l.songIndex;--b>=0;)if(null!=a.lyrics.song[a.lyricsSources[b].name])return b;return null!=a.lyrics.song.saved?-1:null},k=function(){var b;if(null==a.lyrics.song||l.songIndex===a.lyricsSources.length-1)return null;for(b=l.songIndex;++b<a.lyricsSources.length;)if(null!=a.lyrics.song[a.lyricsSources[b].name])return b;return null},n=function(){var b,c,d;return b=$(".first",a.dom.lyrics.navigation),d=$(".prev",a.dom.lyrics.navigation),c=$(".next",a.dom.lyrics.navigation),null!=m()?(b.removeClass("inactive"),d.removeClass("inactive")):(b.addClass("inactive"),d.addClass("inactive")),null!=k()?c.removeClass("inactive"):c.addClass("inactive")},l.onInit.push(function(){return l.log("adding song-change listener"),l.Grooveshark.setSongStatusCallback(u),$(".first",a.dom.lyrics.navigation).click(p),$(".prev",a.dom.lyrics.navigation).click(s),$(".next",a.dom.lyrics.navigation).click(r)}),l.onInit.push(function(){return l.log("initializing navigation"),$("#comfort-nav li").click(function(){var a,b,c;return a=$("a",this),a.hasClass("active")?null:(l.log("navigation: "+a.data("target")),c=function(a){return"#comfort-content "+a.data("target").replace(/,/g,", #comfort-content ")},b=$("#comfort-nav a.active"),$(c(b)).css({height:"0",visibility:"hidden"}),b.removeClass("active"),$(c(a)).css({height:"auto",visibility:"visible"}),a.addClass("active"))})}),v=0,j=function(c){return v++,l.win=unsafeWindow,l.log("searching grooveshark-API",l.win.GS,l.win.Grooveshark),null!=l.win.Grooveshark&&null!=l.win.GS&&"loading..."!==$("body").html().trim()?(l.log("grooveshark-API found"),window.CZ=l.win.CZ=l.win.ComfortZone=a,c.call(b,l.win.Grooveshark,l.win.GS)):200>=v?window.setTimeout(function(){return j(c)},50):l.log("giving up. exit")},j(function(a,b){var c,d,e,f;for(l.Grooveshark=a,l.GS=b,f=l.onInit,d=0,e=f.length;e>d;d++)(c=f[d])();return u(null),l.log("initialization completed")}),void 0)}).call(this);