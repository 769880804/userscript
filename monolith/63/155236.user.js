// ==UserScript==
// @name          PlayBook App Manager
// @namespace     jgc@gridbook.org
// @description   List, manage and install apps on playbook.
// @match         https://playbook/
// @match         https://192.168.254.2/
// @run_at        document_start
// @version       1.9
// ==/UserScript==

document.head.appendChild(document.createElement("script")).innerHTML='var i=void 0,r=!0,x=null,z=!1,aa,ca,A,B,da,ga,E=[x],F=[],ha,K,L,M,N,P=document.getElementById.bind(document);function ia(a){a.previousSibling.disabled=!a.checked}function Q(a){document.documentElement.innerHTML=a}function ja(){Q("<h2>"+(ka(r)?"Logged out":"Unable to log out")+\'</h2><button onclick="la()">Log in again</button>\')}function ma(a){var b=P("ial").checked?"Install and Launch":"Install";if(a.files.length){for(var e=0,l=a.files.length;e<l;e++)E.push([4096<a.files[e].size?b:"Install Debug Token",a.files[e]]);a.value=x;E.f()}return z}function la(){document.title="PlayBook App Manager";Q("<h1>Loading...</h1>");var b=z;try{b=0>document.cookie.indexOf("dtmauth")}catch(e){}setTimeout(b?na:R,0)}function na(){try{document.cookie="loginsession=deleted;expires=Jan 1, 1970 00:00:00 UTC"}catch(a){}var b=new XMLHttpRequest;switch(oa(b,"")){case "PasswdChallenge":var e=b.responseXML.getElementsByTagName("FailedAttempts")[0].textContent|0,l=b.responseXML.getElementsByTagName("RetriesRemaining")[0].textContent|0;aa=b.responseXML.getElementsByTagName("Challenge")[0].textContent;ca=b.responseXML.getElementsByTagName("Algorithm")[0].textContent;A=b.responseXML.getElementsByTagName("Salt")[0].textContent;B=b.responseXML.getElementsByTagName("ICount")[0].textContent|0;if(2!=ca){Q("Unsupported Algorithm: "+ca);break}Q("<head><style>body,input{font:16px/1.5 verdana}</style></head><body><h2>Log in to your PlayBook"+(e?" ("+(e+1)+" of "+(e+l)+")":"")+"</h2>Hostname: "+location.hostname+\'<br/><form onsubmit="return pa()">Password: <input type=password id=passwd size=15 required autocomplete=off><br><label><input type=checkbox id=save>Auto Login</label><br><br><input type=submit id=submit value="Log in"> </form></body>\');!e&&localStorage.passwd&&(P("save").checked=r,pa());break;case "Success":setTimeout(R,0);break;case "Error":Q(b.responseXML.getElementsByTagName("ErrorDescription")[0].textContent)}}function pa(){P("submit").disabled=r;P("submit").value="Logging in";document.forms[0].appendChild(document.createElement("progress")).id="prog";for(var a=A,b=Array(a.length+7>>3),e=0,l=b.length;e<l;e++)b[e]=0;e=0;for(l=a.length;e<l;e++)b[e>>3]|=parseInt(a.charAt(e),16)<<(7-e%8<<2);da=P("passwd").value?P("passwd").value:localStorage.passwd;(ga=localStorage.hash)&&localStorage.passwd==da&&localStorage.salt==A&&localStorage.icount==B?qa(b[0],b[1],B,aa+localStorage.hash,i,2):qa(b[0],b[1],B,da,i,0);return z}function ra(a,b,e,l,p,j){var g=(p>>>8)+1<<8;g>l&&(g=l);for(var q=p;q<g;q++)a[0]=(q&255)<<24|(q&65280)<<8|q>>>8&65280|q>>>24,a[1]=b,a[2]=e,a=sa(a,76);P("prog").value=q/l/2+j/4;q==l?setTimeout(function(){qa(b,e,l,i,a,++j)},0):setTimeout(function(){ra(a,b,e,l,q,j)},0)}function qa(a,b,e,l,p,j){switch(j&1){case 1:p.shift();p.shift();p.shift();for(var g="",q=0,s=p.length<<2;q<s;q++)g+=String.fromCharCode(p[q>>2]>>>(3-q%4<<3)&255);l=g;if(j&2){setTimeout(function(){switch(oa(new XMLHttpRequest,"challenge_data="+ta(l)+"&")){case "Success":P("save").checked&&(localStorage.passwd=da,localStorage.salt=A,localStorage.icount=B,localStorage.hash=ga);aa=ca=A=B=i;setTimeout(R,0);break;case "Denied":ka(),setTimeout(na,0)}},0);break}ga=l;l=aa+l;++j;case 0:for(var g=l,q=Array(g.length+3>>2),s=0,f=q.length;s<f;s++)q[s]=0;s=0;for(f=g.length;s<f;s++)q[s>>2]|=(g.charCodeAt(s)&255)<<(3-s%4<<3);p=q;p.unshift(0,a,b);p=sa(p,l.length+12);setTimeout(function(){ra(p,a,b,e,1,j)},0)}}function ka(a){localStorage.clear();try{document.cookie="loginsession=deleted;expires=Jan 1, 1970 00:00:00 UTC",a&&(document.cookie="dtmauth=deleted;expires=Jan 1, 1970 00:00:00 UTC")}catch(b){return z}return r}function R(a){if(a=a!==r)K?(K.innerHTML="Refresh list of installed apps ...",L.innerHTML="<progress id=prog></progress>"):Q("<h1>Retrieve list of installed apps from PlayBook ...</h1>");var b=new XMLHttpRequest,e=new FormData;e.append("command","List");ua("appInstaller.cgi",b,e,va.bind(b,a))}function va(a){if(!(4>this.readyState||200!==this.status)){var b,e,l,p,j,g,q,s,f;s=this.responseText.split("\\n");var y=s.shift(),u=[];if("Info"==y.slice(0,4)&&"@applications"==s.shift().slice(0,13)){P("apptbl")?(q=P("apptbl"),q.innerHTML=\'<tr class=head><th class=head><button class="updtbl" onclick="R()">Refresh List</button>Name</th><th colspan=2 title="Internal | AppWorld">Version</th><th id=srcth>Source</th><th class=cmdcol>Command</th></tr>\'):(Q(\'<head><title>PlayBook App Manager</title><style>body,input,select,textarea,button{font:16px verdana,tahoma,arial,sans-serif}div.content{margin-top:129px}table.apptbl{border-collapse:collapse;border:solid #999 2px}th,select{background:#ccc}select{font-weight:bold;min-width:76px}option.src{background:#fff}.ok{color:#4a4}.err{color:#f66}.other{color:#f90}.file{color:#66f}span.footnote{color:#888;font-size:13px;line-height:90px}tr:hover{background:#ffa}.pointer:hover{background:#feb;border-radius:3px;-webkit-transition:background .5s;-moz-transition:background .5s}tr.blink{background:#ccf}tr.head{height:30px}th.head{height:24px}button.updtbl{position:absolute;left:12px;height:24px;margin-top:-3px}div#panel{position:fixed;background:#f1f1f1;padding:2px 2px 0 2px;border-bottom:1px solid #eee;border-color:#ccc;top:0px;left:0px;width:100%;height:118px;overflow-x:hidden;z-index:9}div.box-shadow{border-color:#aaa !important;box-shadow:0 1px 10px rgba(102,102,102,.4)}div.info{float:left;width:66%;padding-right:.5%}div.queue{position:absolute;left:66.5%;width:33%;padding-left:.5%;border-left:1px solid #ddd}div.title{height:24px;line-height:24px;margin-left:2px;width:100%;overflow:hidden}div#headline{font-weight:bold;text-shadow: 0 0 1px #aaa}div.cross{width:16px;height:16px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABHRSTlMA7zBgg9mmrAAAADNJREFUeF4li4EJADAMwkI/WNcD2n2wEwr7/6YVBBGJyk1sE0716EywWJ1Qz5GLqNVSrw+bZAUvknrSxQAAAABJRU5ErkJggg==) no-repeat 3px 3px}div#gohome{float:right;margin-top:3px;border:1px solid transparent;border-radius:2px;cursor:pointer}div#gohome:hover{border-color:#C6C6C6!important;background-image:-webkit-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-moz-linear-gradient(top,#f8f8f8,#f1f1f1)}button.tight{height:24px;margin-top:0;margin-bottom:0}ol.logs{margin:0}.pointer{cursor:pointer}pre.news{width:100%;margin:2px;font-family:Consolas,Lucida Console,dejavu sans mono,monospace;overflow-x:hidden}pre#news{height:90px}pre#qlist{height:90px;word-wrap:break-word}span#about{white-space:normal}input#files{height:0px;visibility:hidden;position:absolute}a{text-decoration:none;color:#26b}a:visited{color:#26b}a:hover,a:active{color:#F50}@media screen{select{-webkit-appearance:button;border-radius:3px;box-shadow:0 1px 3px rgba(0, 0, 0, 0.1);background:-webkit-linear-gradient(#fafafa, #f4f4f4 40%, #e5e5e5) no-repeat center right;border:1px solid #aaa;color:#555;font-size:inherit;margin:0;overflow:hidden;padding:2px;white-space:nowrap;}select:disabled{color:graytext;background:-webkit-linear-gradient(#fefefe, #f8f8f8 40%, #e9e9e9);}select:enabled:hover{box-shadow:0 1px 3px rgba(0, 0, 0, 0.2);background:-webkit-linear-gradient(#fefefe, #f8f8f8 40%, #e9e9e9);color:#333;}select:enabled:active{box-shadow:inset 0 1px 3px rgba(0, 0, 0, 0.2);background:-webkit-linear-gradient(#f4f4f4, #efefef 40%, #dcdcdc);color:#444;}}@media print{#panel,.updtbl,.cmdcol{display:none}div.content{margin:0}select{-webkit-appearance:none;border:0}}</style><link rel="Shortcut Icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABmFBMVEUAAADS0tL///+YmJiLi4uKiorc3NyMjIzT09O5ubnu7u7////Z2dnNzc22trbCwsKxsbGNjY3T09Orq6vj4+Pw8PDa2trY2NjX19ednZ2ampr////S0tKcnJyVlZXp6emUlJSvr6+kpKTHx8eVlZWRkZGjo6OUlJSRkZGRkZGbm5taWlpZWVmYmJiIiIhYWFiZmZlUVFSHh4eXl5eUlJSEhISMjIyLi4uEhISUlJSUlJQDAwMQEBAICAgLCwsjIyNTU1NXV1chISEYGBgEBAQGBgYVFRVKSkoMDAwHBwcJCQlSUlJVVVVkZGRvb28fHx9ERESCgoJiYmIsLCwiIiI1NTVgYGDj4+M8PDzHx8fZ2dkCAgIXFxdjY2MODg4aGhrd3d0wMDATExPg4OBQUFDMzMxpaWmenp5mZmaWlpZeXl5AQEAZGRnU1NS0tLSysrJubm7S0tK3t7d2dnY7OzuBgYGfn5+4uLh8fHzBwcHQ0NDe3t4RERHNzc2vr6+ampqUlJQSEhJfX1+qqqpOTk6GhoaFhYU9PT22i8xkAAAAO3RSTlMA9Ab55Ovq8dzsXwfvzNfm5Pq/63RKvPC66uoFrOzjS/jv7K3m2O3gs8BX9/hlw/rr+sUDYMTu7sdjA+g2eC4AAADuSURBVHheTcDTVkQBAAXQM0S2bdvXxtj2ZNvWb1cPtdqAsazJbq0wGJqt9pbGcqC9w1RysmwkwrLOkqnOiO6egOdPurYB/az7n7dKVPk4LhF9DESLfo7jdqtRE1NcucT7aW7foyhKzIH68Oev65vzcC/6gvmn+Gb+Nf5xdru+ERxCK89cXF4xB4dp5hvfiTZZEIS9H0fHJ4I8gy5dojN37vuHZ5f/RdMHMEgmCVHb2t6hJJFIZoYxEiJESadVldY1kQiNYmxcolSyIMsFUqW0iUlgappPZb0M482m+Nm5eQALi2bLks22bDGvrK7hC1qcRWT2+eRhAAAAAElFTkSuQmCC"/></head><body ondragover="event.preventDefault()" ondrop="return ma(event.dataTransfer)"><div id="panel"><div class=info><div class=title><div id=gohome onclick="wa()"><div class="cross"></div></div><div id=headline></div></div><pre id=news class=news></pre></div><div class=queue><div class=title><form onsubmit="return false"><button id=fbtn class=tight onclick="this.form.files.click()">Install Apps</button><input id="files" type="file" multiple onchange="ma(this)" accept=".bar"> <span id=lbtn></span> <label><input id=ial type=checkbox>Launch after install</label></form></div><pre id=qlist class=news></pre></div></div><div class=content><table cellpadding=3 cellspacing=2 border=1 class=apptbl><tbody id=apptbl><tr class=head><th class=head><button class="updtbl" onclick="R()">Refresh List</button>Name</th><th colspan=2 title="Internal | AppWorld">Version</th><th id=srcth>Source</th><th class=cmdcol>Command</th></tr></tbody></table></div></body>\'),ha=P("panel"),K=P("headline"),L=P("news"),q=P("apptbl"),E.e(),window.onscroll=function(){ha.className=window.scrollY?"box-shadow":""},window.onbeforeunload=function(){return E[0]?"Installation is still in progress.":x});for(var v=0,G=s.length;v<G;++v)if(y=s[v].split(","),!(2>y.length)&&(f=y[0].split("::"),!(2>f.length))){b=f[0];e=f[1];l=b.slice(0,-28);a:if(p=l.search(/[\\da-f]{28,32}$/),!(0>p))for(j=p;j<p+4;++j){var h=l.slice(0,j);g=Array(h.length>>2);for(f=0;f<g.length;f++)g[f]=0;for(f=0;f<h.length<<3;f+=8)g[f>>5]|=(h.charCodeAt(f>>3)&255)<<(f&31);f=i;f=h.length<<3;g[f>>5]|=128<<(f&31);g[(f+64>>>9<<4)+14]=f;f=1732584193;for(var h=-271733879,k=-1732584194,m=271733878,n=0;n<g.length;n+=16){var C=f,D=h,t=k,w=m;f=T(f,h,k,m,g[n+0],7,-680876936);m=T(m,f,h,k,g[n+1],12,-389564586);k=T(k,m,f,h,g[n+2],17,606105819);h=T(h,k,m,f,g[n+3],22,-1044525330);f=T(f,h,k,m,g[n+4],7,-176418897);m=T(m,f,h,k,g[n+5],12,1200080426);k=T(k,m,f,h,g[n+6],17,-1473231341);h=T(h,k,m,f,g[n+7],22,-45705983);f=T(f,h,k,m,g[n+8],7,1770035416);m=T(m,f,h,k,g[n+9],12,-1958414417);k=T(k,m,f,h,g[n+10],17,-42063);h=T(h,k,m,f,g[n+11],22,-1990404162);f=T(f,h,k,m,g[n+12],7,1804603682);m=T(m,f,h,k,g[n+13],12,-40341101);k=T(k,m,f,h,g[n+14],17,-1502002290);h=T(h,k,m,f,g[n+15],22,1236535329);f=U(f,h,k,m,g[n+1],5,-165796510);m=U(m,f,h,k,g[n+6],9,-1069501632);k=U(k,m,f,h,g[n+11],14,643717713);h=U(h,k,m,f,g[n+0],20,-373897302);f=U(f,h,k,m,g[n+5],5,-701558691);m=U(m,f,h,k,g[n+10],9,38016083);k=U(k,m,f,h,g[n+15],14,-660478335);h=U(h,k,m,f,g[n+4],20,-405537848);f=U(f,h,k,m,g[n+9],5,568446438);m=U(m,f,h,k,g[n+14],9,-1019803690);k=U(k,m,f,h,g[n+3],14,-187363961);h=U(h,k,m,f,g[n+8],20,1163531501);f=U(f,h,k,m,g[n+13],5,-1444681467);m=U(m,f,h,k,g[n+2],9,-51403784);k=U(k,m,f,h,g[n+7],14,1735328473);h=U(h,k,m,f,g[n+12],20,-1926607734);f=V(h^k^m,f,h,g[n+5],4,-378558);m=V(f^h^k,m,f,g[n+8],11,-2022574463);k=V(m^f^h,k,m,g[n+11],16,1839030562);h=V(k^m^f,h,k,g[n+14],23,-35309556);f=V(h^k^m,f,h,g[n+1],4,-1530992060);m=V(f^h^k,m,f,g[n+4],11,1272893353);k=V(m^f^h,k,m,g[n+7],16,-155497632);h=V(k^m^f,h,k,g[n+10],23,-1094730640);f=V(h^k^m,f,h,g[n+13],4,681279174);m=V(f^h^k,m,f,g[n+0],11,-358537222);k=V(m^f^h,k,m,g[n+3],16,-722521979);h=V(k^m^f,h,k,g[n+6],23,76029189);f=V(h^k^m,f,h,g[n+9],4,-640364487);m=V(f^h^k,m,f,g[n+12],11,-421815835);k=V(m^f^h,k,m,g[n+15],16,530742520);h=V(k^m^f,h,k,g[n+2],23,-995338651);f=W(f,h,k,m,g[n+0],6,-198630844);m=W(m,f,h,k,g[n+7],10,1126891415);k=W(k,m,f,h,g[n+14],15,-1416354905);h=W(h,k,m,f,g[n+5],21,-57434055);f=W(f,h,k,m,g[n+12],6,1700485571);m=W(m,f,h,k,g[n+3],10,-1894986606);k=W(k,m,f,h,g[n+10],15,-1051523);h=W(h,k,m,f,g[n+1],21,-2054922799);f=W(f,h,k,m,g[n+8],6,1873313359);m=W(m,f,h,k,g[n+15],10,-30611744);k=W(k,m,f,h,g[n+6],15,-1560198380);h=W(h,k,m,f,g[n+13],21,1309151649);f=W(f,h,k,m,g[n+4],6,-145523070);m=W(m,f,h,k,g[n+11],10,-1120210379);k=W(k,m,f,h,g[n+2],15,718787259);h=W(h,k,m,f,g[n+9],21,-343485551);f=f+C|0;h=h+D|0;k=k+t|0;m=m+w|0}f=[f,h,k,m];g="";for(h=0;h<f.length<<5;h+=8)g+=String.fromCharCode(f[h>>5]>>>(h&31)&255);if(ta(g,r)==l.slice(j)){l=l.slice(0,j);break a}}p=y[1];j="";g="websl";h=2;for(k=y.length;h<k;h++)switch(f=y[h].split("::"),f[0]){case "name":l=f[1];" for BlackBerry PlayBook"==l.slice(-24)&&(l=l.slice(0,-24));break;case "version":j=f[1];0==p.indexOf(j)?(p=j.bold()+p.slice(j.length),j=""):j=j.bold();break;case "source":g=f[1];break;case "websl":g=f[0]}u.push([b,e,g,l,p,j])}u.sort(function(a,b){if(a[2]<b[2])return-1;if(a[2]>b[2])return 1;c=a[3].toLowerCase();d=b[3].toLowerCase();return c<d?-1:c>d?1:0});N=[[],[]];for(var v=0,G=u.length,ba;v<G;++v)b=u[v][h=0],e=u[v][++h],g=u[v][++h],l=u[v][++h],p=u[v][++h],j=u[v][++h],s=q.appendChild(document.createElement("tr")),p=j?"<td>"+p+"</td><td>"+j+"</td>":"<td colspan=2>"+p+"</td>",j="sys.data."==l.slice(0,9)?" disabled":"",s.innerHTML="<td>"+l+"</td>"+p+"<td>"+g+"</td><td class=cmdcol id="+b+\' nowrap><button onclick="xa(this)" value="Is Running"\'+j+\'>?</button> <button onclick="xa(this)"\'+j+\'>Launch</button> <button onclick="xa(this)"\'+j+\'>Terminate</button> <button onclick="xa(this)" id="\'+e+("appworld"!=g&&"developer"!=g?\'" disabled>Uninstall</button><input type=checkbox onclick="ia(this)">\':\'">Uninstall</button>\')+"</td>",g!=ba&&(N[0].push(ba=g),N[1].push(s.rowIndex));N[1].push(q.rows.length);q=P("srcth");u=P("apptbl");q.innerHTML="";b=q.appendChild(document.createElement("select"));e=b.appendChild(document.createElement("option"));b.style.width=window.getComputedStyle(q,x).width;b.onchange=ya;b.id="src";e.value="";e.innerHTML="Source - All ("+(u.rows.length-1)+")";M||(e.selected=r);q=0;for(u=N[0].length;q<u;++q)e=b.appendChild(document.createElement("option")),e.className="src",e.value=q,e.innerHTML=N[0][q]+" ("+(N[1][q+1]-N[1][q])+")",M===q.toString()&&(e.selected=r);ya.bind(b)();a&&wa()}else"Error: User"==y.slice(0,11)?setTimeout(na,0):Q(y+\'<br><br><button onclick="la()">Try again</button>\')}}function oa(a,b){a.open("GET","/cgi-bin/login.cgi?"+b+"request_version=1",z);a.send(x);if(200===a.status)if(a.response.length)try{return a.responseXML.getElementsByTagName("Status")[0].textContent}catch(e){Q("Invalid HTTP Response: <br><br>"+a.response)}else Q("Empty response. Check whether the correct User-Agent was sent.");else Q("HTTP Error "+a.status+"<br><br>"+a.responseText)}function ua(a,b,e,l){b.onreadystatechange=l;b.open("POST","/cgi-bin/"+a,r);b.send(e)}function za(a,b,e,l){var p=0;switch(a.slice(0,7)){case "Install":p=2;break;case "Uninsta":p=1}K.innerHTML=a+" <span class=file>"+b+"</span> ..."+(e?" ("+(e+1)+"/10)":"");if(this.responseText){L.innerHTML=this.responseText;var j=this.responseText.split("\\n")}else L.innerHTML="<progress id=prog></progress><br/><span id=prog-txt></span>";if(4===this.readyState){var g,q;if("Error:"==j[0].slice(0,6))g=j[0],"User"==j[0].slice(7,11)&&(setTimeout(na,0),q=z);else{for(var s=0,f=j.length;s<f;s++)if("result::"==j[s].slice(0,8)){g=j[s].slice(8);break}else"actual_id::"==j[s].slice(0,11)&&(q=j[s].slice(11));this.d&&(q=this.d);p&&(g?"success"==g&&setTimeout(R.bind(i,r),0):10>++e?(L.innerHTML+="<span class=other>"+a+"ation seems to be incomplete. Retry in 2 seconds.</span>",setTimeout(function(){l(e)},2E3)):(L.innerHTML+="<span class=err>"+a+"ation seems to be incomplete. Maximum retries reached.</span>",g="no result (may be incomplete)"))}if(g){switch(g.slice(0,4).toLowerCase()){case "true":case "succ":case "term":j="ok";break;case "erro":case "fals":case "fail":case "inva":case "no r":j="err";break;default:g|0?(g="success",j="ok"):j="other"}K.innerHTML=a+" <span class=file>"+b+"</span>: <span class="+j+">"+g+"</span>";q&&(K.innerHTML="<span class=pointer onclick=\'Aa("+(2==p?F.length:\'"\'+q+\'"\')+")\'>"+K.innerHTML+"</span>");2==p&&(q===z?E.unshift(x):(F.push([j,K.innerHTML,q]),E.e()))}}L.scrollTop=L.scrollHeight;P("gohome").style.display="inline-block"}function xa(a,b){var e=a.value?a.value:a.innerHTML,l=a.parentNode.parentNode.firstChild.innerHTML;b||(b=0);var p=a.parentNode.id,j=p.slice(0,-28),p="Uninstall"==e?a.id:p.slice(-27),g=new XMLHttpRequest,q=new FormData;q.append("command",e);q.append("package_id",p);q.append("package_name",j);g.d=p.split(".").join("-");ua("appInstaller.cgi",g,q,za.bind(g,e,l,b,function(b){xa(a,b)}))}function Ba(a,b){var e=new FormData;e.append("command",a);e.append("file",this);var l=new XMLHttpRequest;E[0][2]=l;l.upload.onprogress=Ca;l.onabort=za.bind({readyState:4,responseText:"result::abort"},a,this.name,0);ua("appInstaller.cgi",l,e,za.bind(l,a,this.name,b,Ba.bind(this,a)))}function Da(a){var a=a.innerHTML,b=new XMLHttpRequest,e=new FormData;e.append("command",a);ua("appInstaller.cgi",b,e,za.bind(b,a,"",0))}function Ea(){var a=prompt("Input commands in such format: \\nscript.cgi?key1=value1[&key2=value2[...]]\\n(Do not urlencode)",""),b,e,l=new XMLHttpRequest,p=new FormData;if(a){e=(b=a.split("?")).shift();b=b.join("?").split("&");for(var j=0,g=b.length,q;j<g;++j)p.append((q=b[j].split("=")).shift(),q.join("="));ua(e,l,p,za.bind(l,a,"",0))}}function Fa(a){var b="",e=F.length,l={"":e,ok:0,err:0,other:0},p={"":"All",ok:"Success",err:"Failure",other:"Other"};if(e){for(var j=0;j<e;++j){if(!a||a==F[j][0])b+="<li>"+F[j][1]+"</li>";l[F[j][0]]++}L.innerHTML="<ol class=logs>"+b+"</ol>";if(!a){b="Install logs:";for(j in l)l[j]&&(b+=" <button class=\'tight "+j+"\' onclick=\'Fa("+(j?\'"\'+j+\'"\':"")+")\'>"+p[j]+" ("+l[j]+")</button>");b+=\' | <button class=tight onclick="Ga()">Clear Logs</button>\';K.innerHTML=b;P("gohome").style.display="inline-block"}}}function Ga(){F=[];P("lbtn").innerHTML="";wa()}function Ha(a){this.className=a&1?"blink":"";a&&setTimeout(Ha.bind(this,--a),80)}function ya(){var a=P("apptbl").rows;M=this.options[this.selectedIndex].value;for(var b=1,e=a.length;b<e;++b)a[b].style.display=M&&(b<N[1][M]||b>=N[1][(M|0)+1])?"none":""}function Aa(a){if(a=P("string"==typeof a?a:F[a][2]))a=a.parentNode.parentNode,a.style.display&&(P("src").selectedIndex=0,ya.bind(P("src"))()),document.body.scrollTop=a.offsetTop,Ha.bind(a,7)()}function Ca(a){if(a.lengthComputable&&(P("prog")&&(P("prog").value=a.loaded/a.total),P("prog-txt")))if(this.c){var b=Date.now(),e=b-this.c[0],l;if(1E3<e){e=1E3*((a.loaded-this.c[1])/e);l=(a.total-a.loaded)/e;var p=P("prog-txt"),j;j=l/3600|0;var g=(l/60|0)%60;l=l%60|0;j||g?(j=(j?j+":":"")+((j?(9<g?"":"0")+g:g)+":"),j+=(9<l?"":"0")+l):j=l+" sec";p.innerHTML="<span class=other>"+Ia(e)+"/s</span> (<span class=file>"+j+"</span> remaining)";this.c=[b,a.loaded]}}else this.c=[Date.now(),a.loaded]}function wa(){if("169.254."==location.hostname.slice(0,8)){var a=new XMLHttpRequest;a.onloadend=Ja;a.open("GET","/cgi-bin/dynamicProperties.cgi",r);a.send();Ja(\'<span style="color:#bbb">Loading device status ...</span>\')}else Ja(\'<span style="color:#bbb">Device status is not available via wireless connection.</span>\')}function Ja(a){"string"!==typeof a&&(a="");if(200==this.status&&this.responseXML)try{var b=this.responseXML.getElementsByTagName("BatteryLevel")[0].textContent|0,e=this.responseXML.getElementsByTagName("FreeApplicationSpace")[0].textContent,l=Ia(e),a="Free Space: "+("<span class="+("GB"==l.slice(-2)?"file":"other")+\' title="\'+e.slice(0,e.length%3)+e.slice(e.length%3).replace(/(\\d{3})/g,",$1")+\' bytes">\'+l+"</span>")+\' <span style="color:#bbb">|</span> Battery Level: <span class=\'+(60>b?20>b?"err":"other":"ok")+">"+b+"</span>"}catch(p){a=\'<span style="color:#bbb">Device is disconnected.</span>\'}K.innerHTML=\'PlayBook App Manager 1.9 <span style="font-weight:normal">(Designed by JGC)</span>\';L.innerHTML=a+\'\\n\\n<button onclick="ja()">Log out</button> <button onclick="Da(this)">List Device Info</button> <button onclick="Ea()">Manual Debug</button> <button onclick="Ka()">About</button>\';P("gohome").style.display="none"}function Ka(){K.innerHTML="About <span class=file>PlayBook App Manager</span> <span class=other>1.9</span>";L.innerHTML=\'<span id=about>Copyright &copy; 2012 George J (&#x6a;&#x67;&#x63;&#x40;&#x67;&#x72;&#x69;&#x64;&#x62;&#x6f;&#x6f;&#x6b;&#x2e;&#x6f;&#x72;&#x67;)<br>Software Homepage: <a href="http://gridbook.org/pb-app-mgr/" target="_blank">http://gridbook.org/pb-app-mgr/</a><br>If you like this software and want to show your appreciation of my work, the donation can be sent to <span class=ok>&#x6a;&#x67;&#x63;&#x40;&#x67;&#x72;&#x69;&#x64;&#x62;&#x6f;&#x6f;&#x6b;&#x2e;&#x6f;&#x72;&#x67;</span> via PayPal. Please choose Personal instead of Purchase.<br>Distributed under the <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons BY-NC-SA License</a>.<br>JavaScript libraries of SHA-512 and MD5 are originally implemented by <a href="http://pajhome.org.uk/crypt/md5/index.html" target="_blank">Paul Johnston</a>.</span>\';P("gohome").style.display="inline-block"}E.f=function(a){a&&(this[0]=x);!this[0]&&1<this.length&&(this.shift(),setTimeout(Ba.bind(this[0][1],this[0][0],0),a?1E3:0));this.list()};E.list=function(){var a="";if(this[0]){for(var b=0,e=this.length;b<e;++b)a+=(b?b+1+": ":"=> ")+this[b][0]+" <span class=file>"+this[b][1].name+"</span> <span class=\'err pointer\' title=\'"+(b?"remove":"abort")+"\' onclick=\'E.remove("+b+")\'>[X]</span>\\n";P("fbtn").innerHTML="Queue ("+this.length+")";P("qlist").innerHTML=a;document.title="["+this.length+"] "+this[0][1].name+" - PlayBook App Manager"}else P("fbtn").innerHTML="Install Apps",P("qlist").innerHTML="<span class=footnote>Drag and drop files here to install</span>",document.title="PlayBook App Manager"};E.remove=function(a){a?(this.splice(a,1),this.list()):(this[0][2].onreadystatechange=x,this[0][2].abort())};E.e=function(){P("lbtn").innerHTML=F.length?\'<button class=tight onclick="Fa()">Logs (\'+F.length+")</button>":"";this.f(r)};function ta(a,b){for(var e="",l,p=0,j=a.length;p<j;p++)l=a.charCodeAt(p),!b&&16>l&&(e+="0"),e+=l.toString(16);return b?e:e.toUpperCase()}var La;function sa(a,b){La==i&&(La=[X(1116352408,-685199838),X(1899447441,602891725),X(-1245643825,-330482897),X(-373957723,-2121671748),X(961987163,-213338824),X(1508970993,-1241133031),X(-1841331548,-1357295717),X(-1424204075,-630357736),X(-670586216,-1560083902),X(310598401,1164996542),X(607225278,1323610764),X(1426881987,-704662302),X(1925078388,-226784913),X(-2132889090,991336113),X(-1680079193,633803317),X(-1046744716,-815192428),X(-459576895,-1628353838),X(-272742522,944711139),X(264347078,-1953704523),X(604807628,2007800933),X(770255983,1495990901),X(1249150122,1856431235),X(1555081692,-1119749164),X(1996064986,-2096016459),X(-1740746414,-295247957),X(-1473132947,766784016),X(-1341970488,-1728372417),X(-1084653625,-1091629340),X(-958395405,1034457026),X(-710438585,-1828018395),X(113926993,-536640913),X(338241895,168717936),X(666307205,1188179964),X(773529912,1546045734),X(1294757372,1522805485),X(1396182291,-1651133473),X(1695183700,-1951439906),X(1986661051,1014477480),X(-2117940946,1206759142),X(-1838011259,344077627),X(-1564481375,1290863460),X(-1474664885,-1136513023),X(-1035236496,-789014639),X(-949202525,106217008),X(-778901479,-688958952),X(-694614492,1432725776),X(-200395387,1467031594),X(275423344,851169720),X(430227734,-1194143544),X(506948616,1363258195),X(659060556,-544281703),X(883997877,-509917016),X(958139571,-976659869),X(1322822218,-482243893),X(1537002063,2003034995),X(1747873779,-692930397),X(1955562222,1575990012),X(2024104815,1125592928),X(-2067236844,-1578062990),X(-1933114872,442776044),X(-1866530822,593698344),X(-1538233109,-561857047),X(-1090935817,-1295615723),X(-965641998,-479046869),X(-903397682,-366583396),X(-779700025,566280711),X(-354779690,-840897762),X(-176337025,-294727304),X(116418474,1914138554),X(174292421,-1563912026),X(289380356,-1090974290),X(460393269,320620315),X(685471733,587496836),X(852142971,1086792851),X(1017036298,365543100),X(1126000580,-1676669620),X(1288033470,-885112138),X(1501505948,-60457430),X(1607167915,987167468),X(1816402316,1246189591)]);var e=[X(1779033703,-205731576),X(-1150833019,-2067093701),X(1013904242,-23791573),X(-1521486534,1595750129),X(1359893119,-1377402159),X(-1694144372,725511199),X(528734635,-79577749),X(1541459225,327033209)],l=X(0,0),p=X(0,0),j=X(0,0),g=X(0,0),q=X(0,0),s=X(0,0),f=X(0,0),y=X(0,0),u=X(0,0),v=X(0,0),G=X(0,0),h=X(0,0),k=X(0,0),m=X(0,0),n=X(0,0),C=X(0,0),D=X(0,0),t,w,ba,H=Array(80);for(w=0;80>w;w++)H[w]=X(0,0);a[b>>2]|=128<<(3-b%4<<3);a[(b+16>>7<<5)+31]=b<<3;w=0;for(ba=a.length;w<ba;w+=32){Y(j,e[0]);Y(g,e[1]);Y(q,e[2]);Y(s,e[3]);Y(f,e[4]);Y(y,e[5]);Y(u,e[6]);Y(v,e[7]);for(t=0;16>t;t++)H[t].a=a[w+2*t],H[t].b=a[w+2*t+1];for(t=16;80>t;t++){Z(n,H[t-2],19);Ma(C,H[t-2],29);var O=D,I=H[t-2];O.b=I.b>>>6|I.a<<26;O.a=I.a>>>6;h.b=n.b^C.b^D.b;h.a=n.a^C.a^D.a;Z(n,H[t-15],1);Z(C,H[t-15],8);O=D;I=H[t-15];O.b=I.b>>>7|I.a<<25;O.a=I.a>>>7;G.b=n.b^C.b^D.b;G.a=n.a^C.a^D.a;var O=H[t],J=H[t-7],S=H[t-16],I=(h.b&65535)+(J.b&65535)+(G.b&65535)+(S.b&65535),ea=(h.b>>>16)+(J.b>>>16)+(G.b>>>16)+(S.b>>>16)+(I>>>16),fa=(h.a&65535)+(J.a&65535)+(G.a&65535)+(S.a&65535)+(ea>>>16),J=(h.a>>>16)+(J.a>>>16)+(G.a>>>16)+(S.a>>>16)+(fa>>>16);O.b=I&65535|ea<<16;O.a=fa&65535|J<<16}for(t=0;80>t;t++)k.b=f.b&y.b^~f.b&u.b,k.a=f.a&y.a^~f.a&u.a,Z(n,f,14),Z(C,f,18),Ma(D,f,9),h.b=n.b^C.b^D.b,h.a=n.a^C.a^D.a,Z(n,j,28),Ma(C,j,2),Ma(D,j,7),G.b=n.b^C.b^D.b,G.a=n.a^C.a^D.a,m.b=j.b&g.b^j.b&q.b^g.b&q.b,m.a=j.a&g.a^j.a&q.a^g.a&q.a,O=l,J=La[t],S=H[t],I=(v.b&65535)+(h.b&65535)+(k.b&65535)+(J.b&65535)+(S.b&65535),ea=(v.b>>>16)+(h.b>>>16)+(k.b>>>16)+(J.b>>>16)+(S.b>>>16)+(I>>>16),fa=(v.a&65535)+(h.a&65535)+(k.a&65535)+(J.a&65535)+(S.a&65535)+(ea>>>16),J=(v.a>>>16)+(h.a>>>16)+(k.a>>>16)+(J.a>>>16)+(S.a>>>16)+(fa>>>16),O.b=I&65535|ea<<16,O.a=fa&65535|J<<16,$(p,G,m),Y(v,u),Y(u,y),Y(y,f),$(f,s,l),Y(s,q),Y(q,g),Y(g,j),$(j,l,p);$(e[0],e[0],j);$(e[1],e[1],g);$(e[2],e[2],q);$(e[3],e[3],s);$(e[4],e[4],f);$(e[5],e[5],y);$(e[6],e[6],u);$(e[7],e[7],v)}l=Array(19);for(w=0;8>w;w++)l[2*w+3]=e[w].a,l[2*w+4]=e[w].b;return l}function X(a,b){return{a:a,b:b}}function Y(a,b){a.a=b.a;a.b=b.b}function Z(a,b,e){a.b=b.b>>>e|b.a<<32-e;a.a=b.a>>>e|b.b<<32-e}function Ma(a,b,e){a.b=b.a>>>e|b.b<<32-e;a.a=b.b>>>e|b.a<<32-e}function $(a,b,e){var l=(b.b&65535)+(e.b&65535),p=(b.b>>>16)+(e.b>>>16)+(l>>>16),j=(b.a&65535)+(e.a&65535)+(p>>>16),b=(b.a>>>16)+(e.a>>>16)+(j>>>16);a.b=l&65535|p<<16;a.a=j&65535|b<<16}function Ia(a){for(var b=0;1024<=a&&3>b;)a/=1024,b+=1;b&&(a=100<=a?a|0:10<=a?(10*a|0)/10:(100*a|0)/100);a+=" ";switch(b){case 1:a+="k";break;case 2:a+="M";break;case 3:a+="G"}return a+"B"}function V(a,b,e,l,p,j){return((((b|0)+(a|0)|0)+((l|0)+(j|0)|0)|0)<<p|(((b|0)+(a|0)|0)+((l|0)+(j|0)|0)|0)>>>32-p|0)+(e|0)|0}function T(a,b,e,l,p,j,g){return V(b&e|~b&l,a,b,p,j,g)}function U(a,b,e,l,p,j,g){return V(b&l|e&~l,a,b,p,j,g)}function W(a,b,e,l,p,j,g){return V(e^(b|~l),a,b,p,j,g)}la();';
