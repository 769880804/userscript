// ==UserScript==
// @name           Mini Service Record
// @namespace      bungie.net
// @description    Displays a miniture service record.
// @include        http://*bungie.net/*
// @version        1.2
// ==/UserScript==
//By APOCALYPEX
var GAMERTAG = GM_getValue("gamertag_name");var imgasrc = "http://www.bungie.net/card/halo3/USER.ashx";var SRPicture =  imgasrc.replace( "USER", GAMERTAG);var currenturl = document.URL;var activate = true;var posts = document.documentElement.getElementsByTagName("a").item(8);var surf = document.documentElement.getElementsByTagName("a").item(13);if(currenturl == "http://www.bungie.net/setgamertag"){var OriginalPAGE, setupPAGE;OriginalPAGE = document.getElementsByTagName('div').item(0);if (OriginalPAGE) {setupPAGE =document.createElement('div');setupPAGE.innerHTML = '<div id="Settings" align="center" style="margin-top:100px;""><strong>Current Gamertag:</strong><br /><img id="SERVICERECORDPIC" src="http://www.bungie.net/card/halo3/USER.ashx"><br /><br /><strong>Typed in gamertag:</strong><br /><img id="Example" src="http://www.bungie.net/card/halo3/USER.ashx"><br /><br /><p style="font-size:13px;font-color="#FFFFFF";"><strong>Type in your gamertag:</strong> <input id="XBLgamertag" type="text"><br /><br /><input type="button" value="Save" id="submitbutton"><input type="button" value="Test" id="refresher"><input type="button" value="Delete" id="deletey"></p></div>';OriginalPAGE.parentNode.replaceChild(setupPAGE, OriginalPAGE);document.title = "Mini Service Record V.1";}var SUBMIT = document.getElementById('submitbutton');SUBMIT.addEventListener("click", setgamertag, true);var REFRESHER = document.getElementById('refresher');REFRESHER.addEventListener("click", exampleimg, true);var DELETEY = document.getElementById('deletey');DELETEY.addEventListener("click", deletegamertag, true);document.getElementById('SERVICERECORDPIC').src = SRPicture;}function setgamertag(){var name = document.getElementById('XBLgamertag').value;GM_setValue("gamertag_name", name);alert("Saved! Page will reload.");window.location.reload();}function exampleimg(){var name = document.getElementById('XBLgamertag').value;var expic =  imgasrc.replace( "USER", name);document.getElementById('Example').src = expic;}function deletegamertag(){GM_deleteValue("gamertag_name");alert("Gamertag deleted, this page will reload");window.location.reload()}function createservice() {if (GAMERTAG == null) {var asky = confirm("You have not setup your gamertag, do you want to? (you will only be asked this once)");if (asky==true){window.location.assign("http://www.bungie.net/setgamertag");}else{GM_setValue("gamertag_name", " ");}}else if (GAMERTAG == " "){var lol = "lol at you";}else { var ServiceR, record;if(currenturl.search("posts") == -1){ServiceR = document.documentElement.getElementsByTagName("a").item(8);}else{ServiceR = document.documentElement.getElementsByTagName("a").item(13);}if (ServiceR) {record = document.createElement('div');record.innerHTML = '<div id="DBOX" style="position:absolute;left:0%;z-index:300;margin-top:40px;"><img id="SERVICERECORDPIC" src="http://www.bungie.net/card/halo3/USER.ashx"></div>';ServiceR.parentNode.insertBefore(record, ServiceR.nextSibling);document.getElementById('SERVICERECORDPIC').src = SRPicture;}}}function removeservice() {var sr = document.getElementById('DBOX');if (sr) {sr.parentNode.removeChild(sr);}}if(currenturl.search("posts") == -1){posts.addEventListener("mouseover", createservice, true);posts.addEventListener("mouseout", removeservice, true);} else{surf.addEventListener("mouseover", createservice, true);surf.addEventListener("mouseout", removeservice, true);}
var SRlinkwinky = document.getElementById('ctl00_footer_fMenuControl_rptMenu_ctl02_rptSubMenu_ctl05_hypMenu');SRlinkwinky.innerHTML = "Service Record Setup";SRlinkwinky.href = "http://www.bungie.net/setgamertag";
//Hey look its my first scriptorz that does something FLYB