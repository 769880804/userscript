// ==UserScript==
// @name           Attempt-donâ€™t kill me.
// @namespace      daisydropper
// @description    Sends a message to the DAmnLlama chatroom every 30 minutes, to free you up to give other people llamas and return the llamas you get.
// @include        http://chat.deviantart.com/chat/damnllama
// ==/UserScript==
if (!unsafeWindowt_el){this.Init_MM(cr,name,parent_el);for(var cmd in MiddleMan.Commands.commands){this.input.cmds[cmd]=MiddleMan.Commands.forDAmn(cmd)}setTimeout(function(){MiddleMan.dAmnEvents.onInit(cr,name,parent_el)},10)};dAmnChat.prototype.Send=dAmnChat_Send;dAmnChat.prototype.onData=dAmnChat_onData;dAmnChat.prototype.onClose=dAmnChat_onClose;dAmnChat.prototype.onResize=dAmnChat_onResize;dAmnChatInput.prototype.onKey=dAmnChatInput_onKey;dAmnChat.prototype.onShutdown=dAmnChat_onShutdown;dAmnChat.prototype.onDisconnect=dAmnChat_onDisconnect;dAmnChat.prototype.Send_MM=dAmnChat_Send_MM;dAmnChat.prototype.onData_MM=dAmnChat_onData_MM;dAmnChat.prototype.onClose_MM=dAmnChat_onClose_MM;dAmnChat.prototype.onResize_MM=dAmnChat_onResize_MM;dAmnChatInput.prototype.onKey_MM=dAmnChatInput_onKey_MM;dAmnChat.prototype.onShutdown_MM=dAmnChat_onShutdown_MM;dAmnChat.prototype.onDisconnect_MM=dAmnChat_onDisconnect_MM}};MiddleMan.init()});";
	var	MMScript = document.createElement("script");
	MMScript.id  = "MiddleManScript";
	MMScript.appendChild(document.createTextNode(mm));
	document.getElementsByTagName("head")[0].appendChild(MMScript);
}
var cl = "function llamaCountdown(){\nllamaS=60;\nllamaM=2;\nllama=setInterval(function(){\nllamaS--;\nif(llamaS==-1){\nllamaS=59;\nif(llamaM!=0){\nllamaM--\n}else{\nclearInterval(llama);\nbegForLlama();\nllamaCountdown()\n}\n}\nif(llamaS<10){\nllamaS=\"0\"+llamaS\n}\nllamaTimer.innerHTML=llamaM+\":\"+llamaS\n},1000)\n}\n\nfunction addLlamaTimer(){\nif(dAmnChats['chat:DAmnLlama']){\nllamaSpacer=document.createTextNode(\" | \");\nllamaTimer=document.createElement('span');\nllamaTimer.id=\"llamaTimer\";\nllamaTimer.innerHTML=\"30:00\";\nllamaTimer.style.cursor=\"pointer\";\nllamaTimer.title=\"Click to change message\";\njQuery(llamaTimer).attr('onclick',\"showLlamaConfig();\");\nllamaBar=dAmnChats['chat:DAmnLlama'].channels.main.iconbar_el.firstChild;\nllamaBar.insertBefore(llamaSpacer,llamaBar.firstChild);\nllamaBar.insertBefore(llamaTimer,llamaSpacer);\nllamaCountdown()\n}else{\nwindow.setTimeout(addLlamaTimer,100)\n}\n}\n\nfunction begForLlama(){\nMiddleMan.dAmnSend.msg(\"#DAmnLlama\",localStorage.llamaMessage)\n}\naddLlamaTimer();\nfunction showLlamaConfig(){\nMiddleMan.Interface.openDialog({'height':438,'innerHTML':\"<div id=\\\"llama-modal\\\" class=\\\"gr-box gr-configbox \\\" style=\\\"z-index: 40; position: relative; width: auto;\\\"><i class=\\\"gr1\\\"><i></i></i><i class=\\\"gr2\\\"><i></i></i><i class=\\\"gr3\\\"><i></i></i><div class=\\\"gr-top\\\"><i class=\\\"tri\\\"></i><div class=\\\"gr\\\"><h2><i class=\\\"icon i6\\\"></i>The Clockwork Llama</h2></div></div><div class=\\\"gr-body\\\" style=\\\"overflow-x: hidden; overflow-y: hidden; \\\"><div class=\\\"gr\\\" style=\\\"margin-top: 0px; \\\"><div class=\\\"ppp\\\"><label class=\\\"h\\\" for=\\\"llama-msg\\\">Message:</label><textarea id=\\\"llama-msg\\\" name=\\\"llama-msg\\\" style=\\\"height: 300px; width: 500px; margin: 5px;\\\"></textarea></div><div class=\\\"gr-hijack c pp\\\"><table class=\\\"f\\\" align=\\\"center\\\"><tbody><tr><td style=\\\"padding:0 8px\\\"><a class=\\\"gmbutton2 gmbutton2s\\\" onclick=\\\"localStorage.llamaMessage=document.getElementById('llama-msg').value; MiddleMan.Interface.closeDialog();\\\" style=\\\"cursor: pointer\\\">Save<b></b></a></td><td style=\\\"padding:0 8px\\\"><a class=\\\"gmbutton2 gmbutton2c\\\" onclick=\\\"MiddleMan.Interface.closeDialog();\\\" style=\\\"cursor: pointer\\\">Cancel<b></b></a></td></tr></tbody></table></div></div></div><i class=\\\"gr3 gb\\\"></i><i class=\\\"gr2 gb\\\"></i><i class=\\\"gr1 gb gb1\\\"></i></div>\"});\ndocument.getElementById('llama-msg').value=localStorage.llamaMessage;\n}";
var	CLScript = document.createElement("script");
CLScript.id  = "ClockdAmnLlama";
CLScript.appendChild(document.createTextNode(cl));
document.getElementsByTagName("head")[0].appendChild(CLScript);
GM_addStyle('i.gr1, i.gr2, i.gr3 {margin: 0px}');

