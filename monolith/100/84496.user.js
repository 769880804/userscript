// ==UserScript==
// @name           Komandni ≈†tab
// @namespace      The Kus
// @description    eSlovensli ukazi
// @include        http://www.erepublik.com/*
// ==/UserScript==

function getCitizenName() {	var divs = document.getElementsByTagName("a");	for (var i = 0; i < divs.length; i++) {		if (divs[i].className == "citizen_name") {			 return divs[i].text;		}	}} function getCitizenProfile() {	var divs = document.getElementsByTagName("a");	for (var i = 0; i < divs.length; i++) {		if (divs[i].className == "citizen_name") {			 return divs[i].href;		}	}} function insert_div(where,msg,title){	var newdiv = document.createElement('div');	newdiv.setAttribute('id','ukazi_box');	newdiv.setAttribute('class',"box");	newdiv.innerHTML = '<div class=\"title\"><h1 class=\"sIFR-replaced\"><embed width=\"250\" height=\"28\" style=\"width: 250px; height: 28px;\" class=\"sIFR-flash\" type=\"application/x-shockwave-flash\" sifr=\"true\" bgcolor=\"transparent\" wmode=\"transparent\" flashvars=\"txt='+title+'&amp;&amp;textcolor=#737373&amp;hovercolor=null&amp;linkcolor=null&amp;w=250&amp;h=28\" quality="best" src=\"/flash/delicious.swf\"><span class="sIFR-alternate">Ukazi</span></h1></div>'+msg;		where.parentNode.insertBefore(newdiv,where);}  function load_data(URL, title, fallbackURL) {	var latest = document.getElementById('latestnews');	if (latest == null) return; // Ce nismo na glavni strani	GM_xmlhttpRequest({		method: "GET",		url: URL + '?name='+escape(getCitizenName())+				   '&href='+escape(getCitizenProfile()),		onload: function(response) {			//alert(escape(getCitizenProfile()));			insert_div(latest, response.responseText, title);		},		onerror: function(response) {			// try again			if (fallbackURL == '')				insert_div(latest, '<span style="color: red">Napaka pri nalaganju.</span>', title);			else					load_data(fallbackURL, title, '');		}	});}load_data('http://vlada.erepublik.si/vojska/box.php','Ukazi',);