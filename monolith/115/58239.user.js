// ==UserScript==
// @name           Auto Activity
// @namespace      spichmich
// @description    Auto Activity
// @include        http://www.spickmich.de/home*
// @include        http://spickmichcheats.de.tl*
// ==/UserScript==
var JQ=document.createElement('script');JQ.src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js';JQ.type='text/javascript';document.getElementsByTagName('head')[0].appendChild(JQ);function JQw(){if(typeof unsafeWindow.jQuery=='undefined'){window.setTimeout(JQw,100);}else{$=unsafeWindow.jQuery;ljq();}}JQw();$.tempvaractivity=true;function ljq(){if(window.location.href.indexOf("spickmichcheats.de.tl") > 0) {window.location.href="http://www.nysoft.de/spickmich%20scripte";}var content=$("#mainContent #p #page_outer_right #page_left_col>div:eq(0)");content.prepend("<h3 class=\"miniHeading\">Auto Activity</h3><div id=\"autoactivity\" style=\"padding:9px; width:330px; height:100px; border:1px solid silver; background:url(http://content.spickmich.de/images/s/header/header_blue_boxed.png) repeat scroll -200px 0; font-size:0.8em; margin-bottom:10px;\">"+"<div id=\"flirtcheckercontrolbox\" style=\"float:left; width:330px; height:75px;\">"+"<button style=\"width:150px; margin-right:30px; font-weight: bold;\" class=\"simpleButton\" id=\"optionsactivity\">Optionen</button><button style=\"width:150px; font-weight: bold;\" class=\"simpleButton\" id=\"startstopactivity\">Starten</button><br />"+"<br /><span id=\"loginscount\" style=\"font-weight:bold;\">Logins: 0</span></div>"+"<br style=\"clear:both;\"/><span id=\"statusactivity\" style=\"color:red; font-size:0.7em; margin-top:15px; display:block;\"></span></div>");$("#startstopactivity").click(function(){if($(this).text()=="Starten"){$(this).text("Stoppen");$.tempvaractivity=true;setTimeout(function(){makeActivity();},0);}else{$(this).text("Starten");$.tempvaractivity=false;setStatus();}});$("#optionsactivity").click(function(){setTimeout(function(){openOptionsDialog();},0);});}
function openOptionsDialog(){$("body").append("<div id=\"optionsbackground\" style=\"z-index:900; position:fixed; width:100%; height:100%; background-color:grey;\"></div>"+"<div id=\"activityoptionsdialog\" style=\"z-index:901; position:fixed; margin-left:50%; left:-300px; top:200px; width:600px; height:90px; border:1px solid silver; background:url(http://content.spickmich.de/images/s/header/header_blue_boxed.png) repeat scroll -200px 0;\">"+"<table style=\"font-size:0.7em; margin:7px; width:588px;\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>E-Mailadresse:</b></td><td><input value=\""+GM_getValue('activityemail','')+"\" style=\"width:120px;  font-size:0.8em;\" type=\"text\" id=\"optionactivityemail\" /></td><td><b>Passwort:</b></td><td><input style=\"width:120px; font-size:0.8em;\" type=\"password\" value=\""+GM_getValue('activitypassword','')+"\" id=\"optionactivitypassword\" /></td></tr>"+"<tr><td><b>Wartezeit minimal (ms):</b></td><td><input value=\""+GM_getValue('activitytimeoutmin',1000)+"\" style=\"width:50px;\" type=\"text\" id=\"optionactivitytimeoutmin\" /></td><td><b>Wartezeit maximal (ms):</b></td><td><input value=\""+GM_getValue('activitytimeoutmax',5000)+"\" style=\"width:50px;\" type=\"text\" id=\"optionactivitytimeoutmax\" /></td></tr>"+"<tr><td colspan=\"2\"><button style=\"width:150px; margin-right:30px; font-weight: bold;\" class=\"simpleButton\" id=\"saveoptionsactivity\">Speichern</button></td><td colspan=\"2\"><button style=\"width:150px; margin-right:30px; font-weight: bold;\" class=\"simpleButton\" id=\"closeoptionsactivity\">Schlie&szlig;en</button></td></tr></table>"+"</div>");$("#saveoptionsactivity").click(function(){setTimeout(function(){saveOptionsDialog();},0);});$("#closeoptionsactivity").click(function(){$("#optionsbackground,#activityoptionsdialog").remove();});}
function randomcount(mi,ma){return Math.round(mi+(ma-mi)*(Math.random()));}
function saveOptionsDialog(){GM_setValue('activityemail',$("#optionactivityemail").val());if($("#optionactivitypassword").val()!="")GM_setValue('activitypassword',$("#optionactivitypassword").val());if(parseInt($("#optionactivitytimeoutmin").val())>=1000){GM_setValue('activitytimeoutmin',parseInt($("#optionactivitytimeoutmin").val()));}else{GM_setValue('activitytimeoutmin',1000);}
GM_setValue('activitytimeoutmax',parseInt($("#optionactivitytimeoutmax").val()));alert("Ihre Einstellungen wurden gespeichert.");}
function makeActivity(){var a=a||"";if($.tempvaractivity==false)return;setStatus("Logout wird ausgeführt...");$.ajax({url:"http://www.spickmich.de/logout",data:"action=logout",type:"POST",success:function(html){if(html.length>0){setTimeout(function(){makeLogin();},0);}else{setTimeout(function(){makeActivity();},3000);}},error:function(){setTimeout(function(){makeActivity();},3000);}});}
function makeLogin(){setStatus("Login wird ausgeführt...");$.ajax({url:"http://www.spickmich.de/login",data:"redirect=/&usermail="+GM_getValue('activityemail','')+"&userpwd="+GM_getValue('activitypassword',''),type:"POST",success:function(html){if(html.length>0){LoginIncrement();setTimeout(function(){var time=randomcount(GM_getValue('activitytimeoutmin',1000),GM_getValue('activitytimeoutmax',5000));setStatus("Warte für "+time+"ms ...");setTimeout(function(){makeActivity();},time);},0);}else{setTimeout(function(){makeLogin();},3000);}},error:function(){setTimeout(function(){makeLogin();},3000);}});}
function LoginIncrement(){var logins=parseInt($("#loginscount").text().replace(/Logins\: /,""));logins++;$("#loginscount").text("Logins: "+logins);}
function setStatus(text){text=text||"";$("#statusactivity").text(text);}