// ==UserScript==
// @name           Forums++
// @namespace      Forums
// @include        http://*.leagueoflegends.com/*
// @require  http://code.jquery.com/jquery-1.7.2.min.js
// ==/UserScript==
(function(a,c,e,f,l,n,o){function r(a){var c,f,d=this,k=a.length,g=0,h=d.i=d.j=d.m=0;d.S=[];d.c=[];for(k||(a=[k++]);g<e;)d.S[g]=g++;for(g=0;g<e;g++)c=d.S[g],h=h+c+a[g%k]&e-1,f=d.S[h],d.S[g]=f,d.S[h]=c;d.g=function(a){var c=d.S,j=d.i+1&e-1,g=c[j],f=d.j+g&e-1,k=c[f];c[j]=k;c[f]=g;for(var h=c[g+k&e-1];--a;)j=j+1&e-1,g=c[j],f=f+g&e-1,k=c[f],c[j]=k,c[f]=g,h=h*e+c[g+k&e-1];d.i=j;d.j=f;return h};d.g(e)}function q(a,c,e,d,f){e=[];f=typeof a;if(c&&"object"==f)for(d in a)if(5>d.indexOf("S"))try{e.push(q(a[d],
c-1))}catch(g){}return e.length?e:a+("string"!=f?"\x00":"")}function m(a,c,f,d){a+="";for(d=f=0;d<a.length;d++){var k=c,g=d&e-1,h=(f^=19*c[d&e-1])+a.charCodeAt(d);k[g]=h&e-1}a="";for(d in c)a+=String.fromCharCode(c[d]);return a}c.seedrandom=function(j,s){var p=[],d,j=m(q(s?[j,a]:arguments.length?j:[(new Date).getTime(),a,window],3),p);d=new r(p);m(d.S,a);c.random=function(){for(var a=d.g(f),c=o,h=0;a<l;)a=(a+h)*e,c*=e,h=d.g(1);for(;a>=n;)a/=2,c/=2,h>>>=1;return(a+h)/c};return j};o=c.pow(e,f);l=c.pow(2,
l);n=2*l;m(c.random(),a)})([],Math,256,6,52);var folder="http://dl.dropbox.com/u/9244359/summoner/",usernames=[];
if(-1!=document.URL.indexOf("board")){for(var lol_hidden=$(".forum_post.post_frame"),i=0;i<lol_hidden.length;i++){var x=$(lol_hidden[i]),id=x.attr("id").substring(4),b=isBlocked(id);b&&x.parent(":first").remove()}for(var likeTexts=[],r_blocks=$(".r_block"),ratings=$(".post_rating"),down=$(".vote_down_button"),i=0;i<r_blocks.length;i++)try{likeTexts[i]=r_blocks[i].parentNode,ratings[i].style.display="none",down[i].style.display="none"}catch(err){}for(i=0;i<likeTexts.length;i++){var agree=ratings[i].textContent.replace(/ |\n|\t/g,
""),agreeNum=parseInt(agree),width=700,barWidth=7,maxBars=Math.floor(width/barWidth)+1,bars=agreeNum;bars>maxBars&&(bars=maxBars);if(0<agreeNum){var old,Breeder=document.createElement("div");Breeder.style.display="inherit";Breeder.style.height="12px";Breeder.style.backgroundColor="rgb(212,173,84)";for(X=0;X<bars;X++){var text=document.createElement("div");text.style.width=barWidth+"px";text.style.backgroundColor="rgb(0,"+10*X+",0)";text.style.height="10px";text.style.display="table-cell";text.style.border=
"1px solid rgb(212,173,84)";null==old?Breeder.appendChild(text):Breeder.appendChild(text,old);old=text}Breeder.style.width=bars*barWidth+"px";likeTexts[i].appendChild(Breeder,likeTexts[i].firstChild)}}for(var postBox=$("#posts"),Posts=postBox.children(),i=0;i<Posts.length-1;i++){var spam=$("<div class=spamButton/>");spam.css("height","20px");spam.css("width","20px");spam.css("position","relative");spam.css("background-image","url("+folder+"contentMod/SPAM.png)");spam.css("left","95%");spam.css("top",
"10px");spam.click(spamClick);spam.hover(function(){$(this).css("background-position","20px 0px")},function(){$(this).css("background-position","0px 0px")});$(Posts[i]).children(":first").remove();$(Posts[i]).children(":first").before(spam)}for(var comments=$(".post_content"),usernames_raw=$(".avatar"),i=0;i<usernames_raw.length;i++)usernames[i]=usernames_raw[i].children[0].textContent;for(i=0;i<comments.length;i++)if("^"==comments[i].children[0].textContent)try{comments[i].children[0].textContent=
"I agree with "+usernames[i-1]+"."}catch(err$$1){comments[i].children[0].textContent="I agree with the previous post."}for(var icons=$(".user_summoner_icon"),i=0;i<icons.length;i++)if(-1!=icons[i].src.indexOf("unknown_icon.jpg")){Math.seedrandom(usernames[i]);var randomnumber=Math.floor(100*Math.random());icons[i].src=folder+formatNumber(randomnumber)+".png"}}
if(-1!=document.URL.indexOf("account")){var currentUser=document.getElementsByClassName("welcome_text")[0].textContent,currentUser=currentUser.replace(/ |\t|\n/g,""),currentUser=currentUser.replace(/[A-Z]/,""),currentUser=currentUser.substring(currentUser.search(/[A-Z]|[0-9]/)),currentUser=currentUser.substring(0,currentUser.search(/[(]/));$(".page_header_text")[0].textContent=currentUser;var header=document.getElementById("page_header");header.style.background="url("+folder+"header_full.png) no-repeat";
header.style.paddingTop="14px";header.style.paddingLeft="9px";var Portrait=document.createElement("div");Math.seedrandom(currentUser);randomnumber=Math.floor(100*Math.random());Portrait.style.background="url("+folder+""+formatNumber(randomnumber)+".png) no-repeat";Portrait.style.display="inherit";Portrait.style.width="80px";Portrait.style.height="80px";header.appendChild(Portrait);var box=document.getElementsByClassName("box_style1 floatlt")[0],topBox=box.parentNode,box=box.cloneNode(!0);box.children[0].children[0].textContent=
"Forums++";var reset=box.children[2],content=box.children[1];reset.removeChild(reset.children[0]);content.removeChild(content.children[0]);reset.style.background="none";content.style.background="none";var image=document.createElement("div");image.style.background="url("+folder+"contentMod/45.png) no-repeat";image.style.width="45px";image.style.marginTop="10px";image.style.marginLeft="12px";image.style.height="45px";image.style.border="1px solid rgb(212,173,84)";image.style.display="inherit";var text=
content.children[0],rText=reset.children[0];text.children[0].textContent="F++ Forum page";rText.children[0].textContent="Reset hidden posts";text.textContent="Forum++ page, where you can check for updates, and post suggestions.";rText.textContent="Reset all hidden forum posts. Cannot be undone.";var link=document.createElement("a"),rLink=document.createElement("a");link.setAttribute("href","http://euw.leagueoflegends.com/board/showthread.php?p=8106868");rLink.setAttribute("id","SyzResetButton");link.textContent=
"F++ homepage";rLink.textContent="Reset hidden posts";text.insertBefore(link,text.firstChild);rText.insertBefore(rLink,rText.firstChild);content.insertBefore(image,content.firstChild);reset.insertBefore(image.cloneNode(!0),reset.firstChild);topBox.appendChild(box);$("#SyzResetButton").click(delCookie);$("#SyzResetButton").css("cursor","pointer")}function formatNumber(a){return 9<a?100==a?"0100":"00"+a:"000"+a}
function spamClick(){var a=$(this).parent(":first").attr("id").substring(4);$(this).parent(":first").slideUp("slow");cookie(a)}function cookie(a){var c=_readCookie("F++");isBlocked(a)||(null!=c?_createCookie("F++",c+","+a,365):_createCookie("F++",a,365))}function isBlocked(a){var c=[];try{c=_readCookie("F++").split(",");for(M=0;M<c.length;M++)if(c[M]==a)return!0}catch(e){}return!1}function delCookie(){confirmPost()&&_eraseCookie("F++")}
function confirmPost(){return confirm("Are you sure?")?!0:!1}function _createCookie(a,c,e){if(e){var f=new Date;f.setTime(f.getTime()+864E5*e);e="; expires="+f.toGMTString()}else e="";document.cookie=a+"="+c+e+"; path=/"}function _readCookie(a){for(var a=a+"=",c=document.cookie.split(";"),e=0;e<c.length;e++){for(var f=c[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0==f.indexOf(a))return f.substring(a.length,f.length)}return null}function _eraseCookie(a){_createCookie(a,"",-1)};
