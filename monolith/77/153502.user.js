// ==UserScript==
// @name   JoyTwitterX
// @author  joyscripts
// @exclude *
// ==/UserScript==
;(function(){if(''!=document.title){lh=location.href;twitterimg='<img align=middle width=20 height=20 border=0 src=http:'+'//twitter-badges.s3.amazonaws.com/t_logo-a.png>';if(!navigator.userAgent.match(/(Opera|Safari|Chrome|Firefox|MSIE)/)){;
 }else if((lh.match(/:\/\/twitter\.com\/?#?!?\/?twitter\.com/))){location.replace(lh.replace(/(:\/\/twitter\.com\/?#?!?\/?twitter\.com)/,'://twitter.com'));
 }else if((lh.match(/:\/\/twitter\.com\/(#!\/@?[\w\-\.]+|@?[\w\-\.]+|#!\/?$|\/?$)/))&&(!lh.match(/:\/\/twitter\.com\/?#?!?\/?twitter\.com/))&&(!lh.match(/(\/following$|\/followers$|\/lists$|\/settings\/|\/media\/|\/i\/)/))){function addElementBody(doc){if(ele=document.createElement('div')){with(ele){id='BodyChild';innerHTML=doc;}if(lh.match(/(\/|=)/)){document.body.appendChild(ele);return(1);}}return(0);}color='#A0C0F0';border='2';lt=5;m=2;n=1000; deg0='-moz-transform:rotate(0deg) !important;-webkit-transform:rotate(0deg) !important;-o-transform:rotate(0deg) !important;';deg10='-moz-transform:rotate(-10deg) !important;-webkit-transform:rotate(-10deg) !important;-o-transform:rotate(-10deg) !important;'; ti=document.getElementById('timeline');g=ti.getElementsByTagName('h2');if((0!=g[0].innerHTML.length)&&(20>g[0].innerHTML.length)){g[0].innerHTML='';
    addElementBody('<img style=display:none;width:0px;height:0px; width=0 height=0 border=0 src=http://twitpic.com/anxwke><style>media-row,.flex-module{overflow:hidden !important}.preview,.preview-message,.thumbnail-placeholder,*[data-load-status="not-loaded"]{display:none !important;}div.tweet:hover > div > p > span > a:not(:hover) > b:not(:hover) > img:not(:hover){width:320px !important;}div.tweet:hover > div > p > span > a{z-index:1999 !important;} div.tweet:not(:hover) > div > p > div:not(:hover) > ul > li > a > img{width:40px !important;height:40px !important;'+deg10+'}div.tweet:hover > div > p > div:not(:hover) > ul > li > a > img{width:40px !important;height:40px !important;}div.tweet:hover > div > p > div:hover > ul > li > a > img{max-width:none !important;max-height:none !important;width:160px !important;height:auto !important;}'+
    'div.tweet:hover > div > p > div:hover > ul > li > a{z-index:1999 !important;position:relative;right:135px;}div.tweet:hover > div > p > div > ul > li > a > img{'+deg0+'}div.open:hover > div > div > div > p > div > ul > li > a{position:relative;right:-10px;}div.with-social-proof > div > div > div > p > div > ul > li > a{position:relative;right:10px;}div > h2 > span:hover > a > b:not(:hover) > b:not(:hover) > img:not(:hover){z-index:1999;position:absolute;right:527px;width:320px !important;border-style:solid;border-width:'+border+'px;border-color:'+color+';}h2 > span > a > img:hover{position:relative;top:1px !important;left:1px !important;}p.js-tweet-text > span > a:hover{position:absolute;bottom:-1px !important;right:511px !important;}.account-arrow{z-index:2;}.dm-thread-list,.js-dm-thread-list{}</style>');
    setInterval(TwiiterExtend="at=document.getElementsByTagName('p');ti=document.getElementById('timeline');g=ti.getElementsByTagName('h2');g0=g[0].innerHTML;g0=g0.substr((g0+'<').indexOf('<'));for(i=0;Math.min("+(n+2)+",at.length)>i;i++){a=at[i];listurl='';twurl='';txurl='';txlen=0;imgadd='';imgaddx='';if((0<a.innerHTML.indexOf(' data-pre-embedded=\"true\"'))&&(0<a.innerHTML.lastIndexOf('></a></li></ul></div>'))){"+
    "a.innerHTML=a.innerHTML.replace('data-pre-embedded=\"true\"','data-pre-embedded=\"true\" data-expanded-url=\"http://'+a.innerHTML.split(' data-pre-embedded=\"true\"')[1].split('>')[1].split('<')[0]+'\"');}if((0>a.innerHTML.indexOf('title=\"\"'))&&(0<a.innerHTML.indexOf('data-expanded-url='))){d=a.innerHTML.split('data-expanded-url');for(j=1;d.length>j;j++){listurl+=' '+d[j].split('\"')[1].split('\\'').join('%27');}a.innerHTML=d.join('title=\"*\" data-expanded-url');l=listurl.split(' ');d=a.getElementsByTagName('a');k=0;for(j=0;d.length>j;j++){if('*'==d[j].title){k++;t=l[k].split('&amp;').join('&');"+
    "if((''==twurl)&&(t.match(/(\\.)(jpe?g|png|gif|bmp)/img))){if(1==k){if(2==l.length){twurl=t;txurl=twurl}else if(2<l.length){twurl=l[k+1].split('&amp;').join('&');txurl=twurl}}}if((''==twurl)||(!t.match(/(\\.)(jpe?g|png|gif|bmp)/img))){twurl=d[j].href;txurl=t;if((2==l.length)||(!t.match(/(\\.)(jpe?g|png|gif|bmp)/img))){if(t.match(/:\\/\\/www\\.youtube\\.com\\/watch\\?([a-uw-z]\\w+=\\w+\\&)*v=/)){t='http://i2.ytimg.com/vi/'+(t+'v=').split('v=')[1].substr(0,11)+'/hqdefault.jpg'}else if(t.match(/:\\/\\/youtu\\.be\\//)){t='http://i2.ytimg.com/vi/'+(t+'be/').split('be/')[1].substr(0,11)+'/hqdefault.jpg'}else if(t.match(/:\\/\\/www\\.nicovideo\\.jp\\/watch\\/(id|sm|nm|nl)/)){t='http://tn-skr2.smilevideo.jp/smile?i='+(t+'ch/').split('ch/')[1].substr(2,11)+'&.jpg';if((''!=twurl)&&(d.length>(j+1))&&(0<d[j+1].href.indexOf('://t.co/'))){d[j+1].href=twurl}}else if(t.match(/:\\/\\/nico\\.ms\\/(id|sm|nm|nl)/)){t='http://tn-skr2.smilevideo.jp/smile?i='+(t+'ms/').split('ms/')[1].substr(2,11)+'&.jpg'}"+
    "else if(t.match(/:\\/\\/moby\\.to\\/[\\w\\-\\.]+$/)){t+='?&.jpg:square'}else if(t.match(/:\\/\\/yfrog\\.com\\/[\\w\\-\\.]+$/)){t+='?&.jpg:small'}else if(t.match(/:\\/\\/photozou\\.jp\\/photo\\/show\\/\\d+\\/\\d+\\/?$/)){t='http://photozou.jp/p/thumb/'+t.split('/')[6]+'?&.jpg'}else if(t.match(/:\\/\\/instagr\\.am\\/p\\/[\\w\\-\\.]+\\/$/)){t+='media/?size=t&.jpg'}else if(t.match(/:\\/\\/lockerz\\.com\\/s\\/\\d+$/)){t='http://api.plixi.com/api/tpapi.svc/imagefromurl?size=thumbnail&.jpg&url='+t}else if(t.match(/:\\/\\/twitpic\\.com\\/[\\w\\-\\.]+$/)){t='http://twitpic.com/show/thumb/'+(t+'com/').split('com/')[1]+'?&.jpg'}else if(t.match(/:\\/\\/p\\.twipple\\.jp\\/[\\w\\-\\.]+$/)){t='http://p.twipple.jp/show/thumb/'+(t+'jp/').split('jp/')[1]+'?&.jpg'}"+
    "else if((l.length-1==k)&&(0<a.innerHTML.lastIndexOf('></a></li></ul></div>'))){twurl=a.innerHTML.split('<div ')[1].split(' href=')[1].split('\"')[1].split('&amp;').join('&');t=a.innerHTML.split('<div ')[1].split(' src=')[1].split('\"')[1].split('&amp;').join('&').replace(/(\\?size=thumbnail)(&url=http:\\/\\/lockerz.com\\/s\\/)/,'$1&.jpg$2').replace(/(:\\/\\/twitpic\\.com\\/show\\/thumb\\/[\\w\\-\\.]+)$/,'$1?&.jpg').replace(/(\\/default.jpg)$/,'/hqdefault.jpg');}}}twurl=twurl.split('&amp;').join('&');t=t.split('&amp;').join('&');"+
    "if((''!=twurl)&&(t.match(/(\\.)(jpe?g|png|gif|bmp)/img))){d[j].title='';a.innerHTML=a.innerHTML.split('\"*\"').join('\"\"');d[j].href=twurl;if(''==imgadd){tt=a.innerHTML.replace(/(>)([^<]+)(<\\/a>)/img,'$1$3').replace(/(<[^>]+>)/img,'').replace(/^([\\s 　]+)/img,'').split('http')[0];imgadd+='<a style=z-index:2;position:absolute;bottom:0px;right:512px; target=_blank href='+twurl+'><b><img style=z-index:2;border-style:solid;border-width:"+border+"px;border-color:"+color+"; width=96 onerror=\"this.src=this.src.replace(\\'/hqdefault.jpg\\',\\'/default.jpg\\');\" src='+(t=t.replace('?&.jpg:square',':square').replace('?&.jpg:small',':small').replace('?&','?'))+'></b></a>'+"+
    "(twitterx='<a onfocus=this.blur(); target=_blank href=http:'+'//twitter.com/intent/tweet?text='+encodeURIComponent(tt.replace(/([\\r\\n])/img,'')+'\\n'+txurl.replace(/^(https:)/,'https:').replace(/(youtube\\.com\\/watch)(\\?)(v=)/img,'$1?&$3')+('\\n'+t).replace(/^(\\nhttp:\\/\\/twitpic\\.com\\/show\\/thumb\\/\\w+\\?&\\.jpg)$/,'').replace(/^(\\/\\/)/,'http:$1')+' ').split('\\'').join('%27')+'><img width=23 height=23 border=0 src=http://twitter-badges.s3.amazonaws.com/t_logo-a.png></a>').replace(' ',' style=z-index:2;position:absolute;top:64px;left:12px; ');"+
    "imgaddx+='<span style=z-index:1;position:absolute;width:0px;>'+twitterx.replace(' ',' style=z-index:2;position:relative;top:"+Math.floor(24.5*m-11*(1==m))+"px;left:"+Math.floor(36.5*m-11*(1==m))+"px; ')+'</span>'+'<a style=margin-right:"+(m)+"px; target=_blank href='+twurl+'>'+(wimg='<img alt=\"\" onerror=\"this.src=this.src.replace(\\'/hqdefault.jpg\\',\\'/default.jpg\\');\" src='+(imgurl=t)+'>').replace(' ',' width="+(48*m)+" height="+(36*m)+" title=\"'+tt.replace(/([\\s 　]+)/img,' ')+'\" ')+'<b><b>'+wimg.replace(' ',' width=0 ')+'</b></b></a>';}}}}if(0<imgadd.length){a.innerHTML+='<br><span>'+imgadd+'</span>'}"+
    "if((0<imgaddx.length)&&("+n+">(txlen=g0.split('<span>').length))){if(txlen>(i-2)){br=g0.split('<br>').join('').split('<span>');br[(i-2)]+=('<span>'+imgaddx+'</span>');br=br.join('<span>').split('<span>');for(txlen=0;br.length>txlen;txlen++){if((0!=txlen)&&(0==(txlen%"+Math.floor(10/m)+"))){br[txlen]+='<br>'}}g0=br.join('<span>')}else if((0>g0.indexOf(twurl))||(0>g0.indexOf(imgurl))){g0+=('<span>'+imgaddx+'</span>');if((0!=txlen)&&(0==(txlen%"+Math.floor(10/m)+"))){g0+='<br>'}}};}}if(g[0].innerHTML!=g0){g[0].innerHTML=g0}",1111);
} } } } )();
