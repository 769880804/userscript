// ==UserScript==
// @name			MathJax in Wikipedia
// @namespace		http://www.mathjax.org/
// @description		Insert MathJax into Wikipedia pages
// @version			1.0
// @icon			data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%40%00%00%00%40%08%06%00%00%00%AAiq%DE%00%00%00%06bKGD%00%FF%00%FF%00%FF%A0%BD%A7%93%00%00%00%09pHYs%00%00%0B%13%00%00%0B%13%01%00%9A%9C%18%00%00%00%07tIME%07%DD%07%0E%0B%1D2%0Be%DC%0F%00%00%04%99IDATx%DA%ED%9A%7Dh%95U%1C%C7%3F%BE%AD%96o3m%C8%B8%D5%C0rJ%A3%90%A0Y%24%06%81%B3"4I%D2%82%89%28%09%E5"%C8%97%3F%8CB%A8%3F%82F"%CC%88%C2%8A%A8f%2F8%98%0D%B5%2C2%B4%A8%28%1C%8C0%19%F4B%B1%A1a%E6%A6%DB%9C%F7%E9%8F~%0F%FBu8%E7%B9%AF%CF%BDx%9F%F3%85%CB%EE%7D%CE%F7%BC%FC%BE%E7%9C%DF%EF%9C%DF3%F0%F0%F0%F0%F0%F0%F0%282V%02%3D%40%00%A4%81%FD%C0%84%A4%18%DF%25%86o%03%EA%E5%7B%00%3C%93%04%E3%DF%13c%DB%E5%F7%1BJ%80%07%2A%DD%F8fe%EC%D5%F2l%BB%FC%DE%9B%84%D9%EF%17c%0F%26%D1%E9-S%B3%FFp%12%05%F8P%09P%95D%01B%E3O%5Ei%03%9FX%846%EET%DF%BB%93%28%C0%7D%EA%FB%E1%24.%FFo%D4%16%98t%A5%0D~B%91%F6%3F%40%1Fp%93QV%0D4%00%17%80%8B%C0%08pY%84%AA%96%F3%C2d%A0%17%98%03%D4%02%83%C0%100%2A%E3%0B%1D%EB5Rg%2Ap%02%B8U%CA%2F%01%C3%F2%19%93g%C3%C0Y%20%25%F5%86%857E%EA%F7I%FB%05%E3%0E5%FB%ED%96%F2%1D%AA%3C%90A%5C%12%11%02%E3%90%D4%A3%9E%8D%8AX%23j%F0a%D9w%C0%BDF%BB%E6%A7%05%98-%C2%07%EAN%12%00%7F%033%8B%B5%82%9EU%1D%AC%B0%947%00_%AA%01%A4%D5%40N%03k%D5%B6%B9%19%D8"3%97%B6%F0%F7%01%8Dj%15%DC%03%1CQ%FD%0F%00m%C0%5D%B2%0A%AA%80%0D%C0%D7%8AsP%DA%28%1A%8E%AA%C6%AFrp%96%3B%04x%D9%C1os%F0%97%5B%B8%1DJ%1C%97%FF%09%EF%23mq%C6%FF%DF"8s%80s%16%83%0E9%F8%0F9%04x%D2%12%7D%02%F1%07._6_8%7Dq%5C%C7oS%02%BC%9E%21%D4%9E%B0%18%F5%BD%23%0C7%88%C34%05x%D5%10%B5%1F8%03%D4E%F4%1Dn%BF%A5q%CC%FE6%25%C0%EA%0C%DC%0E%8B%00%7F%01%D3%2C%DC%29%C0%EF%16%01%8E%2A%CE%81%88m%11b%A3p%DE%8F%2B%84~%A6%04%98%9E%81%BB%DD"%C0%88%2CQ%1B%BE%B0%F0O%CA%8A%D9%2Ae%2FF%F4W%27%CE%F4%CFbz%7C%D7%FE%EF%CF%21W%60%CEj%B3%83%BF%C7%C2%3F%2F%9E%3F%90%C3W%14%3A%B3%5C%99yc%A1%12%E0%ED%2C%F8%AE%7D%DD%EA%E0%3Fa%11%60%14%F8G%E2x%2A%A2%AFG%A4%EE%C7q%9E%20%9FV%02%3C%96%05%BF%0A%F8%C3"%C0%07%0E%FE%DD%16%01%C2%3A%AB"%FA%99.%8E%F1%3Cp%5D%9C%02t%2B%01fgY%E7%2B%C3%A8%00%F8%D6%11%BF%E7%C9%29%CE4%3ES%B6%E9M%E1%3D%1A%F7%1DbL%3A%3A%9BC%9D%D7%1C%91%60F%0E%2B%A67%A2%FD%A5%C2%F94n%E3%E7%A9%D9%CF%25%C4l%B2%080%06%DC%E2%E0%1F%B3%F0%CF8%96%F6T%E0%17%99%90%BA%B8%F3%01%CDy%DE%FF%7F%B0%3C%9B%14q6%FF%C9%F2l%160%D7%F2%FCy%E0F%60%B3%84%BEX%D1%A9V%40.j%A7%C4%8B%9B%CBzg%86s%86%C97%9D%EE"%89%10%9D%A5%CA%21%5C%94%81%0C%E5%91%7D%3Ae1%E8%13%0B%B75"%0A%BCbp%7F%14%87Y%5B%0A%E3Sj%F6%F3%89%B3%5D%8E%13%9E%BEI%DE.%A7%C4S%12%F3M%01t%DEq%8B%3C%5BW%AA%D9%DF%A8%04%D8%94G%FD%17%2C%02%0C%AA%7D%5D-%F7%80%0B%C0%F5%C0q%0B%FFW%F1%1Ds%25Q%F2y%29Sh%FB%94%00%F5y%D4_%E3%D8%D7MR%1E%BE_%B8_~%EF%B6%F0%87%C4%F7%1C%10%A1%EAK%29%C09%95%B2%CA%07%0B%1C%02%3C.%D9%9B%00xI%F1%D7%3B%F8%ED%F2%F7%A9R%1A_%ABf%BF%2B%CF6j%1C%07%9Cc%92%FB%3Bl%9C%0C%17%CBY%21%ED%B8%1E%974%0B%DD%A2%04h-%A0%9D%E3%0E%83%06%2C%D7%EA%1AK%E8L%CB%DE%9FO%89%F1%8E%12%A0%90%CEw9N%84M%16%EEdK6%29%00%9E%A3%0C8%AD%04%28%04%EB%2C%06E%FD%F7%C8G%FC%3F%AD%FDs9%8C%AFQ%C6%1F%2A%B0%AD%25%86%F1%FB3%F0w%1A%02%2C.%87%00k%94%00%9B%0Bl%AB%8E%F1%17%1D%03r%91%89%C2%83%AA%EF%B7%28%13%DEU%83%98Y%84%D5%D4%21%1E%BF%29%0B~%A3%1Cv%BA%81k%CB%25%C0%60%16%F7%F1%8AE%A3%9A%FD%B5%95n%EC%0D%FC%F7%92%B2%87%F17%29%7B%C9%FC%F6%A7b%D0%ABf%BBV.%27%E1%EF%05I%10%40%A7%BA%A6%29A%96%25e%BF%B70%9E%F0%0C%EF%FC%29%3C%3C%3C%3C%3C%3C%3C%3C%3C%3C%3C%3C%2A%0C%FF%02C%15%0Eg%21j%DA~%00%00%00%00IEND%AEB%60%82
// @include			http://*.wikipedia.org/wiki/*
// @include			https://*.wikipedia.org/wiki/*
// @grant			none
// ==/UserScript==

if ((window.unsafeWindow == null ? window : unsafeWindow).MathJax == null) {
  //
  //  Replace the images with MathJax scripts of type math/tex
  //
  var images = document.getElementsByTagName('img'), count = 0;
  for (var i = images.length - 1; i >= 0; i--) {
    var img = images[i];
    if (img.className === "tex") {
      var script = document.createElement("script"); script.type = "math/tex";
      if (window.opera) {script.innerHTML = img.alt} else {script.text = img.alt}
      img.parentNode.replaceChild(script,img); count++;
    }
  }
  if (count) {
    //
    //  Load MathJax and have it process the page
    //
    var script = document.createElement("script");
    script.src = "http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full";
    var config = 'MathJax.Hub.Startup.onload()';
    if (window.opera) {script.innerHTML = config} else {script.text = config}
    document.getElementsByTagName("head")[0].appendChild(script);
  }
}
