// ==UserScript==
// @version       1.0
// @author        ihsoft
// @name          C&C:TA IHSoftTools
// @namespace     http://cncopt.com/
// @icon          http://cncopt.com/favicon.ico
// @description   Aggregates battle reports results and shows how much resources you got and RT spent. Also indicates daily ratio of money farming. Aggregates are shown by day, two weeks of history. Requires "MaelstromTool Dev".
// @include       http*://prodgame*.alliances.commandandconquer.com/*/index.aspx*
// @include       http*://*.cncopt.com/*
// @include       http*://cncopt.com/*
// @grant         GM_log
// @grant         GM_setValue
// @grant         GM_getValue
// @grant         GM_registerMenuCommand
// @grant         GM_xmlhttpRequest
// @grant         GM_updatingEnabled
// @grant         unsafeWindow
// ==/UserScript==
/* 
Script is heavily based on "C&C:Tiberium Alliances Maelstrom Tools" (http://userscripts.org/scripts/show/140991).
Thank you, guys, for making such a wonderful script and giving it to people non-obfuscated.

This script comes packed with Packer 3.0 (http://dean.edwards.name/packer/).
Unpacked sources can be found here: http://real4x.ru/downloads/ihsoft_tools_v1_0.js.
*/
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(q(){p l=q(){v{q 2i(){p j=A.T.U.K();p k=A.T.4l.K();Y.29.1N("9.t",{1c:"2t",2w:Y.4a.2D,1K:{2F:3V,2H:5,2I:3P,2d:"3N",1I:"33",2K:14*24*I*I*1W,},2M:{M:{},1e:0,O:0,W:x 1i(),X:C,1j:0,17:C,16:q(){v{8.25();8.28();r.s(\'9.t 3D\')}w(e){r.s("9.t.16: ",e)}},2O:q(a){8.W.1O(a)},3B:q(a){p b=8.W.2Q(a);u(b!==-1)8.W.3s(b,1)},25:q(){v{p a=A.T.2T;8.M=a.2Y(9.t.2d,{});8.O=a.2Y(9.t.1I,0);8.1e=8.O;p b=(x 1d()).3a()-9.t.2K;J(p c 11 8.M){u(c<b){39 8.M[c];8.17=13}}}w(e){r.s("9.t.25: ",e)}},1L:q(){v{u(8.17){8.O=8.1e;p a=A.T.2T;a.E(9.t.2d,8.M);a.E(9.t.1I,8.O);8.17=C}}w(e){r.s("9.t.1L: ",e)}},1p:q(){v{u(!8.X){8.X=13;8.1j=0;8.32=8.1Q();8.1S(8.1j++)}}w(e){r.s("9.t.1p: ",e)}},1Q:q(){p a=0;v{k.2Z();J(p b 11 k.2X){p c=k.2X[b].2D.3k();a+=z.U.2U.3m(c,C);a+=z.U.2U.3t(c,C)}}w(e){r.s("9.t.1Q: ",e)}D a*24},28:q(){8.X=13;k.2Z();u(k.3u>0){8.X=C;8.1p()}18{A.2c(G.F.19.2P(8,8.28),9.t.2I)}},1S:q(a){p b=(8.O===0?9.t.2F:9.t.2H);p c={1c:z.1a.1b.3Q.3U,3Y:a*b,4b:b,2v:z.1a.1b.4c.4j,4n:C};p d=G.F.19.2r(z.1x.2q,8,8.1Y);z.1x.2p.2o().2k("4s",c,d,Q)},1Y:q(a,b){v{u(b.1f){8.1B=x 1i();J(p i=0;i<b.1f;i++){8.1B.1O(9.y.1E(b[i]))}8.2a=0;8.2b()}18{8.1F()}}w(e){r.s("9.t.1Y: ",e)}},2b:q(){u(8.2a<8.1B.1f){p a=8.1B[8.2a++];u(a.1o()>8.O){8.2f(a)}18{8.1F()}}18{8.1S(8.1j++)}},1F:q(){J(p i=0;i<8.W.1f;i++){v{8.W[i]()}w(e){r.s("9.t.1F, 3l 2g: ",e)}}8.1L();8.X=C},2f:q(a){p b=G.F.19.2r(z.1x.2q,8,8.22);z.1x.2p.2o().2k("4r",{4q:a.2j()},b,a)},22:q(a,b){v{8.17=13;9.y.1y(a,b.d);p c=1d.4p((x 1d(a.1o()).4o()));p d=8.M[c];u(!d){d={2n:c,20:0,1Z:0,1X:0,1w:0,1T:0,21:0,1R:0};8.M[c]=d}d.20+=a.1t(z.U.1s.49);d.1Z+=a.1t(z.U.1s.2y);d.1X+=a.1t(z.U.1s.2z);d.1w+=a.1t(z.U.1s.48);d.1R=d.1w/8.32;d.1T+=a.44();u(a.42().1f){d.21++}u(8.1e<a.1o()){8.1e=a.1o()}8.2b()}w(e){r.s("9.t.22: ",e)}}}});Y.29.1N("9.n",{1c:"2t",2w:T.3X,1K:{2E:"3W",2G:2,1q:"3R",1M:"9 3O 3K 3J.0",2L:3E,2N:3C,1n:0,1G:1,1h:2,1g:3,1C:4,1z:5,1u:6,1U:7,31:["1d","35 34","3L 1r","2y 1r","2z 1r","30 1r","30 36 37 %","38"]},2M:{12:Q,B:Q,27:q(){v{8.3b=C;j.3c(9.n.1q,"L",3d,I,9.n.2L,9.n.2N);p a=j.3e(9.n.1M,9.n.2E,C,j.3f(9.n.2G));a.3g("3h",q(){A.9.n.K().3i(9.n.1q,9.n.1M)},Q);j.3j(9.n.1q,a)}w(e){r.s("2W.2V.27: ",e)}},26:q(){v{8.12=x Y.2e.2S.3n.3o();8.12.3p(9.n.31);8.B=x Y.2e.2S.3q(8.12);8.B.3r(C);8.B.H(9.n.1n,2R);8.B.H(9.n.1G,2R);8.B.H(9.n.1h,I);8.B.H(9.n.1g,I);8.B.H(9.n.1C,I);8.B.H(9.n.1z,I);8.B.H(9.n.1u,I);8.B.H(9.n.1U,40);8.1m.3v(0);8.1m.E({3w:13});8.1m.3x();8.1m.3y(8.B,{3z:1});p b=8.B.3A();b.N(9.n.1n,x P.S().E({R:q(a){D G.F.19.3F(x 1d(a))}}));b.N(9.n.1G,x P.S().E({R:z.3G.3H.3I}));b.N(9.n.1h,x P.S().E({R:G.F.Z.10.15.1A}));b.N(9.n.1g,x P.S().E({R:G.F.Z.10.15.1A}));b.N(9.n.1C,x P.S().E({R:G.F.Z.10.15.1A}));b.N(9.n.1z,x P.S().E({R:G.F.Z.10.15.1A}));b.N(9.n.1u,x P.S().E({R:G.F.Z.10.15.3M}));A.9.t.K().2O(G.F.19.2P(8,8.1H))}w(e){r.s("2W.2V.26: ",e)}},2J:q(){v{u(!8.B){8.26()}A.9.t.K().1p()}w(e){r.s("9.n.2J: ",e)}},1H:q(){v{p c=x 1i();p d=A.9.t.K().M;J(p f 11 d){p g=d[f];p h=x 1i();h[9.n.1n]=g.2n;h[9.n.1G]=g.1T;h[9.n.1h]=g.20;h[9.n.1g]=g.1Z;h[9.n.1C]=g.1X;h[9.n.1z]=g.1w;h[9.n.1u]=g.1R;h[9.n.1U]=g.21;c.1O(h)}c.2v(q(a,b){u(a[0]<b[0])D 1;u(a[0]>b[0])D-1;D 0});8.12.3S(c)}w(e){r.s("9.n.1H: ",e)}}}});Y.29.1N("9.y",{1c:"3T",1K:{1V:Q,1P:Q,16:q(){9.y.1V=9.y.V(z.1a.1b.1J.2C,\'=b.3Z;\',\'1E()\');9.y.1P=9.y.V(z.1a.1b.1J.2C,\'=b.41;\',\'1y()\')},2B:q(a,b){p c=a.43().d;J(p o 11 c){p d=c[o];u(d.2j()===b)D d}r.s(\'9.y.2B: 45 \'+b+\' 46 47\');D Q},1E:q(a){v{p b=x z.1a.1b.1J();9.y.1V.2A(b,a);D b}w(e){r.s("9.y.1E: ",e);2x e;}},1y:q(a,b){v{9.y.1P.2A(a,b);D a}w(e){r.s("9.y.1y: ",e);2x e;}},V:q(a,b,c,d){p f;v{u(d){f=a[d]}u(1k f===\'23\'){J(p g 11 a){p h=a[g];u(1k h===\'q\'&&h.2u().2Q(b)!==-1){r.s("9.y.V: 4d "+c+" 4e - "+g);f=h;4f}}}u(1k f===\'23\'){r.s("9.y.V: 4g 4h 4i "+c)}}w(e){r.s("9.y.V: "+e)}D f}}})}}w(e){r.s("9 1l 4k: ",e)}q 1v(){v{u(1k A.T!==\'23\'){2i();A.9.y.16();A.9.t.K().16();A.9.n.K().27()}18{r.s("9 1l: 4m J T...");A.2c(1v,1W)}}w(e){r.s("9 1l, 1v: ",e)}}u(/2s\\.2m/i.2l(1D.2h)){A.2c(1v,1W)}};v{p m=1D.4t("4u");m.4v="("+l.2u()+")();";m.1c="4w/4x";u(/2s\\.2m/i.2l(1D.2h)){1D.4y("4z")[0].4A(m)}}w(e){r.s("9 1l: 4B 2g: ",e)}})();',62,286,'||||||||this|IHSoft||||||||||||||FarmingStatsGUI||var|function|console|log|FarmingStats|if|try|catch|new|Utils|ClientLib|window|_table|false|return|set|cnc|phe|setColumnWidth|60|for|getInstance||reportsSummary|setDataCellRenderer|lastSavedTimestamp_|HuffyTools|null|ReplaceFunction|ReplaceRender|MaelstromTools|Base|findMethod|dataReadyCallbacks_|updateInProgress_|qx|gui|util|in|_model|true||Numbers|initialize|hasNewData_|else|Util|Data|Reports|type|Date|lastTimestamp_|length|COL_GREEN_REWARD|COL_RP_REWARD|Array|pageNum_|typeof|tools|Window|COL_DATE|get_Time|requestReports|WINDOW_NAME|reward|EResourceType|GetAttackerResourceReward|COL_GOLD_GAIN_RATIO|checkIfLoaded|gold|Net|addCombatReportData|COL_GOLD_REWARD|formatNumbersCompact|_reports|COL_BLUE_REWARD|document|getReportFromHeader|_endDataPoll|COL_RT_COST|setWidgetLabels|SETTING_LAST_TS|CombatReport|statics|saveStats|WINDOW_TITLE|define|push|FN_ADD_COMBAT_REPORT_DATA|calculateDailyMoneyRate|goldRatio|_requestReports|rt|COL_CRATES_COUNT|FN_PARSE_REPORT|1000|crystal|_reportsCallback|tiberium|rp|crates|_reportDataCallback|undefined||loadStats|initWindow|registerGUI|_getInitialState|Class|_currentReportNum|_requestNextReportData|setTimeout|SETTING_SUMMARY|ui|_requestReportData|error|domain|create|get_Id|SendSimpleCommand|test|com|date|GetInstance|CommunicationManager|CommandResult|createEventDelegate|commandandconquer|singleton|toString|sort|extend|throw|Tiberium|Crystal|call|getBuildingById|prototype|Object|BUTTON_IMAGE|INITIAL_POLL_SIZE|BUTTON_LINE|REFRESH_POLL_SIZE|STATE_CHECK_TIMEOUT|updateCache|HISTORY_LENGTH_MSEC|WINDOW_WIDTH|members|WINDOW_HEIGHT|registerDataReadyCallback|createMethodWrapper|indexOf|80|table|LocalStorage|Resource|FramingStatsGUI|IHsoft|Cities|get|updateCityCache|Money|COL_DEFS|todaysMoneyRate_|IHS_FS_LAST_TS|cost|RT|daily|gain|Crates|delete|getTime|IsTimerEnabled|createNewWindow|120|createDesktopButton|desktopPosition|addListener|execute|openWindow|addToMainMenu|get_CityCreditsProduction|callback|GetResourceGrowPerHour|model|Simple|setColumns|Table|setColumnVisibilityButtonVisible|splice|GetResourceBonusGrowPerHour|CityCount|setPadding|resizable|removeAll|add|flex|getTableColumnModel|unregisterDataReadyCallback|390|loaded|527|getLocaleShortDateString|Vis|VisMain|FormatTimespan|v1|Stats|RP|calculateDisplayPercentValue|IHS_FS_SUMMARY|Farming|200|EPlayerReportType|IHSoftFarmingStats|setData|static|CombatOffense|100|FocusBase|DefaultObject|skip|dbn||apn|get_AttackerItemRewards|get_Buildings|GetAttackerMaxRepairTime|Building|not|found|Gold|ResearchPoints|core|take|ESortColumn|Found|method|break|Failed|to|find|Time|main|Cache|Waiting|ascending|toDateString|parse|playerReportId|GetReportDataAndHeader|GetReportHeaderAll|createElement|script|innerHTML|text|javascript|getElementsByTagName|head|appendChild|init'.split('|'),0,{}))