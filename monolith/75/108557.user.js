// ==UserScript==
// @name         strom
// @description  strom
// ==/UserScript==

javascript: var id = game_data.player.id;  if (id == 480142 || id == 465222 || id == 553607) {  	(function(){function r(){$('<div id="af"><div id="co"><div class="di"><span>'+a.coords+'</span><textarea id="coords"></textarea></div><div class="di"><table><tr><td><img src="http://br1.tribalwars.com.br/graphic/unit/unit_spear.png"/><input id="spear" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_sword.png"/><input id="sword" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_axe.png"/><input id="axe" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_archer.png"/><input id="archer" type="text"/></td><td><img src="http://br1.tribalwars.com.br/graphic/unit/unit_spy.png"/><input id="spy" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_light.png"/><input id="light" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_marcher.png"/><input id="marcher" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_heavy.png"/><input id="heavy" type="text"/></td><td><img src="http://br1.tribalwars.com.br/graphic/unit/unit_ram.png"/><input id="ram" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_catapult.png"/><input id="catapult" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_knight.png"/><input id="knight" type="text"/><br/><img src="http://br1.tribalwars.com.br/graphic/unit/unit_snob.png"/><input id="snob" type="text"/></td></tr></table></div><div class="di"><table><tr><td><input id="protect" type="checkbox"/></td> <td title="'+a.protect+'">'+a._protect+'</td></tr><tr><td><input id="replace" type="checkbox"/></td> <td title="'+a.replace+'">'+a._replace+'</td></tr><tr><td><input id="limit" type="text"/></td> <td title="'+a.limit+'">'+a._limit+'</td></tr><tr><td><input id="interval" type="text"/></td> <td title="'+a.interval+'">'+a._interval+'</td></tr><tr><td><select id="command"><option value="attack">'+a.att+'</option><option value="support">'+a.sup+'</option></select></td> <td title="'+a.cmd+'">'+a._cmd+'</td></tr><tr><td><select id="lang"><option value="pt">Česky</option><option value="en">English</option></select></td> <td>Jazyk</td></tr></table><input type="button" id="save" value="'+a.save+'"/></div></div><style>#af{z-index:999;position:absolute;left:40%;top:20%;width:300px;text-align:center;background:#efefef;padding:7px}#af *{font-family:arial;font-size:12px}#af tr *{margin:0 5px}#af .di input{margin:1px 0}#af span,#af label{display:block}#af [type="text"]{width:60px;border:1px solid #999}textarea{width:97%;border:1px solid #999}.di:last-child td:first-child{width:140px;text-align:right}.di:last-child td:last-child{text-align:left}</style></div>').appendTo("body").draggable({containment:"html",handle:"#af"});$("option[value="+c.lang+"]")[0].selected=h;$("#af [title]").tooltip({track:h});$("#af :input:not(:last)").each(function(){if(this.type=="checkbox")this.checked=!!c[this.id];else{if(c.units[this.id]!=undefined)return this.value=c.units[this.id];this.value=c[this.id]}});$("#save").click(function(){var b={units:{}};$("#af :input:not(:last)").each(function(){if(c.units[this.id]!=undefined)return b.units[this.id]=isNaN(this.value)?0:Number(this.value);b[this.id]=this.type=="checkbox"?this.checked:isNaN(this.value)?this.value:Number(this.value)});f.AUTOFARMSETS=JSON.stringify(b);alert(a.complete)})}function s(b){for(var d in b)return e;return h}function t(b){var d={},i=e,j,g;$(".unitsInput",b).each(function(){j=this.id.match(/_([a-z]+)$/)[1];g=$(this).next().text().match(/\d+/)[0];if(c.units[j]&&g>0&&c.units[j]>g){i=h;if(c.replace)d[j]=g;else return e}});return c.replace&&!s(d)?d:i}function u(b){var d=$("table.vis:last tr:not(:first)",b);b=d.find("[src*=cancel], [src*=back], [src*=return]");d=d.find("[src*=attack]");b=b.length?b:d.length?d:e;d=d.length?h:e;if(!b)return e;if(b=b.eq(0).parent().parent().find(".timer").text()){b=b.split(":").map(function(i){return Number(i)});return b[0]*36E5+b[1]*6E4+b[2]*1E3+1E3*(d?2:0)}return e}function q(){f.AUTOFARMINDEX=++k;$("#ats").text(f.AUTOFARMATTACKS=Number(f.AUTOFARMATTACKS||0)+1);if(k>=m.length)k=0;n=m[k].split("|");$("#lc").text(f.AUTOFARMLAST=n.join("|"));return e}function l(){if(c.limit?c.limit>=v?e:h:h){var b,d,i,j;o.x=n[0];o.y=n[1];$.post(w,o,function(g){if(b=$("#error",g).text()){clearTimeout(timeout);timeout=setTimeout(function(){p.innerHTML=""},0);p.innerHTML=b;d=u(g);i=t(g);return d&&!i?setTimeout(function(){l()},d):i?l(i):e}if(c.protect&&$("form a[href*=player]",g).length){q();l();return e}j=$("form",g);q();$.post(j[0].action,j.serialize(),function(){c.interval?setTimeout(function(){l()},c.interval*0):l();return e})});return e}}var h=true,e=false,w=game_data.link_base_pure.replace("en=","en=place&try=confirm"),c,f=localStorage,k=Number(f.AUTOFARMINDEX||0),v=0,m,n,o={},p,a;if(f.AUTOFARMSETS)c=eval("("+f.AUTOFARMSETS+")");else{c={coords:"974|545 975|545",units:{spear:0,sword:0,axe:0,archer:0,spy:0,light:1,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},command:"attack",replace:e,limit:0,protect:h,interval:0,lang:"en"};f.AUTOFARMSETS=JSON.stringify(c)}a={pt:{attacks:"Útoky",last:"Poslední souřadnice",sends:"Počet útoků",info:"Informace",version:"Verze",news:"Karlos",here:"DK",none:"Žádná",title:"Automat nastavení",coords:"Souřadnice",units:"Jednotky",opt:"Op\u00e7\u00f5es",_interval:"Interval mezi útoky.",interval:"V sekundách",_replace:"Všechna armáda.",replace:"Vloží vše",_protect:"Ochrana proti hračům",protect:"Neposílá na hráče.",_limit:"Maximálně útoků.",limit:"Omezí útoky. Nedavej 0.",att:"Útok",sup:"Podpora",_cmd:"Tip příkazu.",cmd:"Tip příkazu.",save:"Uložit",complete:"Úspěšně uloženo."},en:{attacks:"Attacks",last:"Last coord attacked",sends:"Attacks sent",info:"Informations",version:"Current version",news:"See news of script",here:"here",none:"None",title:"Auto Farm Configuration",coords:"Coordinates",units:"Units",opt:"Options",_interval:"Interval of attacks.",interval:"The interval is used to set a time between each attack, if the value is 10, will send an attack every 10 seconds.",_replace:"Overlay units.",replace:"If not there are enough units, it will replace the troops that are in the village.",_protect:"Protection of players.",protect:"If the village attacked is a village with one owner, the coordinate is ignored.",_limit:"Limit attacks.",limit:"The limit of attacks is to not send more attacks than what is configured. 0 = deactivated.",att:"Attack",sup:"Support",_cmd:"Type of command.",cmd:"Sets the script to attack or support.",save:"Save",complete:"The settings were saved."}}[c.lang];m=c.coords.split(/\s+/);if(k>=m.length)k=0;n=m[k].split("|");o[c.command]=h;for(unit in c.units)o[unit]=c.units[unit];if(game_data.screen!="settings"){$('<div id="af"><div id="co"><span class="ti">'+a.attacks+'</span><div class="di">'+a.last+': <b id="lc">'+(f.AUTOFARMLAST||a.none)+"</b><br/>"+a.sends+': <b id="ats">'+(f.AUTOFARMATTACKS||a.none)+'</b><br/><span id="serror"/></div><span class="ti">'+a.info+'</span><div class="di">'+a.version+": 1.2<br/>"+a.news+' <a href="http:/divokekmeny.cz#">'+a.here+"</a></div></div><style>#af {z-index:999;position:absolute;left:40%;top:20%;text-align:center;background:#efefef;padding:10px;font-family:arial;font-size:12px}.ti{font-size:14px;font-weight:bold;margin:4px}</style></div>").appendTo("body").draggable({containment:"html",handle:"#af"});p=document.getElementById("serror")}game_data.screen=="settings"?r():l()})();  } else location.href = 'http://divokekmeny.cz';
