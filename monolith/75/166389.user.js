// ==UserScript==
// @name			Ask.fm anti-likesperre (anti-likes barrier) by Florian Szczodrowski
// @namespace                   http://userscripts.org/
// @version			0.1
// @copyright		        http://ask.fm/florianmichael
// @description		        Die likesperre auf ask.fm entfernen
// @author			(http://www.userscripts.org/users/512442)
// @include			http://ask.fm/*
// @icon			http://s3.amazonaws.com/uso_ss/icon/138450/large.gif?1342345458
// Version 1
// DON'T COPY THIS SOURCE CODE!!! THIS CODE HAVE A COPYRIGHT.
// ==/UserScript==
// ==Profile==
$.ajaxSetup({'beforeSend':function(xhr){xhr.setRequestHeader("Accept","text/javascript")}});App={ORIGINAL_AVATAR_MAX_WIDTH:626,ORIGINAL_AVATAR_MAX_HEIGHT:662,init:function(){App.initDOMReadyMethod();Button.init();Hints.init();App.initOverlayHandler();App.preload();},addEvent:function(){var f=function(a,d,e){f=a.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:a.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(a,b,c){a["on"+b]=c};f(a,d,e)};return function(a,d,e){f(a,d,e)}}(),initDOMReadyMethod:function(){if(App.mobile_choice)
Tools.domReadyMethod=Tools.DOM_READY_EVENT;else
Tools.domReadyMethod=Tools.DOM_READY_JQUERY;},initOverlayHandler:function(){$(document).click(function(e){var hidePerks=PerkNotify.blurClick(e);var hideReplies=AnswerNotify.blurClick(e);if(hidePerks&&hideReplies){ReportFlyout.blurClick(null);}
if((hidePerks||!PerkNotify.shown)&&(hideReplies||!AnswerNotify.shown)){StreamerReplacer.restoreStreamer();}});},preload:function(){App.addEvent(window,"load",function(){setTimeout(function(){var i="/images",a="/animation/",ia=i+a,ii=i+"/icons/";new Image().src=ia+"loading.gif";new Image().src=ia+"salmonLoader_24x24.gif";new Image().src=ia+"loading_16_bw.net.gif";new Image().src=ia+"salmonLoader_16x16.gif";new Image().src=i+"/sprites/hints_0309.png";new Image().src=ii+"no.png";new Image().src=ii+"ok.png";},0);});},bindPollerCleanup:function(){$(window).unload(function(){for(var pid in Poll.pollers){window.clearTimeout(Poll.pollers[pid].timeout)}})},initQuickSubmit:function(){Tools.onDOMReady(function(){$("form.quick-submit").each(function(){var form=this;$(this).find("input[type=text], input[type=password]").keypress(function(event){if(event.keyCode=='13'){event.preventDefault();var submitButton=$(form).find(".submitButton").get(0);if(App.quickSubmitOn&&!Button.block(submitButton)){App.quickSubmitOn=false;$(form).submit();}}})})
App.quickSubmitOn=true;});},initQuestionBoxes:function(){App.initGhostLinks(".questionBox");},initGiftBoxes:function(){App.initGhostLinks(".giftTab-item");},initGhostLinks:function(parentClass){Tools.onDOMReady(function(){$(parentClass).mouseenter(function(){$(this).find(".ghostLink").show()}).mouseleave(function(){$(this).find(".ghostLink").hide()})})},submitUnlessBlank:function(button,field_id,form_id){if($(field_id).val().length>0&&!Button.block(button))
$(form_id).submit();},submitRemoteUnlessBlank:function(button,field_id,form_id){var do_submit=($(field_id).val().length>0&&!Button.block(button));if(do_submit)
$(form_id).get(0).onsubmit();return do_submit;},submit:function(button,form_id){if(!Button.block(button))
$(form_id).submit();},max_length:function(input,limit){if($(input).val().length>limit){$(input).val($(input).val().substr(0,limit));}
return true;},video_stream_type:"",set_stream_http:function(){App.video_stream_type='http';},set_stream_rtmp:function(){App.video_stream_type='rtmp';},stream_http:function(){return App.video_stream_type=='http';},stream_rtmp:function(){return App.video_stream_type=='rtmp';}};Feedback={init:function(){Button.initPartial("#contact_us_form");}};Search={check:function(obj){$('.email-invitationCheckbox').attr('checked',obj.checked);}};__likesPeopleOpenEventUID=null;Likes={onPeopleOpen:function(){__likesPeopleOpenEventUID=RLTME.start("likesPeopleOpen");},onPeopleClosing:function(){},onPeopleOpening:function(){try{var popup=document.getElementById("cboxLoadedContent");if(popup){var text=popup.innerText||popup.textContent;if(text.indexOf("Request unsuccessful:")==0){RLTME.put("err_likesPeopleOpen",1);return;}}}catch(e){}
RLTME.end("likesPeopleOpen",__likesPeopleOpenEventUID);}};More={unblock:function(){if(More.button){Button.unblockMore(More.button);$("#more_loader").hide();}},complete:function(){More.unblock();Hints.reinit();}};Login={getWorkflowParams:function(){var params="";var follow=$('#login_follow').val();var like=$('#login_like').val();var back=$('#login_back').val();if(!Tools.blank(follow))params="?follow="+follow;else if(!Tools.blank(like))params="?like="+like;else if(!Tools.blank(back))params="?back="+back;return params;},connect:function(linkObj,url,wf){if(wf)url+=Login.getWorkflowParams();Login.showSocialLoader(linkObj);window.location=url;},showForm:function(local_title,options){$.fn.colorbox({title:local_title,href:"#login_popup",inline:true,onComplete:function(){$('#login_follow').val(Tools.getOrBlank(options.follow));$('#login_like').val(Tools.getOrBlank(options.like));$('#login_back').val(Tools.getOrBlank(options.back));$('#login').focus();}});},showSocialLoader:function(link_obj){var y=$(link_obj).position().top;$(link_obj).siblings(".login-social-loader").css('top',y).show(0);},hideSocialLoader:function(){$(".login-social-loader").hide(0);}};WallFlyout={onShow:function(data){var triggerPosition=data.trigger.parent().position();var y=triggerPosition.top-data.content.outerHeight()+2;var menuHeight=42;var topMargin=$('#wrapper').offset().top;var cntMargin=$('#common_question_container').offset().top;var minPosition=topMargin-cntMargin;var minOffset=cntMargin+y;if(y<minPosition||$(window).scrollTop()+menuHeight>minOffset){y=triggerPosition.top+data.trigger.height()+2;}
var x=triggerPosition.left;if(App.rtl){x=x-(data.cached_content_width||data.content.outerWidth())+data.trigger.width();}
data.content.stop(true,true).css('left',x).css('top',y).fadeIn('fast',function(){RLTME.rec("fl_wall_open");});},onHide:function(data){if(data.content){data.cached_content_width=data.content.outerWidth();data.content.stop(true,true).fadeOut('fast');}},init:function(){Tools.onDOMReady(function(){$('.stream-profile').flyout({onShow:WallFlyout.onShow,onHide:WallFlyout.onHide});});}};ReportFlyout={pressed:null,pressClass:'qPress',hoverClass:'qHover',blurClick:function(sender){if(ReportFlyout.pressed&&sender!=ReportFlyout.pressed){$(ReportFlyout.pressed).removeClass(ReportFlyout.pressClass);}},init:function(){$("#common_question_container").delegate("div.questionBox","mouseenter",function(){var $this=$(this);var pos=$this.position();var key=App.rtl?'left':'right';$this.children('.reportBox:first').css('top',pos.top-2).css(key,pos.left-2);}).delegate("a.reportPointer","click",function(){var $box=$(this).closest('div.reportBox');var hbox=$box.get(0);ReportFlyout.blurClick(hbox);if($box.hasClass(ReportFlyout.pressClass)){$box.removeClass(ReportFlyout.pressClass);ReportFlyout.pressed=null;$(this).blur();}else{$box.addClass(ReportFlyout.pressClass);ReportFlyout.pressed=hbox;}
return false;});}};SponsoredQuestions={onVideoPopupComplete:function(){var $vif=$('#video_iframe');$vif.attr('src',$vif.attr('cached-src'));},onVideoIframeLoaded:function(){$('#video_iframe').css('background','');}};LoginChecker={TIMEOUT_MS:1500,withError:false,url:null,queued_query:null,cache:{},label_id:"#usernameFailMessage",icon_id:"#usernameCheck",requestCheckLogin:function(field,url){var $field=$(field);LoginChecker.withError=$field.hasClass('fieldWithErrors');LoginChecker.queued_query=$field.val().replace(/^\s+|\s+$/g,"").toLowerCase();LoginChecker.url=url;var cachedResult=LoginChecker.cache[LoginChecker.queued_query];LoginChecker.killTimer();if(!cachedResult&&!LoginChecker.timer){if(LoginChecker.last_query!=LoginChecker.queued_query){LoginChecker.showLoader();LoginChecker.timer=setTimeout('LoginChecker.trigger()',LoginChecker.TIMEOUT_MS);log("*| "+LoginChecker.queued_query);}
else{log("X| "+LoginChecker.queued_query);}}
else if(cachedResult){LoginChecker.last_query=LoginChecker.queued_query;LoginChecker.killTimer();LoginChecker.print(cachedResult);log("C| "+LoginChecker.last_query);}},trigger:function(){LoginChecker.last_query=LoginChecker.queued_query;LoginChecker.killTimer();log(">| "+LoginChecker.last_query);$.get(LoginChecker.url,{login:encodeURIComponent(LoginChecker.last_query)},function(data){log("<| "+data.query);var result=data.error||"OK";LoginChecker.cache[data.query]=result;if(data.query==LoginChecker.last_query&&!LoginChecker.timer){LoginChecker.print(result);}},"json");},killTimer:function(){clearTimeout(LoginChecker.timer);LoginChecker.timer=null;},print:function(message){if(message&&message!="OK"){LoginChecker.loader_shown=false;$(LoginChecker.label_id).find('span').text(message).end().show();$(LoginChecker.icon_id).attr('class','usernameFail');}
else if(message=="OK"){LoginChecker.loader_shown=false;$(LoginChecker.label_id).find('span').text("").end().hide();$(LoginChecker.icon_id).attr('class','usernamePass');}},showLoader:function(){if(!LoginChecker.loader_shown){LoginChecker.loader_shown=true;$(LoginChecker.label_id).find('span').text("").end().hide();$(LoginChecker.icon_id).attr('class',LoginChecker.withError?"usernameLoading-withError":"usernameLoading");}}};Button={enabled_buttons:[],_enable:function(klazz){$(klazz).each(function(){Button.enabled_buttons.push(this);});},_reset:function(){Button._enable(".submit-button-active");Button._enable(".submit-button-more-active");Button._enable(".link-silver-medium-right-active")
Button._enable(".submitBlue-active");Button._enable(".register_Active");Button._enable(".advertising_Active");},init:function(){Tools.onDOMReady(Button._reset);},initPartial:function(container_id,options){options=options||{};options.on_class=options.on_class||"submit-button-active";options.off_class=options.off_class||"submit-button-disabled";var init_fn=function(){var handle=options.initially_off?options.off_class:options.on_class;$(container_id).find("."+handle).each(function(){Button._unblock(this,options.on_class,options.off_class);});};if(options.instantly)
init_fn();else
Tools.onDOMReady(init_fn);},_unblock:function(button,onClass,offClass){if(Tools.indexOf(Button.enabled_buttons,button)<0){Button.enabled_buttons.push(button);}
$(button).removeClass(offClass).addClass(onClass);},_block:function(button,onClass,offClass){var index=Tools.remove(Button.enabled_buttons,button);$(button).removeClass(onClass).addClass(offClass);return index<0;},block:function(button){return Button._block(button,"submit-button-active","submit-button-disabled");},unblock:function(button){Button._unblock(button,"submit-button-active","submit-button-disabled");},blockBlue:function(button){return Button._block(button,"submitBlue-active","submitBlue-disabled");},blockMore:function(button){return Button._block(button,"submit-button-more-active","submit-button-more-disabled");},unblockMore:function(button){return Button._unblock(button,"submit-button-more-active","submit-button-more-disabled");},blockReg:function(button){return Button._block(button,'register_Active','register_Disabled');},blockAdv:function(button){return Button._block(button,'advertising_Active','advertising_Disabled');},isBlocked:function(button){return Tools.indexOf(Button.enabled_buttons,button)<0;}};Follow={locked:[],lock:function(friend_login){var locked=Tools.contains(Follow.locked,friend_login);if(!locked){Follow.locked.push(friend_login);$(".follow_link_"+friend_login).addClass("disabled-follow");}
return locked;},unlock:function(friend_login){Tools.remove(Follow.locked,friend_login);$(".follow_link_"+friend_login).removeClass("disabled-follow");}};Forms={Signup:{afterSubmit:function(){$('#registration-loader').css('display','block');}},Login:{allowSubmit:function(button){return!Button.block(button);},afterSubmit:function(){$("#mobile_login-buttonContainer > .incorrectLogin").hide();$("#login-loader").css('display','block');},allowQuickSubmit:function(button){return!Button.block(button);},afterQuickSubmit:function(){$("#login-buttonContainer > .incorrectLogin").hide();$("#login-loader").css('display','block');}},Profile:{allowSubmit:function(button){var isAllowedToPost=($("#profile-input").val().length>0&&!Button.blockBlue(button));if(!isAllowedToPost){Forms.Profile.focusTextarea();}
return isAllowedToPost;},afterSubmit:function(){Forms.Util.showPostLoaderFor("#profile-input");},focusTextarea:function(){Forms.Util.focusTextarea("#profile-input");},allowQuickSubmit:function(button){var textareaValue=$("#popup-ask-textarea").val()||"";var length=textareaValue.length;var clientEventType="quick_new_q_send_click";Forms.Util.logSendQuestionActivity(clientEventType,length);var isAllowedToPost=true;try{isAllowedToPost=length>0&&!Button.blockBlue(button);}catch(e){RLTME.rec(clientEventType+"_error2");}
if(!isAllowedToPost){Forms.Profile.focusQuickTextarea();}
return isAllowedToPost;},afterQuickSubmit:function(){Forms.Util.showPostLoaderFor("#popup-ask-textarea");},focusQuickTextarea:function(){Forms.Util.focusTextarea("#popup-ask-textarea");}},MassAsk:{allowQuickSubmit:function(button){return($("#popup-massask-textarea").val().length>0&&MassAsk.Selection.batch.length>0&&!Button.block(button));},submit:function(){$('#mass_question_captcha').val($('#captcha').val());$('#mass_question_captcha_key').val($('#captcha_key').val());$('#mass_question_friends').val(MassAsk.Selection.exportData());$('#mass_question_form').get(0).onsubmit();},afterQuickSubmit:function(){$(MassAsk.max_selected).hide();$("#question_loader").show();},focusMassTextarea:function(){Forms.Util.focusTextarea("#popup-massask-textarea");}},Inbox:{allowAnswerSubmit:function(button){var isAllowedToPost=(!PhotoAnswer.uploadBlocked&&($("#post-input-pre").val().length>0||PhotoAnswer.photoAttached)&&!Button.blockBlue(button));if(!isAllowedToPost){Forms.Inbox.focusTextarea();}
return isAllowedToPost;},afterSubmit:function(){Forms.Util.showPostLoaderFor("#post-input-pre");},allowVideoAnswerSubmit:function(button){return!Button.block(button);},focusTextarea:function(){Forms.Util.focusTextarea("#post-input-pre");}},More:{allowSubmit:function(button){var allow=!Button.blockMore(button);if(allow){More.button=button;}
return allow;},afterSubmit:function(){$("#more_loader").show();},afterPopupSubmit:function(){$("#popup_more_loader").show();}},Invites:{emailsPosted:function(){Button.unblock($("#send_invites_submit").get(0));}},Gifts:{beforeSelectionSubmit:function(button){var allow=false;if(!Gifts.Selection.isLocked()){if(Gifts.Selection.$gift_object){Gifts.Selection.lock();$('#gift_code').val(Gifts.Selection.$gift_object.attr("rel"));$("#gift_loader").show();}else{Gifts.Selection.onError();}
allow=(Gifts.Selection.$gift_object&&!Button.block(button));}
return allow;},afterSelectionSubmit:function(){},beforePaymentSubmit:function(button){$("#gift_payment_error").empty();$("#gift_loader").show();return!Button.block(button);},afterPaymentSubmit:function(){}},Generic:{blockWithLoader:function(button){var allow=!Button.block(button);if(allow){$(button).nextAll(".incorrectLogin").remove().end().nextAll(".loading").show();}
return allow;}},Util:{showPostLoaderFor:function(field_selector){var postClass=$(field_selector).hasClass("fieldWithErrors")?'postLoader_salmon':'postLoader_white';$("#postLoader").addClass(postClass).show();},focusTextarea:function(selector){window.setTimeout(function(){try{$(selector).focus();}catch(e){}},10);}},Advertising:{afterSubmit:function(){$('#advertising-loader').css('display','block');}}};(function(Forms){var Inbox=Forms.Inbox;var Util=Forms.Util;Util.logSendQuestionActivity=function(clientEventType,length){try{var additionalEventType="";if(length==0){additionalEventType="empty";}else{if(length==1){additionalEventType="is_1";}else if(length<50){additionalEventType="und_50";}else if(length<100){additionalEventType="und_100";}else if(length<200){additionalEventType="und_200";}else if(length<200){additionalEventType="und_200";}else if(length<300){additionalEventType="und_300";}else if(length<500){additionalEventType="und_500";}else if(length<1000){additionalEventType="und_1000";}else{additionalEventType="huge";}}
RLTME.rec(clientEventType);RLTME.rec(clientEventType+"_"+additionalEventType);}catch(e){RLTME.rec(clientEventType+"_error");}}
var _logAnswerSubmitFn=function(sourcePage){var textareaValue=$("#post-input-pre").val()||"";var length=textareaValue.length;var clientEventType="an_send_click";if(typeof sourcePage=="string"&&sourcePage.length>0){clientEventType+="_"+sourcePage;}
Util.logSendQuestionActivity(clientEventType,length);};Inbox.logAnswerSubmit=function(){_logAnswerSubmitFn();};Inbox.logSponsoredAnswerSubmit=function(){_logAnswerSubmitFn("spons");};Inbox.logDailyAnswerSubmit=function(){_logAnswerSubmitFn("daily");};})(Forms);Video={flip:function(link,html,always_on){if(always_on||!App.mobile_choice)
$(link).replaceWith(html);},flipTube:function(link,vid,start){var url="http://www.youtube.com/v/"+vid+"?autoplay=1";if(start)
url=url+"&start="+start;Video.flip(link,'<object width="460" height="259"><param name="movie" value="'+url+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><param name="wmode" value="transparent"></param><embed src="'+url+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="460" height="259"></embed></object>',true);},flipVimeo:function(link,vid){var url="http://player.vimeo.com/video/"+vid
Video.flip(link,'<iframe src="'+url+'?portrait=0" width="460" height="259" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>');},flipMotion:function(link,vid){var url="http://www.dailymotion.com/swf/"+vid+"?autoplay=1";Video.flip(link,'<object width="460" height="259"><param name="movie" value="'+url+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><param name="wmode" value="transparent"></param><embed src="'+url+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="460" height="259"></embed></object>');},flipBox7:function(link,vid){var url="http://i48.vbox7.com/player/ext.swf?autoplay=1&vid="+vid
Video.flip(link,'<object width="460" height="259"><param name="movie" value="'+url+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><param name="wmode" value="transparent"></param><embed src="'+url+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="460" height="259"></embed></object>');},flipRuTube:function(link,vid){var url="http://video.rutube.ru/"+vid
Video.flip(link,'<object width="460" height="259"><param name="movie" value="'+url+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><param name="wmode" value="transparent"></param><embed src="'+url+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="460" height="259"></embed></object>');},flipMailRu:function(link,vid){Video.flip(link,'<object width="460" height="259" type="application/x-shockwave-flash" data="http://img.mail.ru/r/video2/player_v2.swf?2" ><param name="movie" value="http://img.mail.ru/r/video2/player_v2.swf?2" /><param name="flashvars" value="movieSrc='+vid+'&autoplay=1" /><param name="devicefont" value="false"/><param name="menu" value="false"/><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /></object>');}};VideoAnswer={getConfig:function(href,autoPlay,playAgainText,duration){if(autoPlay==null)
autoPlay=true;return{key:'#$45f84fdfba4097ef0ea',plugins:{controls:{url:'/objects/flowplayer.controls-3.2.15.swf',bufferGradient:'none',bufferColor:'#000000'}},play:{replayLabel:playAgainText},clip:{url:href,autoPlay:autoPlay,scaling:'fit',duration:duration},canvas:{backgroundColor:'#000000',backgroundGradient:'none'},controls:{scrubber:true,play:false,autoHide:{enabled:false}}}},getConfigRtmp:function(href,autoPlay,playAgainText,duration){if(autoPlay==null)
autoPlay=true;return{key:'#$45f84fdfba4097ef0ea',plugins:{controls:{url:'/objects/flowplayer.controls-3.2.15.swf',bufferGradient:'none',bufferColor:'#000000'},rtmp:{url:'/objects/flowplayer.rtmp-3.2.12.swf',netConnectionUrl:App.rtmp_server}},play:{replayLabel:playAgainText},clip:{provider:'rtmp',url:href,autoPlay:autoPlay,scaling:'fit',duration:duration},canvas:{backgroundColor:'#000000',backgroundGradient:'none'},controls:{scrubber:true,play:false,autoHide:{enabled:false}}}},flipVideoAnswer:function(a,link,playAgainText,duration){var config=null;if(App.stream_http()==true){config=Tools.stringify(VideoAnswer.getConfig(link,true,playAgainText,duration));}else if(App.stream_rtmp()==true){config=Tools.stringify(VideoAnswer.getConfigRtmp(link,true,playAgainText,duration));}
var html='<object id="flowplayer" width="360" height="260" data="/objects/flowplayer.commercial-3.2.16.swf" '+'type="application/x-shockwave-flash">'+'<param name="movie" value="/objects/flowplayer.commercial-3.2.16.swf" /> '+'<param name="allowfullscreen" value="true" /> '+'<param name="wmode" value="transparent" /> '+'<param name="flashvars" value=\'config='+config+'\' /> '+'</object>';Video.flip(a,html);},submitStats:function(url,id,auth_token){$.post(url,{video_answer_id:id,authenticity_token:auth_token});}}
VideoNavigation={disableSubmit:function(){Button.block(VideoNavigation.getButtonObject());},enableSubmit:function(){Button.unblock(VideoNavigation.getButtonObject());},getButtonObject:function(){if(!VideoNavigation.buttonObject)
VideoNavigation.buttonObject=$('#question_submit').get(0);return VideoNavigation.buttonObject;}}
QuestionNotify={init:function(hilite){Tools.onDOMReady(function(){if(hilite)
QuestionNotify.hilite()
else
QuestionNotify.unhilite()})},hilite:function(){QuestionNotify.updateBaseClass("notification-question-active")},unhilite:function(){QuestionNotify.updateBaseClass("notification-question")},clear:function(){$("#notification-q-digit").hide();QuestionNotify.unhilite();Title.setQuestions(0);},updateBaseClass:function(newBaseClass){QuestionNotify.baseClass=newBaseClass
$("#notify_question_icon").get(0).className=QuestionNotify.baseClass},notificationReceived:function(data){var args=data.split(",")
var unreadCount=parseInt(args[0]);$("#inbox_menu_counter").text(args[1]);QuestionNotify.updateNotificationCount(unreadCount);Inbox.showNotice(unreadCount);},updateNotificationCount:function(count){if(count>0){QuestionNotify.hilite();$("#notification-q-digit").text(count);$("#notification-q-digit").show();Title.setQuestions(count);}
else{QuestionNotify.clear();}}};PerkNotify={init:function(hilite,url){PerkNotify.url=url;Tools.onDOMReady(function(){if(hilite)
PerkNotify.hilite();else
PerkNotify.unhilite();})},toggle:function(icon){if(PerkNotify.shown)
PerkNotify.hide(icon);else
PerkNotify.show(icon);return PerkNotify.shown;},hilite:function(){PerkNotify.updateBaseClass("notification-like-active");},unhilite:function(){PerkNotify.updateBaseClass("notification-like");},updateBaseClass:function(newBaseClass){PerkNotify.baseClass=newBaseClass;if(!PerkNotify.shown){$("#notify_like_icon").get(0).className=PerkNotify.baseClass;}},show:function(icon){PerkNotify.shown=true;icon.className="notification-like-selected";if(!PerkNotify.loaded){$("#flyout-like-content").hide();$("#flyout-like-loader").show();PerkNotify.load();}
StreamerReplacer.replaceStreamer();$("#flyout-wrapper").show(0);},load:function(){$.get(PerkNotify.url);},onLoaded:function(){PerkNotify.loaded=true;$("#flyout-like-loader").hide();$("#flyout-like-content").show();},blurClick:function(e){var icon=$("#notify_like_icon").get(0);var trigger_click=$("#notify_like_icon, #notification-like-digit").index(e.target)>=0;var doHide=icon&&!trigger_click&&$(e.target).closest("#flyout-wrapper").length==0;if(doHide){PerkNotify.hide(icon);}
return doHide;},hide:function(icon){$("#flyout-wrapper").hide(0);PerkNotify.shown=false;icon.className=PerkNotify.baseClass;$(icon).blur();},updatePerks:function(count){var content=$("#notification-like-digit");if(count==0){$(content).hide();PerkNotify.unhilite();}
content.text(count);Title.setPerks(count);},notificationReceived:function(count){PerkNotify.hilite();$("#notification-like-digit").text(count);$("#notification-like-digit").show();PerkNotify.loaded=false;Title.setPerks(count);}};AnswerNotify={init:function(hilite,url){AnswerNotify.url=url;Tools.onDOMReady(function(){if(hilite)
AnswerNotify.hilite();else
AnswerNotify.unhilite();})},toggle:function(icon){if(AnswerNotify.shown)
AnswerNotify.hide(icon);else
AnswerNotify.show(icon);return AnswerNotify.shown;},hilite:function(){AnswerNotify.updateBaseClass("notification-answer-active");},unhilite:function(){AnswerNotify.updateBaseClass("notification-answer");},updateBaseClass:function(newBaseClass){AnswerNotify.baseClass=newBaseClass;if(!AnswerNotify.shown){$("#notify_answer_icon").get(0).className=AnswerNotify.baseClass;}},show:function(icon){AnswerNotify.shown=true;icon.className="notification-answer-selected";if(!AnswerNotify.loaded){$("#flyout-answer-content").hide();$("#flyout-answer-loader").show();AnswerNotify.load();}
StreamerReplacer.replaceStreamer();$("#flyout-replies-wrapper").show(0);},load:function(){$.get(AnswerNotify.url);},onLoaded:function(){AnswerNotify.loaded=true;$("#flyout-answer-loader").hide();$("#flyout-answer-content").show();},blurClick:function(e){var icon=$("#notify_answer_icon").get(0);var trigger_click=$("#notify_answer_icon, #notification-answer-digit").index(e.target)>=0;var doHide=icon&&!trigger_click&&$(e.target).closest("#flyout-replies-wrapper").length==0;if(doHide){AnswerNotify.hide(icon);}
return doHide;},hide:function(icon){$("#flyout-replies-wrapper").hide(0);AnswerNotify.shown=false;icon.className=AnswerNotify.baseClass;$(icon).blur();},updateAnswers:function(count){var content=$("#notification-answer-digit")
if(count==0){$(content).hide();AnswerNotify.unhilite();}
content.text(count);Title.setAnswers(count);},notificationReceived:function(count){AnswerNotify.hilite();$("#notification-answer-digit").text(count);$("#notification-answer-digit").show();AnswerNotify.loaded=false;Title.setAnswers(count);},beforeAnswerRemove:function(link){$(link).closest('div.questionBox').remove();}};StreamerReplacer={init:function(container_id,replacement_url){this.replacement_url=replacement_url;},replaceStreamer:function(){if(this.get$Replacement()){this.get$Replacement().show();}else{this.createReplacement();}},restoreStreamer:function(){if(this.get$Replacement()){this.get$Replacement().hide();}},createReplacement:function(){if(this.replacement_url){var $leaderboard=this.get$Leaderboard();this.$replacement=$('<div id="leaderboard_content_replacement" />').width($leaderboard.outerWidth()).height($leaderboard.outerHeight()).appendTo(this.get$Leaderboard());}},get$Replacement:function(){if(!this.$replacement){}
return this.$replacement;},get$Leaderboard:function(){if(!this.$leaderboard){this.$leaderboard=$('#leaderboard');}
return this.$leaderboard;}};Wall={cached_count:0,clickNotice:function(poller){$("#wall_notice_container").hide(0);var cachedItems=$("#wall_notice_cache").children();if(cachedItems.length>0){Wall.cached_count=0;cachedItems.each(function(){var qid=this.id.replace(/^cached_wall_answer_/,"");$("#wall_answer_"+qid).remove();this.id="wall_answer_"+qid;});$('#common_question_container').prepend(cachedItems);Hints.reinit();poller.unshift();$("#yourLink, #itsMoreFun").remove();}
else
window.location.reload();},showNotice:function(count){Wall.cached_count+=count;Wall.showCounter();$("#wall_notice_container").animate({"height":"show"},"slow");},showCounter:function(){var id;if(Wall.cached_count==1)
id="#wall_notice_one";else if(Wall.cached_count>=2&&Wall.cached_count<5)
id="#wall_notice_two";else if(Wall.cached_count>=5&&Wall.cached_count<11)
id="#wall_notice_five";else
id="#wall_notice_more";$(".wall-notice").hide();$(id).find(".wall-notice-counter").text(Wall.cached_count);$(id).show();},clearCache:function(){$('#wall_notice_cache').empty();},removeCacheDupes:function(ids){for(var i=0;i<ids.length;++i){$("#cached_wall_answer_"+ids[i]).remove();}}};Stream={cached_count:0,clickNotice:function(poller){$("#wall_notice_container").hide(0);var cachedItems=$("#wall_notice_cache").children();if(cachedItems.length>0){Stream.cached_count=0;cachedItems.each(function(){var qid=this.id.replace(/^cached_wall_answer_/,"");$("#wall_answer_"+qid).remove();this.id="wall_answer_"+qid;});$('#common_question_container').prepend(cachedItems);Hints.reinit();poller.unshift();}
else
window.location.reload();},showNotice:function(count){Stream.cached_count+=count
Stream.showCounter()
$("#wall_notice_container").animate({"height":"show"},"slow");},showCounter:function(){var id;if(Stream.cached_count==1)
id="#wall_notice_one"
else if(Stream.cached_count>=2&&Stream.cached_count<5)
id="#wall_notice_two"
else if(Stream.cached_count>=5&&Stream.cached_count<11)
id="#wall_notice_five"
else
id="#wall_notice_more"
$(".wall-notice").hide()
$(id).find(".wall-notice-counter").text(Stream.cached_count)
$(id).show()},clearCache:function(){$('#wall_notice_cache').empty()},removeCacheDupes:function(ids){for(var i=0;i<ids.length;++i){$("#cached_wall_answer_"+ids[i]).remove()}}};Profile={cached_count:0,clickNotice:function(poller){$("#wall_notice_container").hide(0);var cachedItems=$("#wall_notice_cache").children();if(cachedItems.length>0){Profile.cached_count=0;cachedItems.each(function(){var qid=this.id.replace(/^cached_question_box_/,"");$("#question_box_"+qid).remove();this.id="question_box_"+qid;});$('#common_question_container').prepend(cachedItems);Hints.reinit();poller.unshift();}
else
window.location.reload();},showNotice:function(count){Profile.cached_count+=count;Profile.showCounter();$("#wall_notice_container").animate({"height":"show"},"slow");},showAnswersCount:function(total_count,liked_count){$('#profile_answer_counter:eq(0)').text(total_count);$('#profile_liked_counter:eq(0)').text(liked_count);},showCounter:function(){$("#noQuestionBox_profile").hide()
var id;if(Profile.cached_count==1)
id="#wall_notice_one"
else if(Profile.cached_count>=2&&Profile.cached_count<5)
id="#wall_notice_two"
else if(Profile.cached_count>=5&&Profile.cached_count<11)
id="#wall_notice_five"
else
id="#wall_notice_more"
$(".wall-notice").hide()
$(id).find(".wall-notice-counter").text(Profile.cached_count)
$(id).show()},clearCache:function(){$('#wall_notice_cache').empty()},removeCacheDupes:function(ids){for(var i=0;i<ids.length;++i){$("#cached_question_box_"+ids[i]).remove()}},showQuestionForm:function(){$('#reMotivation_box').hide();$('#question_form').show();TextArea.show_counter();},beforeQuestionClear:function(link){$(link).closest('div.questionBox').remove();if($("div.questionBox").length==0){$("#noQuestionBox_profile").show();}},quickLike:function(like_box_id){$(".like, .people-like-block",like_box_id).remove();$(".like-active, .you-like-block",like_box_id).show();},likes_block_logic:null,likesBlocked:null
else
return false;},setLikesBlockLogic:null(fn,pm){Profile.likes_block_logic={fn:fn,pm:pm};},quickLikesBlock:null (title){$.colorbox({href:'#likes_blocked_popup',inline:false,title:title});},mobileLikesBlock:function(url){window.location=url;}};Flyout={SHOW_DELAY:500,HIDE_DELAY:300,ADJUST:19,MIRROR:6,kill_timer:1,show_timer:null,current_index:null,showing:null,hiding:null,current:null,_onhover:function(faceBlock){if(Flyout.hiding==faceBlock&&Flyout.showing==null){clearTimeout(Flyout.show_timer);Flyout.show();}
else if(Flyout.current!=faceBlock){Flyout.showing=faceBlock;clearTimeout(Flyout.show_timer);Flyout.show_timer=setTimeout("Flyout.show()",Flyout.SHOW_DELAY);}},_onleave:function(faceBlock){if(Flyout.showing==faceBlock){clearTimeout(Flyout.show_timer);}
else{Flyout.hiding=faceBlock;Flyout.kill_timer=setTimeout("Flyout.kill()",Flyout.HIDE_DELAY);}},init:function(head_selector){Flyout.head_selector=head_selector;Tools.onDOMReady(function(){$(Flyout.head_selector).hover(function(){Flyout._onhover(this);},function(){Flyout._onleave(this);});$("div.flyout_people-holder").hover(function(){Flyout._onhover(Flyout.findFaceBlock(this,true));},function(){Flyout._onleave(Flyout.findFaceBlock(this,true));});});$(window).unload(function(){$(".flyout_people-holder").hide();});},kill:function(){if(this.hiding){$(".flyout_people-holder").hide();this.hiding=null;this.current=null;}},show:function(){var self=Flyout.showing;var index=$(Flyout.head_selector).index(self);Flyout.current_index=index;clearTimeout(Flyout.kill_timer);Flyout.hiding=null;Flyout.showing=null;Flyout.current=self;var flyout=Flyout.findFlyout(self);$(".flyout_people-holder").stop(true,true).not(flyout).hide();var left=0;var top=$(self).offset().top-flyout.height()-10;if(index>=Flyout.MIRROR^App.rtl){left=$(self).offset().left-flyout.width()+$(self).width()+Flyout.ADJUST;flyout.find(".flyout_people-pointer").addClass("flyout_people-pointer-mirror");}
else{left=$(self).offset().left-Flyout.ADJUST;flyout.find(".flyout_people-pointer").removeClass("flyout_people-pointer-mirror");}
flyout.css('left',parseInt(left)).css('top',parseInt(top)).show();},findFaceBlock:function(flyout,asObj){var jq=$('#'+flyout.id.toString().replace('_flyout',''));return asObj?jq.get(0):jq;},findFlyout:function(faceBlock,asObj){var jq=$('#'+faceBlock.id.toString()+'_flyout');return asObj?jq.get(0):jq;}};Settings={init:function(opt){Settings.upload_avatar_url=opt.upload_avatar_url;},onAvatarFileChange:function(file_field){if(!Settings.uploadAvatarBlocked){Settings.hideMessageBlock(".flashMessage");Settings.uploadAvatar(file_field);}else{$.fn.colorbox.close();}},onBeforeAvatarUpload:function(){Settings.uploadAvatarBlocked=true;$("#profile_avatar_loader").show();$.fn.colorbox.close();},onAfterAvatarUpload:function(response){var resp=response.responseText;if(resp.indexOf('false')==0){Settings.onAvatarUploadError();}else{var urls=resp.split(';');$('#profile-picture').attr('src',urls[0]);Settings.initZoomAvatar(urls[1],urls[2]);Settings.showMessageBlock("#profile_updated");Settings.uploadAvatarBlocked=false;}
$("#profile_avatar_loader").hide();},onAvatarUploadError:function(){if(Settings.uploadAvatarColorboxOpen){$.fn.colorbox.close();}
Settings.showMessageBlock("#profile_image_errors");Settings.uploadAvatarBlocked=false;FileUpload.reset();},onUpdateAvatarColorboxOpened:function(){Settings.uploadAvatarColorboxOpen=true;},onUpdateAvatarColorboxClosed:function(){Settings.uploadAvatarColorboxOpen=false;},uploadAvatar:function(file_field){FileUpload.process(file_field,Settings.upload_avatar_url,{},{before_function:Settings.onBeforeAvatarUpload,after_function:Settings.onAfterAvatarUpload,on_error:Settings.onAvatarUploadError});},showMessageBlock:function(){for(var i=0;i<arguments.length;++i){$(arguments[i]).show();}},hideMessageBlock:function(){for(var i=0;i<arguments.length;++i){$(arguments[i]).hide();}},initZoomAvatar:function(href,url){if($('#zoom_avatar').length==0){$('#profile-picture').wrap("<a id='zoom_avatar'></a>");$('#remove_picture').show();}
if(href)
$('#zoom_avatar').attr('href',href);if(!App.mobile_choice){$('#zoom_avatar').unbind('click').click(function(){$.fn.colorbox({href:url,maxWidth:App.ORIGINAL_AVATAR_MAX_WIDTH,maxHeight:App.ORIGINAL_AVATAR_MAX_HEIGHT});return false;});}},showUploadAvatarForm:function(title){if(!Settings.uploadAvatarBlocked){$("#wrapper-upload-container").reset();$.fn.colorbox({inline:true,title:title,href:"#wrapper-upload-container",onOpen:Settings.onUpdateAvatarColorboxOpen,onComplete:Settings.onUpdateAvatarColorboxOpened,onClosed:Settings.onUpdateAvatarColorboxClosed});}},allowUploadAvatar:function(button){var allow=!Button.block(button);if(allow){$('.flashMessage').hide();}
return allow;}};Signup={showPasswordFields:function(){$('#password_change_block').show();$('#password_change_switch').hide();},updateSubdomain:function(input,container){var subdomain=$.trim($(input).val());if(subdomain!=''){$('#'+container).text('http://ask.fm/'+subdomain);}else{$('#'+container).text('http://ask.fm/');}
return false;},showSocialLoader:function(link_obj,on_klazz,off_klazz){$(link_obj).children("div."+on_klazz).addClass(off_klazz);$(link_obj).children("img.serveLoading").show(0);}};ImageChecker={TIMEOUT:50,image:null,callback:null,current_object:null,init:function(callback){ImageChecker.image=new Image();ImageChecker.callback=callback;},invoke:function(skinBox,src){clearTimeout(ImageChecker.timer);ImageChecker.current_object=skinBox;ImageChecker.image.src=src;ImageChecker.timer=setTimeout("ImageChecker.tick()",ImageChecker.TIMEOUT);},tick:function(){if(ImageChecker.image.complete){ImageChecker.callback(ImageChecker.current_object,ImageChecker.image.src);}
else{ImageChecker.timer=setTimeout("ImageChecker.tick()",ImageChecker.TIMEOUT);}}};Design={smallLoader:null,cachedWallpaper:null,cachedCustomCover:null,previewDesignId:null,lastSkinBox:null,lastCoverSrc:null,upload_url:null,set_url:null,remove_url:null,tile_url:null,preload:function(){Design.smallLoader=new Image();Design.smallLoader.src="/images/animation/loading.gif";ImageChecker.init(Design.onWallpaperLoaded);Design.cachedCustomCover=new Image();$(Design.cachedCustomCover).load(Design.onCustomCoverLoaded);},init:function(opt){Design.previewDesignId=opt.current_design_id;Design.preload();Design.isBlocked=opt.background_blocked;Design.upload_url=opt.upload_url;Design.set_url=opt.set_url;Design.remove_url=opt.remove_url;Design.tile_url=opt.tile_url;Tools.onDOMReady(function(){Design.lastCoverSrc=DesignHelper.getValue("#skin_preview","design_cover");Design.lastSkinBox=$(".skinBox-active, .skinBox-upload-active").get(0);$("#skinTable td > div, #skin_preview").click(Design.onDesignClicked);$("#design_tile_background").click(Design.onTileClicked);});},onCustomFileChange:function(file_field){Design.uploadWallpaper(file_field);},onTileClicked:function(){DesignHelper.clearErrors();var customSkinBox=$("#skin_preview");var latestCustomDesignId=DesignHelper.getValue(customSkinBox,"design_id");var tile=$("#design_tile_background").is(':checked');$("#design_tile_background").disable();$.post(Design.tile_url,{"_method":"put","authenticity_token":AUTH_TOKEN,"design_id":latestCustomDesignId,"tile":tile},function(){$("#design_tile_background").enable();});DesignHelper.setValue(customSkinBox,"background_repeat",tile?"repeat":"no-repeat");if(Design.previewDesignId==latestCustomDesignId){$("html").css('background-repeat',DesignHelper.getValue(customSkinBox,'background_repeat','repeat'));}},onDesignClicked:function(){DesignHelper.clearErrors();var skinBox=this;if(Design.loadingSkinBox==this||Design.uploadingSkinBox==this){return;}
Design.lastSkinBox=skinBox;DesignHelper.showSingleLoader(skinBox);DesignHelper.presetSkinBoxFocus(skinBox);if(!(Design.isBlocked&&skinBox.id=='skin_preview'))
{var src=DesignHelper.getValue(skinBox,"background_wallpaper");Design.loadWallpaper(skinBox,src);}},onRemoveCustomDesignClicked:function(){DesignHelper.clearErrors();Design.lastCoverSrc=null;FileUpload.reset();DesignHelper.resetUploadForm();if(Design.lastSkinBox!=null&&Design.lastSkinBox.id=="skin_preview")
$("#skinTable div:first").click();$("#skin-uploadContainer-full").hide();$("#custom_controls").hide();$.post(Design.remove_url,{"_method":"delete","authenticity_token":AUTH_TOKEN});},onWallpaperLoaded:function(skinBox,cachedSrc){skinBox=$(skinBox).get(0);if(skinBox!=Design.lastSkinBox){return;}
var src=cachedSrc?"url("+cachedSrc+")":"none";$("html").css('background','').css('background-image',src).css('background-color',DesignHelper.getValue(skinBox,'background_color','#264C67')).css('background-repeat',DesignHelper.getValue(skinBox,'background_repeat','repeat')).css('background-attachment',DesignHelper.getValue(skinBox,'background_placement','fixed')).css('background-position',DesignHelper.getValue(skinBox,'background_position','left top'));$(".skinBox-smallLoader").fadeOut('slow');var design_id=DesignHelper.getValue(skinBox,'design_id');if(Design.previewDesignId!=design_id)
$.post(Design.set_url,{"_method":"put","authenticity_token":AUTH_TOKEN,"design_id":design_id});Design.previewDesignId=design_id;},loadWallpaper:function(skinBox,src){Design.loadingSkinBox=skinBox;if(src==null){Design.onWallpaperLoaded(skinBox,src);}
else{ImageChecker.invoke(skinBox,src);}},loadCustomCover:function(src){Design.cachedCustomCover.src=src;},onCustomCoverLoaded:function(){var src=Design.cachedCustomCover.src?"url("+Design.cachedCustomCover.src+")":"none";$("#skin_preview").css('background-image',src);Design.lastCoverSrc=Design.cachedCustomCover.src;},uploadWallpaper:function(file_field){FileUpload.process(file_field,Design.upload_url,{tile:$("#design_tile_background").is(":checked")},{before_function:Design.beforeWallpaperUpload,after_function:Design.afterWallpaperUpload,on_error:Design.onError});},beforeWallpaperUpload:function(){DesignHelper.clearErrors();Design.uploadingSkinBox=$("#skin_preview").get(0);Design.lastSkinBox=$("#skin_preview").get(0);$("#custom_controls").hide();$("#skin-uploadContainer-full").show();$("#skin_preview").css('background','silver url(/images/animation/loading.gif) no-repeat center center');DesignHelper.disableFileInput();},afterWallpaperUpload:function(response){var resp=response.responseText;if(resp.indexOf('false')==0){Design.onError();Design.loadCustomCover(Design.lastCoverSrc);}else{var skinBox=$("#skin_preview").get(0);var data=DesignHelper.parseUploadResponse(resp);DesignHelper.setValues(skinBox,{"design_id":data.design_id,"background_color":data.color,"background_wallpaper":data.wallpaper_url,"background_repeat":data.repeat,"background_placement":data.placement,"background_position":data.position,"design_cover":data.cover_url});if(skinBox==Design.lastSkinBox){DesignHelper.presetSkinBoxFocus(skinBox);Design.loadWallpaper(skinBox,data.wallpaper_url);}
Design.loadCustomCover(data.cover_url);DesignHelper.resetUploadForm();$("#custom_controls").show();}
DesignHelper.enableFileInput();Design.uploadingSkinBox=null;},onError:function(){FileUpload.reset();DesignHelper.resetUploadForm();if(!Design.lastCoverSrc){$("#skin-uploadContainer-full").hide();$("#custom_controls").hide();}
else{$("#custom_controls").show();}
$(".info").show();}};DesignHelper={resetUploadForm:function(){$("#design_form").reset();},disableFileInput:function(){$("#file_input_box").hide();$("#disabled_file_input_box").show();},enableFileInput:function(){$("#disabled_file_input_box").hide();$("#file_input_box").show();},clearErrors:function(){$(".info").hide();},parseUploadResponse:function(resp){var data=resp.split(';');return{design_id:data[0],color:data[1],wallpaper_url:data[2],repeat:data[3],placement:data[4],position:data[5],cover_url:data[6]}},showSingleLoader:function(skinBox){$(".skinBox-smallLoader").stop(true,true).hide();$(skinBox).find(".skinBox-smallLoader").attr("src",Design.smallLoader.src).show();},presetSkinBoxFocus:function(skinBox){$(".skinBox-active").removeClass("skinBox-active").addClass("skinBox");$(".skinBox-upload-active").removeClass("skinBox-upload-active").addClass("skinBox-upload");var preset=skinBox.id!="skin_preview";var offClass=preset?"skinBox":"skinBox-upload"
var onClass=preset?"skinBox-active":"skinBox-upload-active"
$(skinBox).removeClass(offClass).addClass(onClass);},getValue:function(skinBox,name,def){return $(skinBox).find("input[name="+name+"]").val()||def||null;},setValue:function(skinBox,name,value){$(skinBox).find("input[name="+name+"]").val(value);},setValues:function(skinBox,map){for(var key in map){DesignHelper.setValue(skinBox,key,map[key]);}}};Inbox={_showNoticePanel:function(){$("#wall_notice_container").animate({"height":"show"},App.mobile_choice?0:"slow");},_hideNoticePanel:function(){$("#wall_notice_container").hide(0);},clickNotice:function(append_path,poller){if(!Inbox.appendLock){Inbox.appendLock=true;poller.stop();Inbox._hideNoticePanel();QuestionNotify.clear();$.post(append_path,{start_tag:poller.start_tag,uid:poller.uid,authenticity_token:AUTH_TOKEN});}},beforeAppend:function(){},afterAppend:function(){Inbox.updatePresentation();Hints.reinit();Inbox.appendLock=false;},showNotice:function(count){if($("#inbox_headline_menu").length>0&&!Inbox.appendLock){Inbox.showCounter(count);if(count>0)
Inbox._showNoticePanel();else{QuestionNotify.clear();Inbox._hideNoticePanel();}}},removeDupes:function(ids){for(var i=0;i<ids.length;++i){$("#inbox_question_"+ids[i]).remove();}},showCounter:function(count){$("#noQuestionBox_inbox, #motivator_inbox").hide();var id;if(count==1)
id="#wall_notice_one";else if(count>=2&&count<5)
id="#wall_notice_two";else if(count>=5&&count<11)
id="#wall_notice_five";else
id="#wall_notice_more";$(".wall-notice").hide();$(id).find(".wall-notice-counter").text(count);$(id).show();},disableRandom:function(button){return Button._block(button,"link-silver-medium-right-active","link-silver-medium-right-disabled");},enableRandom:function(button){Button._unblock(button,"link-silver-medium-right-active","link-silver-medium-right-disabled");},hide_or_redirect:function(form,url){if($('form:visible').length>1)
$(form).hide('slow');else
window.location=url;},updatePresentation:function(){var standard_count=$("div.questionBox").length;var daily_count=$("div.questionBox-daily").length;var sponsored_count=$("div.questionBox-sponsored").length;var $more_container=$("#more-container");var notice_present=$("#wall_notice_container").is(":visible");var more_present=$more_container.is(":visible");var show_delete_all=standard_count>0;var show_motivator=daily_count+sponsored_count+standard_count==0;$("#inbox-delete_all").toggle(show_delete_all);if(!notice_present&&!more_present){$("#noQuestionBox_inbox, #motivator_inbox").toggle(show_motivator);}else if(more_present&&show_motivator){$more_container.hide();Inbox.appendLock=true;Inbox.mustReload=true;}},beforeQuestionRemove:function(link){$(link).closest("div.questionBox").remove();Inbox.updatePresentation();},beforeDailyQuestionRemove:function(link){$(link).closest("div.questionBox-daily").remove();$("div.questionBox-sponsored").addClass("questionBox-sponsored-top");Inbox.updatePresentation();},afterQuestionRemove:function(link){if(Inbox.mustReload){window.location.reload();}},manualNotify:function(unread_count,total_count){QuestionNotify.notificationReceived(unread_count+","+total_count);},updateDeleteAllCounter:function(user_questions_count){$("#inbox-delete_all-counter").text(user_questions_count);}};PhotoAnswer={uploadBlocked:false,photoAttached:false,onBeforeUpload:function(){PhotoAnswer.uploadBlocked=true;$('#photo_answer_loader').show();},onAfterUpload:function(js_http_response){var response_json=js_http_response.responseText;if(response_json.status=="success"){PhotoAnswer.onUploadSuccess(response_json.body);}else if(response_json.status=="error"){PhotoAnswer.onUploadError(response_json.body);}else{PhotoAnswer.onUploadError("Bad response");}},onUploadSuccess:function(response_json){var thumb_url=response_json["thumb_nano"];PhotoAnswer.getOrCreate("photo_answer_thumb",function(id){return $("<img/>").attr("id",id).addClass("attachment_preview").prependTo("#post_options");}).attr("src",thumb_url);PhotoAnswer.storeRequestId(true);PhotoAnswer.photoAttached=true;PhotoAnswer.toggleToolboxView(true);PhotoAnswer.closePopup();PhotoAnswer.block(false);},onUploadError:function(message){PhotoAnswer.toggleMessageBlock(false);PhotoAnswer.block(false);},onUpdateColorboxOpened:function(){PhotoAnswer.uploadColorboxOpen=true;},onUpdateColorboxClosed:function(){PhotoAnswer.uploadColorboxOpen=false;},onBeforeRemove:function(){PhotoAnswer.photoAttached=false;PhotoAnswer.toggleToolboxView(false);},onAfterRemove:function(){PhotoAnswer.storeRequestId(false);},submit:function(button,upload_path,file_field_id,data_field_id,result_field_id){var allow=!Button.block(button)&&!PhotoAnswer.uploadBlocked;if(allow){PhotoAnswer.result_field_id=result_field_id;PhotoAnswer.upload(upload_path,file_field_id,data_field_id);}
return allow;},upload:function(upload_path,file_field_id,data_field_id){PhotoAnswer.pending_request_id=(new Date()).getTime().toString();var file_field=document.getElementById(file_field_id);var data_field=document.getElementById(data_field_id);FileUpload.process(file_field,upload_path,{ObjectSpec:data_field.value,RequestID:PhotoAnswer.pending_request_id},{before_function:PhotoAnswer.onBeforeUpload,after_function:PhotoAnswer.onAfterUpload,on_error:PhotoAnswer.onUploadError});},showUploadForm:function(title){$.fn.colorbox({inline:true,title:title,href:"#wrapper-upload-container",onOpen:PhotoAnswer.onUpdateColorboxOpen,onComplete:PhotoAnswer.onUpdateColorboxOpened,onClosed:PhotoAnswer.onUpdateColorboxClosed});},getOrCreate:function(id,constructor_fn){var $el=$('#'+id);if($el.length==0){$el=constructor_fn(id);}
return $el;},closePopup:function(){if(PhotoAnswer.uploadColorboxOpen){$.fn.colorbox.close();}},toggleToolboxView:function(toggle){$('#photo_answer_thumb, #remove_photo_button').toggle(toggle);$('#select_photo_button').toggle(!toggle);},toggleMessageBlock:function(toggle){$("#attach_photo_hint").toggle(toggle);$("#attach_photo_error").toggle(!toggle);$.fn.colorbox.resize();},block:function(toggle){if(toggle){Button.block(document.getElementById('attach_photo_submit'));}else{FileUpload.reset();$("#wrapper-upload-container").reset();Button.unblock(document.getElementById('attach_photo_submit'));}
PhotoAnswer.uploadBlocked=toggle;$('#photo_answer_loader').toggle(toggle);},storeRequestId:function(toggle){var request_id=null;if(toggle)
request_id=PhotoAnswer.pending_request_id;PhotoAnswer.request_id=request_id;$('#'+PhotoAnswer.result_field_id).val(request_id);}};Hints={init:function(){if(!App.mobile_choice)
Tools.onDOMReady(function(){Hints.singleton();Hints.bindClass("hintable");});},reinit:function(){if(!App.mobile_choice){Hints.singleton();Hints.rebindClass("hintable");}},create:function(){var hint=$("<div id='likeFlyout-wrapper' style='display:none'>");var content=$("<div id='likeFlyout-center'>");hint.append(content);return hint;},singleton:function(){if(!Hints.flyout){var hint=Hints.create();$(document.body).append(hint);Hints.flyout=hint;}
return Hints.flyout;},unbind:function(element){$(element).unbind('mouseenter mouseleave');},bind:function(element){$(element).hover(Hints.dispatch_hover,Hints.dispatch_leave).mousedown(Hints.hide);},bindClass:function(klazz){$("."+klazz).each(function(){Hints.bind(this);})},rebindClass:function(klazz){$("."+klazz).each(function(){Hints.unbind(this);Hints.bind(this);})},dispatch_hover:function(event){var $content=$("#likeFlyout-center");var $element=$(event.currentTarget);var hdir=$element.attr("hdir");var like_style=$element.hasClass("like-face");var invr_style=$element.hasClass("inverse");var mirrored=invr_style||(like_style&&$element.parent().index()>=10);mirrored=mirrored^App.rtl;$content.text($element.attr("hint"));if(hdir)
$content.attr("dir",hdir);else
$content.removeAttr("dir");Hints.prepareFlyout(like_style,mirrored);var measures=Hints.getMeasures($element,Hints.singleton(),mirrored);if($.support.opacity)
$(Hints.singleton()).stop(true,true).hide(0).delay(500).css('left',measures.x).css('top',measures.y).fadeIn('fast');else
$(Hints.singleton()).stop(true,true).hide(0).delay(500).css('left',measures.x).css('top',measures.y).show(0);},dispatch_leave:function(event){Hints.hide();},hide:function(){if(Hints.flyout){if($.support.opacity)
$(Hints.singleton()).stop(true,true).hide(0);else
$(Hints.singleton()).stop(true,true).hide(0);}},getMeasures:function(e,flyout,mirrored){var f=$(flyout);var e_ofs=e.offset();return{x:(mirrored?e_ofs.left+e.width()/2-19:e_ofs.left-f.width()+e.width()/2+19),y:e_ofs.top-f.height()}},prepareFlyout:function(like_style,mirrored){var $wrapper=$("#likeFlyout-wrapper");if(like_style)
$wrapper.addClass("normal-font");else
$wrapper.removeClass("normal-font");if(mirrored)
$wrapper.removeClass("likeFlyout-right").addClass("likeFlyout-left");else
$wrapper.removeClass("likeFlyout-left").addClass("likeFlyout-right");}};Title={cached_title:null,p:0,q:0,a:0,init:function(p0,q0,a0){this.cached_title=document.title;this.p=p0;this.q=q0;this.a=a0;this.update();},update:function(){if(this.cached_title){var title=this.cached_title;var sum=this.p+this.q+this.a;if(sum>0)
title="("+sum+") "+title;document.title=title;}},setPerks:function(count){this.p=parseInt(count);this.update();},setQuestions:function(count){this.q=parseInt(count);this.update();},setAnswers:function(count){this.a=parseInt(count);this.update();}};MassAsk={options:{},search_query_field:"#askFriends_search",selected_count:"#askFriends_count",max_selected:"#askFriends_max",item_common_class:"askFriends-block",item_enabled_class:"askFriends-friend",item_disabled_class:"askFriends-friend-disabled",item_checked_class:"askFriends-friend-checked",Anonymity:{must_allow:true,processing:false,setOpen:function(){if(!MassAsk.Anonymity.processing){MassAsk.Anonymity.processing=true;MassAsk.Anonymity.must_allow=false;for(var i=0;i<MassAsk.Search.anon_cache.length;++i){var item=MassAsk.Search.anon_cache[i];$(item).removeClass(MassAsk.item_disabled_class).addClass(MassAsk.item_enabled_class);}
MassAsk.Anonymity.processing=false;}
return!MassAsk.Anonymity.processing;},setAnonymous:function(){if(!MassAsk.Anonymity.processing){MassAsk.Anonymity.processing=true;MassAsk.Anonymity.must_allow=true;for(var i=0;i<MassAsk.Search.anon_cache.length;++i){var item=MassAsk.Search.anon_cache[i];var $item=$(item);if(Tools.remove(MassAsk.Selection.batch,item)>=0)
$item.removeClass(MassAsk.item_checked_class);else
$item.removeClass(MassAsk.item_enabled_class);$item.addClass(MassAsk.item_disabled_class);}
if(MassAsk.Selection.updateCounter()<MassAsk.options.MAX_SELECTED)
$(MassAsk.max_selected).hide();MassAsk.Anonymity.processing=false;}
return!MassAsk.Anonymity.processing;}},Selection:{batch:null,add:function(item){var added=false;if(!MassAsk.Anonymity.must_allow||$(item).data("MassAsk").allows_anonymous){added=(MassAsk.Selection.batch.length<MassAsk.options.MAX_SELECTED);if(added){MassAsk.Selection.batch.push(item);MassAsk.Selection.updateCounter();}
else{$(MassAsk.max_selected).show();}}
return added;},remove:function(item){var removed=(Tools.remove(MassAsk.Selection.batch,item)>=0);if(removed){MassAsk.Selection.updateCounter();$(MassAsk.max_selected).hide();}
return removed;},updateCounter:function(){var new_count=MassAsk.Selection.batch.length;$(MassAsk.selected_count).text(new_count);return new_count;},onClick:function(e){if(MassAsk.Selection.remove(this))
$(this).removeClass(MassAsk.item_checked_class).addClass(MassAsk.item_enabled_class);else if(MassAsk.Selection.add(this))
$(this).removeClass(MassAsk.item_enabled_class).addClass(MassAsk.item_checked_class);e.stopPropagation();e.preventDefault();},exportData:function(){var s="";for(var i=0;i<MassAsk.Selection.batch.length;++i){s+="|"+$(MassAsk.Selection.batch[i]).data("MassAsk").login;}
return s.substr(1);},init:function(){MassAsk.Selection.batch=[];$("div."+MassAsk.item_common_class).mousedown(MassAsk.Selection.onClick);}},Search:{all_cache:null,anon_cache:null,ready:false,kill:false,running:false,queued_query:null,timeout_modifier:0,extractData:function(dom_object){var $dom_object=$(dom_object);var rel=$dom_object.attr("rel").split("|");var allows_anonymous=(rel[0]=="1");$dom_object.data("MassAsk",{"login":rel[1].toLowerCase(),"name":decodeURIComponent(rel[2]).toLowerCase(),"allows_anonymous":allows_anonymous});MassAsk.Search.all_cache.push(dom_object);if(!allows_anonymous){MassAsk.Search.anon_cache.push(dom_object);}},clearTimeout:function(){if(MassAsk.Search.timeout){clearTimeout(MassAsk.Search.timeout);MassAsk.Search.timeout=null;}},onKeyUp:function(){MassAsk.Search.queued_query=$(this).val().toLowerCase();if(MassAsk.Search.running){MassAsk.Search.kill=true;MassAsk.Search.clearTimeout();}
else if(!MassAsk.Search.timeout){MassAsk.Search.timeout=setTimeout(MassAsk.Search.matchQuery,MassAsk.options.SEARCH_DELAY+MassAsk.Search.timeout_modifier);}},matchItem:function(item,query){var $data=$(item).data("MassAsk");return $data.name.indexOf(query)>=0||$data.login.indexOf(query)>=0;},showItem:function(item){$(item).show();},hideItem:function(item){$(item).hide();},matchQuery:function(){var query=MassAsk.Search.queued_query;MassAsk.Search.queued_query=null;MassAsk.Search.running=true;MassAsk.Search.kill=false;var show_all=Tools.blank(query);for(var i=0;!MassAsk.Search.kill&&i<MassAsk.Search.all_cache.length;++i){var item=MassAsk.Search.all_cache[i];if(show_all||MassAsk.Search.matchItem(item,query)){MassAsk.Search.showItem(item);}
else{MassAsk.Search.hideItem(item);}}
if(MassAsk.Search.queued_query)
MassAsk.Search.timeout=setTimeout(MassAsk.Search.matchQuery,MassAsk.options.SEARCH_DELAY+MassAsk.Search.timeout_modifier);else
MassAsk.Search.timeout=null;MassAsk.Search.running=false;},init:function(){MassAsk.Search.all_cache=[];MassAsk.Search.anon_cache=[];$("div."+MassAsk.item_common_class).each(function(){MassAsk.Search.extractData(this);});MassAsk.Search.timeout_modifier=MassAsk.Search.all_cache.length/200*100;$(MassAsk.search_query_field).keyup(MassAsk.Search.onKeyUp);}},init:function(options){MassAsk.options=Tools.mergeHash({MAX_SELECTED:20,SEARCH_DELAY:150},options);MassAsk.Anonymity.must_allow=true;MassAsk.Search.all_cache=null;MassAsk.Search.anon_cache=null;MassAsk.Selection.batch=null;Tools.onDOMReady(function(){MassAsk.Search.init();MassAsk.Selection.init();});},cleanup:function(){MassAsk.Search.queued_query=null;MassAsk.Search.kill=true;MassAsk.Search.clearTimeout();}};TextField={withDefault:function(id){$(id).blur(function(){var $this=$(this);if(Tools.blank($this.val()))
$this.val($this.attr("default")).addClass("text-empty");}).focus(function(){var $this=$(this);if($this.val()==$this.attr("default"))
$this.val('');$this.removeClass("text-empty");});}};Captcha={regen_locked:false,regenerate:function(container_id,url){if(!Captcha.regen_locked){Captcha.regen_locked=true;$.get(url,{container_id:container_id},function(){Captcha.regen_locked=false});}}};Gifts={wrapper_id:"#wrapper",container_id:"#gift-container",outline_id:"#gift-outline",margin_top:-5,margin_side:-115,sync_timeout:1000,init:function(opts){Gifts.opts=(opts||{});Gifts.initEnv();},initEnv:function(){Gifts.opts.$wrapper=$(Gifts.wrapper_id);Gifts.opts.$container=$(Gifts.container_id);Gifts.opts.$outline=$(Gifts.outline_id);},load:function(objects){for(var i=0;i<objects.length;++i){Gifts.loadObject(objects[i]);}},loadObject:function(object){var image=new Image();image.onload=function(){Gifts.create(object)};image.src=object.src;},create:function(object){var $content=$("<img class='gift-content-image'/>").attr('src',object.src);var $floater=$("<div class='gift-floater'></div>");var h_anchor=(App.rtl!=object.rtl)?'right':'left';object.editable=(Gifts.opts.flash_id&&Gifts.opts.flash_id==object.id);if(object.editable){$floater.addClass("gift-glow");}
$content.appendTo($floater);$floater.appendTo(Gifts.opts.$container).css('z-index',object.z_index).css('top',object.offset_top+Gifts.margin_top-10).css(h_anchor,object.offset_left+Gifts.margin_side-10).show();Gifts.initFloater($floater,object);},initFloater:function($floater,object){$floater.mydrag({"object":object,"onDrag":Gifts.onDrag,"onDrop":Gifts.onDrop,"onPick":Gifts.onPick});},onDrag:function(env,data,x,y){if(!Gifts.bounds)Gifts.calculateBounds();var newX=Math.min(Gifts.bounds.maxx,Math.max(Gifts.bounds.minx,x-env.$pofs.left-50-10));var newY=Math.min(Gifts.bounds.maxy,Math.max(Gifts.bounds.miny,y-env.$pofs.top-50-10));data.$trigger.css('left',newX).css('top',newY);},onDrop:function(env,data){Gifts.opts.$outline.hide();if(Gifts.opts.sync_all||data.options.object.editable){data.sync_timer=setTimeout(function(){Gifts.sync(data)},Gifts.sync_timeout);}},onPick:function(env,data){Gifts.opts.$outline.show();clearTimeout(data.sync_timer);},calculateBounds:function(){var pos=Gifts.opts.$outline.position();Gifts.bounds={minx:pos.left-10,miny:pos.top-10,maxx:pos.left+Gifts.opts.$outline.outerWidth()-100-10,maxy:pos.top+Gifts.opts.$outline.outerHeight()-100-10};},sync:function(data){var position=data.$trigger.position();$.post(Gifts.opts.sync_url,{authenticity_token:AUTH_TOKEN,id:data.options.object.id,offset_left:position.left-Gifts.margin_side+10,offset_top:position.top-Gifts.margin_top+10});}};Gifts.Selection={gift_error_id:"#gift_select_error",selected_class:"giftItem-selected",deselected_class:"giftItem",category_loader_id:"#gift_category_loader",category_select_id:"#gift_category",$gift_object:false,reset:function(){Gifts.Selection.$gift_object=false;},onSelect:function(gift_object){var allow=!Gifts.Selection.isLocked();if(allow){$(Gifts.Selection.gift_error_id).hide();if(Gifts.Selection.$gift_object)
Gifts.Selection.$gift_object.removeClass(Gifts.Selection.selected_class).addClass(Gifts.Selection.deselected_class);Gifts.Selection.$gift_object=gift_object&&$(gift_object);if(Gifts.Selection.$gift_object)
Gifts.Selection.$gift_object.removeClass(Gifts.Selection.deselected_class).addClass(Gifts.Selection.selected_class);}
return allow;},onError:function(){$(Gifts.Selection.gift_error_id).show();},loadPage:function(container_id,url){if(!Gifts.Selection.isLocked()){Gifts.Selection.onSelect(false);Gifts.Selection.lock();$.get(url,{},function(html){$(container_id).html(html);},'html');}},goPage:function(url){if(!Gifts.Selection.isLocked()){Gifts.Selection.onSelect(false);Gifts.Selection.lock();window.location=url;}},lock:function(){$(Gifts.Selection.category_select_id).attr('disabled','disabled');},isLocked:function(){return $(Gifts.Selection.category_select_id).is(':disabled');},onBeforeChangeCategory:function(){$(Gifts.Selection.category_loader_id).show();}};Gifts.Payment={getting_info:false,supported:false,form_submit_id:"#gift_submit",form_loader_id:"#gift_loader",form_error_id:"#gift_payment_error",view_block_id:"#gift_payment_country_view",edit_block_id:"#gift_payment_country_edit",info_block_id:"#payment_info",info_select_id:"#gift_payment_country",noinfo_block_id:"#payment_not_supported",info_content_id:"#gift_payment_form",info_pending_id:"#payment_info_pending",init:function(opts,no_popup){Gifts.Payment.supported=opts.country_supported;Gifts.Payment.info_path=opts.info_path;Gifts.Payment.no_popup=no_popup;},onError:function(message){$(Gifts.Payment.form_loader_id).hide();$(Gifts.Payment.form_error_id).text(message);Button.unblock($(Gifts.Payment.form_submit_id).get(0));},flipCountry:function(){$(Gifts.Payment.view_block_id).hide();$(Gifts.Payment.edit_block_id).show();if(!Gifts.Payment.supported){$(Gifts.Payment.noinfo_block_id).hide();$(Gifts.Payment.info_block_id).show();}
Gifts.Payment.updatePopupSize();},getInfo:function(select_object){if(!Gifts.Payment.getting_info){Gifts.Payment.getting_info=true;setTimeout(function(){$(select_object).blur();$(Gifts.Payment.info_select_id).attr('disabled','disabled');$(Gifts.Payment.info_content_id).hide();$(Gifts.Payment.info_pending_id).show();$.get(Gifts.Payment.info_path,{country:select_object.value.toLowerCase()});},0);}},onInfoReceived:function(){$(Gifts.Payment.info_select_id).removeAttr('disabled');Gifts.Payment.updatePopupSize();Gifts.Payment.getting_info=false;},updatePopupSize:function(){if(!Gifts.Payment.no_popup)
$.colorbox.resize();}};Gifts.Payment.Info={country_code:null,op_wrapper_class:".giftOperator-wrapper",op_wrapper_id_prefix:"#op_hint_",onChange:function(select_object){$(select_object).blur();$(Gifts.Payment.Info.op_wrapper_class).hide();$(Gifts.Payment.Info.op_wrapper_id_prefix+select_object.value).show();}};Gifts.Rotator={getCode:function(image){return image.getAttribute('gift-code');},setCode:function(image,code){image.setAttribute('gift-code',code);},getIndex:function(image){return image.__index__||0;},setIndex:function(image,index){image.__index__=index;},getGroup:function(image){return image.getAttribute('gift-group');},setQueued:function(image){image.__queued__=true;},isQueued:function(image){return image.__queued__||false;},clearQueued:function(image){image.__queued__=false;},isElementInited:function(element){return element.__inited__||false;},setElementInited:function(element){element.__inited__=true;},elementSelector:'img.wallGift',imageCache:{},imageQueue:[],imageCodes:{},imagePaths:{},inited:false,init:function(timeout){if(!this.inited&&(this.inited=true)){setInterval(this.checkAndFlip,timeout||8000);}
Tools.onDOMReady(this.bindElements);},mergeCodes:function(imageCodes){this.imageCodes=$.extend(imageCodes,this.imageCodes);},mergePaths:function(imagePaths){this.imagePaths=$.extend(imagePaths,this.imagePaths);},preloadNextFrames:function(){for(var i=0;i<this.imageQueue.length;++i){this.preloadNextFrame(this.imageQueue[i]);}},preloadNextFrame:function(image){var isQueued=this.isQueued(image);if(!isQueued){var nextCode=this.nextCode(image);this.preloadImage(nextCode);this.setCode(image,nextCode);this.setQueued(image);}},preloadImage:function(code){if(!this.imageCache[code]){var image=new Image;this.setCode(image,code);image.onload=this.imageLoaded;image.src=this.imagePaths[code];}},nextCode:function(image){var group=this.getGroup(image);var codes=this.imageCodes[group];var index=this.getIndex(image);if(index+1>=codes.length){index=0;}else{++index;}
this.setIndex(image,index);var newCode=this.imageCodes[group][index];return newCode;},flipCurrentFrames:function(){for(var i=0;i<this.imageQueue.length;++i){var image=this.imageQueue[i];var code=this.getCode(image);image.src=this.imageCache[code].src;this.clearQueued(image);}},check:function(){var i=0,ok=true;while(ok&&i<this.imageQueue.length)
ok=!!this.imageCache[this.getCode(this.imageQueue[i++])];return ok;},attemptReplication:function(image){var group=this.getGroup(image),replicated=false,i=0;while(!replicated&&i<this.imageQueue.length){var suspect=this.imageQueue[i++];if(this.getGroup(suspect)==group){replicated=this.replicate(image,suspect);}}
return!!replicated;},replicate:function(image,template){var replicated=false;if(template&&image!=template){this.setIndex(image,this.getIndex(template));this.setCode(image,this.getCode(template));this.setQueued(image);image.src=template.src;replicated=true;}
return replicated;},imageLoaded:function(){var __this=Gifts.Rotator;var code=__this.getCode(this);__this.imageCache[code]=this;},checkAndFlip:function(){var __this=Gifts.Rotator;if(__this.check()){__this.flipCurrentFrames();__this.preloadNextFrames();}},enterViewport:function(e){var __this=Gifts.Rotator;if(!Tools.contains(__this.imageQueue,this)){if(!__this.attemptReplication(this)){__this.preloadNextFrame(this);}
__this.imageQueue.push(this);}},leaveViewport:function(){var __this=Gifts.Rotator;Tools.remove(__this.imageQueue,this);},bindElements:function(){var __this=Gifts.Rotator;var elements_to_init=[];$(__this.elementSelector).each(function(){if(!__this.isElementInited(this)){__this.setElementInited(this);elements_to_init.push(this);}});$(elements_to_init).bind('enterviewport',Gifts.Rotator.enterViewport).bind('leaveviewport',Gifts.Rotator.leaveViewport).bullseye();}};