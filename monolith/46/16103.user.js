// ==UserScript==
// @name          Salesforce - LinkedIn Mashup
// @namespace     http://www.japaninyourpalm.com
// @description   Adds a LinkedIn icon & link next to each Lead, Account, Contact and Opportunity in Salesforce.com
// @include       https://*.salesforce.com/00Q*
// @include       https://*.salesforce.com/001*
// @include       https://*.salesforce.com/003*
// @include       https://*.salesforce.com/006*

// Written by: Al N
// December 2007
// Dec 31, 2007 - updated the includes - removed the trailing /

// LinkedIn logo Data URI
var imageLinkedInElem = document.createElement('img');
imageLinkedInElem.setAttribute('src', "data:image/jpeg,%FF%D8%FF%E0%00%10JFIF%00%01%01%00%00%01%00%01%00%00%FF%DB%00C%00%06%04%05%06%05%04%06%06%05%06%07%07%06%08%0A%10%0A%0A%09%09%0A%14%0E%0F%0C%10%17%14%18%18%17%14%16%16%1A%1D%25%1F%1A%1B%23%1C%16%16%20%2C%20%23%26')*)%19%1F-0-(0%25()(%FF%DB%00C%01%07%07%07%0A%08%0A%13%0A%0A%13(%1A%16%1A((((((((((((((((((((((((((((((((((((((((((((((((((%FF%C0%00%11%08%00%10%00%10%03%01%22%00%02%11%01%03%11%01%FF%C4%00%1F%00%00%01%05%01%01%01%01%01%01%00%00%00%00%00%00%00%00%01%02%03%04%05%06%07%08%09%0A%0B%FF%C4%00%B5%10%00%02%01%03%03%02%04%03%05%05%04%04%00%00%01%7D%01%02%03%00%04%11%05%12!1A%06%13Qa%07%22q%142%81%91%A1%08%23B%B1%C1%15R%D1%F0%243br%82%09%0A%16%17%18%19%1A%25%26'()*456789%3ACDEFGHIJSTUVWXYZcdefghijstuvwxyz%83%84%85%86%87%88%89%8A%92%93%94%95%96%97%98%99%9A%A2%A3%A4%A5%A6%A7%A8%A9%AA%B2%B3%B4%B5%B6%B7%B8%B9%BA%C2%C3%C4%C5%C6%C7%C8%C9%CA%D2%D3%D4%D5%D6%D7%D8%D9%DA%E1%E2%E3%E4%E5%E6%E7%E8%E9%EA%F1%F2%F3%F4%F5%F6%F7%F8%F9%FA%FF%C4%00%1F%01%00%03%01%01%01%01%01%01%01%01%01%00%00%00%00%00%00%01%02%03%04%05%06%07%08%09%0A%0B%FF%C4%00%B5%11%00%02%01%02%04%04%03%04%07%05%04%04%00%01%02w%00%01%02%03%11%04%05!1%06%12AQ%07aq%13%222%81%08%14B%91%A1%B1%C1%09%233R%F0%15br%D1%0A%16%244%E1%25%F1%17%18%19%1A%26'()*56789%3ACDEFGHIJSTUVWXYZcdefghijstuvwxyz%82%83%84%85%86%87%88%89%8A%92%93%94%95%96%97%98%99%9A%A2%A3%A4%A5%A6%A7%A8%A9%AA%B2%B3%B4%B5%B6%B7%B8%B9%BA%C2%C3%C4%C5%C6%C7%C8%C9%CA%D2%D3%D4%D5%D6%D7%D8%D9%DA%E2%E3%E4%E5%E6%E7%E8%E9%EA%F2%F3%F4%F5%F6%F7%F8%F9%FA%FF%DA%00%0C%03%01%00%02%11%03%11%00%3F%00%EE%7C9%A0Xj%1E%15%B3%B9%1A%5Cw%17%92%EDS!%8D%0E%E2T%13%92y%CEsX%BE4%D0%A3%D2%7C%3Fyz%FADV%A5co.e%89T%A4%80%1C%10G%20%E4T~%0E%F8%91%A4%F8s%C3%F6%96%3A%98%BA%17%16%F7%3B%DDV1%C2%85%DB%8EH%E75%CA%EB%3F%10%AC%F5O%09%F8%8FG%89n%E5%BE%D4%B5%0F6%D4l%04l%2C8%3C%E78%ED%CD%7D%24i%D7%85Gu%A5%CF%9C%A3%0A.%09%F5%B1%FF%D9");

imageLinkedInElem.setAttribute('style', 'vertical-align: top;');

var spanNarrowElem = document.createElement('span');
spanNarrowElem.innerHTML = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';

//common xpath to list of object in Leads, Accounts, Contacts and Opportunities tab
var xpath = "/html/body/div[2]/table[@id='bodyTable']/tbody/tr/td[@id='bodyCell']/div[3]/div[1]/div/div[2]/table/tbody/tr";

var rowElems = document.evaluate(xpath, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);

// loop thru each object skip the heading and construct name and add logo and link
                   
for (var i = 1; i < rowElems.snapshotLength; i++) { // iterate thru each node
    rowElem = rowElems.snapshotItem(i);
    nameElem = rowElem.getElementsByTagName('th')[0];
    nameText = nameElem.textContent;
    nameSplit = nameText.split(', ');
    if (nameSplit[1] == null) {nameSplit[1] = ''; }
    nameForURL = '%22' + nameSplit[1] + ' ' + nameSplit[0] + '%22';
    nameForURL = nameForURL.replace(/\s/g, "+");
    var linkLinkedInElem = document.createElement('a');
    linkLinkedInElem.setAttribute('href', 'http://www.linkedin.com/search?search=&sortCriteria=4&keywords=' + nameForURL);
    linkLinkedInElem.setAttribute('target', '_blank');
    linkLinkedInElem.setAttribute('title', 'Search LinkedIn');
    
    nameElem.appendChild(spanNarrowElem.cloneNode(true)); 
    linkLinkedInElem.appendChild(imageLinkedInElem.cloneNode(true));
    nameElem.appendChild(linkLinkedInElem);   
}    


/*

Spock

http://www.spock.com/q/%22Jane-Smith%22
data:image/x-icon,%00%00%01%00%01%00%10%10%00%00%01%00%08%00h%05%00%00%16%00%00%00(%00%00%00%10%00%00%00%20%00%00%00%01%00%08%00%00%00%00%00%00%00%00%00%13%0B%00%00%13%0B%00%00%00%01%00%00%00%00%00%00%C4%88%00%00%CF%8F%00%00%C7%8D%00%00%C6%8A%00%00%C5%8B%00%00%C7%8D%02%00%C8%90%03%00%C8%90%05%00%CE%96%09%00%C7%8E%00%00%C9%92%01%00%C7%8F%03%00%C9%94%05%00%CA%94%06%00%CA%95%07%00%C9%93%08%00%C8%94%09%00%CB%96%0B%00%CA%96%0B%00%CA%95%0C%00%C9%97%0C%00%CF%99%0E%00%CA%96%10%00%CA%97%11%00%CC%9A%16%00%CC%9A%19%00%CB%99%1A%00%CE%9C%1B%00%CF%A1(%00%CF%A3%2B%00%CF%A4.%00%D0%A40%00%D1%A79%00%D1%A8%3A%00%D3%AB%3C%00%D2%AA%40%00%D1%AAC%00%D1%ABC%00%D3%ACE%00%D3%AEF%00%D4%AFO%00%D5%B3R%00%D7%B8_%00%D7%B9b%00%D9%BBn%00%D9%BDp%00%D9%C0w%00%DD%C8%8D%00%E0%CF%A4%00%DD%C8%8B%00%E1%CF%9C%00%E0%D0%A3%00%DF%CB%7C%00%DF%CC%7D%00%E1%CE%81%00%E0%CE%80%00%E0%CE%86%00%E0%CF%8D%00%E3%D6%9F%00%E3%D6%A1%00%E9%E7%DE%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D42%3D%3D%3D%3D%3D%3D29%3D%3D%3D%3D%3D%3D8%1B(%3D%3D%3D%3D0%225%3D%3D%3D%3D%3D%3D%3D!%00%1D%3D%3D%2F%05%1C%3D%3D%3D%3D%3D%3D%3D%3D%3D'%02%19)%0B%1A%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D-%0A%09%1F%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%11%0C%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3A*%24!%0E%0D%20%25%2B%3B%3D%3D%3D%3D%3D%3D7%1E%10%14%16%17%13%0F%1F6%3D%3D%3D%3D%3D%3D%3C%3D.%26%3D%3D%26.%3D%3D%3D%3D%3D%3D%3D%3D%3D2%03%3D%3D%3D%3D%022%3D%3D%3D%3D%3D%3D%3D%3D%23%06%3D%3D%3D%3D%13%26%3D%3D%3D%3D%3D%3D%3D%3D2%041%3D%3D3%022%3D%3D%3D%3D%3D%3D%3D%3D%3D%07%12%2C.%18%07%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%15%01%01%08%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%FF%FF%00%00%E7%E7%00%00%E3%C7%00%00%F1%8F%00%00%F8%1F%00%00%FC%3F%00%00%FE%7F%00%00%E0%07%00%00%E0%07%00%00%E9%9F%00%00%F3%CF%00%00%F3%CF%00%00%F1%8F%00%00%F8%1F%00%00%FC%3F%00%00%FF%FF%00%00


http://www.zoominfo.com/search/PersonQuery.aspx?searchSource=basic_ssb&singleSearchBox=%22Jane+Smith%22&x=0&y=0

(Your browser should have redirected you automatically. If you see this it probably has a bug.)data:image/gif,GIF89a%22%00%22%00%F7%00%00%00c%9C1c%9C1c%CE1%9C%CEc%9C%CE%9C%9C%CE%9C%CE%CE%A5%CE%F7%CE%CE%CE%CE%EF%FF%D6%D6%D6%DE%DE%DE%E7%E7%D6%E7%E7%E7%EF%D6%C6%EF%EF%EF%F7%F7%F7%FF%9C%00%FF%9C1%FF%9Cc%FF%CEc%FF%CE%9C%FF%FF%F7%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%FF%2C%00%00%00%00%22%00%22%00%00%08%E1%00%2F%08%1CH%B0%A0%C1%83%08%13*%5C%C8%B0%A1%C3%87%10%23J%9CH%B1%A2%C5%8B%18%2BZ%A0P!%E3%C0%06%03%0CX%900%E1%02%01%02%19!%04%08pA%02%85%07%00%06%5C%3C%10%60%01%CC%03%1C%0B%04%B0%40%B3%01%C5%03%00%00%1C8%40%80%A3%80%05%05%00%D4%9C%08%E1%82%05%03%01%0A%14%60%80%C0%00%81%00%07%2C%40h%1A1%40L%03D%1FTp%90%80%00%D1%01B-D%3C%C9%F6%80%83%08%12%20Xm%ABV%E2%02%AB%06%20p%84p%F2%40%83%BA%11%81%02%10%40%D4%40%82%B2%06%0C%04%15%F0%60%A2Y%0B%04B%F6%05%90%D7*%E0%88%0D%04%00x%20%19%2C%00%02%97%25%12%10%DA%00%40%D9%9D%A3%15%5C%5C%00y3%D0%03%10%12x%A4%09%81%A6%EA%D0%16%D5%E2%F6%C8%BB%B7%EF%DF%C0%83%0B%1FN%7Ca%40%00%00%3B

*/

