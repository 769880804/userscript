// ==UserScript==
// @name            Posting Tools 2.1
// @author          Duardo// @ contributor          Luke Bonaccorsi AKA SpeedySurfer
// @contributor		CAVX
// @contributor		Sprool
// @contributor		paulmarv
// @namespace       http://gears.speedysurfer.co.uk
// @description     This script adds a number of buttons below the text entry box which insert the text formatting.  NEW: deleted everything except for the text formatting.  The quote preview cancel submit group is apart of this group. h3shot removed.
// @license         Creative Commons Attribution License
//  @version	        2.0
// @include         http://*bungie.net/Forums/createpost.aspx*
// @include			http://*bungie.net/fanclub/*/Forums/createpost.aspx*
// @include			http://*bungie.net/account/profile.aspx?uid=*&page=PostMsg
// @include			http://*bungie.net/Account/Profile.aspx?msgID=*&act=reply*
// @include			http://*bungie.net/Account/Profile.aspx?postID=*&act=msg
// @released        2008-08-12
// @compatible      Greasemonkey
// ==/UserScript==
 
/* 
 * This file is a Greasemonkey user script. To install it, you need 
 * the Firefox plugin "Greasemonkey" (URL: http://greasemonkey.mozdev.org/)
 * After you installed the extension, restart Firefox and revisit 
 * this script. Now you will see a new menu item "Install User Script"
 * in your tools menu.
 * 
 * To uninstall this script, go to your "Tools" menu and select 
 * "Manage User Scripts", then select this script from the list
 * and click uninstall :-)
 *
 * Creative Commons Attribution License (--> or Public Domain)
 * http://creativecommons.org/licenses/by/2.5/
*/
function addFormatting()
{
var divArray = document.getElementsByTagName("div");
for (var j = 0; j<divArray.length; j++)
{
if(divArray[j].getAttribute("class") == "list-c" || divArray[j].getAttribute("class") == "list-b" )
{
if(divArray[j].getAttribute("class") == "list-c")
{
	msgBox="ctl00_mainContent_postForm_skin_body";
}else{
	msgBox="ctl00_mainContent_messageForm_skin_body";
}
divArray[j].innerHTML = divArray[j].innerHTML.replace(/<div class=.formgroup3.>/i,"<div class=\"formgroup1\"><div style=\"position:relative; z-index: 5; width: 530px;\"><input type=\"button\" id=\"italbutton\" onClick=\"thisButton=document.getElementById('italbutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''}; textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[i]'){thisButton.value='[/i]'}else{thisButton.value='[i]'}};\" value=\"[i]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('italbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('italbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\" />&nbsp;&nbsp;\
																																																																																																																																																																																																																																															<input type=\"button\" id=\"boldbutton\" onClick=\"thisButton=document.getElementById('boldbutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''};textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[b]'){thisButton.value='[/b]'}else{thisButton.value='[b]'}};\" value=\"[b]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('boldbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('boldbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\"/>&nbsp;&nbsp;\
																																																																																																																																																																																																																																															<input type=\"button\" id=\"underbutton\" onClick=\"thisButton=document.getElementById('underbutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''};textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[u]'){thisButton.value='[/u]'}else{thisButton.value='[u]'}};\" value=\"[u]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('underbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a';thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('underbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\"/>&nbsp;&nbsp;\
																																																																																																																																																																																																																																																<input type=\"button\" id=\"linkbutton\" onClick=\"thisButton=document.getElementById('linkbutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''};textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[url]'){thisButton.value='[/url]'}else{thisButton.value='[url]'}};\" value=\"[url]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('linkbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('linkbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\"/>&nbsp;&nbsp;\
																																																																																																																																																																																																																																																<input type=\"button\" id=\"emailbutton\" onClick=\"thisButton=document.getElementById('emailbutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''};textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[email]'){thisButton.value='[/email]'}else{thisButton.value='[email]'}};\" value=\"[email]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('emailbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('emailbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\"/>&nbsp;&nbsp;\
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																<input type=\"button\" id=\"quotebutton\" onClick=\"thisButton=document.getElementById('quotebutton');var textbox=document.getElementById('"+msgBox+"');var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; if(endPos-startPos>0){thisButton.value=thisButton.value.replace('/','');extratext=textbox.value.substring(startPos, endPos)+thisButton.value.replace('[','[/')}else{extratext=''};textbox.value = textbox.value.substring(0, startPos)+ thisButton.value +extratext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=endPos+thisButton.value.length; textbox.setSelectionRange(caretPos, caretPos); if(extratext==''){if(thisButton.value=='[quote]'){thisButton.value='[/quote]'}else{thisButton.value='[quote]'}};\" value=\"[quote]\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('quotebutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('quotebutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\" />&nbsp;&nbsp;\
																																																																																																																																																																																																																																																<input type=\"button\" id=\"namedlinkbutton\" onClick=\"url = window.prompt('Named Link - Please enter the address you wish to link to','http://');text = window.prompt('Named Link - Please enter the text you wish to be displayed',''); if(url!='http://' && text!=''){var textbox=document.getElementById('"+msgBox+"'); inserttext= '[url='+url+']'+text+'[/url]'; var startPos = textbox.selectionStart;var endPos = textbox.selectionEnd; textbox.value = textbox.value.substring(0, startPos)+inserttext+textbox.value.substring(endPos, textbox.value.length); document.getElementById('"+msgBox+"').focus(); caretPos=startPos+inserttext.length; textbox.setSelectionRange(caretPos, caretPos);}\" value=\"Named URL\" style=\"background:#1b1d1f; color:#a3a3a4; border-color:#5c5d5f; border-width:1px; border-style:solid;\" onmouseover=\"thisButton=document.getElementById('namedlinkbutton'); thisButton.style.borderColor='#56AACD'; thisButton.style['background']='#17668a'; thisButton.style['color']='#FFFFFF'\" onmouseout=\"thisButton=document.getElementById('namedlinkbutton'); thisButton.style['background']='#1b1d1f'; thisButton.style.borderColor='#5c5d5f'; thisButton.style['color']='#a3a3a4'\" />\
																																																																																																																																																																																																																																																</div><br><div class=\"formgroup3\">");
}
}
}
addFormatting();

