// ==UserScript==
// @name         delicious.com encrypted bookmarks
// @description  delicious.com (previously del.icio.us) encrypted bookmarks creates bookmarks which are private even from delicious by encrypting them using blowfish encryption
// @namespace    http://loonyone.livejournal.com
// @include      http://delicious.com/*
// @creator      Manpreet Singh |junkblocker<at>yahoo<dot>com|
// @source       http://userscripts.org/scripts/show/7333
// @identifier   http://userscripts.org/scripts/source/7333.user.js
// @version      0.8
// @date         2008-07-31
// ==/UserScript==

// Changelog
// =========
// Version 0.8 - Updated for del.icio.us to delicious.com redesign
// Version 0.7 - Fixed partially broken auto update.
//               Don't increase the install count on userscripts.org while checking for updates
// Version 0.6 - Added auto update without requiring an external script
// Version 0.5 - Add "private://" while clicking Encrypt to have it avoid a default "http://" prefix
//               Trailing null trim fix
// Version 0.4 - Updated contact info
// Version 0.3 - Fixed auto update
// Version 0.2 - Various speed optimizations
//               Automatic update checks if available using http://userscripts.org/people/336 script
//               Remove appended nulls from the URLs
// Version 0.1 - First release

/*
 * Contains code leeched and modified from
 *
 * 1) Blowfish encryption modle 2.0 - http://dren.ch/js_blowfish/ - by Daniel Rench {
 * Based on existing code:
 * Copyright (c) 2003 by Andre Mueller.
 * Init of blowfish constants with a function (init/backup errors)
 * Copyright (c) 2003 by Rainer Wollmann
 * This Object is open source. You can redistribute it and/or modify
 * it under the terms of the Universal General Public License (UGPL).
 *  http://www.ugpl.de/
 *  }
 *  2) Bookmarklets from the same site based on the code above
 *
 * TODO : Make it safer for URLs/content that are too long as they can get truncated on encryption
 * TODO : Add eye candy icons instead of Encrypt / Decrypt labels
 * TODO : Maybe have a single decrypt all icon someplace
 */

(function() {
  function autoUpdateFromUserscriptsDotOrg(SCRIPT) {
    try {
      if (!GM_getValue) return;
      // avoid a flood of dialogs e.g. when opening a browser with multiple tabs set to homepage and a script with * includes
      var DoS_PREVENTION_TIME = 2 * 60 * 1000;
      var isSomeoneChecking = GM_getValue('CHECKING', null);
      var now = new Date().getTime();
      GM_setValue('CHECKING', now.toString());
      if (isSomeoneChecking && (now - isSomeoneChecking) < DoS_PREVENTION_TIME) return;
      var lastChecked = GM_getValue('LAST_CHECKED', null);

      var ONE_DAY = 24 * 60 * 60 * 1000;
      if (lastChecked && (now - lastChecked) < ONE_DAY) return;
      GM_xmlhttpRequest({
        method: 'GET',
        url: SCRIPT.url + '?source', // don't increase the 'installed' count just for checking
        onload: function(result) {
          if (!result.responseText.match(/@version\s+([\d.]+)/)) return;
          var theOtherVersion = RegExp.$1;
          if (theOtherVersion == SCRIPT.version) return;
          if (window.confirm('A new version ' + theOtherVersion + ' of greasemonkey script "' + SCRIPT.name + '" is available.\nYour installed version is ' + SCRIPT.version + ' .\n\nUpdate now?\n')) {
            GM_openInTab(SCRIPT.url);
          }
        }
      });
      GM_setValue('LAST_CHECKED', now.toString());
    } catch (ex) {
    }
  }
  autoUpdateFromUserscriptsDotOrg({
    name: 'Del.icio.us encrypted bookmarks',
    url: 'http://userscripts.org/scripts/source/7333.user.js',
    version: "0.8",
  });

  var head = document.getElementsByTagName('head')[0];
  var encReg = /^((http:\/\/(del\.icio\.us|delicious\.com))?\/doc\/dangerous[#?])?private:\/\/([0-9a-fA-F]+).?$/;

  var entry = document.getElementsByTagName('h4');
  for(var i=0, len=entry.length; i < len; i++) {
    var link = entry[i].getElementsByTagName('a')[0].href;
    if (link && link.match(encReg)) {
      var p = document.createElement('p');
      p.innerHTML = '<a href="javascript: eGet();">view unencrypted</a>';
      entry[i].parentNode.insertBefore(p, entry[i].parentNode.getElementsByTagName('div')[0]);
    }
  }

  var blow = 'function%20B(k){if(k.length%3D%3D0){throw%20%220%20length%20key%22%3B}%0Athis.es%3Dfunction(t){var%20r%3D%27%27%3Bfor(var%20i%3D0%2Cl%3Dt.length%3Bi%3Cl%3Bi%2B%2B){var%20c%3Dt.charCodeAt(i)%3Bvar%20t1%3DMath.floor(c/16)%3Bvar%20t2%3Dc%2516%3Bif(t1%3C10){t1%2B%3D48%3B}%0Aelse{t1%2B%3D55%3B}%0Aif(t2%3C10){t2%2B%3D48%3B}%0Aelse{t2%2B%3D55%3B}%0Ar%2B%3DString.fromCharCode(t1)%2BString.fromCharCode(t2)%3B}%0Areturn%20r%3B}%3Bthis.w0%3Dfunction(w){return%20Math.floor(Math.floor(Math.floor(w/256)/256)/256)%25256%3B}%3Bthis.w1%3Dfunction(w){return%20Math.floor(Math.floor(w/256)/256)%25256%3B}%3Bthis.w2%3Dfunction(w){return%20Math.floor(w/256)%25256%3B}%3Bthis.w3%3Dfunction(w){return%20w%25256%3B}%3Bthis.xr%3Dfunction(wa%2Cwb){var%20r%3Dwa%5Ewb%3Bif(r%3C0){r%3D0xffffffff%2B1%2Br%3B}return%20r%3B}%3Bthis.ky%3D(k.length%3E56)%3Fk.substr(0%2C56):k%3Bvar%20j%3D0%3Bfor(var%20i%3D0%3Bi%3C18%3B%2B%2Bi){var%20d%3D((this.ky.charCodeAt(j%25this.ky.length)%2A256%2Bthis.ky.charCodeAt((j%2B1)%25this.ky.length))%2A256%2Bthis.ky.charCodeAt((j%2B2)%25this.ky.length))%2A256%2Bthis.ky.charCodeAt((j%2B3)%25this.ky.length)%3Bthis.bf_P[i]%3Dthis.xr(this.bf_P[i]%2Cd)%3Bj%3D(j%2B4)%25this.ky.length%3B}%0Athis.ky%3Dthis.es(this.ky)%3Bthis.xlp%3D0x00000000%3Bthis.xrp%3D0x00000000%3Bfor(i%3D0%3Bi%3C18%3Bi%2B%3D2){this.ecf()%3Bthis.bf_P[i]%3Dthis.xlp%3Bthis.bf_P[i%2B1]%3Dthis.xrp%3B}%0Afor(j%3D0%3Bj%3C256%3Bj%2B%3D2){this.ecf()%3Bthis.bf_S0[j]%3Dthis.xlp%3Bthis.bf_S0[j%2B1]%3Dthis.xrp%3B}%0Afor(j%3D0%3Bj%3C256%3Bj%2B%3D2){this.ecf()%3Bthis.bf_S1[j]%3Dthis.xlp%3Bthis.bf_S1[j%2B1]%3Dthis.xrp%3B}%0Afor(j%3D0%3Bj%3C256%3Bj%2B%3D2){this.ecf()%3Bthis.bf_S2[j]%3Dthis.xlp%3Bthis.bf_S2[j%2B1]%3Dthis.xrp%3B}%0Afor(j%3D0%3Bj%3C256%3Bj%2B%3D2){this.ecf()%3Bthis.bf_S3[j]%3Dthis.xlp%3Bthis.bf_S3[j%2B1]%3Dthis.xrp%3B}%0Athis.ue%3Dfunction(t){var%20r%3D%27%27%3Bfor(i%3D0%3Bi%3Ct.length%3Bi%2B%2B){var%20t1%3Dt.charCodeAt(i%2B%2B)%3Bvar%20t2%3Dt.charCodeAt(i)%3Bif(t1%3C58){t1-%3D48%3B}%0Aelse{if(t1%3E96){t1-%3D87%3B}%0Aelse{t1-%3D55%3B}}%0Aif(t2%3C58){t2-%3D48%3B}%0Aelse{if(t2%3E96){t2-%3D87%3B}%0Aelse{t2-%3D55%3B}}%0Ar%2B%3DString.fromCharCode(t1%2A16%2Bt2)%3B}%0Areturn%20r%3B}%3B}%0AB.prototype.bf_P%3D[0x243f6a88%2C0x85a308d3%2C0x13198a2e%2C0x03707344%2C0xa4093822%2C0x299f31d0%2C0x082efa98%2C0xec4e6c89%2C0x452821e6%2C0x38d01377%2C0xbe5466cf%2C0x34e90c6c%2C0xc0ac29b7%2C0xc97c50dd%2C0x3f84d5b5%2C0xb5470917%2C0x9216d5d9%2C0x8979fb1b]%3BB.prototype.bf_S0%3D[0xd1310ba6%2C0x98dfb5ac%2C0x2ffd72db%2C0xd01adfb7%2C0xb8e1afed%2C0x6a267e96%2C0xba7c9045%2C0xf12c7f99%2C0x24a19947%2C0xb3916cf7%2C0x0801f2e2%2C0x858efc16%2C0x636920d8%2C0x71574e69%2C0xa458fea3%2C0xf4933d7e%2C0x0d95748f%2C0x728eb658%2C0x718bcd58%2C0x82154aee%2C0x7b54a41d%2C0xc25a59b5%2C0x9c30d539%2C0x2af26013%2C0xc5d1b023%2C0x286085f0%2C0xca417918%2C0xb8db38ef%2C0x8e79dcb0%2C0x603a180e%2C0x6c9e0e8b%2C0xb01e8a3e%2C0xd71577c1%2C0xbd314b27%2C0x78af2fda%2C0x55605c60%2C0xe65525f3%2C0xaa55ab94%2C0x57489862%2C0x63e81440%2C0x55ca396a%2C0x2aab10b6%2C0xb4cc5c34%2C0x1141e8ce%2C0xa15486af%2C0x7c72e993%2C0xb3ee1411%2C0x636fbc2a%2C0x2ba9c55d%2C0x741831f6%2C0xce5c3e16%2C0x9b87931e%2C0xafd6ba33%2C0x6c24cf5c%2C0x7a325381%2C0x28958677%2C0x3b8f4898%2C0x6b4bb9af%2C0xc4bfe81b%2C0x66282193%2C0x61d809cc%2C0xfb21a991%2C0x487cac60%2C0x5dec8032%2C0xef845d5d%2C0xe98575b1%2C0xdc262302%2C0xeb651b88%2C0x23893e81%2C0xd396acc5%2C0x0f6d6ff3%2C0x83f44239%2C0x2e0b4482%2C0xa4842004%2C0x69c8f04a%2C0x9e1f9b5e%2C0x21c66842%2C0xf6e96c9a%2C0x670c9c61%2C0xabd388f0%2C0x6a51a0d2%2C0xd8542f68%2C0x960fa728%2C0xab5133a3%2C0x6eef0b6c%2C0x137a3be4%2C0xba3bf050%2C0x7efb2a98%2C0xa1f1651d%2C0x39af0176%2C0x66ca593e%2C0x82430e88%2C0x8cee8619%2C0x456f9fb4%2C0x7d84a5c3%2C0x3b8b5ebe%2C0xe06f75d8%2C0x85c12073%2C0x401a449f%2C0x56c16aa6%2C0x4ed3aa62%2C0x363f7706%2C0x1bfedf72%2C0x429b023d%2C0x37d0d724%2C0xd00a1248%2C0xdb0fead3%2C0x49f1c09b%2C0x075372c9%2C0x80991b7b%2C0x25d479d8%2C0xf6e8def7%2C0xe3fe501a%2C0xb6794c3b%2C0x976ce0bd%2C0x04c006ba%2C0xc1a94fb6%2C0x409f60c4%2C0x5e5c9ec2%2C0x196a2463%2C0x68fb6faf%2C0x3e6c53b5%2C0x1339b2eb%2C0x3b52ec6f%2C0x6dfc511f%2C0x9b30952c%2C0xcc814544%2C0xaf5ebd09%2C0xbee3d004%2C0xde334afd%2C0x660f2807%2C0x192e4bb3%2C0xc0cba857%2C0x45c8740f%2C0xd20b5f39%2C0xb9d3fbdb%2C0x5579c0bd%2C0x1a60320a%2C0xd6a100c6%2C0x402c7279%2C0x679f25fe%2C0xfb1fa3cc%2C0x8ea5e9f8%2C0xdb3222f8%2C0x3c7516df%2C0xfd616b15%2C0x2f501ec8%2C0xad0552ab%2C0x323db5fa%2C0xfd238760%2C0x53317b48%2C0x3e00df82%2C0x9e5c57bb%2C0xca6f8ca0%2C0x1a87562e%2C0xdf1769db%2C0xd542a8f6%2C0x287effc3%2C0xac6732c6%2C0x8c4f5573%2C0x695b27b0%2C0xbbca58c8%2C0xe1ffa35d%2C0xb8f011a0%2C0x10fa3d98%2C0xfd2183b8%2C0x4afcb56c%2C0x2dd1d35b%2C0x9a53e479%2C0xb6f84565%2C0xd28e49bc%2C0x4bfb9790%2C0xe1ddf2da%2C0xa4cb7e33%2C0x62fb1341%2C0xcee4c6e8%2C0xef20cada%2C0x36774c01%2C0xd07e9efe%2C0x2bf11fb4%2C0x95dbda4d%2C0xae909198%2C0xeaad8e71%2C0x6b93d5a0%2C0xd08ed1d0%2C0xafc725e0%2C0x8e3c5b2f%2C0x8e7594b7%2C0x8ff6e2fb%2C0xf2122b64%2C0x8888b812%2C0x900df01c%2C0x4fad5ea0%2C0x688fc31c%2C0xd1cff191%2C0xb3a8c1ad%2C0x2f2f2218%2C0xbe0e1777%2C0xea752dfe%2C0x8b021fa1%2C0xe5a0cc0f%2C0xb56f74e8%2C0x18acf3d6%2C0xce89e299%2C0xb4a84fe0%2C0xfd13e0b7%2C0x7cc43b81%2C0xd2ada8d9%2C0x165fa266%2C0x80957705%2C0x93cc7314%2C0x211a1477%2C0xe6ad2065%2C0x77b5fa86%2C0xc75442f5%2C0xfb9d35cf%2C0xebcdaf0c%2C0x7b3e89a0%2C0xd6411bd3%2C0xae1e7e49%2C0x00250e2d%2C0x2071b35e%2C0x226800bb%2C0x57b8e0af%2C0x2464369b%2C0xf009b91e%2C0x5563911d%2C0x59dfa6aa%2C0x78c14389%2C0xd95a537f%2C0x207d5ba2%2C0x02e5b9c5%2C0x83260376%2C0x6295cfa9%2C0x11c81968%2C0x4e734a41%2C0xb3472dca%2C0x7b14a94a%2C0x1b510052%2C0x9a532915%2C0xd60f573f%2C0xbc9bc6e4%2C0x2b60a476%2C0x81e67400%2C0x08ba6fb5%2C0x571be91f%2C0xf296ec6b%2C0x2a0dd915%2C0xb6636521%2C0xe7b9f9b6%2C0xff34052e%2C0xc5855664%2C0x53b02d5d%2C0xa99f8fa1%2C0x08ba4799%2C0x6e85076a]%3BB.prototype.bf_S1%3D[0x4b7a70e9%2C0xb5b32944%2C0xdb75092e%2C0xc4192623%2C0xad6ea6b0%2C0x49a7df7d%2C0x9cee60b8%2C0x8fedb266%2C0xecaa8c71%2C0x699a17ff%2C0x5664526c%2C0xc2b19ee1%2C0x193602a5%2C0x75094c29%2C0xa0591340%2C0xe4183a3e%2C0x3f54989a%2C0x5b429d65%2C0x6b8fe4d6%2C0x99f73fd6%2C0xa1d29c07%2C0xefe830f5%2C0x4d2d38e6%2C0xf0255dc1%2C0x4cdd2086%2C0x8470eb26%2C0x6382e9c6%2C0x021ecc5e%2C0x09686b3f%2C0x3ebaefc9%2C0x3c971814%2C0x6b6a70a1%2C0x687f3584%2C0x52a0e286%2C0xb79c5305%2C0xaa500737%2C0x3e07841c%2C0x7fdeae5c%2C0x8e7d44ec%2C0x5716f2b8%2C0xb03ada37%2C0xf0500c0d%2C0xf01c1f04%2C0x0200b3ff%2C0xae0cf51a%2C0x3cb574b2%2C0x25837a58%2C0xdc0921bd%2C0xd19113f9%2C0x7ca92ff6%2C0x94324773%2C0x22f54701%2C0x3ae5e581%2C0x37c2dadc%2C0xc8b57634%2C0x9af3dda7%2C0xa9446146%2C0x0fd0030e%2C0xecc8c73e%2C0xa4751e41%2C0xe238cd99%2C0x3bea0e2f%2C0x3280bba1%2C0x183eb331%2C0x4e548b38%2C0x4f6db908%2C0x6f420d03%2C0xf60a04bf%2C0x2cb81290%2C0x24977c79%2C0x5679b072%2C0xbcaf89af%2C0xde9a771f%2C0xd9930810%2C0xb38bae12%2C0xdccf3f2e%2C0x5512721f%2C0x2e6b7124%2C0x501adde6%2C0x9f84cd87%2C0x7a584718%2C0x7408da17%2C0xbc9f9abc%2C0xe94b7d8c%2C0xec7aec3a%2C0xdb851dfa%2C0x63094366%2C0xc464c3d2%2C0xef1c1847%2C0x3215d908%2C0xdd433b37%2C0x24c2ba16%2C0x12a14d43%2C0x2a65c451%2C0x50940002%2C0x133ae4dd%2C0x71dff89e%2C0x10314e55%2C0x81ac77d6%2C0x5f11199b%2C0x043556f1%2C0xd7a3c76b%2C0x3c11183b%2C0x5924a509%2C0xf28fe6ed%2C0x97f1fbfa%2C0x9ebabf2c%2C0x1e153c6e%2C0x86e34570%2C0xeae96fb1%2C0x860e5e0a%2C0x5a3e2ab3%2C0x771fe71c%2C0x4e3d06fa%2C0x2965dcb9%2C0x99e71d0f%2C0x803e89d6%2C0x5266c825%2C0x2e4cc978%2C0x9c10b36a%2C0xc6150eba%2C0x94e2ea78%2C0xa5fc3c53%2C0x1e0a2df4%2C0xf2f74ea7%2C0x361d2b3d%2C0x1939260f%2C0x19c27960%2C0x5223a708%2C0xf71312b6%2C0xebadfe6e%2C0xeac31f66%2C0xe3bc4595%2C0xa67bc883%2C0xb17f37d1%2C0x018cff28%2C0xc332ddef%2C0xbe6c5aa5%2C0x65582185%2C0x68ab9802%2C0xeecea50f%2C0xdb2f953b%2C0x2aef7dad%2C0x5b6e2f84%2C0x1521b628%2C0x29076170%2C0xecdd4775%2C0x619f1510%2C0x13cca830%2C0xeb61bd96%2C0x0334fe1e%2C0xaa0363cf%2C0xb5735c90%2C0x4c70a239%2C0xd59e9e0b%2C0xcbaade14%2C0xeecc86bc%2C0x60622ca7%2C0x9cab5cab%2C0xb2f3846e%2C0x648b1eaf%2C0x19bdf0ca%2C0xa02369b9%2C0x655abb50%2C0x40685a32%2C0x3c2ab4b3%2C0x319ee9d5%2C0xc021b8f7%2C0x9b540b19%2C0x875fa099%2C0x95f7997e%2C0x623d7da8%2C0xf837889a%2C0x97e32d77%2C0x11ed935f%2C0x16681281%2C0x0e358829%2C0xc7e61fd6%2C0x96dedfa1%2C0x7858ba99%2C0x57f584a5%2C0x1b227263%2C0x9b83c3ff%2C0x1ac24696%2C0xcdb30aeb%2C0x532e3054%2C0x8fd948e4%2C0x6dbc3128%2C0x58ebf2ef%2C0x34c6ffea%2C0xfe28ed61%2C0xee7c3c73%2C0x5d4a14d9%2C0xe864b7e3%2C0x42105d14%2C0x203e13e0%2C0x45eee2b6%2C0xa3aaabea%2C0xdb6c4f15%2C0xfacb4fd0%2C0xc742f442%2C0xef6abbb5%2C0x654f3b1d%2C0x41cd2105%2C0xd81e799e%2C0x86854dc7%2C0xe44b476a%2C0x3d816250%2C0xcf62a1f2%2C0x5b8d2646%2C0xfc8883a0%2C0xc1c7b6a3%2C0x7f1524c3%2C0x69cb7492%2C0x47848a0b%2C0x5692b285%2C0x095bbf00%2C0xad19489d%2C0x1462b174%2C0x23820e00%2C0x58428d2a%2C0x0c55f5ea%2C0x1dadf43e%2C0x233f7061%2C0x3372f092%2C0x8d937e41%2C0xd65fecf1%2C0x6c223bdb%2C0x7cde3759%2C0xcbee7460%2C0x4085f2a7%2C0xce77326e%2C0xa6078084%2C0x19f8509e%2C0xe8efd855%2C0x61d99735%2C0xa969a7aa%2C0xc50c06c2%2C0x5a04abfc%2C0x800bcadc%2C0x9e447a2e%2C0xc3453484%2C0xfdd56705%2C0x0e1e9ec9%2C0xdb73dbd3%2C0x105588cd%2C0x675fda79%2C0xe3674340%2C0xc5c43465%2C0x713e38d8%2C0x3d28f89e%2C0xf16dff20%2C0x153e21e7%2C0x8fb03d4a%2C0xe6e39f2b%2C0xdb83adf7]%3BB.prototype.bf_S2%3D[0xe93d5a68%2C0x948140f7%2C0xf64c261c%2C0x94692934%2C0x411520f7%2C0x7602d4f7%2C0xbcf46b2e%2C0xd4a20068%2C0xd4082471%2C0x3320f46a%2C0x43b7d4b7%2C0x500061af%2C0x1e39f62e%2C0x97244546%2C0x14214f74%2C0xbf8b8840%2C0x4d95fc1d%2C0x96b591af%2C0x70f4ddd3%2C0x66a02f45%2C0xbfbc09ec%2C0x03bd9785%2C0x7fac6dd0%2C0x31cb8504%2C0x96eb27b3%2C0x55fd3941%2C0xda2547e6%2C0xabca0a9a%2C0x28507825%2C0x530429f4%2C0x0a2c86da%2C0xe9b66dfb%2C0x68dc1462%2C0xd7486900%2C0x680ec0a4%2C0x27a18dee%2C0x4f3ffea2%2C0xe887ad8c%2C0xb58ce006%2C0x7af4d6b6%2C0xaace1e7c%2C0xd3375fec%2C0xce78a399%2C0x406b2a42%2C0x20fe9e35%2C0xd9f385b9%2C0xee39d7ab%2C0x3b124e8b%2C0x1dc9faf7%2C0x4b6d1856%2C0x26a36631%2C0xeae397b2%2C0x3a6efa74%2C0xdd5b4332%2C0x6841e7f7%2C0xca7820fb%2C0xfb0af54e%2C0xd8feb397%2C0x454056ac%2C0xba489527%2C0x55533a3a%2C0x20838d87%2C0xfe6ba9b7%2C0xd096954b%2C0x55a867bc%2C0xa1159a58%2C0xcca92963%2C0x99e1db33%2C0xa62a4a56%2C0x3f3125f9%2C0x5ef47e1c%2C0x9029317c%2C0xfdf8e802%2C0x04272f70%2C0x80bb155c%2C0x05282ce3%2C0x95c11548%2C0xe4c66d22%2C0x48c1133f%2C0xc70f86dc%2C0x07f9c9ee%2C0x41041f0f%2C0x404779a4%2C0x5d886e17%2C0x325f51eb%2C0xd59bc0d1%2C0xf2bcc18f%2C0x41113564%2C0x257b7834%2C0x602a9c60%2C0xdff8e8a3%2C0x1f636c1b%2C0x0e12b4c2%2C0x02e1329e%2C0xaf664fd1%2C0xcad18115%2C0x6b2395e0%2C0x333e92e1%2C0x3b240b62%2C0xeebeb922%2C0x85b2a20e%2C0xe6ba0d99%2C0xde720c8c%2C0x2da2f728%2C0xd0127845%2C0x95b794fd%2C0x647d0862%2C0xe7ccf5f0%2C0x5449a36f%2C0x877d48fa%2C0xc39dfd27%2C0xf33e8d1e%2C0x0a476341%2C0x992eff74%2C0x3a6f6eab%2C0xf4f8fd37%2C0xa812dc60%2C0xa1ebddf8%2C0x991be14c%2C0xdb6e6b0d%2C0xc67b5510%2C0x6d672c37%2C0x2765d43b%2C0xdcd0e804%2C0xf1290dc7%2C0xcc00ffa3%2C0xb5390f92%2C0x690fed0b%2C0x667b9ffb%2C0xcedb7d9c%2C0xa091cf0b%2C0xd9155ea3%2C0xbb132f88%2C0x515bad24%2C0x7b9479bf%2C0x763bd6eb%2C0x37392eb3%2C0xcc115979%2C0x8026e297%2C0xf42e312d%2C0x6842ada7%2C0xc66a2b3b%2C0x12754ccc%2C0x782ef11c%2C0x6a124237%2C0xb79251e7%2C0x06a1bbe6%2C0x4bfb6350%2C0x1a6b1018%2C0x11caedfa%2C0x3d25bdd8%2C0xe2e1c3c9%2C0x44421659%2C0x0a121386%2C0xd90cec6e%2C0xd5abea2a%2C0x64af674e%2C0xda86a85f%2C0xbebfe988%2C0x64e4c3fe%2C0x9dbc8057%2C0xf0f7c086%2C0x60787bf8%2C0x6003604d%2C0xd1fd8346%2C0xf6381fb0%2C0x7745ae04%2C0xd736fccc%2C0x83426b33%2C0xf01eab71%2C0xb0804187%2C0x3c005e5f%2C0x77a057be%2C0xbde8ae24%2C0x55464299%2C0xbf582e61%2C0x4e58f48f%2C0xf2ddfda2%2C0xf474ef38%2C0x8789bdc2%2C0x5366f9c3%2C0xc8b38e74%2C0xb475f255%2C0x46fcd9b9%2C0x7aeb2661%2C0x8b1ddf84%2C0x846a0e79%2C0x915f95e2%2C0x466e598e%2C0x20b45770%2C0x8cd55591%2C0xc902de4c%2C0xb90bace1%2C0xbb8205d0%2C0x11a86248%2C0x7574a99e%2C0xb77f19b6%2C0xe0a9dc09%2C0x662d09a1%2C0xc4324633%2C0xe85a1f02%2C0x09f0be8c%2C0x4a99a025%2C0x1d6efe10%2C0x1ab93d1d%2C0x0ba5a4df%2C0xa186f20f%2C0x2868f169%2C0xdcb7da83%2C0x573906fe%2C0xa1e2ce9b%2C0x4fcd7f52%2C0x50115e01%2C0xa70683fa%2C0xa002b5c4%2C0x0de6d027%2C0x9af88c27%2C0x773f8641%2C0xc3604c06%2C0x61a806b5%2C0xf0177a28%2C0xc0f586e0%2C0x006058aa%2C0x30dc7d62%2C0x11e69ed7%2C0x2338ea63%2C0x53c2dd94%2C0xc2c21634%2C0xbbcbee56%2C0x90bcb6de%2C0xebfc7da1%2C0xce591d76%2C0x6f05e409%2C0x4b7c0188%2C0x39720a3d%2C0x7c927c24%2C0x86e3725f%2C0x724d9db9%2C0x1ac15bb4%2C0xd39eb8fc%2C0xed545578%2C0x08fca5b5%2C0xd83d7cd3%2C0x4dad0fc4%2C0x1e50ef5e%2C0xb161e6f8%2C0xa28514d9%2C0x6c51133c%2C0x6fd5c7e7%2C0x56e14ec4%2C0x362abfce%2C0xddc6c837%2C0xd79a3234%2C0x92638212%2C0x670efa8e%2C0x406000e0]%3BB.prototype.bf_S3%3D[0x3a39ce37%2C0xd3faf5cf%2C0xabc27737%2C0x5ac52d1b%2C0x5cb0679e%2C0x4fa33742%2C0xd3822740%2C0x99bc9bbe%2C0xd5118e9d%2C0xbf0f7315%2C0xd62d1c7e%2C0xc700c47b%2C0xb78c1b6b%2C0x21a19045%2C0xb26eb1be%2C0x6a366eb4%2C0x5748ab2f%2C0xbc946e79%2C0xc6a376d2%2C0x6549c2c8%2C0x530ff8ee%2C0x468dde7d%2C0xd5730a1d%2C0x4cd04dc6%2C0x2939bbdb%2C0xa9ba4650%2C0xac9526e8%2C0xbe5ee304%2C0xa1fad5f0%2C0x6a2d519a%2C0x63ef8ce2%2C0x9a86ee22%2C0xc089c2b8%2C0x43242ef6%2C0xa51e03aa%2C0x9cf2d0a4%2C0x83c061ba%2C0x9be96a4d%2C0x8fe51550%2C0xba645bd6%2C0x2826a2f9%2C0xa73a3ae1%2C0x4ba99586%2C0xef5562e9%2C0xc72fefd3%2C0xf752f7da%2C0x3f046f69%2C0x77fa0a59%2C0x80e4a915%2C0x87b08601%2C0x9b09e6ad%2C0x3b3ee593%2C0xe990fd5a%2C0x9e34d797%2C0x2cf0b7d9%2C0x022b8b51%2C0x96d5ac3a%2C0x017da67d%2C0xd1cf3ed6%2C0x7c7d2d28%2C0x1f9f25cf%2C0xadf2b89b%2C0x5ad6b472%2C0x5a88f54c%2C0xe029ac71%2C0xe019a5e6%2C0x47b0acfd%2C0xed93fa9b%2C0xe8d3c48d%2C0x283b57cc%2C0xf8d56629%2C0x79132e28%2C0x785f0191%2C0xed756055%2C0xf7960e44%2C0xe3d35e8c%2C0x15056dd4%2C0x88f46dba%2C0x03a16125%2C0x0564f0bd%2C0xc3eb9e15%2C0x3c9057a2%2C0x97271aec%2C0xa93a072a%2C0x1b3f6d9b%2C0x1e6321f5%2C0xf59c66fb%2C0x26dcf319%2C0x7533d928%2C0xb155fdf5%2C0x03563482%2C0x8aba3cbb%2C0x28517711%2C0xc20ad9f8%2C0xabcc5167%2C0xccad925f%2C0x4de81751%2C0x3830dc8e%2C0x379d5862%2C0x9320f991%2C0xea7a90c2%2C0xfb3e7bce%2C0x5121ce64%2C0x774fbe32%2C0xa8b6e37e%2C0xc3293d46%2C0x48de5369%2C0x6413e680%2C0xa2ae0810%2C0xdd6db224%2C0x69852dfd%2C0x09072166%2C0xb39a460a%2C0x6445c0dd%2C0x586cdecf%2C0x1c20c8ae%2C0x5bbef7dd%2C0x1b588d40%2C0xccd2017f%2C0x6bb4e3bb%2C0xdda26a7e%2C0x3a59ff45%2C0x3e350a44%2C0xbcb4cdd5%2C0x72eacea8%2C0xfa6484bb%2C0x8d6612ae%2C0xbf3c6f47%2C0xd29be463%2C0x542f5d9e%2C0xaec2771b%2C0xf64e6370%2C0x740e0d8d%2C0xe75b1357%2C0xf8721671%2C0xaf537d5d%2C0x4040cb08%2C0x4eb4e2cc%2C0x34d2466a%2C0x0115af84%2C0xe1b00428%2C0x95983a1d%2C0x06b89fb4%2C0xce6ea048%2C0x6f3f3b82%2C0x3520ab82%2C0x011a1d4b%2C0x277227f8%2C0x611560b1%2C0xe7933fdc%2C0xbb3a792b%2C0x344525bd%2C0xa08839e1%2C0x51ce794b%2C0x2f32c9b7%2C0xa01fbac9%2C0xe01cc87e%2C0xbcc7d1f6%2C0xcf0111c3%2C0xa1e8aac7%2C0x1a908749%2C0xd44fbd9a%2C0xd0dadecb%2C0xd50ada38%2C0x0339c32a%2C0xc6913667%2C0x8df9317c%2C0xe0b12b4f%2C0xf79e59b7%2C0x43f5bb3a%2C0xf2d519ff%2C0x27d9459c%2C0xbf97222c%2C0x15e6fc2a%2C0x0f91fc71%2C0x9b941525%2C0xfae59361%2C0xceb69ceb%2C0xc2a86459%2C0x12baa8d1%2C0xb6c1075e%2C0xe3056a0c%2C0x10d25065%2C0xcb03a442%2C0xe0ec6e0e%2C0x1698db3b%2C0x4c98a0be%2C0x3278e964%2C0x9f1f9532%2C0xe0d392df%2C0xd3a0342b%2C0x8971f21e%2C0x1b0a7441%2C0x4ba3348c%2C0xc5be7120%2C0xc37632d8%2C0xdf359f8d%2C0x9b992f2e%2C0xe60b6f47%2C0x0fe3f11d%2C0xe54cda54%2C0x1edad891%2C0xce6279cf%2C0xcd3e7e6f%2C0x1618b166%2C0xfd2c1d05%2C0x848fd2c5%2C0xf6fb2299%2C0xf523f357%2C0xa6327623%2C0x93a83531%2C0x56cccd02%2C0xacf08162%2C0x5a75ebb5%2C0x6e163697%2C0x88d273cc%2C0xde966292%2C0x81b949d0%2C0x4c50901b%2C0x71c65614%2C0xe6c6c7bd%2C0x327a140a%2C0x45e1d006%2C0xc3f27b9a%2C0xc9aa53fd%2C0x62a80f00%2C0xbb25bfe2%2C0x35bdd2f6%2C0x71126905%2C0xb2040222%2C0xb6cbcf7c%2C0xcd769c2b%2C0x53113ec0%2C0x1640e3d3%2C0x38abbd60%2C0x2547adf0%2C0xba38209c%2C0xf746ce76%2C0x77afa1c5%2C0x20756060%2C0x85cbfe4e%2C0x8ae88dd8%2C0x7aaaf9b0%2C0x4cf9aa7e%2C0x1948c25c%2C0x02fb8a8c%2C0x01c36ae4%2C0xd6ebe1f9%2C0x90d4f869%2C0xa65cdea0%2C0x3f09252d%2C0xc208e69f%2C0xb74e6132%2C0xce77e25b%2C0x578fdfe3%2C0x3ac372e6]%3BB.prototype.encrypt%3Dfunction(t){var%20x%3Dthis.es(t)%3Bfor(var%20i%3D0%3Bi%3Cx.length%2516%3Bi%2B%2B){x%2B%3D%270%27%3B}%0Avar%20r%3D%27%27%3Bfor(i%3D0%3Bi%3Cx.length%3Bi%2B%3D16){this.xrp%3Dthis.wu(x.substr(i%2C8))%3Bthis.xlp%3Dthis.wu(x.substr(i%2B8%2C8))%3Bthis.ecf()%3Br%2B%3Dthis.we(this.xrp)%2Bthis.we(this.xlp)%3B}%0Areturn%20r%3B}%3BB.prototype.decrypt%3Dfunction(t){for(var%20i%3D0%3Bi%3Ct.length%2516%3Bi%2B%2B){t%2B%3D%270%27%3B}%0Avar%20r%3D%27%27%3Bfor(i%3D0%3Bi%3Ct.length%3Bi%2B%3D16){this.xrp%3Dthis.wu(t.substr(i%2C8))%3Bthis.xlp%3Dthis.wu(t.substr(i%2B8%2C8))%3Bthis.dcf()%3Br%2B%3Dthis.we(this.xrp)%2Bthis.we(this.xlp)%3B}%0Areturn%20this.ue(r)%3B}%3BB.prototype.we%3Dfunction(w){var%20r%3D%27%27%3Bvar%20m%3D[this.w0(w)%2Cthis.w1(w)%2Cthis.w2(w)%2Cthis.w3(w)]%3Bfor(var%20i%3D3%3Bi%3E%3D0%3Bi--){var%20t1%3DMath.floor(m[i]/16)%3Bvar%20t2%3Dm[i]%2516%3Bif(t1%3C10){t1%2B%3D48%3B}%0Aelse{t1%2B%3D55%3B}%0Aif(t2%3C10){t2%2B%3D48%3B}%0Aelse{t2%2B%3D55%3B}%0Ar%2B%3DString.fromCharCode(t1)%2BString.fromCharCode(t2)%3B}%0Areturn%20r%3B}%3BB.prototype.wu%3Dfunction(t){var%20r%3D0%3Bfor(var%20i%3D6%3Bi%3E%3D0%3Bi-%3D2){var%20t1%3Dt.charCodeAt(i)%3Bvar%20t2%3Dt.charCodeAt(i%2B1)%3Bif(t1%3C58){t1-%3D48%3B}%0Aelse{t1-%3D55%3B}%0Aif(t2%3C58){t2-%3D48%3B}%0Aelse{t2-%3D55%3B}%0Ar%3Dr%2A256%2B(t1%2A16%2Bt2)%3B}%0Areturn%20r%3B}%3BB.prototype.rn%3Dfunction(a%2Cb%2Cn){var%20t%3Dthis%3Breturn(t.xr(a%2Ct.xr(((t.xr((t.bf_S0[t.w0(b)]%2Bt.bf_S1[t.w1(b)])%2Ct.bf_S2[t.w2(b)]))%2Bt.bf_S3[t.w3(b)])%2Ct.bf_P[n])))%3B}%3BB.prototype.ecf%3Dfunction(){var%20t%3Dthis%3Bvar%20Xl%3Dt.xlp%3Bvar%20Xr%3Dt.xrp%3BXl%3Dt.xr(Xl%2Ct.bf_P[0])%3BXr%3Dt.rn(Xr%2CXl%2C1)%3BXl%3Dt.rn(Xl%2CXr%2C2)%3BXr%3Dt.rn(Xr%2CXl%2C3)%3BXl%3Dt.rn(Xl%2CXr%2C4)%3BXr%3Dt.rn(Xr%2CXl%2C5)%3BXl%3Dt.rn(Xl%2CXr%2C6)%3BXr%3Dt.rn(Xr%2CXl%2C7)%3BXl%3Dt.rn(Xl%2CXr%2C8)%3BXr%3Dt.rn(Xr%2CXl%2C9)%3BXl%3Dt.rn(Xl%2CXr%2C10)%3BXr%3Dt.rn(Xr%2CXl%2C11)%3BXl%3Dt.rn(Xl%2CXr%2C12)%3BXr%3Dt.rn(Xr%2CXl%2C13)%3BXl%3Dt.rn(Xl%2CXr%2C14)%3BXr%3Dt.rn(Xr%2CXl%2C15)%3BXl%3Dt.rn(Xl%2CXr%2C16)%3BXr%3Dt.xr(Xr%2Ct.bf_P[17])%3Bt.xlp%3DXr%3Bt.xrp%3DXl%3B}%3BB.prototype.dcf%3Dfunction(){var%20t%3Dthis%3Bvar%20Xl%3Dt.xlp%3Bvar%20Xr%3Dt.xrp%3BXl%3Dt.xr(Xl%2Ct.bf_P[17])%3BXr%3Dt.rn(Xr%2CXl%2C16)%3BXl%3Dt.rn(Xl%2CXr%2C15)%3BXr%3Dt.rn(Xr%2CXl%2C14)%3BXl%3Dt.rn(Xl%2CXr%2C13)%3BXr%3Dt.rn(Xr%2CXl%2C12)%3BXl%3Dt.rn(Xl%2CXr%2C11)%3BXr%3Dt.rn(Xr%2CXl%2C10)%3BXl%3Dt.rn(Xl%2CXr%2C9)%3BXr%3Dt.rn(Xr%2CXl%2C8)%3BXl%3Dt.rn(Xl%2CXr%2C7)%3BXr%3Dt.rn(Xr%2CXl%2C6)%3BXl%3Dt.rn(Xl%2CXr%2C5)%3BXr%3Dt.rn(Xr%2CXl%2C4)%3BXl%3Dt.rn(Xl%2CXr%2C3)%3BXr%3Dt.rn(Xr%2CXl%2C2)%3BXl%3Dt.rn(Xl%2CXr%2C1)%3BXr%3Dt.xr(Xr%2Ct.bf_P[0])%3Bt.xlp%3DXr%3Bt.xrp%3DXl%3B}%3B';

  if (head) {
    var s = document.createElement('script');
    s.language='javascript';
    s.type = 'text/javascript';
    s.text = unescape([blow, '%0Avar%20blow%3B%0Afunction%20eGet()%20{%0A%20var%20L%3Ddocument.getElementsByTagName(%27a%27)%3B%0A%20for(var%20_%3D0%3B_%3C%3DL.length%3B%2B%2B_)%20{%0A%20%20if%20(%21%20L[_]%20%7C%7C%20%21%20L[_].href)%20continue%3B%0A%20%20var%20r%3DL[_].href.match(/%5E((https%3F:..(del.icio.us%7Cdelicious.com))%3F.doc.dangerous[%23%3F])%3Fprivate:..([0-9a-fA-F]%2B).%3F%24/)%3B%0A%20%20if%20(r)%20{%0A%20%20%20if%20(%21blow)%20{%0A%20%20%20%20blow%20%3D%20new%20B(prompt(%27Password%3F%27))%3B%0A%20%20%20}%0A%20%20%20var%20o_d%20%3D%20blow.decrypt(r[4].toUpperCase()).replace(/\0%2B%24/%2C%22%22)%3B%0A%20%20%20if%20(o_d%20%21%3D%20r[3]%20%26%26%20o_d.match(/%5E(file%7Cftp%7Chttps%3F):../)){%0A%20%20%20%20var%20x_url%3Do_d%3B%0A%20%20%20%20var%20x_t%3DL[_].innerHTML%3B%0A%20%20%20%20if%20(x_t.match(/%5E[0-9a-fA-F]%2B%24/))%20{%0A%20%20%20%20%20x_t%3Dblow.decrypt(x_t).replace(/\0%2B%24/%2C%22%22)%3B%0A%20%20%20%20}%0A%20%20%20%20L[_].href%3Dx_url%3B%0A%20%20%20%20L[_].innerHTML%3Dx_t%3B%0A%20%20%20%20var%20onc%3DL[_].getAttribute(%22onclick%22)%3B%0A%20%20%20%20if%20(onc)%20{%0A%20%20%20%20%20L[_].setAttribute(%22onclick%22%2C%20%27%27)%3B%0A%20%20%20%20}%0A%20%20%20}%0A%20%20}%0A%20}%0A}%0Afunction%20eEnc()%20{%0A%20if%20(%21blow)%20{%0A%20%20blow%3Dnew%20B(prompt(%27Password%3F%27))%3B%0A%20}%0A%20var%20flds%3D[%27url%27%2C%27description%27%2C%27notes%27]%3B%0A%20for%20(var%20i%3D0%3B%20i%20%3C%20flds.length%3B%20i%2B%2B)%20{%0A%20%20var%20tf%3Ddocument.getElementById(flds[i])%3B%0A%20%20if%20(tf)%20{%0A%20%20%20var%20nvalue%3Dblow.encrypt(tf.value)%3B%0A%20%20%20if%20(flds[i]%20%3D%3D%20%27url%27)%20{%0A%20%20%20%20%20tf.value%3D%27private://%27%2Bnvalue%3B%0A%20%20%20}%20else%20{%0A%20%20%20%20%20tf.value%3Dnvalue%3B%0A%20%20%20}%0A%20%20}%0A%20}%0A}%0Afunction%20eDec()%20{%0A%20if%20(%21blow)%20{%0A%20%20blow%3Dnew%20B(prompt(%27Password%3F%27))%3B%0A%20}%0A%20var%20flds%3D[%27url%27%2C%27description%27%2C%27notes%27]%3B%0A%20for%20(var%20i%3D0%3Bi%3Cflds.length%3Bi%2B%2B){%0A%20%20var%20tf%3Ddocument.getElementById(flds[i])%3B%0A%20%20if%20(tf)%20{%0A%20%20%20var%20ind%3Dtf.value%3B%0A%20%20%20if%20(ind.match(/%5E((https%3F:..(del.icio.us%7Cdelicious.com))%3F.doc.dangerous[%23%3F])%3Fprivate:..([0-9a-fA-F]%2B).%3F%24/))%20{%20//%20url%20field%0A%20%20%20%20ind%3DRegExp.%244%3B%0A%20%20%20}%0A%20%20%20tf.value%3Dblow.decrypt(ind).replace(/\0%2B%24/%2C%22%22)%3B%0A%20%20}%0A%20}%0A}%0A'].join(''));
    head.appendChild(s);
  }

  window.addEventListener("load", function(e) {
    // "Post form" modification
    var tagfield = document.getElementById("tags");
    var urlfield = document.getElementById("url");
    if (tagfield && urlfield) {
      var tr = document.createElement('tr');
      var td1 = document.createElement('td');
      td1.setAttribute('class', 'rs');
      td1.innerHTML = 'privacy';
      tr.appendChild(td1);
      var td2 = document.createElement('td');
      td2.innerHTML = '<a href="javascript: eEnc();">Encrypt</a> / <a href="javascript: eDec();">Decrypt</a>';
      tr.appendChild(td2);
      tr.appendChild(document.createElement('td'));
      var urlRow = urlfield.parentNode.parentNode;
      urlRow.parentNode.insertBefore(tr, urlRow);
    }
    var p = document.getElementById('alt_message');
    if (p) {
      p.innerHTML = [
        p.innerHTML
        , ' <em> | </em> <a class="" href=\''
        , 'javascript:(function(){%0A'
        , blow
        , 'var%20blow%3B%0Avar%20L%3Ddocument.getElementsByTagName(%27a%27)%3B%0Afor(var%20_%3D0%3B_%3C%3DL.length%3B%2B%2B_){%0A%20if%20(%21%20L[_]%20%7C%7C%20%21%20L[_].href)%20continue%3B%0A%20var%20r%20%3D%20L[_].href.match(/%5E((https%3F:..(del.icio.us|delicious.com))%3F.doc.dangerous[%23%3F])%3Fprivate:..([0-9a-f]%2B).%3F%24/i)%3B%0A%20if%20(r){%0A%20%20if%20(%21blow)%20{blow%3Dnew%20B(prompt(%27Password%3F%27))%3B}%0A%20%20var%20o_d%3Dblow.decrypt(r[4].toUpperCase())%3B%0A%20%20if%20(o_d%20%21%3D%20r[3]%20%26%26%20o_d.match(/%5E(ftp%7Cfile%7Chttps%3F):../i)){%0A%20%20%20var%20xu%3Do_d.replace(/\0%2B%24/%2C%22%22)%3B%0A%20%20%20var%20xt%3DL[_].innerHTML%3B%0A%20%20%20if%20(xt.match(/%5E[0-9A-F]%2B%24/i))%20{xt%3Dblow.decrypt(xt).replace(/\0%2B%24/%2C%22%22)%3B}%0A%20%20%20L[_].href%3Dxu%3B%0A%20%20%20L[_].innerHTML%3Dxt%3B%0A%20%20%20var%20onc%3DL[_].getAttribute(%22onclick%22)%3B%0A%20%20%20if%20(onc){L[_].setAttribute(%22onclick%22%2C%20%27%27)%3B}%0A%20%20}%0A%20}%0A}%0A})()%0A'
        , '\' alt="drag me to your bookmarks toolbar or click to decrypt any private links on this page" title="drag me to your bookmarks toolbar or click to decrypt any private links on this page"/>"Decrypt links" bookmarklet</a>'
        , ' <em> | </em> <a class="" href=\''
        , 'javascript:(function(){%0A'
        , blow
        , '%0Avar%20blow%3Dnew%20B(prompt(%27Password%3F%27))%3B%0Avar%20xu%3Dblow.encrypt(location.href)%3B%0Avar%20xt%3Dblow.encrypt(prompt(%27Title%20before%20encryption%27%2Cdocument.title%7C%7Clocation.href))%3B%0Alocation.href%3D%27http://delicious.com/save%3Furl%3Dprivate:%252f%252f%27%2Bxu%2B%27%3Btitle%3D%27%2Bxt%2B%27%3Bv%3D5%3Bjump%3Dno%3Btags%3Dprivate%27%3B%0A})()'
        , '\' alt="drag me to your bookmarks toolbar" title="drag me to your bookmarks toolbar"/>"Post encrypted" bookmarklet</a>'
      ].join('');
    }
  }, false);
})();
