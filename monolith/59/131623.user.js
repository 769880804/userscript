// ==UserScript==
// @name FiMFiction Enhancements
// @description Comment preview + More BBCode tag buttons + More emoticons + Some other crap
// @include http*://www.fimfiction.net/*
// @version 10
// @icon http://dl.dropbox.com/u/31471793/FiMFiction/Luna_lolface.png
// ==/UserScript==
function GM_addStyle(a){"use strict";var b=document.getElementsByTagName("head")[0];if(b){var c=document.createElement("style");c.type="text/css";c.textContent=a;b.appendChild(c);return c}return null}function GM_getValue(a,b){var c=localStorage.getItem(GM_STORAGE_PREFIX+a);if(null==c&&"undefined"!=typeof b){return b}return c}function GM_setValue(a,b){localStorage.setItem(GM_STORAGE_PREFIX+a,b)}function setTitle(a){unsafeWindow.title_cache=a+" - FIMFiction.net";document.title=unsafeWindow.title_cache}function setCookie(a,b,c){var d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+(c==null?"":"; expires="+d.toUTCString());document.cookie=a+"="+e+";path=/"}function setting_emoticons(){addEmoticons=document.getElementById("ss_emoticons").checked;GM_setValue("addEmoticons",addEmoticons)}function setting_preview(){commentPreview=document.getElementById("ss_preview").checked;GM_setValue("commentPreview",commentPreview)}function setting_autoupdate(){ap=document.getElementById("ss_autoupdate").checked;GM_setValue("autopreview",ap)}function setting_fullwidth(){fullwidth=document.getElementById("ss_fullwidth").checked;GM_setValue("fullWidth",fullwidth)}function setting_banner(){banner=document.getElementById("ss_banner").value.trim();GM_setValue("banner",banner);if(!error502&&banner!==""){GM_addStyle('div.header div.title{background-image:url("'+banner+'") !important;}');if(home_link!=null){home_link.style.display=banner.indexOf("//static.fimfiction.net/images/custom_banners/twilightlicious.jpg")===-1?"none":"block"}}}function setting_banner_dd(){document.getElementById("ss_banner").value=document.getElementById("ss_banner_dd").value;setting_banner()}function setting_banner_add(){banner=document.getElementById("ss_banner").value.trim();var a=document.getElementById("ss_banner_dd");for(i=0;i<a.options.length;i++){if(a.options[i].value===banner){return null}}if(userBanners.indexOf(banner)===-1){var b=prompt("Banner name:");if(b==null){return null}if(b===""){b=banner.substring(banner.lastIndexOf("/")+1)}userBanners+=""+banner+""+b;if(userBanners.indexOf("")===0){userBanners=userBanners.substring(1)}GM_setValue("userBanners",userBanners);var c=document.getElementById("ss_banner_dd");c.innerHTML+=(c.innerHTML.indexOf("Custom URLs")===-1?'<option value="" disabled="true">Custom URLs</option>':"")+'<option value="'+banner+'">'+b+"</option>";c.selectedIndex=c.options.length-1}}function setting_banner_del(){banner=document.getElementById("ss_banner").value.trim();if(userBanners.indexOf(banner)!==-1){var a=userBanners.split("");var b=a.indexOf(banner);if(b!==-1){a.splice(b,2);userBanners=a.join("");GM_setValue("userBanners",userBanners);var c=document.getElementById("ss_banner_dd"),d=c.innerHTML;d=d.substring(0,d.indexOf('<option value="" disabled="true">Custom URLs</option>'));if(userBanners.length>0){d+='<option value="" disabled="true">Custom URLs</option>';var e=false;for(i=0;i<c.options.length;i++){if(!e){e=c.options[i].innerHTML==="Custom URLs"}else if(c.options[i].value!==banner){d+='<option value="'+c.options[i].value+'">'+c.options[i].innerHTML+"</option>"}}}c.innerHTML=d}}}function setting_errmsg502(){errmsg502=document.getElementById("ss_errmsg502").value.trim();GM_setValue("errmsg502",errmsg502)}function setting_fbc1(){var a=document.getElementById("ss_fboxtitlecolor_bg");fboxtitlecolor_bg=a.value.trim();GM_setValue("fboxtitlecolor_bg",fboxtitlecolor_bg);a.style.backgroundColor=fboxtitlecolor_bg;GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a{background-color:"+fboxtitlecolor_bg+" !important;}")}function setting_fbc2(){var a=document.getElementById("ss_fboxtitlecolor_bgh");fboxtitlecolor_bgh=a.value.trim();GM_setValue("fboxtitlecolor_bgh",fboxtitlecolor_bgh);a.style.backgroundColor=fboxtitlecolor_bgh;GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a:hover{background-color:"+fboxtitlecolor_bgh+" !important;}")}function setting_fbc3(){var a=document.getElementById("ss_fboxtitlecolor_txt");fboxtitlecolor_txt=a.value.trim();GM_setValue("fboxtitlecolor_txt",fboxtitlecolor_txt);a.style.backgroundColor=fboxtitlecolor_txt;GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a{color:"+fboxtitlecolor_txt+" !important;}")}function setting_character(a){var b=document.getElementsByClassName("select_character")[a];var c=document.getElementById(b.getElementsByClassName("included")[0].value);if(c.style.cssText.indexOf("0.5")!==-1){characters+=","+c.id;c.style.opacity=1}else{var d=characters.split(",");var e=d.indexOf(c.id);if(e!==-1){d.splice(e,1);characters=d.join(",");c.style.opacity=.5}}GM_setValue("characters",characters)}function getCharImg(a){switch(a){case"7":return"twilight_sparkle";case"8":return"rainbow_dash";case"9":return"pinkie_pie";case"10":return"applejack";case"11":return"rarity";case"12":return"fluttershy";case"13":return"apple_bloom";case"14":return"scootaloo";case"15":return"sweetie_belle";case"16":return"spike";case"17":return"celestia";case"18":return"princess_luna";case"19":return"gilda";case"20":return"zecora";case"21":return"trixie";case"22":return"big_mac";case"23":return"granny_smith";case"24":return"braeburn";case"25":return"diamond_tiara";case"26":return"silver_spoon";case"27":return"twist";case"28":return"snips";case"29":return"snails";case"30":return"cherilee";case"31":return"the_mayor";case"32":return"hoity_toity";case"33":return"photo_finish";case"34":return"sapphire_shores";case"35":return"spitfire";case"36":return"soarin";case"37":return"prince_blueblood";case"38":return"little_strongheart";case"39":return"angel";case"40":return"winona";case"41":return"opalescence";case"42":return"gummy";case"43":return"owlowiscious";case"44":return"philomena";case"45":return"derpy_hooves";case"46":return"lyra";case"47":return"bon_bon";case"48":return"dj_pon3";case"49":return"oc";case"50":return"caramel";case"51":return"doctor_whooves";case"52":return"octavia";case"53":return"discord";case"54":return"nightmare_moon";case"55":return"pipsqueak";case"56":return"berry_punch";case"57":return"carrot_top";case"58":return"mare_do_well";case"59":return"tank";case"60":return"fancypants";case"61":return"fleur_de_lis";case"62":return"other";case"63":return"daring_do";case"64":return"colgateicon";case"65":return"flimflamicon";case"66":return"cranky doodle icon";case"67":return"matilda icon";case"68":return"mr cake icon";case"69":return"mrs cake icon";case"70":return"dinkyicon";case"71":return"ironwillicon";case"72":return"Cadence";case"73":return"shining-armor";case"74":return"main_6";case"75":return"cmc";case"76":return"wonderbolts";case"77":return"diamond_dogs";case"78":return"queen-chrysalis";case"79":return"thunderlane";case"80":return"flitter_and_cloudchaser";case"81":return"rumble";case"82":return"roseluck";default:return"undefined"}}function taginfo_t(a,b){this.bbtag=a;this.etag=b}function isValidTag(a){return!a||!a.length?false:tagname_re.test(a)}function textToHtmlCB(a,b,c,d,e,f,g){if(b&&b.length){if(!crlf2br){return a}switch(b){case"\r":return"";case"\n":return"<br>"}}if(isValidTag(c)){if(opentags.length&&opentags[opentags.length-1].bbtag==="url"&&urlstart>=0){return"["+c+"]"}switch(c){case"color":{opentags.push(new taginfo_t(c,"</span>"));return'<span style="color:'+d+'">'};case"size":{if(!d||!number_re.test(d)){opentags.push(new taginfo_t(c,"[/size]</span>"));return'<span style="background-color:#ffaa00;">'+a+""}else{opentags.push(new taginfo_t(c,"</span>"));return'<span style="font-size:'+d+'px">'}};case"quote":{opentags.push(new taginfo_t(c,"</blockquote>"));return'<blockquote style="margin:0px 5px;padding: 15px;background-color:#F7F7F7;border: 1px solid #AAA;width:95%;box-shadow:5px 5px 0px #EEE;">'};case"url":{opentags.push(new taginfo_t(c,"</a>"));if(d&&uri_re.test(d)){urlstart=-1;return'<a href="'+d+'">'}urlstart=a.length+f;return'<a href="'};case"youtube":{opentags.push(new taginfo_t(c,"</iframe>"));if(d&&uri_re.test(d)){urlstart=-1;return'<iframe width="560" height="315" frameborder="0" allowfullscreen="" src="http://www.youtube.com/embed/'+d+'">'}urlstart=a.length+f;return""};case"hr":return"<hr>";case"img":{opentags.push(new taginfo_t(c,'">'));return'<img style="border:0px; max-width:100%;" src="'};case"smcaps":{opentags.push(new taginfo_t(c,"</span>"));return'<span style="font-variant:small-caps;">'};case"email":{opentags.push(new taginfo_t(c,"</a>"));return'<a rel="nofollow" href="mailto:'+c+'">'};case"s":{opentags.push(new taginfo_t(c,"</span>"));return'<span style="text-decoration:line-through;">'};default:{opentags.push(new taginfo_t(c,"</"+c+">"));return"<"+c+">"}}}if(isValidTag(e)){if(!opentags.length||opentags[opentags.length-1].bbtag!==e){return'<span style="background-color: #ffff00;">[/'+e+"]</span>"}if(e==="url"){if(urlstart>0){return'">'+g.substr(urlstart,f-urlstart)+opentags.pop().etag}return opentags.pop().etag}return opentags.pop().etag}return a}function parseBBCode(a){var b,c;crlf2br=true;if(opentags==null||opentags.length){opentags=new Array(0)}b=a.replace(postfmt_re,textToHtmlCB);if(opentags.length){c="";if(opentags[opentags.length-1].bbtag==="url"){opentags.pop();c+='">'+a.substr(urlstart,a.length-urlstart)+"</a>"}while(opentags.length){c+=opentags.pop().etag}}return c?b+c:b}function addTBB(a,b){var c=a.getElementsByClassName("toolbar_buttons");for(i=0;i<c.length;i++){if(c[i].innerHTML.indexOf("AddYoutube")!==-1){var d=c[i].getElementsByTagName("a");for(var e=0;e<d.length;e++){if(d[e].href.indexOf("AddYoutube")!==-1){d[e].href="javascript:void(0);";d[e].id="youtubebtn_"+b;break}}break}}a.innerHTML+='<ul class="toolbar_buttons"><li><a href="javascript:Center(document.getElementById(\'comment_comment\'));" title="Center Align"><img class="icon_16" src="//static.fimfiction.net/images/icons/center.png"></a></li><li><a href="javascript:AddHR(document.getElementById(\'comment_comment\'));" title="Add Horizontal Rule" class="left_curved_4"><img class="icon_16" src="//static.fimfiction.net/images/icons/horizontal_rule.png"></a></li><li><a href="javascript:var field=document.getElementById(\'comment_comment\'),txt=BBCodeGetSelection(field);if(txt==null)txt=\'\';InsertTextAt(field,\'[smcaps]\'+txt+\'[/smcaps]\');" title="SMCaps" class="left_curved_4">SMCaps</a></li><li><a href="javascript:var field=document.getElementById(\'comment_comment\'),txt=BBCodeGetSelection(field);if(txt==null)txt=\'\';InsertTextAt(field,\'[email]\'+txt+\'[/email]\');" title="Email" class="left_curved_4"><img class="icon_16" src="//static.fimfiction.net/images/icons/mail.png"></a></li></ul>';var f=document.getElementById("youtubebtn_"+b);if(f!=null){f.addEventListener("click",AddYT)}}function AddYT(){var a=document.getElementById(blogEdit?"":"comment_comment");if(a!=null){var b=prompt("Enter a YouTube video URL","");if(b!=null&&b!==""){b=b.trim();var c=b.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);if(c!=null&&c[2].length===11){InsertTextAt(a,"[youtube="+c[2]+"]")}else{alert("That is not a valid YouTube video URL")}}}}function InsertTextAt(a,b){if(a.selectionStart||a.selectionStart==="0"){var c=a.selectionStart;var d=a.selectionEnd;a.value=a.value.substring(0,c)+b+a.value.substring(d,a.value.length);a.selectionStart=c+b.length;a.selectionEnd=c+b.length}else{a.value+=b}}function preview(){var a=document.getElementById("comment_comment");if(a!=null){var b=a.value;if(b!=null&&b!==""){b=b.replace("\r\n","\n").replace("\r","\n");b=b.replace(/ /g," ");b=b.replace(/</g,"<").replace(/>/g,">");var c=b.split("\n");for(i=0;i<c.length;i++){if(c[i].indexOf("	")===0){c[i]='<p class="indented">'+c[i].substring(1)+"</p>"}}b=c.join("\n");b=b.replace(/\t/g,"    ");var d;for(i=0;i<emoticons.length;i++){d=new RegExp(":"+emoticons[i]+":","g");b=b.replace(d,'<img src="//static.fimfiction.net/images/emoticons/'+emoticons[i]+'.png" style="height:27px;" alt=":'+emoticons[i]+':">')}b=parseBBCode(b);c=b.match(/>>\d+/g);if(c!=null&&c.length>0){var e=c.filter(function(a,b){return c.indexOf(a)===b});for(i=0;i<e.length;i++){d=new RegExp(e[i],"g");b=b.replace(d,'<a class="comment_quote_link" href="#comment/'+e[i].substring(8)+'">'+e[i]+"</a>")}}b=b.replace(/<\/p><br>/g,"</p>");var f=document.getElementById("comment_preview");if(f!=null){f=f.getElementsByClassName("comment_data")[0];if(f!=null){f.innerHTML=b}}else{var g=document.getElementsByClassName("comment_list")[0];if(g==null){g=document.getElementById("comment_list")}if(g!=null){var h=document.createElement("div");h.setAttribute("id","comment_preview");h.setAttribute("class","comment");h.innerHTML='<div class="author"><div class="name'+(redname?" name_author":"")+'"><a>'+username+'</a></div><img width="64" height="64" class="avatar" src="//static.fimfiction.net/images/avatars/'+userid+"_64."+(userid==="none"?"png":"jpg")+'"></div><div class="data"><div class="comment_arrow"></div><div class="comment_information" style="padding-bottom:12px;"><div style="vertical-align:bottom; display:inline-block; margin-top: 5px;">COMMENT PREVIEW</div><div class="toolbar" style="display: inline-block; float: right;"><a href="javascript:void(0);" id="boomstick" class="delete_button pill_button pill_button_img_only" title="Delete preview"><img src="//static.fimfiction.net/images/icons/delete.png"></a></div></div><div class="comment_data">'+b+"</div></div>";g.appendChild(h);document.getElementById("boomstick").addEventListener("click",boomstick)}}}else{boomstick()}}}function boomstick(){try{var a=document.getElementById("comment_preview");a.parentNode.removeChild(a)}catch(b){}}function addEmoticonsF(a,b){if(addEmoticons){if(a==null){var c=document.getElementsByClassName("emoticons_panel");for(i=0;i<c.length;i++){if(c[i]!=null){addEmoticonsF(c[i],i)}}}else{txtToAdd="";var d=a.getElementsByClassName("inner_padding")[0];a.style.overflow="auto";txtToAdd+=blogEdit?'<a id="emot_l"><span id="emot_s">▶<i>Emoticons</i> </a></span><br><div id="emot_d" style="display:none;">':"<b>Do not post more than 20 emoticons at once</b><br>";txtToAdd+='<a id="ehl_0_'+b+'"><span id="ehs_0_'+b+'">'+(eha_0?"▼":"▶")+"<i>Default</i>"+(eha_0?":":" ")+'</a></span><br><div id="ehd_0_'+b+'" style="display:'+(eha_0?"inherit":"none")+';">';addEmoticon1("ajbemused","AJ Bemused");addEmoticon1("ajsleepy","AJ Sleepy");addEmoticon1("ajsmug","AJ Smug");addEmoticon1("applecry","Crying Applebloom");addEmoticon1("applejackconfused","AJ Confused");addEmoticon1("applejackunsure","AJ Unsure");addEmoticon1("coolphoto","Cool Photo");addEmoticon1("derpyderp1","Derpy Derp #1");addEmoticon1("derpyderp2","Derpy Derp #2");addEmoticon1("derpytongue2","Derpy Tongue");addEmoticon1("fluttercry","Crying Fluttershy");addEmoticon1("flutterrage","LOVE ME OR DIE");addEmoticon1("fluttershbad","Fluttershy Bad");addEmoticon1("fluttershyouch","Fluttershy Ouch");addEmoticon1("fluttershysad","Sad Fluttershy");addEmoticon1("heart","Heart");addEmoticon1("pinkiecrazy","Pinkamena");addEmoticon1("pinkiegasp","Pinkie Gasp");addEmoticon1("pinkiehappy","Happy Pinkie");addEmoticon1("pinkiesad2","Sad Pinkie");addEmoticon1("pinkiesick","Sick Pinkie");addEmoticon1("pinkiesmile","Pinkie Smile");addEmoticon1("rainbowderp","Rainbow Derp");addEmoticon1("rainbowdetermined2","Rainbow Determined");addEmoticon1("rainbowhuh","Rainbow Huh");addEmoticon1("rainbowkiss","Rainbow Kiss");addEmoticon1("rainbowlaugh","Rainbow Laugh");addEmoticon1("rainbowwild","Rainbow Wild");addEmoticon1("raritycry","Crying Rarity");addEmoticon1("raritydespair","Rarity Despair");addEmoticon1("raritystarry","Rarity Starry");addEmoticon1("raritywink","Rarity Wink");addEmoticon1("scootangel","Scootaloo Angel");addEmoticon1("trixieshiftleft","Trixie Shift Left");addEmoticon1("trixieshiftright","Trixie Shift Right");addEmoticon1("twilightangry2","Angry Twilight");addEmoticon1("twilightblush","Blushing Twilight");addEmoticon1("twilightoops","Twilight Oops");addEmoticon1("twilightsheepish","Sheepish Twilight");addEmoticon1("twilightsmile","Twilight Smile");addEmoticon1("twistnerd","Twist Nerd");addEmoticon1("unsuresweetie","Unsure Sweetie");addEmoticon1("yay","Yay");addEmoticon1("trollestia","Trollestia");addEmoticon1("moustache","Moustache");addEmoticon1("facehoof","Facehoof");addEmoticon1("eeyup","Eeyup");addEmoticon1("duck","Duck");txtToAdd+='</div><a id="ehl_1_'+b+'"><span id="ehs_1_'+b+'">'+(eha_1?"▼":"▶")+"<i>Awesome Faces</i>"+(eha_1?":":" ")+'</a></span><br><div id="ehd_1_'+b+'" style="display:'+(eha_1?"inherit":"none")+';">';addEmoticon2("Luna_lolface","Luna Lolface");addEmoticon3("lolface_Celestia","Celestia Lolface");addEmoticon2("Sweetie_Belle_lolface","Sweetie Belle Lolface");addEmoticon2("Twilight_Sparkle_lolface","Twilight Sparkle Lolface");addEmoticon2("Spike_lolface","Spike Lolface");addEmoticon2("Pinkie_Pie_lolface","Pinkie Pie Lolface");addEmoticon2("Rarity_lolface","Rarity Lolface");addEmoticon2("Rainbow_Dash_lolface","Rainbow Dash Lolface");addEmoticon2("Applejack_lolface","Applejack Lolface");addEmoticon2("Vinyl_Scratch_lolface","Vinyl Scratch Lolface");addEmoticon2("Fluttershy_lolface","Fluttershy Lolface");addEmoticon2("Scootaloo_lolface","Scootaloo Lolface");addEmoticon2("Applebloom_lolface","Applebloom Lolface");addEmoticon2("Derpy_Hooves_lolface","Derpy Hooves Lolface");addEmoticon2("Trixie_lolface_1","Trixie Lolface 1");addEmoticon2("Trixie_lolface_2","Trixie Lolface 2");addEmoticon3("lolface_Queen_Chrysalis","Queen Chrysalis Lolface");txtToAdd+='</div><a id="ehl_2_'+b+'"><span id="ehs_2_'+b+'">'+(eha_2?"▼":"▶")+"<i>Sillyfillies</i>"+(eha_2?":":" ")+'</a></span><br><div id="ehd_2_'+b+'" style="display:'+(eha_2?"inherit":"none")+';">';addEmoticon3("sillyfilly_Sweetie_Belle","Sweetie Belle Sillyfilly");addEmoticon3("sillyfilly_Scootaloo","Scootaloo Sillyfilly");addEmoticon3("sillyfilly_Applebloom","Applebloom Sillyfilly");addEmoticon3("sillyfilly_Twilight_Sparkle","Twilight Sparkle Sillyfilly");addEmoticon3("sillyfilly_Fluttershy","Fluttershy Sillyfilly");addEmoticon3("sillyfilly_Applejack","Applejack Sillyfilly");addEmoticon3("sillyfilly_Pinkie_Pie","Pinkie Pie Sillyfilly");addEmoticon3("sillyfilly_Rarity","Rarity Sillyfilly");addEmoticon3("sillyfilly_Rainbow_Dash","Rainbow Dash Sillyfilly");addEmoticon3("sillyfilly_Derpy_Hooves","Derpy Hooves Sillyfilly");txtToAdd+='</div><a id="ehl_3_'+b+'"><span id="ehs_3_'+b+'">'+(eha_3?"▼":"▶")+"<i>Shrugponies</i>"+(eha_3?":":" ")+'</a></span><br><div id="ehd_3_'+b+'" style="display:'+(eha_3?"inherit":"none")+';">';addEmoticon3("shrug_Luna_apple","Luna Shrug (Apple)");addEmoticon3("shrug_Twilight_Sparkle","Twilight Sparkle Shrug");addEmoticon3("shrug_Twilight_future","Future Twilight Shrug");addEmoticon3("shrug_Rainbow_Dash","Rainbow Dash Shrug");addEmoticon3("shrug_Derpy_Hooves","Derpy Hooves Shrug");addEmoticon3("shrug_Queen_Chrysalis","Queen Chrysalis Shrug");addEmoticon3("shrug_bronymaster1","bronymaster1 Shrug");txtToAdd+='</div><a id="ehl_4_'+b+'"><span id="ehs_4_'+b+'">'+(eha_4?"▼":"▶")+"<i>Miscellaneous</i>"+(eha_4?":":" ")+'</a></span><br><div id="ehd_4_'+b+'" style="display:'+(eha_4?"inherit":"none")+';">';addEmoticon3("misc_unsuresweetie_flip","Unsure Sweetie (flipped)");addEmoticon3("misc_rainbowkiss_flip","Rainbow Kiss (flipped)");addEmoticon3("misc_rainbowderp_flip","Rainbow Derp (flipped)");addEmoticon2("discord","Discord");addEmoticon3("misc_Discord","Discord 2");addEmoticon2("eenope","Eenope");addEmoticon2("Mr_Cake","Mr. Cake");addEmoticon2("yay_red","Red Yay");addEmoticon3("misc_TwilightWut","Twilight Wut");addEmoticon3("misc_Twilight_crazy","Crazy Twilight");addEmoticon3("misc_Twilight_crazy_invert","Crazy Twilight (inverted)");addEmoticon3("misc_Twilight_pea","Twilight Pea");addEmoticon3("misc_Fluttershy_umad","Fluttershy Umad");addEmoticon3("misc_Fluttershy","Fluttershy being Fluttershy");addEmoticon3("misc_Pinkie_loool","Pinkie LOOOL");addEmoticon3("misc_Rainbow_dealwithit","Rainbow Dash Deal With It");addEmoticon3("misc_Sweetie_happy","Happy Sweetie Belle");addEmoticon3("misc_Lyra2","Happy Lyra");addEmoticon3("misc_Lyra","Super Happy Lyra");addEmoticon3("misc_Lyra_cry","Lyra Cry");addEmoticon3("misc_Lyra_dealwithit","Lyra Deal With It");addEmoticon3("misc_Lyra_smile","Smiling Lyra");addEmoticon3("misc_Lyra_ooh",'"Oooh!"');addEmoticon3("misc_Bonbon_gaze","Bonbon Gaze");addEmoticon3("misc_Bonbon_grin","Bonbon Grin");addEmoticon3("misc_Bonbon_OMG_LOVE","Bonbon OMG LOVE");addEmoticon3("misc_Redheart_hmph","Nurse Redheard Hmph");addEmoticon3("misc_Redheart_shh","Nurse Redheard Shh");addEmoticon3("misc_Redheart_smile","Nurse Redheart Smile");addEmoticon3("misc_Redheart_gasp","Nurse Redheart Gasp");addEmoticon3("misc_Octavia","Octavia");addEmoticon3("misc_Octavia2","Octavia 2");addEmoticon3("misc_Octavia_O_O","Octavia O_O");addEmoticon3("misc_Octavia_cake","Octavia likes cake");addEmoticon3("misc_Octavia_chair","Octavia Chair");addEmoticon3("misc_Octavia_plot","Octavia Plot");addEmoticon3("misc_Cheerilee","Cheerilee");addEmoticon3("misc_Vinyl_Scratch","Vinyl Scratch");addEmoticon3("misc_Vinyl2","Vinyl Scratch 2");addEmoticon3("misc_Vinyl_sad","Sad Vinyl");addEmoticon3("misc_Vinyl_shock","Shocked Vinyl");addEmoticon3("misc_Soarin_dayum","Soarin DAYUM");addEmoticon3("misc_Spitfire","Spitfire");addEmoticon3("misc_Spitfire_dayum","Spitfire DAYUM");addEmoticon3("misc_Spitfire_lazy","Lazy Spitfire");addEmoticon3("misc_Spitfire_rape","Spitfire Rapeface");addEmoticon3("misc_Spitfire_sad","Sad Spitfire");addEmoticon3("misc_Cloudchaser_dealwithit","Cloudchaser Deal With It");addEmoticon3("misc_Colgate_beam","Colgate Beam");addEmoticon3("misc_Colgate_bedroomeyes","Colgate Bedroom Eyes");addEmoticon3("misc_Twilightclopple","Twilightclopple");addEmoticon3("misc_RageFace","Rage Face");addEmoticon3("misc_YouDontSay2","You Don't Say?!");txtToAdd+='</div><a id="ehl_5_'+b+'"><span id="ehs_5_'+b+'">'+(eha_5?"▼":"▶")+"<i>deviantART</i>"+(eha_5?":":" ")+'</a></span><br><div id="ehd_5_'+b+'" style="display:'+(eha_5?"inherit":"none")+';">';addEmoticon("http://e.deviantart.net/emoticons/t/trollface.png","Trollface");addEmoticon("http://e.deviantart.com/emoticons/moods/love.gif","Love");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection.gif","Affection");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/adoration.gif","Adoration");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/attraction.gif","Attraction");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/caring.gif","Caring");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/compassion.gif","Compassion");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/da_love.gif","dA Love");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/flirty.gif","Flirty");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/obsessed.gif","Obsessed");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/sentimental.gif","Sentimental");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/sweet.gif","Sweet");addEmoticon("http://e.deviantart.com/emoticons/moods/love/affection/tender.gif","Tender");addEmoticon("http://e.deviantart.com/emoticons/moods/love/longing.gif","Longing");addEmoticon("http://e.deviantart.com/emoticons/moods/love/longing/drooling.gif","Drooling");addEmoticon("http://e.deviantart.com/emoticons/moods/love/longing/love_dazed.gif","Love Dazed");addEmoticon("http://e.deviantart.com/emoticons/moods/love/longing/yearning.gif","Yearning");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust.gif","Lust");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/aroused.gif","Aroused");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/horny.gif","Horny");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/hump.gif","Hump");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/passionate.gif","Passionate");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/suggestive.gif","Suggestive");addEmoticon("http://e.deviantart.com/emoticons/moods/love/lust/unf.gif","Unf!");addEmoticon("http://e.deviantart.net/emoticons/moods/joy.gif","Joy");addEmoticon("http://e.deviantart.com/emoticons/moods/surprise.gif","Wow!");addEmoticon("http://e.deviantart.com/emoticons/moods/anger.gif","Anger");addEmoticon("http://e.deviantart.com/emoticons/moods/sadness.gif","Sadness");addEmoticon("http://e.deviantart.com/emoticons/moods/fear.gif","Fear");addEmoticon("http://e.deviantart.com/emoticons/moods/neutral.gif","Neutral");txtToAdd+="</div>";if(blogEdit){txtToAdd+="</div>"}d.innerHTML=txtToAdd;var e=document.getElementById("ehl_0_"+b);e.addEventListener("click",function(){eh(0,b)});e=document.getElementById("ehl_1_"+b);e.addEventListener("click",function(){eh(1,b)});e=document.getElementById("ehl_2_"+b);e.addEventListener("click",function(){eh(2,b)});e=document.getElementById("ehl_3_"+b);e.addEventListener("click",function(){eh(3,b)});e=document.getElementById("ehl_4_"+b);e.addEventListener("click",function(){eh(4,b)});e=document.getElementById("ehl_5_"+b);e.addEventListener("click",function(){eh(5,b)});if(blogEdit){e=document.getElementById("emot_l");e.addEventListener("click",function(){eh(-1)})}}}}function addEmoticon1(a,b){txtToAdd+="<a href=\"javascript:smilie(':"+a+':\');" title="'+b+'"><img style="margin:1px;" src="//static.fimfiction.net/images/emoticons/'+a+'.png"></a> '}function addEmoticon2(a,b){addEmoticon("http://dl.dropbox.com/u/31471793/FiMFiction/"+a+".png",b)}function addEmoticon3(a,b){addEmoticon("http://dl.dropbox.com/u/31471793/FiMFiction/emoticons/"+a+".png",b)}function addEmoticon(a,b){txtToAdd+="<a href=\"javascript:smilie('[img]"+a+'[/img]\');" title="'+b+'"><img style="margin:1px;" src="'+a+'"></a>'}function eh(a,b){var c=null;if(a===-1){c=document.getElementById("emot_s");if(c.innerHTML.indexOf("▶")!==-1){c.innerHTML=c.innerHTML.replace("▶","▼").replace(" ",":");document.getElementById("emot_d").style.display="inherit"}else if(c.innerHTML.indexOf("▼")!==-1){c.innerHTML=c.innerHTML.replace("▼","▶").replace(":"," ");document.getElementById("emot_d").style.display="none"}}else{var d="ehs_"+a+"_"+b;c=document.getElementById(d);if(c.innerHTML.indexOf("▶")!==-1){c.innerHTML=c.innerHTML.replace("▶","▼").replace(" ",":");document.getElementById("ehd_"+a+"_"+b).style.display="inherit";GM_setValue("eha_"+a,true)}else if(c.innerHTML.indexOf("▼")!==-1){c.innerHTML=c.innerHTML.replace("▼","▶").replace(":"," ");document.getElementById("ehd_"+a+"_"+b).style.display="none";GM_setValue("eha_"+a,false)}}}"use strict";var GM_STORAGE_PREFIX="******FiMFiction Enhancements***";var bGreasemonkeyServiceDefined=false;try{if(typeof Components.interfaces.gmIGreasemonkeyService==="object"){bGreasemonkeyServiceDefined=true}}catch(err){}if(typeof unsafeWindow==="undefined"||!bGreasemonkeyServiceDefined){unsafeWindow=function(){var a=document.createElement("p");a.setAttribute("onclick","return window;");return a.onclick()}()}var i=0;var addEmoticons=GM_getValue("addEmoticons",true);var commentPreview=GM_getValue("commentPreview",true);var ap=GM_getValue("autopreview",false);var fullwidth=GM_getValue("fullWidth",false);var banner=GM_getValue("banner","");var userBanners=GM_getValue("userBanners","");var errmsg502=GM_getValue("errmsg502","502 Bad Gateway");var fboxtitlecolor_bg=GM_getValue("fboxtitlecolor_bg","#297FCF");var fboxtitlecolor_bgh=GM_getValue("fboxtitlecolor_bgh","#429AEB");var fboxtitlecolor_txt=GM_getValue("fboxtitlecolor_txt","#FFFFFF");var characters=GM_getValue("characters","7,11,9,10,8,12,45");var eha_0=GM_getValue("eha_0",true);var eha_1=GM_getValue("eha_1",false);var eha_2=GM_getValue("eha_2",false);var eha_3=GM_getValue("eha_3",false);var eha_4=GM_getValue("eha_4",false);var eha_5=GM_getValue("eha_5",false);var error502=document.body.innerHTML.indexOf("<center><h1>502 Bad Gateway</h1></center>")!==-1;var settingsPage=/manage_user\/scriptsettings/.test(self.location.href);var blogEdit=/manage_user\/edit_blog_post/.test(self.location.href);var blogPage=/blog\//.test(self.location.href);var groupThread=/view=group/.test(self.location.href)&&/thread=/.test(self.location.href);var notificationsPage=/manage_user\/notifications/.test(self.location.href);var userPage=/\/user\//.test(self.location.href);var storyPage=/story\//.test(self.location.href)||/chapter\//.test(self.location.href);var username="";var userid="none";var redname=false;var user_toolbar=document.getElementsByClassName("user_toolbar")[0];if(user_toolbar!=null){var innerdiv_ut=user_toolbar.getElementsByClassName("menu_list")[0];innerdiv_ut.innerHTML=innerdiv_ut.innerHTML.replace("Edit Account</a>",'Edit Account</a><a href="/manage_user/avatar" class="button"><img src="//static.fimfiction.net/images/icons/image.png">Change Avatar</a>');innerdiv_ut.innerHTML=innerdiv_ut.innerHTML.replace("Groups</a>",'Groups</a><a class="button" href="/manage_user/blocked_users"><img src="//static.fimfiction.net/images/icons/error.png">Blocked Users</a><a class="button" href="/manage_user/scriptsettings"><img src="//static.fimfiction.net/images/icons/dashboard.png">Script Settings</a>');var vmt=innerdiv_ut.getElementsByTagName("input")[0];vmt.addEventListener("change",function(){if(vmt.checked){vmt.checked=confirm("Please confirm that you are of legal age to read sexual or other adult content in your country by clicking OK. Click Cancel if this is not true.")}setCookie("view_mature",vmt.checked,1e4)});if(username===""){username=user_toolbar.getElementsByClassName("user_drop_down_menu")[0].getElementsByClassName("button")[0].href;username=username.substring(username.indexOf("user/")+5);if(username==null){username=""}}}var sideMenu=document.getElementsByClassName("user_cp main")[0];if(sideMenu!=null){var sideTabs=sideMenu.getElementsByClassName("tabs")[0];if(sideTabs!=null){sideTabs.getElementsByClassName("tab")[0].getElementsByTagName("img")[0].src="//static.fimfiction.net/images/icons/settings.png";sideTabs.innerHTML+='<a href="/manage_user/scriptsettings" class="tab'+(settingsPage?" tab_selected":"")+'"><img src="//static.fimfiction.net/images/icons/dashboard.png">Script Settings</a>'}}if((blogPage||storyPage)&&username===""){var e_username=document.getElementById("comment_username");if(e_username!=null&&e_username.value!=null){username=e_username.value}}if(blogPage||storyPage||groupThread){var e_authors=document.getElementsByClassName("author");for(i=0;i<e_authors.length;i++){var e_avatar=e_authors[i].getElementsByClassName("avatar");if(e_avatar!=null&&e_avatar.length>0){var auname=e_avatar[0].parentNode.getElementsByClassName("name")[0].getElementsByTagName("a")[1].innerHTML;if(auname===username){userid=e_avatar[0].src;userid=userid.substring(userid.indexOf("tars/")+5,userid.indexOf("_64"))}}}}if((userid==null||userid===""||userid==="none")&&!/\/manage_user\//.test(self.location.href)){var avatar=document.getElementsByClassName("user_info")[0];if(avatar!=null){avatar=avatar.getElementsByClassName("name")[0].getElementsByClassName("avatar")[0];if(avatar.href.substring(avatar.href.indexOf("user/")+5)===username){userid=avatar.getElementsByTagName("img")[0].src;userid=userid.substring(userid.indexOf("tars/")+5,userid.indexOf("_64"))}}}if(settingsPage){var tableHTML='<table class="properties"><tr><td class="label" style="line-height:1em;text-align:center;" colspan="2"><h2>General</h2></td></tr><tr><td class="label" style="line-height:1em;">More Emoticons</td><td><div><input id="ss_emoticons" type="checkbox"'+(addEmoticons?' checked="true"':"")+'></div></td></tr><tr><td class="label" style="line-height:1em;">Comment Preview</td><td><div><input id="ss_preview" type="checkbox"'+(commentPreview?' checked="true"':"")+'></div></td></tr><tr><td class="label" style="line-height:1em;">Automatically update preview</td><td><div><input id="ss_autoupdate" type="checkbox"'+(ap?' checked="true"':"")+'></div></td></tr><tr><td class="label" style="line-height:1em;">Full-width chapters</td><td><div><input id="ss_fullwidth" type="checkbox"'+(fullwidth?' checked="true"':"")+'></div></td></tr><tr><td class="label">Banner (leave blank for default)</td><td><div><input id="ss_banner" type="text" style="width:85%" value="'+banner+'"><input type="button" style="width:5%;margin-left:1%;" value="Add" id="ss_banner_add"><input type="button" style="width:7%;margin-left:1%;" value="Delete" id="ss_banner_del"><br><select id="ss_banner_dd" onclick="setting_banner_dd();" style="width:100%;"><option value="">Default</option><option value="" disabled="true">Official</option><option value="https://static.fimfiction.net/images/custom_banners/502fiction.jpg">502fiction</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_appledash.jpg">Appledash</option><option value="https://static.fimfiction.net/images/custom_banners/fields.jpg">Fields</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_flittercloudchaser.jpg">Flitter and Cloudchaser</option><option value="https://dl.dropbox.com/u/31471793/FiMFiction/banners/flutterdash.jpg">Flutterdash</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_flutterdash.jpg">Flutterdash 2</option><option value="https://static.fimfiction.net/images/custom_banners/flutterdash.jpg">Flutterdash 3</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_fluttershy.jpg">Fluttershy</option><option value="https://static.fimfiction.net/images/custom_banners/fluttershypinkie.jpg">Fluttershy and Pinkie</option><option value="https://static.fimfiction.net/images/custom_banners/luna.jpg">Luna</a><option value="https://static.fimfiction.net/themes/poni2.0/images/header_title_mdw.png">Mare-Do-Well</option><option value="https://static.fimfiction.net/images/custom_banners/twilestia.jpg">My Faithful Student</option><option value="https://static.fimfiction.net/images/custom_banners/one_year_anniversary.jpg">One Year Anniversary</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_pinkiedash.jpg">Pinkiedash</option><option value="https://static.fimfiction.net/images/custom_banners/pinkiedash.jpg">Pinkiedash 2</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_rainbowdash.jpg">Rainbow Dash</option><option value="https://static.fimfiction.net/themes/poni2.0/images/header_title_pet.png">Rainbow Dash and Tank</option><option value="https://static.fimfiction.net/images/custom_banners/rarijack.jpg">Rarijack</option><option value="https://static.fimfiction.net/images/custom_banners/header_title_reu.png">Reuniclus Edition</option><option value="https://static.fimfiction.net/images/custom_banners/fwf.jpg">Running of the Leaves</option><option value="https://static.fimfiction.net/images/custom_banners/scootaloo.jpg">Scootaloo</option><option value="https://static.fimfiction.net/images/custom_banners/theshadytrough.jpg">The Shady Trough</option><option value="https://static.fimfiction.net/images/custom_banners/stealth.jpg">Stealth</option><option value="https://static.fimfiction.net/images/custom_banners/trees.jpg">Trees</option><option value="https://static.fimfiction.net/images/custom_banners/twidash.jpg">Twidash</option><option value="https://static.fimfiction.net/images/custom_banners/twilightlicious.jpg">Twilightlicious</option><option value="https://static.fimfiction.net/images/custom_banners/twixie.jpg">Twixie</option><option value="" disabled="true">Official - Stories</option><option value="https://static.fimfiction.net/images/custom_banners/the_63rd_rune.jpg">The 63rd Rune</option><option value="https://static.fimfiction.net/images/custom_banners/the_ambassadors_son.jpg">The Ambassador\'s Son</option><option value="https://static.fimfiction.net/images/custom_banners/images/header_title_antipodes.png">Antipodes</option><option value="https://static.fimfiction.net/images/custom_banners/the_elements_of_discord.jpg">The Elements of Discord</option><option value="https://static.fimfiction.net/images/custom_banners/equestrians_in_undergarments.jpg">Equestrians in Undergarments</option><option value="https://static.fimfiction.net/images/custom_banners/harmony.jpg">Harmony</option><option value="" disabled="true">User-created</option><option value="https://dl.dropbox.com/u/31471793/FiMFiction/banners/veggie55_v1.png">Veggie55 v1 (art by veggie55-Manfaceplz)</option></select></div></td></tr><tr><td class="label">502 error message</td><td><div><input id="ss_errmsg502" type="text" style="width:100%" value="'+errmsg502+'"></div></td></tr><tr><td class="label" style="line-height:1em;text-align:center;" colspan="2"><h2>Colors</h2></td></tr><tr><td class="label">Featured Title Background</td><td><div><input id="ss_fboxtitlecolor_bg" type="text" style="color:#000000;background-color:'+fboxtitlecolor_bg+';" value="'+fboxtitlecolor_bg+'"></div></td></tr><tr><td class="label">Featured Title Background (hover)</td><td><div><input id="ss_fboxtitlecolor_bgh" type="text" style="color:#000000;background-color:'+fboxtitlecolor_bgh+';" value="'+fboxtitlecolor_bgh+'"></div></td></tr><tr><td class="label">Featured Title Text</td><td><div><input id="ss_fboxtitlecolor_txt" type="text" style="color:#000000;background-color:'+fboxtitlecolor_txt+';" value="'+fboxtitlecolor_txt+'"></div></td></tr><tr><td class="label" style="line-height:1em;text-align:center;" colspan="2"><h2>Characters in the Browse dropdown thing</h2></td></tr><tr><td colspan="2"><center><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"><a class="select_character"><input type="checkbox" class="included" style="display:none;" value="7"><img title="Twilight Sparkle" class="archive_character" style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/twilight_sparkle.png\');opacity:0.5;" id="7" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" class="included" style="display:none;" value="8"><img title="Rainbow Dash" class="archive_character" style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/rainbow_dash.png\');opacity:0.5;" id="8" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" class="included" style="display:none;" value="9"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/pinkie_pie.png\');opacity:0.5;" id="9" title="Pinkie Pie" class="archive_character" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" class="included" style="display:none;" value="10"><img id="10" title="Applejack" class="archive_character" style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/applejack.png\');opacity:0.5;" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" class="included" style="display:none;" value="11"><img id="11" title="Rarity" class="archive_character" style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/rarity.png\');opacity:0.5;" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" class="included" style="display:none;" value="12"><img id="12" title="Fluttershy" class="archive_character" style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/fluttershy.png\');opacity:0.5;" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="16" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/spike.png\');opacity:0.5;" class="archive_character" title="Spike" id="16" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="74" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/main_6.png\');opacity:0.5;" class="archive_character" title="Main 6" id="74" src="//static.fimfiction.net/images/selected/neutral.png" width="64" height="32"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="13" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/apple_bloom.png\');opacity:0.5;" class="archive_character" title="Apple Bloom" id="13" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="14" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/scootaloo.png\');opacity:0.5;" class="archive_character" title="Scootaloo" id="14" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="15" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/sweetie_belle.png\');opacity:0.5;" class="archive_character" title="Sweetie Belle" id="15" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="75" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/cmc.png\');opacity:0.5;" class="archive_character" title="Cutie Mark Crusaders" id="75" src="//static.fimfiction.net/images/selected/neutral.png" width="64" height="32"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="17" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/celestia.png\');opacity:0.5;" class="archive_character" title="Princess Celestia" id="17" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="18" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/princess_luna.png\');opacity:0.5;" class="archive_character" title="Princess Luna" id="18" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="54" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/nightmare_moon.png\');opacity:0.5;" class="archive_character" title="Nightmare Moon" id="54" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="19" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/gilda.png\');opacity:0.5;" class="archive_character" title="Gilda" id="19" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="20" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/zecora.png\');opacity:0.5;" class="archive_character" title="Zecora" id="20" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="21" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/trixie.png\');opacity:0.5;" class="archive_character" title="Trixie" id="21" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="30" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/cherilee.png\');opacity:0.5;" class="archive_character" title="Cheerilee" id="30" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="31" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/the_mayor.png\');opacity:0.5;" class="archive_character" title="The Mayor" id="31" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="32" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/hoity_toity.png\');opacity:0.5;" class="archive_character" title="Hoity Toity" id="32" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="33" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/photo_finish.png\');opacity:0.5;" class="archive_character" title="Photo Finish" id="33" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="34" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/sapphire_shores.png\');opacity:0.5;" class="archive_character" title="Sapphire Shores" id="34" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="35" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/spitfire.png\');opacity:0.5;" class="archive_character" title="Spitfire" id="35" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="36" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/soarin.png\');opacity:0.5;" class="archive_character" title="Soarin" id="36" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="37" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/prince_blueblood.png\');opacity:0.5;" class="archive_character" title="Prince Blueblood" id="37" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="38" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/little_strongheart.png\');opacity:0.5;" class="archive_character" title="Little Strongheart" id="38" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="53" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/discord.png\');opacity:0.5;" class="archive_character" title="Discord" id="53" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="58" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/mare_do_well.png\');opacity:0.5;" class="archive_character" title="Mare Do Well" id="58" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="60" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/fancypants.png\');opacity:0.5;" class="archive_character" title="Fancypants" id="60" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="63" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/daring_do.png\');opacity:0.5;" class="archive_character" title="Daring Do" id="63" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="65" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/flimflamicon.png\');opacity:0.5;" class="archive_character" title="Flim and Flam" id="65" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="66" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/cranky doodle icon.png\');opacity:0.5;" class="archive_character" title="Cranky Doodle Donkey" id="66" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="67" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/matilda icon.png\');opacity:0.5;" class="archive_character" title="Matilda" id="67" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="68" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/mr cake icon.png\');opacity:0.5;" class="archive_character" title="Mr. Cake" id="68" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="69" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/mrs cake icon.png\');opacity:0.5;" class="archive_character" title="Mrs. Cake" id="69" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="71" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/ironwillicon.png\');opacity:0.5;" class="archive_character" title="Iron Will" id="71" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="72" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/Cadence.png\');opacity:0.5;" class="archive_character" title="Princess Cadence" id="72" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="73" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/shining-armor.png\');opacity:0.5;" class="archive_character" title="Shining Armor" id="73" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="76" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/wonderbolts.png\');opacity:0.5;" class="archive_character" title="Wonderbolts" id="76" src="//static.fimfiction.net/images/selected/neutral.png" width="64" height="32"></a> <a class="select_character"><input type="checkbox" value="77" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/diamond_dogs.png\');opacity:0.5;" class="archive_character" title="Diamond Dogs" id="77" src="//static.fimfiction.net/images/selected/neutral.png" width="64" height="32"></a> <a class="select_character"><input type="checkbox" value="78" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/queen-chrysalis.png\');opacity:0.5;" class="archive_character" title="Queen Chrysalis" id="78" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="22" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/big_mac.png\');opacity:0.5;" class="archive_character" title="Big Macintosh" id="22" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="23" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/granny_smith.png\');opacity:0.5;" class="archive_character" title="Granny Smith" id="23" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="24" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/braeburn.png\');opacity:0.5;" class="archive_character" title="Braeburn" id="24" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="25" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/diamond_tiara.png\');opacity:0.5;" class="archive_character" title="Diamond Tiara" id="25" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="26" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/silver_spoon.png\');opacity:0.5;" class="archive_character" title="Silver Spoon" id="26" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="27" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/twist.png\');opacity:0.5;" class="archive_character" title="Twist" id="27" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="28" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/snips.png\');opacity:0.5;" class="archive_character" title="Snips" id="28" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="29" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/snails.png\');opacity:0.5;" class="archive_character" title="Snails" id="29" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="55" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/pipsqueak.png\');opacity:0.5;" class="archive_character" title="Pipsqueak" id="55" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="39" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/angel.png\');opacity:0.5;" class="archive_character" title="Angel" id="39" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="40" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/winona.png\');opacity:0.5;" class="archive_character" title="Winona" id="40" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="41" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/opalescence.png\');opacity:0.5;" class="archive_character" title="Opalescence" id="41" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="42" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/gummy.png\');opacity:0.5;" class="archive_character" title="Gummy" id="42" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="43" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/owlowiscious.png\');opacity:0.5;" class="archive_character" title="Owlowiscious" id="43" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="44" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/philomena.png\');opacity:0.5;" class="archive_character" title="Philomena" id="44" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="59" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/tank.png\');opacity:0.5;" class="archive_character" title="Tank" id="59" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="45" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/derpy_hooves.png\');opacity:0.5;" class="archive_character" title="Derpy Hooves" id="45" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="46" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/lyra.png\');opacity:0.5;" class="archive_character" title="Lyra" id="46" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="47" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/bon_bon.png\');opacity:0.5;" class="archive_character" title="Bon-Bon" id="47" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="48" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/dj_pon3.png\');opacity:0.5;" class="archive_character" title="DJ P0N-3" id="48" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="50" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/caramel.png\');opacity:0.5;" class="archive_character" title="Caramel" id="50" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="51" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/doctor_whooves.png\');opacity:0.5;" class="archive_character" title="Doctor Whooves" id="51" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="52" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/octavia.png\');opacity:0.5;" class="archive_character" title="Octavia" id="52" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="56" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/berry_punch.png\');opacity:0.5;" class="archive_character" title="Berry Punch" id="56" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="57" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/carrot_top.png\');opacity:0.5;" class="archive_character" title="Carrot Top" id="57" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="82" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/roseluck.png\');opacity:0.5;" class="archive_character" title="Roseluck" id="82" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="61" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/fleur_de_lis.png\');opacity:0.5;" class="archive_character" title="Fleur de Lis" id="61" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="64" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/colgateicon.png\');opacity:0.5;" class="archive_character" title="Colgate" id="64" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="70" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/dinkyicon.png\');opacity:0.5;" class="archive_character" title="Dinky Hooves" id="70" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="79" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/thunderlane.png\');opacity:0.5;" class="archive_character" title="Thunderlane" id="79" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="80" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/flitter_and_cloudchaser.png\');opacity:0.5;" class="archive_character" title="Flitter and Cloudchaser" id="80" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="81" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/rumble.png\');opacity:0.5;" class="archive_character" title="Rumble" id="81" src="//static.fimfiction.net/images/selected/neutral.png"></a></div><div style="border:1px solid #ccc;padding:5px;display:inline-block;background-color:#FFF;margin:2px;height:32px;"> <a class="select_character"><input type="checkbox" value="49" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/oc.png\');opacity:0.5;" class="archive_character" title="Original Character" id="49" src="//static.fimfiction.net/images/selected/neutral.png"></a> <a class="select_character"><input type="checkbox" value="62" style="display:none;" class="included"><img style="background-repeat:no-repeat;background-position:center center;background-image:url(\'//static.fimfiction.net/images/characters/other.png\');opacity:0.5;" class="archive_character" title="Other" id="62" src="//static.fimfiction.net/images/selected/neutral.png"></a></div></center></td></tr></table>';if(error502){document.title="Script Settings - 502fiction.net";document.body.innerHTML=tableHTML}else{setTitle("Script Settings");var innerContent=document.getElementsByClassName("content_background")[0].getElementsByClassName("inner")[0].getElementsByClassName("content_box user_cp_content_box ")[0];if(innerContent!=null){document.getElementsByClassName("content_box_header")[0].innerHTML="<h2>Script Settings</h2>";document.getElementsByClassName("user_cp main")[0].innerHTML+=tableHTML}}document.getElementById("ss_emoticons").addEventListener("click",setting_emoticons);document.getElementById("ss_preview").addEventListener("click",setting_preview);document.getElementById("ss_autoupdate").addEventListener("click",setting_autoupdate);document.getElementById("ss_fullwidth").addEventListener("click",setting_fullwidth);document.getElementById("ss_banner").addEventListener("input",setting_banner);document.getElementById("ss_banner_dd").addEventListener("change",setting_banner_dd);document.getElementById("ss_banner_dd").addEventListener("keydown",function(){setTimeout(setting_banner_dd,10)});document.getElementById("ss_banner_add").addEventListener("click",setting_banner_add);document.getElementById("ss_banner_del").addEventListener("click",setting_banner_del);document.getElementById("ss_errmsg502").addEventListener("input",setting_errmsg502);document.getElementById("ss_fboxtitlecolor_bg").addEventListener("input",setting_fbc1);document.getElementById("ss_fboxtitlecolor_bgh").addEventListener("input",setting_fbc2);document.getElementById("ss_fboxtitlecolor_txt").addEventListener("input",setting_fbc3);var e=document.getElementById("ss_banner_dd");if(userBanners!=null&&userBanners!==""&&userBanners.split("").length>1){var txt=e.innerHTML+'<option value="" disabled="true">Custom URLs</option>';var uba=userBanners.split("");for(i=0;i<uba.length;i+=2){txt+='<option value="'+uba[i]+'">'+uba[i+1]+"</option>"}e.innerHTML=txt}if(banner===""){e.selectedIndex=0}else{for(i=2;i<e.options.length;i++){if(banner===e.options[i].value){e.selectedIndex=i;break}}}var selectchars=document.getElementsByClassName("select_character");var arraay=characters.split(",");if(arraay.length>0){for(i=0;i<arraay.length;i++){for(var j=0;j<selectchars.length;j++){if(selectchars[j].innerHTML.indexOf('value="'+arraay[i]+'"')!==-1){selectchars[j].innerHTML=selectchars[j].innerHTML.replace("opacity:0.5","opacity:1.0");break}}}}for(i=0;i<selectchars.length;i++){(function(a){selectchars[a].addEventListener("click",function(){setting_character(a)})})(i)}}else if(error502){document.body.innerHTML=document.body.innerHTML.replace("502 Bad Gateway",errmsg502);addEmoticons=false}else if(notificationsPage){setTitle("Notifications");var notifications=document.getElementsByClassName("notification");for(i=0;i<notifications.length;i++){if(notifications[i].innerHTML.indexOf('"></a>')!==-1&&notifications[i].innerHTML.indexOf("blog")!==-1){notifications[i].innerHTML=notifications[i].innerHTML.replace('"></a>','">Untitled</a>')}}}else if(/page=banner_credits/.test(self.location.href)){setTitle("Banner Credits")}else if(/view=category/.test(self.location.href)){if(/&read_it_later/.test(self.location.href)){setTitle("Read Later")}else if(/&tracking=1&order=updated&unread=1/.test(self.location.href)){setTitle("Favorites")}}else if(/manage_user\/blog/.test(self.location.href)){setTitle("Manage Blog")}else if(storyPage){if(fullwidth){var container=document.getElementById("chapter_container");if(container!=null){container.setAttribute("style","max-width:100%");container.getElementsByClassName("inner_margin")[0].setAttribute("style","max-width:100%")}}}else if(userPage){var lc=document.getElementsByClassName("left_column")[0];if(lc!=null){lc.setAttribute("style","padding-right:13px;")}}else if(blogPage){var infobox=document.getElementsByClassName("information_box")[0];if(infobox!=null){redname=infobox.getElementsByTagName("a")[0].innerHTML===username;var ownpost=infobox.innerHTML.indexOf('Posted by <a href="/user/'+username+'">')!==-1;infobox.innerHTML+='<a href="'+self.location.href.replace("/blog/","/manage_user/edit_blog_post/")+(ownpost?'">Edit':'#view">View')+" BBcode</a>"}}else if(blogEdit){if(/#view/.test(self.location.href)){document.getElementsByClassName("content_box_header")[0].innerHTML="<h2>View Blog Post</h2>";var tbody=document.getElementsByClassName("properties")[0].getElementsByTagName("tbody")[0];tbody.removeChild(tbody.getElementsByTagName("tr")[2])}else{var e_blog_title=document.getElementById("blog_title");if(e_blog_title!=null&&e_blog_title.value===""){e_blog_title.setAttribute("value","Untitled")}}}else if(groupThread){var ep=document.getElementsByClassName("emoticons_panel")[0];if(ep!=null){ep.style.width="320px"}var cc=document.getElementById("comment_comment");if(cc!=null){cc.parentNode.parentNode.style.marginRight="320px"}}else{addEmoticons=false;commentPreview=false}GM_addStyle("div.add_comment div.emoticons_panel{height:400px;}div.add_comment div.textbox_container textarea{height:380px;}");if(!error502&&banner!==""){GM_addStyle('div.header div.title{background-image:url("'+banner+'") !important;}')}var home_link=document.getElementsByClassName("home_link")[0];if(home_link!=null){home_link.style.backgroundImage='url("http://static.fimfiction.net/images/twibop.gif")';home_link.style.width="128px";home_link.style.height="128px";home_link.style.marginLeft="-438px";home_link.style.top="73px";if(banner.indexOf("//static.fimfiction.net/images/custom_banners/twilightlicious.jpg")===-1){home_link.style.display="none"}}if(fboxtitlecolor_bg!==""){GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a{background-color:"+fboxtitlecolor_bg+" !important;}")}if(fboxtitlecolor_bgh!==""){GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a:hover{background-color:"+fboxtitlecolor_bgh+" !important;}")}if(fboxtitlecolor_txt!==""){GM_addStyle("div.header div.title div.featured_box div.text_container h1.title a{color:"+fboxtitlecolor_txt+" !important;}")}var fboxoverlay=document.getElementsByClassName("featured_box_overlay_left")[0];if(fboxoverlay!=null){fboxoverlay.parentNode.removeChild(fboxoverlay)}fboxoverlay=document.getElementsByClassName("featured_box_overlay_right")[0];if(fboxoverlay!=null){fboxoverlay.parentNode.removeChild(fboxoverlay)}var browsething=document.getElementsByClassName("drop_down_container")[0];if(browsething!=null){browsething=browsething.getElementsByClassName("container")[0];if(browsething!=null){browsething=browsething.getElementsByClassName("panel")[0];if(browsething!=null){browsething=browsething.getElementsByClassName("section")[1];if(browsething!=null){var arraay=characters.split(",");if(arraay.length>0){var defaultchars=browsething.getElementsByTagName("a");var teckzt="";if(defaultchars.length===9||defaultchars.length===10){var i1=defaultchars.length-1;var i2=defaultchars.length-7;for(i=i1;i>i2;i--){if(defaultchars[i].innerHTML.indexOf("images/characters")!==-1){defaultchars[i].parentNode.removeChild(defaultchars[i])}}}else{teckzt="<br>"}teckzt+="<div>";for(i=0;i<arraay.length;i++){teckzt+='<a href="/index.php?view=category&characters%5B%5D='+arraay[i]+'"><img src="//static.fimfiction.net/images/characters/'+getCharImg(arraay[i])+'.png"></a>';if(i%6===5){teckzt+='</div><div style="margin-top:4px;">'}else if(i!==arraay.length){teckzt+=" "}}teckzt+="</div>";browsething.innerHTML+=" "+teckzt}}}}}var opentags=null,crlf2br=true,urlstart=-1,tagname_re=/^\/?(?:b|i|u|center|color|size|quote|strike|url|youtube|hr|img|smcaps|email|s)$/,number_re=/^[\\.0-9]{1,8}$/i,uri_re=/^[-;\/\?:@&=\+\$,_\.!~\*'\(\)%0-9a-z#]{1,512}$/i,postfmt_re=/([\r\n])|(?:\[([a-z]{1,16})(?:=([^\x00-\x1F"'\(\)<>\[\]]{1,256}))?\])|(?:\[\/([a-z]{1,16})\])/ig;var commentForm=document.getElementById("comment_form");if(commentForm!=null){if(commentPreview){var pbtncode=' <input type="button" id="previewbtn" value="Preview" class="styled_button">';var addbtncode="";if(groupThread||userPage){addbtncode='<input id="add_comment_submit" class="styled_button" onclick="$(\'#comment_form\').submit();" value="Add Comment" type="button">';var addbtn=document.getElementById("add_comment_submit");addbtn.parentNode.removeChild(addbtn)}var startcode=userPage?'<div style="margin:10px; font-size:0.8em;">':'<div style="margin:10px;">';commentForm.innerHTML=commentForm.innerHTML.replace(startcode,startcode+pbtncode+addbtncode);document.getElementById("previewbtn").addEventListener("click",preview);document.getElementById("comment_comment").addEventListener("keyup",function(){if(ap)preview()})}var light_toolbar=document.getElementsByClassName("light_toolbar");for(i=0;i<light_toolbar.length;i++){if(light_toolbar[i].id.indexOf("report_chapter")===-1){addTBB(light_toolbar[i],i)}}}var emoticons=["ajbemused","ajsleepy","ajsmug","applecry","applejackconfused","applejackunsure","coolphoto","derpyderp1","derpyderp2","derpytongue2","fluttercry","flutterrage","fluttershbad","fluttershyouch","fluttershysad","heart","pinkiecrazy","pinkiegasp","pinkiehappy","pinkiesad2","pinkiesick","pinkiesmile","rainbowderp","rainbowdetermined2","rainbowhuh","rainbowkiss","rainbowlaugh","rainbowwild","raritycry","raritydespair","raritystarry","raritywink","scootangel","trixieshiftleft","trixieshiftright","twilightangry2","twilightblush","twilightoops","twilightsheepish","twilightsmile","twistnerd","unsuresweetie","yay","trollestia","moustache","facehoof","eeyup","duck"];if(addEmoticons&&blogEdit){var form=document.getElementById("edit_story_form");if(form!=null){unsafeWindow.smilie=function(a){InsertTextAt(document.getElementById("blog_post_content"),a)};form.innerHTML=form.innerHTML.replace("</textarea>",'</textarea><div class="emoticons_panel"><div class="inner_padding"></div></div>')}}var txtToAdd="";addEmoticonsF(null,0)