// ==UserScript==
// @name        Switch Mafia Pokes 
// @namespace   Mafiawars by Zynga
// @description Switch Mafia Profile On FB / Black Frame / Auto Pokes / Bookmarklet Page / Mafia Bonus
// @icon        http://lockupmwm.webs.com/gambor/mwmsmall1.png
// @include     http://www.facebook.com/*
// @exclude     http://mwfb.zynga.com/mwfb/*#*
// @exclude     http://www.facebook.com/plugins/*
// @exclude     http://www.facebook.com/dialog/feed*
// @include     http://apps.facebook.com/inthemafia/*
// @exclude     http://apps.new.facebook.com/inthemafia/*
// @include     http://www.facebook.com/connect/uiserver*
// @exclude 	http://www.facebook.com/dialog/apprequests*
// @exclude     http://facebook.mafiawars.zynga.com/mwfb/*#*
// @exclude     http://www.facebook.com/plugins/likebox.php*
// @include     http://mwfb.zynga.com/mwfb/remote/html_server.php*
// @exclude     http://apps.facebook.com/inthemafia/sk_updater.php*
// @exclude     http://facebook.mafiawars.zynga.com/mwfb/xd_receiver.htm*
// @exclude     http://facebook.mafiawars.zynga.com/mwfb/iframe_proxy.php*
// @include     http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @exclude     http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?xw_controller=requests*
// @exclude     http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?xw_controller=freegifts*
// @include     https://www.facebook.com/*
// @exclude     https://mwfb.zynga.com/mwfb/*#*
// @exclude     https://www.facebook.com/plugins/*
// @exclude     https://www.facebook.com/dialog/feed*
// @include     https://apps.facebook.com/inthemafia/*
// @exclude     https://apps.new.facebook.com/inthemafia/*
// @include     https://www.facebook.com/connect/uiserver*
// @exclude 	https://www.facebook.com/dialog/apprequests*
// @exclude     https://facebook.mafiawars.zynga.com/mwfb/*#*
// @include     https://mwfb.zynga.com/mwfb/remote/html_server.php*
// @exclude     https://apps.facebook.com/inthemafia/sk_updater.php*
// @exclude     https://facebook.mafiawars.zynga.com/mwfb/xd_receiver.htm*
// @include     https://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @exclude     https://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?xw_controller=requests*
// @exclude     https://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php?xw_controller=freegifts*
// @version     Mafia Black.〤
// ==/UserScript==

function fb_ap_lw(){if(typeof Arbiter=="undefined"){window.setTimeout(fb_ap_lw,100)}else{function a(){console.log("Facebook Autopoke Lightweight - Finding Pokes");var a=document.getElementsByClassName("pokesDashboard")[0].getElementsByClassName("uiIconText"),b;console.log(a);for(i in a){if(a.hasOwnProperty(i)){try{a[i].click()}catch(c){try{b=document.createEvent("MouseEvents");b.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a[i].dispatchEvent(b)}catch(d){if(d.message!="Object 1 has no method 'dispatchEvent'"){console.error(c.message);console.error(d.message)}}}}}}Arbiter.subscribe("channel/message:live_poke",function(){window.setTimeout(a,500)});a();console.log("Facebook Autopoke Lightweight - Successful Load");window.setTimeout(function(){window.location.reload()},6e5)}}function fb_ap_lw_dt(){if(typeof DocumentTitle=="undefined"){window.setTimeout(fb_ap_lw_dt,100)}else{DocumentTitle.set(DocumentTitle.get()+" (Automatic)")}}function injectScript(a){var b=function(a){return Object.prototype.toString.call(a)=="[object Function]"};var c=function(a){if(!a||!a.length)return a;var b=/['"<>\/]/g,c="",d=0,e;do{e=b.exec(a);c+=e?a.substring(d,b.lastIndex-1)+"\\x"+e[0].charCodeAt(0).toString(16):a.substring(d)}while(e&&(d=b.lastIndex)>0);return c.length?c:a};var d=b(a);var e=document.createElement("script");var f,g,h="";if(d){var i=[];for(var j=1;j<arguments.length;j++){var k=arguments[j];var l;if(b(k))l='eval("'+c("("+k.toString()+")")+'")';else if(Object.prototype.toString.call(k)=="[object Date]")l="(new Date("+k.getTime().toString()+"))";else if(Object.prototype.toString.call(k)=="[object RegExp]")l="(new RegExp("+k.toString()+"))";else if(typeof k==="string"||typeof k==="object")l='JSON.parse("'+c(JSON.stringify(k))+'")';else l=k.toString();i.push(l)}while(h.length<16)h+=String.fromCharCode(!h.length||Math.random()>.5?97+Math.floor(Math.random()*25):48+Math.floor(Math.random()*9));f="(function(){var value={callResult: null, throwValue: false};try{value.callResult=(("+a.toString()+")("+i.join()+"));}catch(e){value.throwValue=true;value.callResult=e;};"+"document.getElementById('"+h+"').innerText=JSON.stringify(value);})();";e.id=h}else{f=a}e.type="text/javascript";e.innerHTML=f;document.head.appendChild(e);if(d){g=JSON.parse(e.innerText);e.parentNode.removeChild(e);delete e;if(g.throwValue)throw g.callResult;else return g.callResult}else return e}function x$(a,b){b=b||document;return document.evaluate(a,b,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function aboveTheFrame(){var a=x$('//iframe[@class="canvas_iframe_util"]');if(a!==null){var b=document.createElement("div");b.innerHTML='<span style="font-weight: bold; font-size: 14px;"><a target="_blank" href="http://userscripts.org/scripts/show/149027">Switch Mafia Pokes</a> | '+'<a id="UpD">Check for updates</a> | '+'<a target="_blank" href="http://tinyurl.com/emailbonuslink">Email Bonus</a> | '+'<a target="_blank" href="http://tinyurl.com/zyngabonuslink">Zynga Bonus</a> | '+'<a target="_blank" href="http://tinyurl.com/3xspin">3 Free Spins</a> | '+'<a target="_blank" href="http://mwlootlady.blogspot.com/">MW Loot Lady</a> | '+'<a target="_blank" href="https://www.facebook.com/groups/mafiawarsmalaysiaworld/">ℳ₩♏₩ Group</a> | '+'<a target="_blank" href="https://www.facebook.com/MafiaWarsAddon">MW AddOn</a> | '+'<a target="_blank" href="https://www.facebook.com/mafiatools">Spockholm</a> | '+'<a target="_blank" href="https://www.facebook.com/mwscripts">Lucifers</a> | '+'<a target="_blank" href="https://www.facebook.com/pages/GuessX-Scripts/131414080285469">Guess〤</a>'+"</span>";a.parentNode.insertBefore(b,a);document.getElementById("UpD").addEventListener("click",updateCheck,false)}}body=document.body;if(body!=null){var twsis="";div=document.createElement("div");div.style.position="fixed";div.style.bottom="+50px";div.style.left="+12px";div.style.padding="2px";div.innerHTML="<a style=\"font-weight:bold;color:#000000\" target='_blank' href='https://www.facebook.com/mafiawarsmalaysiaworld' title='Mafia Wars Malaysia World'><img src='http://i49.servimg.com/u/f49/11/59/11/00/elite_10.gif' height='100' width='100'></img></a>";div2=document.createElement("div");div2.style.position="fixed";div2.style.bottom="+20px";div2.style.left="+15px";div2.style.padding="2px";div2.innerHTML="<a style=\"font-weight:bold;color:#FFFFFF\" target='_top' href='javascript:%28function%28%29%7Bif%28%2Fapps.facebook.com.inthemafia%2F.test%28document.location%29%29%7Bfor%28var%20i%3D0%3Bi%3Cdocument.forms.length%3Bi%2B%2B%29%7Bif%28%2F%5Ecanvas_iframe_post%2F.test%28document.forms%5Bi%5D.id%29%29%7Bdocument.forms%5Bi%5D.target%3D%27%27%3Bdocument.forms%5Bi%5D.submit%28%29%3Breturn%3B%7D%7D%7Delse%20if%28document.getElementById%28%27some_mwiframe%27%29%29%7Bwindow.location.href%3Ddocument.getElementById%28%27some_mwiframe%27%29.src%3Breturn%3B%7Delse%7Bfunction%20get_id_from_game%28%29%7Btry%7Bif%28m%3D%2Fxw_controller%3Drobbing.%2A%3Ftarget%3D%28%5B0-9%5D%2B%29%2F.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28m%3D%2Fxw_controller%3Dstats.%2A%3Fuser%3D%28%5B0-9%5D%2B%29%2F.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28m%3D%2Fxw_action%3Dgift_wishlist.%2A%3Fuser%3D%28%5B0-9%5D%2B%29%2F.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28m%3D%2Fq%28%5B0-9%5D%2B%29_%28%5Cd%2B%29%5C.jpg%2F.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28document.getElementsByClassName%28%27fightres_image%27%29.length%3E1%29%7Bvar%20fight_image%3D%2F%28%5Cd%2B%29_%28%5Cd%2B%29_q.jpg%2F.exec%28document.getElementsByClassName%28%27fightres_image%27%29%5B1%5D.innerHTML%29%3Breturn%20fight_image%5B1%5D%3B%7Dif%28m%3D%2Fxw_controller%3DVegasSlots.%2B%3Ffriend_id%3D%28%5B0-9%5D%2B%29%2Fi.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28m%3D%2F%28%5B0-9%5D%2B%29_%28%5Cd%2B%29%5C_q.jpg%2F.exec%28document.getElementById%28%27inner_page%27%29.innerHTML%29%29%7Breturn%20m%5B1%5D%3B%7Dif%28%28m%3D%2Fuser%252522.%2A%3F%252522%28%5B0-9A-Za-z%25%5D%2B%29%252522%2F.exec%28document.getElementById%28%27mainDiv%27%29.innerHTML%29%29%7C%7C%28m%3D%2Fuser%2522.%2A%3F%2522%28%5B0-9A-Za-z%25%5D%2B%29%2522%2F.exec%28document.getElementById%28%27mainDiv%27%29.innerHTML%29%29%29%7Breturn%20atob%28m%5B1%5D.replace%28%2F%25253D%2Fg%2C%27%3D%27%29.replace%28%2F%253D%2Fg%2C%27%3D%27%29%29%3B%7D%7Dcatch%28err%29%7B%7Dreturn%20null%3B%7Dfunction%20get_id_from_fb%28%29%7Bfunction%20f%28expr%29%7Btry%7Breturn%2Frid%3D%28%5B0-9%5D%2B%29%2F.exec%28eval%28expr%29%29%5B1%5D%3B%7Dcatch%28e%29%7Breturn%20null%3B%7D%7Dfunction%20reportid%28expr%29%7Btry%7Breturn%2Fcid%3D%28%5B0-9%5D%2B%29%2F.exec%28eval%28expr%29%29%5B1%5D%3B%7Dcatch%28e%29%7Breturn%20null%3B%7D%7Dfunction%20newfb%28expr%29%7Btry%7Breturn%2F%28%5Cd%2B%29_%28%5Cd%2B%29_%28%5Cd%2B%29%5C_n.jpg%2F.exec%28eval%28expr%29%29%5B2%5D%3B%7Dcatch%28e%29%7Breturn%20null%3B%7D%7Dfunction%20timeline%28expr%29%7Btry%7Breturn%2F%22profile_owner%22%3A%22%28%5Cd%2B%29%22%2F.exec%28eval%28expr%29%29%5B1%5D%3B%7Dcatch%28e%29%7Breturn%20null%3B%7D%7Dfunction%20timeline2%28expr%29%7Btry%7Breturn%2F%22profile_id%22%3A%22%28%5Cd%2B%29%22%2F.exec%28eval%28expr%29%29%5B1%5D%3B%7Dcatch%28e%29%7Breturn%20null%3B%7D%7Dreturn%20timeline%28%22document.getElementById%28%27pagelet_timeline_main_column%27%29.getAttribute%28%27data-gt%27%29%22%29%7C%7Cf%28%22document.getElementById%28%27profile_action_report_block%27%29.innerHTML%22%29%7C%7Cf%28%22document.getElementById%28%27profileimage%27%29.parentNode.innerHTML%22%29%7C%7Cf%28%22document.getElementById%28%27profile_action_send_message%27%29.parentNode.innerHTML%22%29%7C%7Creportid%28%22document.getElementsByClassName%28%27actions%20secondary_actions%27%29%5B0%5D.innerHTML%22%29%7C%7Cnewfb%28%22document.getElementById%28%27profile_pic%27%29.src%22%29%7C%7Ctimeline2%28%22document.getElementsByClassName%28%27fbTimelineScrubber%27%29%5B0%5D.getAttribute%28%27data-gt%27%29%22%29%7C%7Cnull%3B%7Dvar%20http%3D%27http%3A%2F%2F%27%3Bif%28%2Fhttps%2F.test%28document.location%29%29%7Bhttp%3D%27https%3A%2F%2F%27%3B%7Dvar%20id%3Bif%28id%3Dget_id_from_game%28%29%29%7Btop.location.href%3Dhttp%2B%27www.facebook.com%2Fprofile.php%3Fid%3D%27%2Bid%3B%7Delse%20if%28id%3Dget_id_from_fb%28%29%29%7Btop.location.href%3Dhttp%2B%27apps.facebook.com%2Finthemafia%2Ftrack.php%3Fnext_controller%3Dstats%26next_action%3Dview%26next_params%3D%257B%2522user%2522%253A%2522%24ID%2522%257D%27.replace%28%27%24ID%27%2Cid%29%3B%7Delse%7Balert%28%27Could%20not%20find%20an%20id%21%5CnFor%20non-friends%20you%20can%20try%20attacking%20once%20and%20using%20Switch%20on%20the%20fight%20result%20screen.%5CnFor%20friends%20it%20should%20work%20on%20MW%20profile%20pages.%27%29%3B%7D%7D%7D%29%28%29'><img src=https://fbcdn-photos-a.akamaihd.net/photos-ak-snc7/v43/231/10979261223/app_2_10979261223_8090.gif height=20 width=20 alt='Like Comment' title='Switch MW Profile'</img></a>";div3=document.createElement("div");div3.style.position="fixed";div3.style.bottom="+20px";div3.style.left="+45px";div3.style.padding="2px";div3.innerHTML="<a style=\"font-weight:bold;color:#FFFFFF\" target='_blank' href='https://www.facebook.com/?sk=cg'><img src=http://www.picbadges.com/badges-assets/350/2272022_1307692082.png height=20 width=20 alt='Like Comment' title='Applications Feed'</img></a>";div4=document.createElement("div");div4.style.position="fixed";div4.style.bottom="+20px";div4.style.left="+75px";div4.style.padding="2px";div4.innerHTML="<a style=\"font-weight:bold;color:#FFFFFF\" target='_blank' href='http://screepts.com/happyplace/v2/'><img src=http://th01.deviantart.net/fs25/300W/f/2008/148/2/8/Sigil_of_Lucifer_by_Monation.jpg height=20 width=20 alt='Like Comment' title='HappyPlace'</img></a>";div5=document.createElement("div");div5.style.position="fixed";div5.style.bottom="+20px";div5.style.left="+105px";div5.style.padding="2px";div5.innerHTML="<a style=\"font-weight:bold;color:#FFFFFF\" target='_blank' href='https://www.facebook.com/pokes'><img src=http://s3.amazonaws.com/uso_ss/18652/large.png?1348384223 height=20 width=20 alt='Like Comment' title='Auto Pokes'</img></a>";body.appendChild(div);body.appendChild(div2);body.appendChild(div3);body.appendChild(div4);body.appendChild(div5)}console.log("Facebook Autopoke Lightweight - Loading");var s=document.createElement("script");s.textContent=String(fb_ap_lw)+"\n"+String(fb_ap_lw_dt)+"\nfb_ap_lw();fb_ap_lw_dt();";document.head.appendChild(s);document.head.removeChild(s);var SUC_script_num=149027;try{function updateCheck(a){if(a||parseInt(GM_getValue("SUC_last_update","0"))+864e5<=(new Date).getTime()){try{GM_xmlhttpRequest({method:"GET",url:"http://userscripts.org/scripts/source/"+SUC_script_num+".meta.js?"+(new Date).getTime(),headers:{"Cache-Control":"no-cache"},onload:function(b){var c,d,e,f;e=b.responseText;GM_setValue("SUC_last_update",(new Date).getTime()+"");d=parseInt(/@uso:version\s*(.*?)\s*$/m.exec(e)[1]);c=parseInt(GM_getValue("SUC_current_version","-1"));if(c!=-1){f=/@name\s*(.*?)\s*$/m.exec(e)[1];GM_setValue("SUC_target_script_name",f);if(d>c){if(confirm('There is an update available for the Greasemonkey script "'+f+'."\nWould you like to go to the install page now?')){window.location.href="http://userscripts.org/scripts/source/"+SUC_script_num+".user.js";GM_setValue("SUC_current_version",d)}}else if(a)alert('No update is available for "'+f+'."')}else GM_setValue("SUC_current_version",d+"")}})}catch(b){if(a)alert("An error occurred while checking for updates:\n"+b)}}}GM_registerMenuCommand(GM_getValue("SUC_target_script_name","???")+" - Manual Update Check",function(){updateCheck(true)});updateCheck(false)}catch(err){}aboveTheFrame();var myscript=function(){try{document.getElementById("contentCol").removeChild(document.getElementById("rightCol"))}catch(a){}document.getElementById("pagelet_canvas_content").style.width="100%"}();injectScript(myscript)