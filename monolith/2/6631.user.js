// ==UserScript==
// @name           Google Merchant Link Removal
// @namespace      
// @description    Avoid useless search results in Google by filtering out hits that lead to sites that sell stuff.
// @include        http://*google.*/search*
// ==/UserScript==

var filters  = [

  // Generic DNS patterns

  '.buy.',
  '/buy.',
  '.shopping.',
  '/shopping.',
  '.store.',
  '/store.',


  // Multi-TLD DNS names

  '.amazon.',
  '.ciao.',
  '.craigslist.',
  '.ebay.',
  '.expansys.',
  '.idealo.',
  '.insight.',
  '.listpic.',
  '.pricegrabber.',
  '.pricerunner.',
  '.komplett.',
  '.preissuchmaschine.',


  // Explicit DNS names

  '1001case.ro',
  'abcd.com.au',
  'achetezfacile',
  'adart-elektro.cz',
  'alibaba.com',
  'allstarshop.com',
  'apeshop.com',
  'atomicpark.com',
  'auction-warehouse.com',
  'auctions.yahoo.com',
  'audioexpert.sk',
  'auspcmarket.com.au',
  'bestbuy.ca',
  'bidonusa.com',
  'bidorbuy.co.za',
  'bizrate.co.uk',
  'bizrate.com',
  'busytrade.com',
  'buy.com',
  'catmando.com',
  'centralcomputer.com',
  'cheapremotecontrols.com',
  'chiefvalue.com',
  'chillblast.com',
  'circuitcity.com',
  'classifieds.yahoo.com',
  'cleverware.nl',
  'closo.com',
  'comparestoreprices.co.uk',
  'compricer.se',
  'compusa.com',
  'computergoodies.ca',
  'computeruniverse.net',
  'comtec.ca',
  'coolestpc.co.uk',
  'cqout.com',
  'crazypc.com',
  'dabs.com',
  'dbgweb.com',
  'dealtime.co.uk',
  'dealtime.com',
  'decparts.com',
  'digitallowprices.com',
  'direct4games.com',
  'directron.com',
  'dixonsmobileaccessories.co.uk',
  'dooyoo.co.uk',
  'dvdupgrades.ch',
  'ea3w.com',
  'eastluna.com',
  'ebgames.com',
  'ec21.com',
  'electroseller.com',
  'elektromedia.cz',
  'elektropartner.cz',
  'emax.lv',
  'enet.com.cn',
  'epinions.com',
  'eukasa.pl',
  'evendi.de',
  'flash-memory-store.com',
  'frontierpc.com',
  'gamepc.com',
  'gamestop.com',
  'geizhals.at',
  'geizkragen.de',
  'getpartsonline.com',
  'getprice.de',
  'gottadeal.com',
  'guenstiger.de',
  'gumtree.com',
  'heise.de',
  'hifi-regler.de',
  'hifishop.cz',
  'home-elektro.cz',
  'icct.ca',
  'icpsales.com',
  'imarketlive.com',
  'internethity.cz',
  'intozgc.com',
  'it-shop-online.co.uk',
  'itxpressinc',
  'jonczak.pl',
  'jrsystems.co.uk',
  'kalahari.net',
  'kamennyobchod.cz',
  'kasa.cz',
  'keenzo.com',
  'kelkoo.co.uk',
  'kieskeurig.nl',
  'kijiji.ca',
  'kobaltcomputers.co.uk',
  'koridor.cz',
  'korunka.cz',
  'lowestonweb.com',
  'lowpricememory.co.uk',
  'macwarehouse.co.uk',
  'markt.pcwelt.de',
  'matchcomputer.com',
  'megaobchod.cz',
  'memory-configurator.com',
  'memoryforless.co.uk',
  'memoryxsun.com',
  'microdirect.co.uk',
  'microdirect.com',
  'misco.co.uk',
  'mobymemory.com',
  'monarchcomputer.com',
  'mrmdvd.com',
  'mymemory.co.uk',
  'mysimon.com',
  'ncix.com',
  'nejlepsiceny.cz',
  'netdropshipper.com',
  'newegg.com',
  'newman.com',
  'nextag.com',
  'novatech.co.uk',
  'ntcw.com',
  'obchodni-dum.cz',
  'olympusamerica.com',
  'orig.co.uk',
  'outpost.com',
  'overstock.com/',
  'pchome.net',
  'pcpro.co.uk',
  'pcupgrade.co.uk',
  'peats.com',
  'performance-pcs.com',
  'picstop.co.uk',
  'pixmania.co.uk',
  'play-asia.com',
  'pluscorp.com.au',
  'preistrend.de',
  'pricewatch.com',
  'prisjakt.nu',
  'quietpcusa.com',
  'reboot-it.com',
  'remotecontrolsinc.com',
  'replacementremotes.com',
  'resellerratings.com',
  'ritzcamera.com',
  'scan.co.uk',
  'sendit.com',
  'shibby.com.au',
  'shop.by',
  'shopbot.ca',
  'shopbot.com',
  'shopferret.com.au',
  'shopireland.ie',
  'shoplift.com',
  'shopper.cnet.com',
  'sina.com.cn',
  'skycomp.com.au',
  'smarto.se',
  'sony-asia.com',
  'sonystyle.com',
  'soundandvisiononline.com',
  'supercheappc.biz',
  'supermediastore.com',
  'superufo.com',
  'superwarehouse.com',
  'take2.co.za',
  'techbargains.com',
  'tekheads.co.uk',
  'thecoolingshop.com',
  'tigerdirect.ca',
  'tigerdirect.com',
  'tivis.cz',
  'tj.cn',
  'tom.com',
  'toppreise.ch',
  'tradekey.com',
  'trafalgarelectronics.co.uk',
  'unbeatable.co.uk',
  'videoexpert.cz',
  'webkupiec.pl',
  'wolfcamera.com',
  'xpbargains.com',
  'zedesco.com',
  'zol.com.cn',


  // URL paths

  '.product',
  '/acatalog/',
  '/art/',
  '/buy/',
  '/buyselltrade/',
  '/catalog/',
  '/catalogue/',
  '/classifieds/',
  '/details/',
  '/eStore/',
  '/goods/',
  '/merchandise/',
  '/preise/',
  '/prices/',
  '/product/',
  '/products/',
  '/produkt/',
  '/sale/',
  '/shop/',
  '/shopping/',


  // Script names

  'auctions.cgi',
  'Product.asp',

  // Variable names

  'katalognr=',
  'prod=',
  'product_id=',
  'product=',
  'productid=',
  'products_id=',
  'ProductID=',
  'sku=',
];

function filterLinks(filter)
{
  var all_divs, ad_div;
  all_divs = document.evaluate(
    "//a[contains(@href, '" + filter+ "')]",
    document,
    null,
    XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,
    null);

  for (var i = 0; i < all_divs.snapshotLength; ++i)
  {
    ad_div = all_divs.snapshotItem (i);
    if (ad_div.getAttribute("class") == "l")
    {
      var nodeToRemove = ad_div.parentNode.parentNode;
      //nodeToRemove.parentNode.removeChild(nodeToRemove);
      nodeToRemove.setAttribute("align", "right");
      //nodeToRemove.setAttribute("style", "font-size: 8pt");
    }
  }
}

for each (filter in filters)
{
  filterLinks(filter);
}
