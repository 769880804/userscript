// ==UserScript==
// @name           GF Power Bot Tools - Espa√±ol (Version translated)
// @version        20131107a
// @namespace      Translated version.
// @homepage       http://userscripts.org/
// @description    Herramienta avanzada para El Padrino: Las cinco Familias.
// @match          ^
// @match          *://*/*
// @include        ^
// @include        *://*
// ==/UserScript==
(function(){var Ka,La,Ma,wa,Na,Z;function ab(){var a=g("iframe_canvas");if(a){for(a.style.width="100%";(a=a.parentNode)!==null;)if(a.tagName=="DIV")a.style.width="100%";g("rightCol").style.display="none"}else setTimeout(ab,1E3)}function bb(){var a=g("game_frame");if(a){a.style.width="100%";for(a.style.height="1000px";(a=a.parentNode)!==null;)if(a.tagName=="DIV")a.style.width="100%";g("main-nav").parentNode.removeChild(g("main-nav"));g("main-header").parentNode.removeChild(g("main-header"));g("promo-sidebar").style.display=
"none"}else setTimeout(bb,1E3)}function cb(){var a;return a=(a=document.body.className.split(" "))&&a[0]?a[0].replace(/(platforms_|_game)/g,""):"google"}function db(){var a="",b;for(b=0;b<5;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(Math.random()*62));return a}function Oa(){return h("Creado por")+" Tiestoale, mikmeg, Ciccio[TeamDoa]"}function Pa(){var a=cb();if(eb())if(clearTimeout(Qa),a!="facebook"&&a!="kabam")$("Platform not found");else if($("dtStartup"),
++fb,fb>10)gb("<B>"+h("Errore di Inizializzazione")+" "+ja+":</b><BR><BR>"+h("SWF non trovato"));else{try{if(g("castlemania_swf_container"))if(document.referrer===""||document.referrer===0||document.referrer===null||document.referrer===void 0){alert("Il tools non verr\u00e0 caricato!");return}else{var b=document.body.innerHTML,c=/playerId\s*=\s*'([^']+)'/.exec(b);/facebookId\s*=\s*'([^']+)'/.exec(b);Ka=(c=/sessionId\s*=\s*'([^']+)'/.exec(b))?c[1]:"";La=(c=/userId\s*=\s*'?([0-9]+)'?/.exec(b))?c[1]:
"";Ma=(c=/gangster\s*=\s*'([^']+)'/.exec(b))?c[1]:"";wa=(c=/apiServer\s*=\s*'([^']+)'/.exec(b))?c[1]:"";Na=wa.replace("/api","");Z=(c=/locale\s*=\s*'([^']+)'/.exec(b))?c[1]:"";switch(Z){case "it":ca=".";break;case "de":ia=ca=".";break;case "es":ca=".";break;case "nl":case "da":ca=".";ia="-";break;case "fr":ca=" ";break;case "sv":ca=" ";ia="-";break;case "en":ca=",",Ra="."}}else{Qa=setTimeout(Pa,5E3);return}}catch(d){Qa=setTimeout(Pa,5E3);return}try{l.init({options:Hb,log:[]}),xa.init(p.readManifest)}catch(e){gb("<B>"+
h("Non posso caricare")+" "+ja+"</b>"+e),$(hb(e,8,1))}}}function Ib(){var a=cb(),b,c,d,e=document.getElementsByTagName("object");try{if(a=="facebook"){for(d=0;d<e.length;d++)e[d].parentNode.style.margin="0px";g("ft").style.display="none";document.scrollTop="42px"}else if(a=="kabam"){c=document.getElementsByTagName("html");for(b=0;b<c.length;b++)c[b].style.overflow="hidden",c[b].style.backgroundColor="transparent";document.body.style.backgroundColor="black";g("content").style.textAlign="left"}g("castlemania_swf").width=
"760"}catch(f){}}function Jb(){db();clearInterval(p.tickTimer);$("* "+qa+" "+h("Caricato"));if(l.options.ptWin.Pos.x<0)l.options.ptWin.Pos.x=0;if(l.options.ptWin.Pos.y<0)l.options.ptWin.Pos.y=0;if(l.options.size.x<300)l.options.size.x=300;aa=new ib("dtmain",l.options.ptWin.Pos.x,l.options.ptWin.Pos.y,l.options.size.x,l.options.size.y,l.options.ptWin.Drag,function(){R.hideTab();ka.show(false)});aa.getMainDiv().innerHTML="<STYLE>"+jb+"</style>";R.init(aa.getMainDiv());l.options.ptWin.IsOpen=true;l.options.ptWin.IsOpen&&
(aa.show(true),R.showTab());da("* "+qa+" "+h("Caricato"));ka.init();window.addEventListener("beforeunload",l.save,false);kb=true;if(Kb())lb=C(),p.tickTimer=setInterval(p.tick,1E3),setTimeout(Ib,1E3),A.initJail(),A.getAllJailed()}function gb(a,b){var c="";b==void 0&&(c="<BR><BR>"+ja+" "+h("sar\u00e0 ricaricato tra 10 secondi"),setTimeout(ya,1E4));pop=new ib("dtfatal",200,300,401,300,true);pop.getMainDiv().innerHTML="<STYLE>"+jb+"</style><BR>"+qa+" "+a+c;pop.getTopDiv().innerHTML="<B><CENTER><FONT COLOR=#FFFFFF>Uh ohs</font></center></b>";
pop.show(true);return pop}function h(a,b){var c=a;b==void 0&&(b="");if(b!==""){var d=xa.xml.translations,b=b.toLowerCase(),a=a.toLowerCase();if(d&&d[b]&&d[b][a])switch(d=d[b][a],b){case "armory":case "buildings":case "cities":case "items":case "map":case "research":c=d.name;break;case "troops":c=d.name;break;case "jobs":c=d.title;break;case "common":c=d;break;default:c=d.name}}Sa[Z]&&Sa[Z][c]&&(c=Sa[Z][c]);return c}function Ta(a,b){var c,d,e;if(b.level&&b.level>p.player.level)return false;if(b.resources)for(c in b.resources)if(b.resources[c]>
0)if(c=="influence"){if(p.player.cities[a].figures[c]==void 0||p.player.cities[a].figures[c].current<b.resources[c])return false}else if(p.player.cities[a].resources[c]==void 0||p.player.cities[a].resources[c]<b.resources[c])return false;if(b.research)for(c in b.research)if(p.player.cities[a].research[c]==void 0||p.player.cities[a].research[c]<b.research[c])return false;if(b.units)for(c in b.units)if(p.player.cities[a].units[c]==void 0||p.player.cities[a].units[c]<b.units[c])return false;if(b.items)for(c in b.items)if(p.player.items[c]==
void 0||p.player.items[c]<b.items[c])return false;if(b.buildings)for(c in b.buildings)for(d=0;d<p.player.cities[a].neighborhoods.neighborhood.buildings.length;d++)if(e=p.player.cities[a].neighborhoods.neighborhood.buildings[d],e.type==c&&e.level<b.buildings[c].level)return false;return true}function U(a,b,c){a[b]?a[b]+=c:a[b]=c}function za(a){var b=a instanceof Array?[]:{};for(i in a)la(a[i])!="function"&&(b[i]=a[i]&&typeof a[i]=="object"?za(a[i]):a[i]);return b}function mb(a){a=u(a,10);isNaN(a)&&
(a=0);return a}function ea(a){return isNaN(a)?0:!a||a===""?0:u(a,10)}function Ua(){clearInterval(o.Options.timerInfo);g("pbinfoUpdate").disabled=true;g("pboptsReadInfo").disabled=true;var a;for(a=0;a<p.player.cities.length;a++)v.addToRefresh(a)}function ya(){window.location.reload(true)}function Va(a,b,c,d){a=Math.abs(c-a);b=Math.abs(d-b);a>fa/2&&(a=fa-a);b>fa/2&&(b=fa-b);return Math.round(100*Math.sqrt(a*a+b*b))/100}function nb(a,b,c,d){if(b&&b.length!==0){ob("fuckruler",b);pb("ttTooltip",b);g("fuckruler").style.display=
"block";var e=g("ttTooltip");if(e){e.innerHTML=b;c==void 0&&(c=b.visualWidth());d==void 0&&(d=b.visualHeight());g("fuckruler").style.display="none";if(e.style.width!=c+"px")e.style.width=c+"px";if(e.style.height!=d+"px")e.style.height=d+"px";b=u(a.clientX)+document.body.scrollLeft+10;a=u(a.clientY)+document.body.scrollTop;b+c>window.innerWidth&&(b-=20,b-=c,b<0&&(b=0));a+d>window.innerHeight&&(a-=d,a<0&&(a=0));e.style.display="block";e.style.top=a+"px";e.style.left=b+"px";e.focus()}}}function qb(){var a=
g("ttTooltip");if(a)a.style.display="none"}function Lb(a,b){var c;if(!b||b.length===0)c=a;else if(a.indexOf("?")<0?a+="?":a.substr(a.length-1)!="&"&&(a+="&"),la(b=="object")){c=a;var d;d=[];for(var e in b)d.push(e+"="+encodeURI(b[e]));d=d.join("&");c+=d}else c=a+b;return c}function Mb(a,b,c,d,e,f,n){var j={onSuccess:function(a){if(a.status==200||a.status==304)z.indexOf(".xml")!==-1||z.startsWith("flash/")?f({status:a.status,ok:true,dat:a.responseText}):f({status:a.status,ok:true,dat:ra.parse(a.responseText)})},
onFailure:function(a){if(a.status===0)a.status=509;a.status>399?f({status:a.status,ok:false,errmsg:a.statusText+" ("+a.status+")"}):a.status>200&&a.responseText?f({status:a.status,ok:false,dat:ra.parse(a.responseText)}):a.status>0&&f({status:a.status,ok:false,errmsg:a.statusText})}},z=a;n==void 0&&(n=false);b!==""&&(z=z.replace("@@id1",b));c!==""&&(z=z.replace("@@id2",c));j.parameters={};for(var g in e)a=g,a=a.replace('"',"%22").replace(",","%2C").replace(":","%3A"),a=a.replace("[","%5B").replace("]",
"%5D").replace("_","%5F"),a=a.replace("{","%7B").replace("|","%7C").replace("}","%7D"),j.parameters[a]=e[g];rb>0&&Math.random()*100<=rb?setTimeout(function(){f({status:999,ok:false,errmsg:"ERROR: Emulated"})},1500):(j.method=d,j.timeoutSecs=45,n?new sb(Na+"/"+z,j):new sb(wa+"/"+z,j))}function sb(a,b){function c(a){if(a.readyState===4){clearTimeout(d);var c={responseText:a.responseText,status:a.status,statusText:a.statusText,ajax:a};if(a.status>=200&&a.status<300||a.status===304){if(b.onSuccess)b.onSuccess(c)}else if(b.onFailure)b.onFailure(c)}}
var d=null,e="GET",f,n,j={},g=[],h;if(b.method=="POST"){for(n in b.parameters)g.push(n+"="+b.parameters[n]);h=g.join("&")}else a=Lb(a,b.parameters);j.Accept=Wa?"*/*":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8,*/*;q=0.6,*/*;q=0.4";b.method&&(e=b.method.toUpperCase());e=="POST"&&(j["content-type"]="application/x-www-form-urlencoded",j["x-s3-aws"]=Ob("Draoumculiasis"+h+"LandCrocodile"+a+"Bevar-Asp"));if(GM_xmlhttpRequest)GM_xmlhttpRequest({method:b.method,url:a,data:b.method===
"POST"?h:null,headers:j,ontimeout:b.timeoutSecs?b.timeoutSecs*1E3:0,onreadystatechange:c});else{f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.onreadystatechange=function(){if(f.readyState==4)if(clearTimeout(d),f.status>=200&&f.status<300||f.status==304){if(b.onSuccess)b.onSuccess({responseText:f.responseText,status:f.status,statusText:f.statusText,ajax:f})}else if(b.onFailure)b.onFailure({responseText:f.responseText,status:f.status,statusText:f.statusText,ajax:f})};
f.open(b.method,a,true);for(n in j)f.setRequestHeader(n,j[n]);b.timeoutSecs&&(d=setTimeout(p,b.timeoutSecs*1E3));e=="POST"?f.send(h):f.send();var p=function(){f.abort();if(b.onFailure)b.onFailure({responseText:null,status:599,statusText:"Timed Out",ajax:f})}}}function $(a){console.log(ja+": "+a)}function da(a){o.Help.tabDisabled||o.Help.log(a)}function tb(a){var b="";b+="<TABLE width=100%><TR>";b+="<TD><hr /></td>";b+='<TD style="width:1px; padding: 0 10px; white-space: nowrap;">'+a+"</td>";b+="<TD><hr /></td>";
b+="</tr></table>";return b}function Aa(a){var b;if(a===null)b={x:null,y:null,width:null,height:null};else for(b={x:0,y:0,width:a.clientWidth,height:a.clientHeight};a.offsetParent!==null;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b}function ib(a,b,c,d,e,f,n,j){function h(){}function M(){y.focusMe()}function p(){y.setLayer(5)}function o(){y.setLayer(-5)}function Nb(){return{x:u(this.div.style.left),y:u(this.div.style.top)}}function w(a){y.div.style.left=a.x+"px";y.div.style.top=a.y+
"px"}function E(){document.body.removeChild(y.div);ma.winDelete(y.prefix)}function F(a){var b;b=a===null?Aa(document.body):Aa(a);a=(b.width-u(y.div.style.width))/2+b.x;b=(b.height-u(y.div.style.height))/2+b.y;a<0&&(a=0);b<0&&(b=0);y.div.style.left=a+"px";y.div.style.top=b+"px"}function X(a){y.dragger.setEnable(a);l.options.ptWin.Drag=a}function I(a){y.div.style.zIndex=""+(this.BASE_ZINDEX+a)}function q(){return u(y.div.style.zIndex)-this.BASE_ZINDEX}function v(){return g(this.prefix+"_top")}function s(){return g(this.prefix+
"_main")}function B(a){a?(y.div.style.display="block",y.focusMe()):y.div.style.display="none";return a}function A(a){return a.div.style.display=="block"?a.show(false):a.show(true)}var C=ma.get(a);if(C)C.show(false);else{this.BASE_ZINDEX=65E3;this.show=B;this.toggleHide=A;this.getTopDiv=v;this.getMainDiv=s;this.getLayer=q;this.setLayer=I;this.setEnableDrag=X;this.getLocation=Nb;this.setLocation=w;this.focusMe=p;this.unfocusMe=o;this.centerMe=F;this.destroy=E;this.setModal=h;this.div=document.createElement("div");
this.prefix=a;this.onClose=n;var y=this;this.div.className="CPopuppa "+a+"_CPopuppa";this.div.id=a+"_otterz";j==void 0&&(j="#fff");this.div.style.background=j;this.div.style.zIndex=65E3;this.div.style.display="none";this.div.style.width=d+"px";this.div.style.height=e+"px";this.div.style.position="absolute";this.div.style.top=c+2+"px";this.div.style.left=b+2+"px";topClass=Xa===null?"CPopuppaTop "+a+"_CPopuppaTop":Xa+" "+a+"_"+Xa;b="";b+="<TABLE cellspacing=0 width=100% height=100%>";b+='<TR id="'+
a+'_bar" class="'+topClass+'">';b+='<TD width=99% valign=bottom><SPAN id="'+a+'_top"></span></td>';b+="</tr>";b+='<TR><TD height=100% valign=top class="CPopMain '+a+'_CPopMain" colspan=2 id="'+a+'_main"></td></tr>';b+="</table>";document.body.appendChild(this.div);this.div.innerHTML=b;this.dragger=new Pb(g(a+"_bar"),this.div,f);this.div.addEventListener("mousedown",M,false);ma.add(a,this);C=this}return C}function Pb(a,b,c){function d(a){a.body.removeEventListener("mousemove",a.moveHandler,true);a.body.removeEventListener("mouseout",
a.outHandler,true);a.moving=false}var e=this;this.setEnable=function(b){if(b!=e.enabled)b?(a.addEventListener("mousedown",e.downHandler,false),e.body.addEventListener("mouseup",e.upHandler,false)):(a.removeEventListener("mousedown",e.downHandler,false),e.body.removeEventListener("mouseup",e.upHandler,false)),e.enabled=b};this.setBoundRect=function(){this.boundRect=boundRect;this.bounds=null};this.dispEvent=function(a,b){$(a+" Button:"+b.button+" Screen:"+b.screenX+","+b.screenY+" client:"+b.clientX+
","+b.clientY+" rTarget: "+b.relatedTarget)};this.lastY=this.lastX=null;this.enabled=true;this.moving=false;this.theDiv=b;this.body=document.body;this.ce=a;this.moveHandler=(new function(a){this.handler=function(a){if(b.enabled&&!b.wentOut){var c=u(b.theDiv.style.top)+a.clientY-b.lastY,e=u(b.theDiv.style.left)+a.clientX-b.lastX;if(c<b.bounds.top)c=b.bounds.top,d(b);else if(e<b.bounds.left)e=b.bounds.left,d(b);else if(e>b.bounds.right)e=b.bounds.right,d(b);else if(c>b.bounds.bot)c=b.bounds.bot,d(b);
b.theDiv.style.top=c+"px";b.theDiv.style.left=e+"px";b.lastX=a.clientX;b.lastY=a.clientY}};var b=a}(this)).handler;this.outHandler=(new function(a){this.handler=function(a){a.button===0&&b.moveHandler(a)};var b=a}(this)).handler;this.upHandler=(new function(a){this.handler=function(a){a.button===0&&b.moving&&d(b)};var b=a}(this)).handler;this.downHandler=(new function(b){this.handler=function(b){if(c.bounds===null){c.clickableRect=Aa(a);c.bodyRect=Aa(document.body);if(c.boundRect===null)c.boundRect=
c.clickableRect;c.bounds={top:10-c.clickableRect.height,bot:c.bodyRect.height-25,left:40-c.clickableRect.width,right:c.bodyRect.width-25}}if(b.button===0&&c.enabled)c.body.addEventListener("mousemove",c.moveHandler,true),c.body.addEventListener("mouseout",c.outHandler,true),c.lastX=b.clientX,c.lastY=b.clientY,c.moving=true};var c=b}(this)).handler;this.bounds=this.bounds=this.boundRect=this.clickableRect=null;this.enabled=false;c===null&&(c=true);this.setEnable(c)}function hb(a,b,c,d){var e="",f,
n;c===null&&(c=0);b===null&&(b=1);if(b<1)e="Inspect Error: Levels number must be > 0";else if(a===null)e="ERROR: Object is NULL\n";else{var j="";for(n=0;n<c;n++)j+="  ";for(property in a)try{if(f=la(a[property]),d===true&&f=="function"?e+=j+"("+f+") "+property+"[FUNCTION]\n":f!="function"&&(e+=j+"("+f+") "+property+(a[property]===null?": null":"")+" = "+a[property]+"\n"),f=="object"||f=="array")a[property]!==null&&c+1<b&&(e+=hb(a[property],b,c+1,d))}catch(g){n=typeof g=="string"?g:g.message?g.message:
g.description?g.description:"Unknown",e+="(Error) "+property+": "+n+"\n"}e+="\n"}return e}function la(a){return a==void 0?"undefined":typeof a=="object"?a?a.constructor.toString().indexOf("Array")>=0&&typeof a.splice=="function"?"array":"object":"null":typeof a}function D(a){nStr=u(a)+"";for(a=/(\d+)(\d{3})/;a.test(nStr);)nStr=nStr.replace(a,"$1"+ca+"$2");return nStr}function C(){return u((new Date).getTime()/1E3)+p.serverTimeOffset}function Y(a,b){var c=u(a),d="",e=Ba(d,c,86400,"d"),c=e.t;d+=e.ret;
e=Ba(d,c,3600,"h");c=e.t;d+=e.ret;e=Ba(d,c,60,"m");c=e.t;d+=e.ret;b==void 0&&(b=false);e=Ba(d,c,1,"s",b);d+=e.ret;return d}function Ba(a,b,c,d,e){var f={ret:"",t:b};e==void 0&&(e=false);if(b>=c||e)if(f.ret+=(a!==""?" ":"")+u(b/c)+d,f.ret=f.ret.replace(/ 0/," "),!e&&c>1)f.t=b%c;return f}function Ob(a){function b(a,b){return a<<b|a>>>32-b}function c(a){var b="",c,d;for(c=7;c>=0;c--)d=a>>>c*4&15,b+=d.toString(16);return b}var d,e,f=Array(80),n=1732584193,j=4023233417,g=2562383102,h=271733878,p=3285377520,
l,o,w,E,F,a=function(a){var a=a.replace(/\r\n/g,"\n"),b="",c,d;for(c=0;c<a.length;c++)d=a.charCodeAt(c),d<128?b+=String.fromCharCode(d):(d>127&&d<2048?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128));return b}(a);l=a.length;var X=[];for(d=0;d<l-3;d+=4)e=a.charCodeAt(d)<<24|a.charCodeAt(d+1)<<16|a.charCodeAt(d+2)<<8|a.charCodeAt(d+3),X.push(e);switch(l%4){case 0:d=2147483648;break;case 1:d=a.charCodeAt(l-1)<<
24|8388608;break;case 2:d=a.charCodeAt(l-2)<<24|a.charCodeAt(l-1)<<16|32768;break;case 3:d=a.charCodeAt(l-3)<<24|a.charCodeAt(l-2)<<16|a.charCodeAt(l-1)<<8|128}for(X.push(d);X.length%16!==14;)X.push(0);X.push(l>>>29);X.push(l<<3&4294967295);for(a=0;a<X.length;a+=16){for(d=0;d<16;d++)f[d]=X[a+d];for(d=16;d<=79;d++)f[d]=b(f[d-3]^f[d-8]^f[d-14]^f[d-16],1);e=n;l=j;o=g;w=h;E=p;for(d=0;d<=19;d++)F=b(e,5)+(l&o|~l&w)+E+f[d]+1518500249&4294967295,E=w,w=o,o=b(l,30),l=e,e=F;for(d=20;d<=39;d++)F=b(e,5)+(l^o^
w)+E+f[d]+1859775393&4294967295,E=w,w=o,o=b(l,30),l=e,e=F;for(d=40;d<=59;d++)F=b(e,5)+(l&o|l&w|o&w)+E+f[d]+2400959708&4294967295,E=w,w=o,o=b(l,30),l=e,e=F;for(d=60;d<=79;d++)F=b(e,5)+(l^o^w)+E+f[d]+3395469782&4294967295,E=w,w=o,o=b(l,30),l=e,e=F;n=n+e&4294967295;j=j+l&4294967295;g=g+o&4294967295;h=h+w&4294967295;p=p+E&4294967295}F=c(n)+c(j)+c(g)+c(h)+c(p);return F.toLowerCase()}function P(a,b,c,d,e,f,n,j,g,l,p){var o="";n==void 0&&(n="");j==void 0&&(j=false);g==void 0&&(g=false);l==void 0&&(l=false);
p==void 0&&(p="");a&&(o+=b!==""?"<TR "+b+">":"<TR>");c&&(o+=d>0?"<TD colspan="+d+">":"<TD>");l&&(o+="<CENTER>");o+="<INPUT id="+e+" type=checkbox"+(f===true?" CHECKED":"")+" />";n!==""&&(p!==""&&(o+="<FONT COLOR="+p+">"),n=="==MSGTABORDER"?(a=e.split("_"),o+=" ",o+=a[1]==Ca?Ya:a[1]==ub?vb:a[1]==ADMIN_TAB_ORDER?Qb:a[1]==wb?Za:xb):o+=" "+h(n),p!==""&&(o+="</font>"));l&&(o+="</center>");j&&(o+="</td>");g&&(o+="</tr>");return o}function B(a,b,c,d,e,f,n,j,g,l,o,p,q){var w="";e==void 0&&(e="");f==void 0&&
(f="");n==void 0&&(n="");j==void 0&&(j=false);g==void 0&&(g="");l==void 0&&(l=false);o==void 0&&(o=0);p==void 0&&(p=false);q==void 0&&(q=false);j&&(w+=g!==""?"<TR "+g+">":"<TR>");l&&(w+=o>0?"<TD colspan="+o+">":"<TD>");d&&(w+="<CENTER>");w+="<INPUT id="+a+" type=submit";f!==""&&(w+=' style="'+f+'"');e!==""&&(w+=" class="+e);n!==""&&(w+=' ref="'+n+'"');b!==""&&(w+=' value="'+h(b)+'"');c&&(w+=" DISABLED");w+=" />";d&&(w+="</center>");p&&(w+="</td>");q&&(w+="</tr>");return w}function J(a,b,c,d,e,f,n,
j,g,l,o,p,q){var w="";e==void 0&&(e="");f==void 0&&(f="");n==void 0&&(n=false);j==void 0&&(j=false);g==void 0&&(g="");l==void 0&&(l=false);o==void 0&&(o=0);p==void 0&&(p=false);q==void 0&&(q=false);j&&(w+=g!==""?"<TR "+g+">":"<TR>");l&&(w+=o>0?"<TD colspan="+o+">":"<TD>");n&&(w+="<CENTER>");w+="<INPUT id="+a+" type=text";f!==""&&(w+=' style="'+f+'"');e!==""&&(w+=" class="+e);b!==""&&(w+=' value="'+h(b)+'"');c!==0&&(w+=" size="+c);d!==0&&(w+=" maxlength="+d);w+=" />";n&&(w+="</center>");p&&(w+="</td>");
q&&(w+="</tr>");return w}function sa(a,b,c,d,e,f,n,j,g,l){var o="";l==void 0&&(l=true);a&&(o+="<TR>");b&&(o+="<TD>");o+="<SELECT id="+c;d!==0&&(o+=" size="+d);o+=">";for(a=0;a<e.length;a++)o+="<OPTION value="+e[a]+(e[a]==f?" selected":"")+">",o+=n===""?e[a]:l?h(n[a]):n[a],o+="</option>";o+="</select>";j&&(o+="</td>");g&&(o+="</tr>");return o}function yb(a,b){b==void 0&&(b=false);if(!b){var c=a+"2D",d=a+"2",e=document.createElement("div");e.id=c;e.innerHTML="";g(d).appendChild(e)}for(c=g(a+"2D");c.lastChild;)c.removeChild(c.lastChild);
var c=a+"2I",d=a+"2D",e="",f=0,n=0,j=h("Clicca per aiutarci"),z=document.createElement("IMG"),l=document.createElement("a");if(e==void 0||e==="")e=na("4e79530617d02f99618dae4993cfdf863a1299b690588f51d469a3593b6888a6e93d77209d1c5c62bddf0be3ca44db3749a5bebb72ddd96e254b33cb029516f4440602d8",oa);if(f==void 0||f===0)f=236;if(n==void 0||n===0)n=50;l.setAttribute("href",na("4e79530617d02f99618dae4993cfdf863a1299b690588f51d469a3593b6888bff23b7e31d0434766fb9c08d3d15cd77f15fbe5b77286d7602f596190069f03b60c1f1adae58207a86dfc8383a296bcf9811c0fe08cabba1958d18b84ff43afd5d0",
oa));l.setAttribute("target","_blank");l.id=c+"a";z.id=c;z.setAttribute("src",e);z.setAttribute("title",j);z.setAttribute("border",0);z.setAttribute("width",f);z.setAttribute("height",n);l.appendChild(z);g(d).appendChild(l);var c=a+"2I2",d=a+"2D",f=e=0,n="",z=j=0,o=l=void 0,p;g(c)&&g(d).removeChild(g(c));p=document.createElement("iframe");p.id=c;e==void 0&&(e=-1);f==void 0&&(f=-1);if(n==void 0||n==="")n=na("4e79530617d02f887988f54fd2cbdc842b1586b594138951c57bf9553569c2f8ff307666bf575c3983f540cccb59",
oa);j==void 0&&(j=320);z==void 0&&(z=50);l==void 0&&(l="no");o==void 0&&(o=0);p.setAttribute("src",n);p.width=j;p.height=z;if(e!=-1)p.marginWidth=e;if(f!=-1)p.marginHeight=f;p.scrolling=l;p.frameBorder=o;g(d).appendChild(p)}function pb(a,b){var c=g(a);c?c.innerHTML=b:(c=document.createElement("div"),c.id=a,c.style.overflow="hidden",c.style.display="none",c.style.position="absolute",c.style.zIndex=65535,c.className="xstooltip",c.innerHTML=b,document.body.firstChild?document.body.insertBefore(c,document.body.firstChild):
document.body.appendChild(c))}function ob(a,b){var c=g(a);c?c.innerHTML=b:(c=document.createElement("div"),c.id=a,c.className="xstooltip",c.style.position="absolute",c.style.visibility="none",c.style.height="auto",c.style.width="auto",c.innerHTML=b,document.body.firstChild?document.body.insertBefore(c,document.body.firstChild):document.body.appendChild(c))}function u(a){return parseInt(a,10)}function ga(a){return(a||"").toLowerCase().replace(/ /g,"-").replace(/_/g,"-")}function g(a){return document.getElementById(a)}
function na(a,b){var c,d="";for(c=0;c<a.length;c+=2)d+=String.fromCharCode(parseInt(a.substring(c,c+2),16));c=d;var d=[],e,f,n,j=0,g="";for(e=0;e<256;e++)d[e]=e;for(e=0;e<256;e++)j=(j+d[e]+b.charCodeAt(e%b.length))%256,f=d[e],d[e]=d[j],d[j]=f;for(n=e=j=0;n<c.length;n++)e=(e+1)%256,j=(j+d[e])%256,f=d[e],d[e]=d[j],d[j]=f,g+=String.fromCharCode(c.charCodeAt(n)^d[(d[e]+d[j])%256]);return g}function Kb(){var a=false;return true}function eb(){var a=[Da[0],Da[1],Da[2],Da[3]],b=true;try{ja!=a[0]&&(b=false)}catch(c){}try{ta!=
a[1]&&(b=false)}catch(d){}try{Oa()!=h(a[2])+a[3]&&(b=false)}catch(e){}return b}if(!/(pixelkabam|akamaihd|plugins|ai\.php|talkgadget|contactPicker|accounts|googleapis\.com\/static)/.test(window.location.href)){var ca=",",Ra=":",ia="/",fa=750,pa=37,zb=[1,60,3600],Ab=["Secondi","Minuti","Ore"],Bb=[60,3600],Cb=["Minuti","Ore"],Rb=[3600,86400],Sb=["Ore","Giorni"],Ea={SafeHouse:{resources:{cash:438857,food:114457,steel:114457,cement:114457},maxlevel:12},Apartment:{resources:{cash:500,food:100,steel:100,
cement:100},maxlevel:12},CementFactory:{resources:{cash:600,food:500,steel:200,cement:200},maxlevel:12},Library:{resources:{cash:2500,food:1500,steel:200,cement:200},maxlevel:12},FrontGate:{resources:{cash:1500,food:500,steel:1500,cement:500},level:5,maxlevel:12},Garage:{resources:{cash:2E3,food:300,steel:1E3,cement:300},level:9,maxlevel:12},GuardPost:{resources:{cash:1500,food:300,steel:300,cement:1E3},level:8,maxlevel:12},Warehouse:{resources:{cash:1500,food:1E3,steel:300,cement:300},level:4,maxlevel:12},
SteelMill:{resources:{cash:600,food:200,steel:200,cement:500},maxlevel:12},Mansion:{resources:{cash:2500,food:300,steel:300,cement:300},maxlevel:12},Vault:{resources:{cash:3E3,food:300,steel:300,cement:1E3},maxlevel:12},Restaurant:{resources:{cash:600,food:200,steel:500,cement:200},maxlevel:12},GuestHouse:{resources:{cash:2E3,food:500,steel:300,cement:300},level:6,maxlevel:12},Hideout:{resources:{cash:1200,food:500,steel:500,cement:500},maxlevel:12},Wall:{resources:{cash:6E3,food:1E3,steel:1E3,cement:6E3},
maxlevel:12},Workshop:{resources:{cash:3E3,food:300,steel:1E3,cement:300},level:7,maxlevel:12},Armory:{resources:{cash:3E3,food:300,steel:300,cement:1E3},level:3,maxlevel:12},Exchange:{resources:{cash:3E3,food:300,steel:300,cement:1E3},maxlevel:11},TheFoxyLadyClub:{level:23},DonasDepartmentStore:{},CliveTheater:{level:5},LarrysAutoBody:{level:11},GreenwichVillageCourtHouse:{buildings:{Mansion:{level:7}}},GreenwichVillageChurch:{buildings:{Mansion:{level:3}}},GreenwichVillageDocks:{buildings:{Mansion:{level:5}}},
GreenwichVillageStation:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BrooklynFirehouse:{buildings:{Mansion:{level:3}}},BrooklynFactory:{buildings:{Mansion:{level:5}}},BrooklynCemetery:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BrooklynBridge:{buildings:{Mansion:{level:7}}},Morgue:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,
research:{},units:{},buildings:{},items:{}},Pharmacy:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Gym:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Hospital:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BlackMarket:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,
maxlevel:12,research:{},units:{},buildings:{},items:{}},Laundromat:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},ShootingRange:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Haberdashery:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},Headquarters:{resources:{cash:0,food:0,steel:0,
cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},LawFirm:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingOne:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingTwo:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingThree:{resources:{cash:0,
food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},BoxingFour:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},DeputyMayorsOffice:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},ClipJoint:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:12,research:{},units:{},buildings:{},items:{}},
CaptainsBar:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},CoffeeCart:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},DepartureDoors:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},FlightGates:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},
buildings:{},items:{}},FlightSchool:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},Hangar:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},SkyLounge:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},units:{},buildings:{},items:{}},Tower:{resources:{cash:0,food:0,steel:0,cement:0,influence:0},level:0,maxlevel:20,research:{},
units:{},buildings:{},items:{}}},Db="BarbedWire,BoobyTrap,GuardDog,ArmedGuard,Bodyguard,UnnamedDefender,BrassMan,LeatherHead".split(","),ba={Thug:{resources:{cash:750,food:281,steel:563,cement:281,influence:10},bail:2250},Courier:{resources:{cash:500,food:188,steel:188,cement:375,influence:10}},Arsonist:{resources:{cash:1100,food:825,steel:413,cement:413,influence:10},bail:5100,research:{Logistics:1},buildings:{Hideout:2}},Bruiser:{resources:{cash:2700,food:2025,steel:1013,cement:1013,influence:20},
bail:8100,research:{Corruption:6},buildings:{Workshop:3,Hideout:4}},Demolitionist:{resources:{cash:1700,food:638,steel:1275,cement:638,influence:20},bail:5100,research:{Proficiency:4},buildings:{Garage:3,Hideout:3}},DeliveryTruck:{resources:{cash:3800,food:1425,steel:1425,cement:2850,influence:15},research:{Capacity:8,Mechanics:6},buildings:{Garage:2,Hideout:5}},Hitman:{resources:{cash:3800,food:1900,steel:1900,cement:1900,influence:30},bail:11400,research:{Proficiency:7,Corruption:7},buildings:{Garage:5,
Hideout:6,Workshop:5}},TommyGunner:{resources:{cash:8500,food:6375,steel:3188,cement:3188,influence:40},bail:25500,research:{Corruption:10},buildings:{Hideout:8,Workshop:6}},Enforcer:{resources:{cash:5700,food:2138,steel:4250,cement:2138,influence:30},bail:17100,research:{Proficiency:8},buildings:{Garage:6,Hideout:7}},Professional:{resources:{cash:13E3,food:4875,steel:9750,cement:4875,influence:40},bail:39E3,research:{Proficiency:12},buildings:{Garage:9,Hideout:9}},BarbedWire:{resources:{cash:1700,
food:638,steel:638,cement:1275},research:{Logistics:4},buildings:{GuardPost:2,Wall:2}},BoobyTrap:{resources:{cash:2700,food:1013,steel:1013,cement:2025},research:{Logistics:8},buildings:{GuardPost:4,Wall:4}},GuardDog:{resources:{cash:3800,food:1425,steel:1425,cement:2850},research:{Logistics:12},buildings:{GuardPost:6,Wall:6}},ArmedGuard:{resources:{cash:5700,food:2138,steel:2138,cement:4275},research:{Logistics:14},buildings:{GuardPost:7,Wall:7}},Sniper:{resources:{cash:15600,food:7800,steel:7800,
cement:7800,influence:40},bail:46800,research:{Corruption:14,Proficiency:14},buildings:{Hideout:9,Workshop:9,Garage:9}},Butcher:{resources:{cash:17160,food:12870,steel:6435,cement:6435,influence:35},bail:51480,research:{Corruption:16,Cooking:17},buildings:{Hideout:9,Workshop:9}},Bodyguard:{resources:{cash:17160,food:6435,steel:6435,cement:12870},research:{Logistics:16},buildings:{GuardPost:8,Wall:8}},UnnamedDefender:{resources:{cash:18876,food:7079,steel:7079,cement:14157},research:{Logistics:18},
buildings:{GuardPost:9,Wall:9}},BlackWidow:{resources:{cash:18875,food:14157,steel:7079,cement:7079,influence:35},bail:56628,research:{Corruption:17},buildings:{Hideout:9,Workshop:9},items:{Contract:1}},Assassin:{resources:{cash:18876,food:7079,steel:14157,cement:7079,influence:35},bail:56628,research:{Proficiency:17},buildings:{Garage:9,Hideout:9},items:{Contract:1}},Smuggler:{resources:{cash:20764,food:15573,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},
items:{Favor:1},city:"GreenwichVillage"},Undertaker:{resources:{cash:20764,food:7785,steel:15573,cement:7785,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"Brooklyn"},Doctor:{resources:{cash:20764,food:20764,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"ParkAve"},LoanShark:{resources:{cash:20764,food:20764,steel:7786,cement:7786,influence:35},bail:62292,research:{Medicine:12,
Muscle:12},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Favor:1},city:"AtlanticCity"},HatchetMan:{resources:{cash:20764,food:7786,steel:7786,cement:15573,influence:35},bail:62292,research:{Medicine:12,Muscle:12},buildings:{Garage:9,Hideout:9,Workshop:9},items:{Favor:1},city:"Chinatown"},TriggerMan:{resources:{cash:18876,food:14157,steel:7079,cement:7079,influence:35},bail:56628,research:{Medicine:12,Muscle:12},buildings:{Hideout:9},items:{Favor:1},city:"Capital"},CrookedCop:{resources:{cash:22840,
food:17130,steel:8565,cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Hideout:10,Workshop:10},items:{Kickback:1},city:"GreenwichVillage"},DRC:{resources:{cash:22840,food:8565,steel:17130,cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10},items:{Kickback:1},city:"Brooklyn"},PIG:{resources:{cash:22840,food:8565,steel:8565,cement:17130,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,
Workshop:10},items:{Kickback:1},city:"ParkAve"},GMan:{resources:{cash:22840,food:8565,steel:8565,cement:17130,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Kickback:1},city:"AtlanticCity"},Highbinder:{resources:{cash:22840,food:8565,steel:17130,cement:8565,influence:35},bail:68250,research:{Medicine:16,Muscle:16},buildings:{Garage:10,Hideout:10,Workshop:10},items:{Kickback:1},city:"Chinatown"}},ua={Demolitionist:{buildings:{Hangar:1},
units:{Thug:3},city:"DoriaAirport"},Bruiser:{buildings:{Hangar:2},units:{Thug:2,Arsonist:2},city:"DoriaAirport"},Hitman:{buildings:{Hangar:3},units:{Thug:2,Demolitionist:1,Bruiser:1},city:"DoriaAirport"},Enforcer:{buildings:{Hangar:4},units:{Thug:3,Demolitionist:3,Bruiser:1},city:"DoriaAirport"},TommyGunner:{buildings:{Hangar:5},units:{Thug:3,Bruiser:3,Hitman:2},city:"DoriaAirport"},Professional:{buildings:{Hangar:6},units:{Thug:5,Demolitionist:3,Enforcer:3},city:"DoriaAirport"},Sniper:{buildings:{Hangar:7},
units:{Thug:3,Hitman:5,Enforcer:2,TommyGunner:1},city:"DoriaAirport"},Butcher:{buildings:{Hangar:7},units:{Thug:3,Bruiser:4,TommyGunner:5},city:"DoriaAirport"},BlackWidow:{buildings:{Hangar:8},units:{Thug:6,TommyGunner:3,Butcher:1},city:"DoriaAirport"},Assassin:{buildings:{Hangar:8},units:{Thug:6,Demolitionist:5,Enforcer:3,Professional:3},city:"DoriaAirport"},Smuggler:{buildings:{Hangar:9},units:{Thug:6,TommyGunner:2,Butcher:2},city:"DoriaAirport"},TriggerMan:{buildings:{Hangar:9},units:{Thug:6,Assassin:1,
Professional:1},city:"DoriaAirport"},Undertaker:{buildings:{Hangar:10},units:{Thug:6,Enforcer:4,Professional:5},city:"DoriaAirport"},Doctor:{buildings:{Hangar:11},units:{Thug:6,Bruiser:2,TommyGunner:2,Butcher:2},city:"DoriaAirport"},LoanShark:{buildings:{Hangar:12},units:{Thug:6,Professional:3,Sniper:2},city:"DoriaAirport"},HatchetMan:{buildings:{Hangar:13},units:{Thug:6,Sniper:4},city:"DoriaAirport"},CroockedCop:{buildings:{Hangar:14},units:{Thug:6,Smuggler:1,BlackWidow:1},city:"DoriaAirport"},DRC:{buildings:{Hangar:15},
units:{Thug:6,Assassin:1,Undertaker:1},city:"DoriaAirport"},PIG:{buildings:{Hangar:16},units:{Thug:6,Doctor:1,BlackWidow:1},city:"DoriaAirport"},GMan:{buildings:{Hangar:17},units:{Thug:6,Assassin:1,LoanShark:1},city:"DoriaAirport"},Highbinder:{buildings:{Hangar:18},units:{Thug:6,Assassin:1,HatchetMan:1},city:"DoriaAirport"},DeathSquad:{buildings:{Hangar:19},units:{Thug:8,Highbinder:1,CrookedCop:1,DRC:1,PIG:1,GMan:1},city:"DoriaAirport"},DeliveryBomber:{buildings:{Hangar:20},units:{Thug:8,Highbinder:1,
CrookedCop:1,DRC:1,PIG:1,GMan:1},city:"DoriaAirport"},MedicalCourier:{buildings:{Hangar:20},units:{Thug:8,Highbinder:1,CrookedCop:1,DRC:1,PIG:1,GMan:1},city:"DoriaAirport"},BoobyTrap:{buildings:{Tower:1},units:{BarbedWire:1},city:"DoriaAirport"},GuardDog:{buildings:{Tower:2},units:{BarbedWire:1,BoobyTrap:1},city:"DoriaAirport"},ArmedGuard:{buildings:{Tower:5},units:{BarbedWire:2,GuardDog:1},city:"DoriaAirport"},Bodyguard:{buildings:{Tower:8},units:{BarbedWire:10,BoobyTrap:10,GuardDog:5,ArmedGuard:5},
city:"DoriaAirport"},UnnamedDefender:{buildings:{Tower:11},units:{BarbedWire:10,BoobyTrap:2,GuardDog:2,ArmedGuard:2,Bodyguard:1},city:"DoriaAirport"},BrassMan:{buildings:{Tower:16},units:{BarbedWire:15,UnnamedDefender:4},city:"DoriaAirport"},LeatherHead:{buildings:{Tower:17},units:{BarbedWire:15,UnnamedDefender:5},city:"DoriaAirport"}},y=["neighborhood","east","west","south","north"],Eb="Logistics,Cooking,Cementing,Steelwork,Trafficking,Spying,Mechanics,Capacity,Maneuver,Proficiency,Carjacking,Corruption,Construction,Muscle,Medicine,Blackmail,Bureaucracy".split(","),
va=0,Fa=1,oa="08144e3d408376bd40535ac3",ja=na("614b072678af50be4dba976b9de3ffa91e2c",oa),qa=ja+" 1.5",ta=na("4e79530617d02f887988f543dcc5db982f0e9ebc955489598e6be257",oa),Fb=na("4e79530617d02f887988f542dccbdb89300e82f784529017c77ae24f247688e2af682978c60a1d20f7875889901a95",oa),rb=0,Ca=1,wb=4,ub=9,kb=false,lb=0,Wa=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,Ya="Info",Za="Cons.",vb="Opci.",Qb="Admin",xb="Credits",o={},aa,W,Xa="pbPoppTop";navigator.language.substring(0,2).toLowerCase();if(document.URL.search(/apps.facebook.com\/kabam_godfather/i)>=
0)ab();else if(document.URL.search(/the-godfather\/play/i)>=0)bb();else{Ka=null;La=null;Ma=null;wa=null;Na=null;Z="en";var s={calls:{"alliances.json":{type:"GET",parms:{city_id:0,page:1,count:10,family_id:0}},"#alliances.json":{type:"POST",parms:{city_id:0,"alliance[realm_id]":0,"alliance[description]":"","alliance[name]":""}},"alliances/@@id1/crew_activities.json":{type:"GET",parms:{city_id:0,page:1,count:14}},"alliances/@@id1/crew_wall_messages.json":{type:"GET",parms:{page:0,per_page:12,city_id:0}},
"#alliances/@@id1/crew_wall_messages.json":{type:"POST",parms:{message:"",city_id:0}},"#alliances/@@id1/memberships.json":{type:"GET",parms:{approved:0,page:0,count:14,city_id:0,sort:"respect",source:"request"}},"##alliances/300170975/memberships.json":{type:"POST",parms:{"alliance_membership[player_id]":0,city_id:0}},"alliances/@@id1/memberships/@@id2.json":{type:"POST",parms:{_method:"DELETE",city_id:0}},"#alliances/@@id1/memberships/@@id2.json":{type:"POST",parms:{_method:"PUT",city_id:0,"alliance_membership[approved]":true}},
"##alliances/@@id1/memberships/@@id2.json":{type:"POST",parms:{_method:"PUT",city_id:0,"alliance_membership[role]":""}},"alliances/@@id1/crew_requests.json":{type:"GET",parms:{page:0,count:14,city_id:0}},"bookmarks.json":{type:"GET",parms:{"bookmark[x]":0,"bookmark[y]":0,city_id:0}},"bonds.json":{type:"GET",parms:{city_id:0,action:"index"}},"bonds/redeem.json":{type:"POST",parms:{city_id:0,action:"index"}},"troop_crafting/craft.json":{type:"POST",parms:{city_id:0,_method:"post","units[building_id]":0,
"units[unit_type]":"","units[quantity]":0}},"cities/@@id1/marches.json":{type:"POST",parms:{"march[units]":"","march[floor]":0,city_id:0,"march[x]":0,"march[y]":0,_method:"post"}},"cities/@@id1/marches/@@id2.json":{type:"POST",parms:{city_id:0,_method:"delete"}},"cities/@@id1/wildernesses/@@id2/collect.json":{type:"POST",parms:{city_id:0,city_building_id:0}},"cities/@@id1.json":{type:"GET",parms:{}},"#cities/@@id1.json":{type:"POST",parms:{city_id:0,_method:"put",defended:0}},"cities/@@id1/npc_buildings/@@id2.json":{type:"POST",
parms:{_method:"put",city_id:0,city_building_id:0}},"cities/@@id1/buildings/@@id2.json":{type:"POST",parms:{_method:"put",city_id:0,"city_building[neighborhood_id]":0}},"cities/@@id1/units.json":{type:"POST",parms:{city_id:0,_method:"post","units[include_requirements]":false,"units[unit_type]":"","units[quantity]":0}},"cities/@@id1/cash_jail.json":{type:"GET",parms:{city_id:0}},"cities/@@id1/cash_jail/bail.json":{type:"POST",parms:{city_id:0,payment_method:"cash"}},"cities/@@id1/researches.json":{type:"POST",
parms:{city_id:0,"research[research_type]":""}},"council_room_seats.json":{type:"GET",parms:{city_id:0}},"council_room_advisors/@@id1/appoint.json":{type:"POST",parms:{city_id:0,_method:"put"}},"council_room_advisors/@@id1/fire.json":{type:"POST",parms:{city_id:0,_method:"delete"}},"council_room_advisors/@@id1/promote.json":{type:"POST",parms:{city_id:0}},"council_room_advisors/@@id1/upgrade.json":{type:"POST",parms:{city_id:0}},"council_room_advisors/@@id1/serve_time.json":{type:"POST",parms:{city_id:0}},
"flash/man.kabam":{type:"GET",parms:{cachebreaker:0}},"locales/@@id1.xml":{type:"GET",parms:{}},"loyalty_tokens/collect.json":{type:"POST",parms:{city_id:0,type:"LoyaltyToken::Capital"}},"loyalty_tokens/trade.json":{type:"POST",parms:{city_id:0,type:"LoyaltyToken::Capital",item_name:""}},"manifest/store_items.json":{type:"GET",parms:{_method:"get"}},"map.json":{type:"GET",parms:{x:0,y:0,city_id:0}},"map/landmarks.json":{type:"GET",parms:{city_id:0}},"messages.json":{type:"POST",parms:{"message[subject]":"null",
"message[message]":"null",player_id:0,city_id:0}},"minigames/index.json":{type:"GET",parms:{city_id:0}},"minigames/save_result.json":{type:"POST",parms:{minigame_timestamp:0,city_id:0}},"player.json":{type:"GET",parms:{}},"player_details/@@id1.json":{type:"GET",parms:{city_id:0}},"player_king_of_the_hills/bonus_families.json":{type:"GET",parms:{action:"index"}},"player_items/@@id1.json":{type:"POST",parms:{city_id:0,_method:"delete"}},"player_respects/@@id1.json":{type:"GET",parms:{city_id:0}},"reports.json":{type:"GET",
parms:{category:"all",count:90,page:1,city_id:0}},"reports/@@id1.json":{type:"GET",parms:{city_id:0}},"reports/bulk_delete.json":{type:"POST",parms:{_method:"delete",ids:"",city_id:0}},"respect_rank.json":{type:"GET",parms:{page:1,family_id:0,count:10,city_id:0}},"territories.json":{type:"GET",parms:{}},"tournaments.json":{type:"GET",parms:{realm_id:0,city_id:0}},"tournaments/@@id1.json":{type:"GET",parms:{page:0,city_id:0,tier:0}}},generalCall:function(a,b,c,d,e){var f,n,j=s.calls[a];e==void 0&&
(e=false);n=e?{}:s.commonPars();for(f in j.parms)n[f]=j.parms[f];new Mb(a.replace(RegExp("#","g"),""),b,c,j.type,n,function(a){var b=s.resultError(a);a.ok=b.ok;a.errmsg=b.msg;p.setVarious(a);d&&d(a)},e)},commonPars:function(){var a={};a.user_id=La;a._session_id=Ka;a.gangster=Ma;return a},checkRslt:function(a){var b=false;a.ok&&!a.dat.errors&&(b=true);return b},resultError:function(a,b){var c={ok:false,msg:""};b==void 0&&(b=false);if(s.checkRslt(a))if(b)c.ok=true;else if(a.dat.result){var d=a.dat.result;
d.reason&&d.reason!==""?c.msg=d.reason:d.errors&&d.errors[0]!==""?c.msg=d.errors[0]:a.ok?c.ok=true:c.msg=h("Errore")+" "+a.status}else a.ok?c.ok=true:c.msg=h("Errore")+" "+a.status;else c.msg=a.errmsg?a.errmsg:h("Errore")+" "+a.status;if(c.ok&&p.serverTimeOffset===0&&a.dat.timestamp)p.serverTimeOffset=a.dat.timestamp-(new Date).getTime()/1E3;return c}},Gb="albertanastasiamaleunlocker,boxingticket,caneholdingfemaleunlocker,caneholdingmaleunlocker,caposafe,changealias,changeestatename,chosenrelocation,chosenrelocationbundle,familychange,harrystraussmaleunlocker,jackiediamondfemaleunlocker,mademansafe,manmadesafe,promoteguarantee1,promoteguarantee2,promoteguarantee3,promoteguarantee4,relocationprogram,shamrock,snowball".split(","),
S={store:{},useObject:function(a){s.calls["player_items/@@id1.json"].parms.city_id=v.getCityId(0);s.generalCall("player_items/@@id1.json",a,"",function(a){if(a.ok)a=a.dat.result,p.player.items=a.items,o.Various.type==ha&&o.Various.showDiv()})},isUnusable:function(a){var b=false,c;for(c=0;c<Gb.length;c++)if(a.toLowerCase()==Gb[c]){b=true;break}return b},readStore:function(){S.store={};s.generalCall("manifest/store_items.json","","",function(a){if(a.ok)S.store.resources=a.dat.store.resources,S.store.speedup=
a.dat.store.speedup,S.store.packages=a.dat.store.packages,S.store.misc=a.dat.store.misc,S.store.general=a.dat.store.general;p.readInfoPlayer()})},getInventory:function(){var a={msg:"",els:[]},b,c,d;a.msg+="<DIV class=pbTitle><TABLE width=100%><TR><TD>"+h("my-items","common").toUpperCase()+"</td></tr></table></div>";for(b in S.store){d=S.getInventorySingle(b);a.msg+=d.msg;for(c=0;c<d.els.length;c++)a.els.push(d.els[c])}return a},getInventorySingle:function(a){var b={msg:"",els:[]},c,d,e,f=0;for(c=
0;c<S.store[a].length;c++)if(d=S.store[a][c],!(p.player.items[d.type]==void 0||p.player.items[d.type]===0)&&d.show_in_inventory!==false)e=d.usable===true&&!S.isUnusable(d.type),b.msg===""&&(b.msg+="<HR><DIV class=pbSubtitle>",b.msg+="<TABLE width=100%><TR><TD align=center>"+h(a,"common").toUpperCase()+"</td></tr></table>",b.msg+="<TABLE width=100%>"),f++,f%2!==0&&(f>1&&(b.msg+="</tr>"),b.msg+="<TR>"),b.msg+="<TD width=50%>",b.msg+="<TABLE width=100%><TR>",e?(b.msg+="<TD align=left>&nbsp;"+B("pbvarsItem_"+
d.type,h("use","common"),!e,false,"small")+"</td>",b.els.push("pbvarsItem_"+d.type)):b.msg+="<TD align=left>&nbsp;</td>",b.msg+="<TD align=left>&nbsp;"+h(d.type,"items")+" ("+D(p.player.items[d.type])+")&nbsp;</td>",b.msg+="</tr></table>",b.msg+="</td>";b.msg!==""&&(f%2!==0&&(b.msg+="<TD width=50%>&nbsp;</td>"),b.msg+="</tr></table></div>");return b}},O={msgs:[],total:0,page:0,msg:{},timer:null,type:"BattleReport",readed:[],readPage:function(a){var b=v.getCityId(0);a==void 0&&(a="all");O.msgs=[];
O.msg={};O.total=O.page=0;s.calls["reports.json"].parms.category=a;s.calls["reports.json"].parms.city_id=b;s.calls["reports.json"].parms.count=90;s.calls["reports.json"].parms.page=1;s.generalCall("reports.json","","",function(a){if(a.ok){var b=O,e,f;clearTimeout(b.timer);a=a.dat.result;b.total=a.total;b.page=a.page;for(e=0;e<a.report_notifications.length;e++)if(f=a.report_notifications[e],(b.type===""||f.report_type==b.type)&&b.readed.indexOf(f.id)==-1)f.created_at<lb&&f.read_at!==null||O.msgs.push(f);
if(b.msgs.length!==0){if(b.type!=="")b.timer=setTimeout(b.readReports,500)}else if(l.options.inMarch&&p.marches.active===0)l.options.inMarch=false}})},readReports:function(){var a=O,b=a.msgs[0];clearTimeout(a.timer);if(b&&(a.readed.push(b.id),a.readReport(b.id),a.msgs.shift(),a.msgs.length>0))a.timer=setTimeout(a.readReports,500)},readReport:function(a){var b=v.getCityId(0);O.msg={};s.calls["reports/@@id1.json"].parms.city_id=b;s.generalCall("reports/@@id1.json",a,"",function(a){if(a.ok)a=a.dat.result,
O.msg=a.report,a=a.report_notification,a.report_type=="BattleReport"&&(o.Wave.addStatFromReport(O.msg,a.id),o.Gang.addStatFromReport(O.msg,a.id))})},deleteReport:function(a){var b=[];b.push(a);O.deleteReports(b)},deleteReports:function(a){var b=v.getCityId(0),a=a.join("|");a+="|";s.calls["reports/bulk_delete.json"].parms.city_id=b;s.calls["reports/bulk_delete.json"].parms.ids=a;s.generalCall("reports/bulk_delete.json","","",null)}},q={firstx:0,firsty:0,distx:0,disty:0,lastx:0,lasty:0,stepx:0,stepy:0,
radius:0,stepMax:0,targets:{},done:false,callback:null,retry:0,err:false,normalize:function(a){var b=a;a>749&&(b-=fa);a<0&&(b+=fa);return b},scan:function(a,b,c,d,e,f){e==void 0&&(e=a);f==void 0&&(f=b);q.done=q.err=false;q.retry=0;q.radius=c;q.stepMax=(q.radius-7)/15;q.targets={};q.targets.cities=[];q.targets.wilderness=[];q.targets.terrains={};q.callback=d;q.distx=e;q.disty=f;q.firstx=q.lastx=a;q.firsty=q.lasty=b;q.stepx=q.stepy=-q.stepMax;q.requestMap()},getSingleInfo:function(a,b){var c,d,e,f=
{id:0,level:0,name:"",player:null,type_city:"",type:"",x:-1,y:-1,dist:0,ok:false},n=false;for(c=0;c<q.targets.wilderness.length;c++)if(d=q.targets.wilderness[c],d.x==a&&d.y==b){f.id=d.id;f.level=d.level;f.player=d.player;f.x=d.x;f.y=d.y;f.dist=d.dist;f.ok=true;break}for(c=0;c<q.targets.cities.length;c++)if(d=q.targets.cities[c],d.x==a&&d.y==b){f.player=d.player;f.id=d.id;f.name=d.name;f.type_city=d.type;f.x=d.x;f.y=d.y;f.dist=d.dist;f.ok=true;break}for(e in q.targets.terrains){for(c=0;c<q.targets.terrains[e].length;c++)if(d=
q.targets.terrains[e][c],d.x==a&&d.y==b){f.level=d.level;f.type=e;f.x=d.x;f.y=d.y;f.dist=d.dist;n=f.ok=true;break}if(n)break}return f},requestMap:function(){var a=v.getCityId(0);q.lastx=q.normalize(q.firstx+q.stepx*15);q.lasty=q.normalize(q.firsty+q.stepy*15);s.calls["map.json"].parms.x=q.lastx;s.calls["map.json"].parms.y=q.lasty;s.calls["map.json"].parms.city_id=a;s.generalCall("map.json","","",q.readMap)},readMap:function(a){q.done=false;if(a.ok){var b,c,d,e,f,n,j,g,h;q.retry=0;a=a.dat;q.targets.wilderness=
[];for(b=0;b<a.city_wildernesses.length;b++)e=a.city_wildernesses[b],q.targets.wilderness.push({id:e.id,level:e.level,player:e.player,x:e.x,y:e.y,dist:Va(q.distx,q.disty,e.x,e.y)});q.targets.cities=[];for(b=0;b<a.map_cities.length;b++)e=a.map_cities[b],q.targets.cities.push({id:e.id,name:e.name,player:e.player,"protected":e["protected"],protected_until:e.protected_until,type:e.type,use_common_buildings:e.use_common_buildings,x:e.x,y:e.y,dist:Va(q.distx,q.disty,e.x,e.y)});q.targets.terrains={};for(b=
0;b<a.terrain.length;b++)for(c=0;c<a.terrain[b].length;c++)if(d=a.terrain[b][c],n=d[0],n=="Blank"?(n=d[1],f=99):f=d[1],j=d[2],g=d[3],n!="City"){if(n=="CityScape"||n=="Slum"){h=false;for(d=0;d<q.targets.wilderness.length;d++)if(e=q.targets.wilderness[d],e.x==j&&e.y==g){h=true;break}if(h)continue;for(d=0;d<q.targets.cities.length;d++)if(e=q.targets.cities[d],e.x==j&&e.y==g){h=true;break}if(h)continue}q.targets.terrains[n]==void 0&&(q.targets.terrains[n]=[]);q.targets.terrains[n].push({id:j*1E3+g,level:f,
x:j,y:g,dist:Va(q.distx,q.disty,j,g)})}q.stepx++;if(q.stepx>=q.stepMax&&(q.stepx=-q.stepMax,q.stepy++,q.stepy>=q.stepMax))q.stepy=-q.stepMax,q.done=true}else q.retry++,q.done=q.err=q.retry>=10;q.done||setTimeout(q.requestMap,1E3);q.callback&&q.callback()}},xa={xml:{},init:function(a){xa.fetchLocale(function(b){a&&a(b)})},fetchLocale:function(a){var b=xa;s.generalCall("locales/@@id1.xml",Z,"",function(c){if(c.ok){try{var d,e=c.dat,f=new XML.ObjTree;for(d=0;d<10;d++)e=e.replace(RegExp("<"+d,"g"),"<alpha_"+
d).replace(RegExp("</"+d,"g"),"</alpha_"+d);b.xml=f.parseXML(e)}catch(n){c.ok=false,c.errmsg=n.toString()}a&&a(c)}})}},Hb={ptWin:{IsOpen:true,Drag:true,Pos:{x:760,y:93}},size:{x:500,y:800},_reset:{enabled:false,delay:10,unit:60},save:{enabled:false,delay:10,unit:60},blds:{enabled:false,ind:0,type:"",blden:[],bldcap:[],bldexp:[]},wave:{enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],units:[],floors:[],imperial:[]},gang:{enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],
en:[],coords:[],units:[],last:[],leven:[],dist:[],same:60},coll:{collen:[]},trai:{enabled:false,ind:0,type:"",dind:0,dtype:"",traen:[],traqty:[]},rese:{enabled:false,ind:0,type:"",resen:[],rescap:[]},tips:true,inMarch:false,every6:false,bail:false,tabEnabled:[],info:{enabled:true,delay:5,unit:60},flash:{enabled:false,delay:15,unit:60},tool:{enabled:false,delay:15,unit:60},jail:{enabled:true,delay:5,unit:60},bear:{enabled:true,delay:8,unit:3600},TESTOPTION:{}},jb="div {margin:0 ! important}.incoming {font-weight:bold; font-size:24px; color:#FF0000;}div.pbTitle {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#6B7E8B}div.pbTitleRed {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FF0000; background-color:#6B7E8B}div.pbSubtitle {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#444}div.pbSubtitleRed {border:1px solid; border-color:#FFFFFF; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FF0000; background-color:#444}div.pbAttack {border:1px solid; border-color:#FF0000; font-weight:bold; padding-top:2px; padding-bottom:2px; text-align:center; color:#FFFFFF; background-color:#000000}div.pbInput {border:2px; background-color:#6B6258; padding:3px}div.pbStatBox {border:1px solid; border-color:white; background-color:#6B6258; padding:2px}div.short {height:7px;}.hiding {background-color: #21A121; color: white; padding-left: 10px; padding-right: 10px; margin-right: -2px;}.defending {background-color: #F80000; color: white; padding-left: 10px; padding-right: 10px; margin-right: -2px;}table.pbTabWrap {width: 100%;}table.pbTabWrap tr td {border:none; background:none; white-space:normal; padding: 1px 1px}table.pbTabPad {width: 100%;}table.pbTabPad tr td {border:none; background:none; white-space:nowrap; padding: 1px 1px}table.pbTab {width:100%;}table.pbTab tr td {border:none; background:none; white-space:nowrap; padding: 1px 1px;}table tr td.pbTabLeft {font-weight:bold; text-align:left; width: 20%;}table tr td.pbTabRight {text-align:right;}table.pbTabLined tr td {border-bottom:1px solid #ccc; background:none; white-space:nowrap; padding: 1px 4px 1px 4px;}table tr.pbTabHdr1 td {background-color:#dde#000000; font-weight:bold}table tr.pbTabHdr2 td {font-weight:bold}tr.pbMarchOther td {color:#CCCCCC}tr.pbMarchMine td {color:#00FF00}tr.pbMarchEncamp td {color:#FF9900}tr.pbMarchReturn td {color:#33CCFF}tr.pbPoppTop td { background-color:#000000; border:none; height: 21px;  padding:0px; }tr.pbretry_pbPoppTop td { background-color:#a00; color:#fff; border:none; height: 21px; padding:0px; }tr.pbOwned {background-color: #e80000; color:white}table.pbMainTab {empty-cells:show; margin-top:5px; }table.pbMainTab tr td a {color:inherit }table.pbMainTab tr td   {height:60%; empty-cells:show; padding: 0px 5px 0px 5px;  margin-top:5px; white-space:nowrap; border: 2px solid; border-style: none none solid none; }table.pbMainTab tr td.spacer {padding: 0px 1px; border:none;}table.pbMainTab tr td.sel    {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#FFFFFF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSel {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#6B7E8B; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selRed {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#FF0000; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelRed {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#FF0000; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selBlue {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#0000FF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelBlue {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#0000FF; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.selGreen {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#6B7E8B; color:#00FF00; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}table.pbMainTab tr td.notSelGreen {font-weight:bold; font-size:13px; border: 1px solid; border-style: solid solid none solid; background-color:#FFFFFF; color:#00FF00; border-color:#FFFFFF; cursor:hand; cursor:pointer; padding: 2px;}.CPopuppa .CPopMain { color:#FFFFFF; background-color:#000000; padding:6px; z-index:65000; left=700px;}.CPopuppa  {border:3px ridge #666 z-index:65000; left=700px;}input.butAttackOff {width:auto; background-color:#FF0000; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.butAttackOn {width:auto; background-color:#21A121; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.small {margin:0; padding:0; font-size:10px}input.smallGreen {margin:0; padding:0; color:#21A121; font-size:10px}input.smallRed {margin:0; padding:0; color:#FF0000; font-size:10px}input.smallBlue {margin:0; padding:0; color:#0000FF; font-size:10px}input.smallGrey {margin:0; padding:0; color:#909090; font-size:10px}input.smallBrown {margin:0; padding:0; color:#A0522D; font-size:10px}input.smallDisabled {margin:0; padding:0; color:#D8D8D8; font-size:10px}input.normalGreen {margin:0; padding:0; color:#21A121; font-size:13px}input.normalRed {margin:0; padding:0; color:#FF0000; font-size:13px}input.short {width:30px}input.megaButton {width:auto; background-color:#0044a0; color:white; font-weight:bold; cursor:hand; cursor:pointer;}input.megaButton:active {width:auto; background-color:black; color:white; font-weight:bold; cursor:hand; cursor:pointer; }input.megaButton:hover {width:auto; background-color:#770000; color:white; font-weight:bold; cursor:hand; cursor:pointer; }hr.thin {margin:0px; padding:0px}#ft ul.tabs li.tab a.toolbutOn {background-color:#900 ! important; color:white ! important}#ft ul.tabs li.tab a.toolbuttOff {background-color:#ffc ! important; color:black ! important}span.LinkWhite {color:#FFFFFF}span.boldRed {color:#FF0000; font-weight:bold}span.normalRed {color:#FF0000}span.boldGreen {color:#21A121; font-weight:bold}span.normalGreen {color:#21A121}span.toSpectral {color:#FF9900; font-weight:bold}span.toCity {color:#33CCFF; font-weight:bold}.xstooltip {font: normal 8pt sans-serif; padding: 3px; border: solid 1px; background: ivory; color: black}";
typeof JSON!=="object"&&(JSON={});(function(){function a(a){return a<10?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=j[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,j,h,l,o=f,p,I=d[a];I&&typeof I==="object"&&typeof I.toJSON==="function"&&(I=I.toJSON(a));typeof g==="function"&&(I=g.call(d,a,I));switch(typeof I){case "string":return b(I);case "number":return isFinite(I)?String(I):
"null";case "boolean":case "null":return String(I);case "object":if(!I)return"null";f+=n;p=[];if(Object.prototype.toString.apply(I)==="[object Array]"){l=I.length;for(e=0;e<l;e++)p[e]=c(e,I)||"null";h=p.length===0?"[]":f?"[\n"+f+p.join(",\n"+f)+"\n"+o+"]":"["+p.join(",")+"]";f=o;return h}if(g&&typeof g==="object"){l=g.length;for(e=0;e<l;e++)typeof g[e]==="string"&&(j=g[e],(h=c(j,I))&&p.push(b(j)+(f?": ":":")+h))}else for(j in I)Object.prototype.hasOwnProperty.call(I,j)&&(h=c(j,I))&&p.push(b(j)+(f?
": ":":")+h);h=p.length===0?"{}":f?"{\n"+f+p.join(",\n"+f)+"\n"+o+"}":"{"+p.join(",")+"}";f=o;return h}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,n,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,d){var e;n=f="";if(typeof d==="number")for(e=0;e<d;e++)n+=" ";else typeof d==="string"&&(n=d);if((g=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return c("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function c(a,d){var e,f,n=a[d];if(n&&typeof n==="object")for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(f=c(n,e),f!==void 0?n[e]=f:delete n[e]);return b.call(a,d,n)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();var ra=JSON,Qa=null,fb=0,p={tickTimer:null,serverTimeOffset:0,marches:{total:0,encamped:0,retreating:0,marching:0,active:0},player:{},indcity:0,ntick:0,showInfo:false,readManifest:function(){s.calls["flash/man.kabam"].parms.cachebreaker=C();s.generalCall("flash/man.kabam","","",function(){S.readStore()},true)},readInfoPlayer:function(){s.generalCall("player.json",
"","",function(a){if(a.ok)p.player=a.dat,p.indcity=0,p.readNextCity()})},readNextCity:function(){function a(a){if(a.ok)p.player.cities[p.indcity]=a.dat.city,p.indcity++,setTimeout(p.readNextCity,2E3)}p.indcity>=p.player.cities.length?kb||Jb():s.generalCall("cities/@@id1.json",p.player.cities[p.indcity].id,"",a)},readCitySingle:function(a){s.generalCall("cities/@@id1.json",p.player.cities[a].id,"",function(b){if(b.ok)p.player.cities[a]=b.dat.city,A.getInJail(a,true)})},setVarious:function(a){if(a.ok){a=
a.dat;if(a.energy)p.player.energy=a.energy;if(a.respect)p.player.respect=a.respect;if(a.boosts)p.player.boosts=a.boosts;if(a.quests)p.player.quests=a.quests}},tick:function(){var a=p;R.refreshTabs();a.ntick++;a.userOK();v.runCitiesRefresh();N.checkAndCountMarches();if(!l.options.inMarch&&p.marches.active!==0)l.options.inMarch=true;if(l.options.inMarch&&a.ntick%20===0)O.type="BattleReport",O.readPage()},userOK:function(){var a=false;return true}},ka={timer:null,but:null,init:function(){var a=ka;if(!l.options.ptWin.IsOpen)clearInterval(a.timer),
a.timer=setInterval(a.blink,1500)},show:function(a){var b=ka;if(l.options.ptWin.IsOpen!=a)if(l.options.ptWin.IsOpen=a,aa.show(a),clearInterval(b.timer),a){if(b.but)b.but.className="toolbuttOff"}else b.timer=setInterval(b.blink,1500)},setBlinkElement:function(a){ka.but=a},blink:function(){var a=ka;if(a.but)a.but.className=a.but.className=="toolbuttOff"?"toolbutOn":"toolbuttOff"}};Date.prototype.myString=function(){return this.toLocaleDateString()+" "+this.toLocaleTimeString()};Date.prototype.formatTime=
function(){var a=this.getHours(),b=this.getMinutes(),c=this.getSeconds();return(a<10?"0":"")+a+Ra+(b<10?"0":"")+b+Ra+(c<10?"0":"")+c};Date.prototype.formatDate=function(a){var b=this.getDate(),c=this.getMonth(),d=this.getFullYear();a==void 0&&(a="it");c++;switch(a){case "sv":case "en":a=d+ia+(c<10?"0":"")+c+ia+(b<10?"0":"")+b;break;default:a=(b<10?"0":"")+b+ia+(c<10?"0":"")+c+ia+d}return a};var Sa={it:{Info:"Info",Ataques:"Atacar",Banda:"Banda","Construir":"Constuir.",Entrenar:"Entrenar",Investigar:"Investigar",Recolectar:"Recolectar",
Rueda:"Rueda",Varios:"Varios","Opciones":"Opciones","Acerca de":"Acerca de","Creato da":"Creato da","Errore di Inizializzazione":"Errore di Inizializzazione","SWF non trovato":"SWF non trovato","Non posso caricare":"Non posso caricare",Caricato:"Caricato","sar\u00e0 ricaricato tra 10 secondi":"sar\u00e0 ricaricato tra 10 secondi","Sommario di tutte le attivit\u00e0":"Sommario di tutte le attivit\u00e0","Buon gioco":"Buon gioco","Actualizar Informaci√≥n":"Actualizar Informaci√≥n","Recargar GF":"Recargar GF","Mostrar Flash":"Mostrar Flash","Ocultar flash":"Ocultar flash",
"Seleziona le tue preferenze e":"Seleziona le tue preferenze e","Questo tab ti informa sul nostro tool":"Questo tab ti informa sul nostro tool","Gruppo su Facebook":"Gruppo su Facebook","LOG AZIONI":"LOG AZIONI","Cancella Log":"Cancella Log",Errore:"Errore",CHIUDI:"CHIUDI","Non riprovare":"Non riprovare","Riprovo tra":"Riprovo tra","in automatico":"in automatico","Leggi Info ogni":"Leggi Info ogni","Leggi ORA":"Leggi ORA","Riavvia Flash ogni":"Riavvia Flash ogni","Riavvia ORA":"Riavvia ORA","Riavvia Tool ogni":"Riavvia Tool ogni",
"Segundos":"Segundos","Minutos":"Minutos","Horas":"Horas","Dias":"Dias","Opciones":"Opciones","Ritardo tra attacchi":"Ritardo tra attacchi","Ritardo stesso obiettivo":"Ritardo stesso obiettivo","Elimina rapporti":"Elimina rapporti","Scan Mappa":"Scan Mappa","Scansione terminata":"Scansione terminata","Scansione gang di":"Scansione gang di","Distancia":"Distancia","Coordinadas":"Coordinadas","Ultimo ataque":"Ultimo ataque","Ultimi attacchi":"Ultimi attacchi","Raggiunto il limite massimo delle marce":"Raggiunto il limite massimo delle marce",
"Non hai abbastanza":"Non hai abbastanza","Troppe truppe":"Troppe truppe","Iniziate il":"Iniziate il","Tempo di esecuzione":"Tempo di esecuzione",Attacchi:"Attacchi",Abilita:"Abilita","Energia insufficiente":"Energia insufficiente","Nessuna truppa selezionata":"Nessuna truppa selezionata","Nessun obiettivo selezionato":"Nessun obiettivo selezionato","Nessun obiettivo disponibile":"Nessun obiettivo disponibile","Raccogli dai tuoi slot":"Raccogli dai tuoi slot",neighborhood:"Centrale",east:"Est",west:"Ovest",
south:"Sud",north:"Nord",Piano:"Piano",ogni:"ogni",packages:"Pacchi","le MURDER pi\u00f9 vicine entro una distanza di 37":"le MURDER pi\u00f9 vicine entro una distanza di 37","Copia in Onda":"Copia in Onda",ORA:"ORA","EN PRISI√ìN":"EN PRISI√ìN",Controlla:"Controlla","Clicca per aiutarci":"Clicca per aiutarci",Caratteristiche:"Caratteristiche","In arrivo":"In arrivo"},en:{Info:"Info",Atacar:"Ataques",Banda:"Banda","Construir":"Construir",Entrenar:"Entrenar",Investigar:"Research",Recolectar:"Collect",Rueda:"Wheel",Varios:"Various",
"Opciones":"Opciones","Acerca de":"Acerca de","Creato da":"Creado por","Errore di Inizializzazione":"Error on Initializing","SWF non trovato":"SWF not found","Non posso caricare":"I can't load",Caricato:"Loaded","sar\u00e0 ricaricato tra 10 secondi":"will be reloaed in 10 seconds","Sommario di tutte le attivit\u00e0":"Summary of all activities","Buon gioco":"Good game","Actualizar Informaci√≥n":"Update Info","Recargar GF":"Reload GF","Mostrar Flash":"Show Flash","Ocultar flash":"Hide Flash","Seleziona le tue preferenze e":"Select your preferences and",
"Questo tab ti informa sul nostro tool":"These tab inform you about our tool","Gruppo su Facebook":"Facebook Group","LOG AZIONI":"ACTIONS LOG","Cancella Log":"Delete Log",Errore:"Error",CHIUDI:"CLOSE","Non riprovare":"Not Retry","Riprovo tra":"Retry in","in automatico":"automatically","Leggi Info ogni":"Read Info every","Leggi ORA":"Read NOW","Riavvia Flash ogni":"Restart Flash every","Riavvia ORA":"Restart NOW","Riavvia Tool ogni":"Restart Tool every",Segundos:"Seconds",Minutos:"Minutes",Horas:"Hours",
Dias:"Days",Opciones:"Options","Ritardo tra attacchi":"Delay between attacks","Ritardo stesso obiettivo":"Delay same target","Elimina rapporti":"Delete reports","Scan Mappa":"Scan Map","Scansione terminata":"Scan finished","Scansione gang di":"Scan gang of",Distancia:"Distance",Coordinadas:"Coordinates","Ultimo ataque":"Last attack","Ultimi attacchi":"Last attacks","Raggiunto il limite massimo delle marce":"Marches: reached maximum limit","Non hai abbastanza":"You don't have enough","Troppe truppe":"Too many troops",
"Iniziate il":"Started at","Tempo di esecuzione":"Run Time",Attacchi:"Attacks",Abilita:"Enable","Energia insufficiente":"Insufficient energy","Nessuna truppa selezionata":"No troops selected","Nessun obiettivo selezionato":"No target selected","Nessun obiettivo disponibile":"No target available","Raccogli dai tuoi slot":"Collect from your slot",neighborhood:"Central",east:"East",west:"West",south:"South",north:"North",Piano:"Floor",ogni:"every",packages:"packages","le MURDER pi\u00f9 vicine entro una distanza di 37":"the nearest MURDER in a distance of 37",
"Copia in Onda":"Copy to Wave",ORA:"NOW","EN PRISI√ìN":"In Jail",Controlla:"Check","Clicca per aiutarci":"Click for help us",Caratteristiche:"Options","In arrivo":"Coming soon"},de:{Info:"Info",Atacar:"Atacar",Banda:"Banda","Construir":"Construir",Entrenar:"Entrenar",Investigar:"Investigar",Recolectar:"Recolectar",Rueda:"Rueda",Varios:"Varios","Opciones":"Opciones","Acerca de":"Acerca de","Creado por":"Creado por","Errore di Inizializzazione":"Ladefehler","SWF non trovato":"SWF nicht gefunden","Non posso caricare":"Nicht geladen",
Caricato:"Geladen","sar\u00e0 ricaricato tra 10 secondi":"wird in 10 Sekunden neu geladen","Sommario di tutte le attivit\u00e0":"Uebersicht","Buon gioco":"Gutes Spiel","Actualizar Informaci√≥n":"aktualisieren Info","Recargar GF":"Nachladen GF","Mostrar Flash":"Flash zeigen","Ocultar flash":"Flash verbergen","Seleziona le tue preferenze e":"Waehle deine Einstellungen und","Questo tab ti informa sul nostro tool":"Diese Tab informieren Sie \u00fcber uns Tool","Gruppo su Facebook":"Facebook Gruppe","LOG AZIONI":"AKTIONEN LOG",
"Cancella Log":"Loesche Log",Errore:"Fehler",CHIUDI:"SCHLIESSEN","Non riprovare":"Kein Neuversuch","Riprovo tra":"Neuversuch in","in automatico":"automatisch","Leggi Info ogni":"Infos einlesen alle","Leggi ORA":"JETZT neu einlesen","Riavvia Flash ogni":"Flash Neustart alle","Riavvia ORA":"JETZT neu starten","Riavvia Tool ogni":"Tool Neustart alle",Secondi:"Sekunden",Minuti:"Minuten",Ore:"Stunden",Giorni:"Tage",Opzioni:"Optionen","Ritardo tra attacchi":"Angiffs Zeitintervall","Ritardo stesso obiettivo":"Zeitintervall bei gleichen Zielen",
"Elimina rapporti":"Berichte loeschen","Scan Mappa":"Karte scannen","Scansione terminata":"Scan abgeschlossen","Scansione gang di":"Gangs scannen von",Distanza:"Distanz",Coordinate:"Koordinaten","Ultimo attacco":"Letzter Angriff","Ultimi attacchi":"Letzte Angriffe","Raggiunto il limite massimo delle marce":"Befehle: Maximum Limit erreicht","Non hai abbastanza":"Du hast nicht genug","Troppe truppe":"Zu viele Einheiten","Iniziate il":"Gestartet um","Tempo di esecuzione":"Laufzeit",Attacchi:"Angriffe",
Abilita:"Aktivieren","Energia insufficiente":"Unzureichende Energie","Nessuna truppa selezionata":"Keine Einheiten ausgewaehlt","Nessun obiettivo selezionato":"Kein Ziel ausgewaehlt","Nessun obiettivo disponibile":"Kein Ziel vorhanden","Raccogli dai tuoi slot":"Slots einsammeln",neighborhood:"Zentral",east:"Ost",west:"West",south:"Sued",north:"Nord",Piano:"Etage",ogni:"alle",packages:"Pakete","le MURDER pi\u00f9 vicine entro una distanza di 37":"die n\u00e4chsten MURDER in einer Entfernung von 37",
"Copia in Onda":"Kopieren auf Welle",ORA:"JETZT","EN PRISI√ìN":"Im Gef\u00e4ngnis",Controlla:"Pr\u00fcfen","Clicca per aiutarci":"Klicken Sie um Hilfe",Caratteristiche:"Optionen","In arrivo":"Kommt bald"},fr:{Info:"Info",Atacar:"Atacar",Banda:"Banda","Construir":"Construir",Entrenar:"ENTRA\u00ceNER",Investigar:"Investigar",Recolectar:"Recolectar",Rueda:"Rueda",Varios:"Varios","Opciones":"Opciones","Acerca de":"Acerca de","Creato da":"Cr\u00e9\u00e9 par","Errore di Inizializzazione":"Erreur de initialisation","SWF non trovato":"SWF introuvable",
"Non posso caricare":"Je ne peux pas t\u00e9l\u00e9charger",Caricato:"Charg\u00e9","sar\u00e0 ricaricato tra 10 secondi":"sera recharg\u00e9e en 10 secondes","Sommario di tutte le attivit\u00e0":"R\u00e9sum\u00e9 de toutes les activit\u00e9s","Buon gioco":"Bon jeu","Actualizar Informaci√≥n":"Mise \u00e0 jour Info","Recargar GF":"Recharger GF","Mostrar Flash":"Voir le Flash","Ocultar flash":"Masquer le Flash","Seleziona le tue preferenze e":"S\u00e9lectionnez vos pr\u00e9f\u00e9rences et","Questo tab ti informa sul nostro tool":"Cet onglet vous informer sur notre tool",
"Gruppo su Facebook":"Groupe Facebook","LOG AZIONI":"JOURNAL DES ACTIONS","Cancella Log":"Effacer le journal",Errore:"Erreur",CHIUDI:"FERMER","Non riprovare":"Ne pas essayer","Riprovo tra":"Essayez \u00e0 nouveau dans","in automatico":"automatiquement","Leggi Info ogni":"Lire Info toutes les","Leggi ORA":"Lire MAINTENANT","Riavvia Flash ogni":"Red\u00e9marrez Flash toutes les","Riavvia ORA":"Red\u00e9marrez MAINTENANT","Riavvia Tool ogni":"Red\u00e9marrez le Tool toutes les",Secondi:"Secondes",Minuti:"Minutes",
Ore:"Heures",Giorni:"Jours",Opzioni:"Options","Ritardo tra attacchi":"Retard entre les attaques","Ritardo stesso obiettivo":"Retard m\u00eame objectif","Elimina rapporti":"Supprimer des rapports","Scan Mappa":"Balayage Carte","Scansione terminata":"Balayage termin\u00e9e","Scansione gang di":"Balayage de gang de",Distanza:"Distance",Coordinate:"Coordonn\u00e9es","Ultimo attacco":"Derni\u00e8re attaque","Ultimi attacchi":"Derni\u00e8res attaques","Raggiunto il limite massimo delle marce":"Marches: a atteint la limite maximale",
"Non hai abbastanza":"Vous ne avez pas assez de","Troppe truppe":"Trop de troupes","Iniziate il":"Commenc\u00e9 le","Tempo di esecuzione":"Dur\u00e9e",Attacchi:"Attaques",Abilita:"Activer","Energia insufficiente":"\u00c9nergie insuffisante","Nessuna truppa selezionata":"Aucune troupe choisie","Nessun obiettivo selezionato":"Aucune objectif s\u00e9lectionn\u00e9e","Nessun obiettivo disponibile":"Aucune objectif disponible","Raccogli dai tuoi slot":"Chercher \u00e0 votre slot",neighborhood:"Central",
east:"Est",west:"Ouest",south:"Sud",north:"Nord",Piano:"\u00c9tage",ogni:"toutes les",packages:"Colis","le MURDER pi\u00f9 vicine entro una distanza di 37":"les plus proches MURDER dans une distance de 37","Copia in Onda":"Copie en Onde",ORA:"MAINTENANT","EN PRISI√ìN":"En Prison",Controlla:"V\u00e9rifier","Clicca per aiutarci":"Cliquez pour nous aider",Caratteristiche:"Options","In arrivo":"Vient"},nl:{"":""},es:{"":""},sv:{"":""},da:{"":""}},v={citiesToRefresh:[],citiesExpansions:[],collectToken:function(){var a=
v.getCityId(0);s.calls["loyalty_tokens/collect.json"].parms.city_id=a;s.generalCall("loyalty_tokens/collect.json","","",function(){})},exchangeToken:function(a){var b=v.getCityId(0);s.calls["loyalty_tokens/trade.json"].parms.city_id=b;s.calls["loyalty_tokens/trade.json"].parms.item_name=a;s.generalCall("loyalty_tokens/trade.json","","",function(){})},checkBear:function(){function a(a){a.ok&&o.Various.type==ha&&o.Various.showDiv()}var b=v.getCityId(0);s.calls["bonds.json"].parms.city_id=b;s.generalCall("bonds.json",
"","",function(b){if(b.ok){var b=b.dat.result,d,e;for(d=0;d<b.bonds_list.length;d++)if(e=b.bonds_list[d],e.name=="BearerBond"&&e.quantity==e.quantity_limit){b=v.getCityId(0);s.calls["bonds/redeem.json"].parms.city_id=b;s.generalCall("bonds/redeem.json","","",a);break}}})},getJailSize:function(a){var b=p.player.cities[a],c=2E3,d,e,f,n,j;if(b.type=="DoriaAirport")return 0;for(f=0;f<y.length;f++)if(v.citiesExpansions[a][y[f]]!==void 0&&v.citiesExpansions[a][y[f]])for(d in n=K.getBuildsByArea(a,y[f]),
n)if(j=n[d],j.builds.length!==0)switch(d){case "Hideout":for(e=0;e<j.builds.length;e++)j.builds[e].level==10?c+=25:j.builds[e].level==11?c+=100:j.builds[e].level==12&&(c+=250);break;case "SafeHouse":j.builds[j.builds.length-1].level>1&&(c+=100*(j.builds[j.builds.length-1].level-1))}b.research&&b.research.Bureaucracy&&(c+=250*b.research.Bureaucracy);return c},defendCity:function(a){var b=v.getCityId(a),a=!p.player.cities[a].defended;s.calls["#cities/@@id1.json"].parms.city_id=b;s.calls["#cities/@@id1.json"].parms.defended=
a===true?1:0;s.generalCall("#cities/@@id1.json",b,"",function(a){if(a.ok){var a=a.dat,b=v.getCityIndById(a.city.id);p.player.cities[b]=a.city;o.Build.showInfo();o.Train.showInfo()}})},getUnits:function(a){var b={},a=p.player.cities[a],c,d;for(d in a.units)b[d]==void 0&&(b[d]={incity:0,inmarch:0,retreat:0,encamped:0}),b[d].incity+=a.units[d];for(c=0;c<a.marches.length;c++)for(d in a.marches[c].units)switch(b[d]==void 0&&(b[d]={incity:0,inmarch:0,retreat:0,encamped:0}),a.marches[c].status){case "encamped":b[d].encamped+=
a.marches[c].units[d];break;case "retreating":b[d].retreat+=a.marches[c].units[d];break;default:b[d].inmarch+=a.marches[c].units[d]}return b},remainingTimeToCollect:function(a,b){var c=C(),d=1,d=0;if(b!==0)if(l.options.every6)d=21600-u(c-b);else{var e=K.getBuildsByFirstHood(a);if(e.Mansion)d=e.Mansion.builds[0].level,d=21600*(1-3*(d-1)/100)-u(c-b)}return d},assignExpansions:function(){var a,b,c=p.player.cities,d=v.citiesExpansions;d==void 0&&(d=[]);for(a=0;a<c.length;a++){d[a]==void 0&&(d[a]={});
for(b=0;b<y.length;b++)c[a].neighborhoods[y[b]]&&d[a][y[b]]==void 0&&(d[a][y[b]]=true)}},addToRefresh:function(a){var b,c=-1;for(b=0;b<v.citiesToRefresh.length;b++)if(v.citiesToRefresh[b].index==a){c=b;break}c==-1&&v.citiesToRefresh.push({index:a,isRefresh:false})},readCityToRefresh:function(a,b){p.showInfo=b;p.readCitySingle(a);b&&o.Options.setTimerInfo()},runCitiesRefresh:function(){var a,b=0,c=-1;for(a=0;a<v.citiesToRefresh.length;a++)v.citiesToRefresh[a].isRefresh||(c=a);for(a=0;a<v.citiesToRefresh.length;a++)if(!v.citiesToRefresh[a].isRefresh)v.citiesToRefresh[a].isRefresh=
true,setTimeout(v.readCityToRefresh,b*2E3,a,v.citiesToRefresh[a].index==c),b++;v.citiesToRefresh=[]},getCityTitle:function(a,b){var c="",d=p.player.cities[a],e="";switch(b.tabLabel){case Ya:e="info";break;case Za:e="blds";break;case "Entr.":e="trai"}c+="<TABLE width=100%><TR>";c+="<TD align=left>&nbsp;"+p.player.cities[a].name;var f=v.getJailSize(a);f!==0&&(c+=" ("+D(f)+")");b.expand&&(c+="&nbsp;"+B("pb"+e+"HideShow_"+a," "+(b.expand[a]===true?"-":"+")+" ",false,false,"small"));c+="</td>";c+="<TD align=center>";
c+=B("pb"+e+"Defend_"+a,v.getCityDefended(a),false,false,v.getClassDefended(a),"border:none; font-weight:bold");c+="</td>";c+="<TD align=right>"+d.x+"/"+d.y+"&nbsp;</td>";c+="</tr><table>";return c},getCityDefended:function(a){return h(p.player.cities[a].defended===true?"troops-defending":"troops-hide","common")},getClassDefended:function(a){return p.player.cities[a].defended===true?"defending":"hiding"},getCityIndById:function(a){var b=-1,c,d,e=p.player.cities;for(c=0;c<e.length;c++)if(d=e[c],d.id==
a){b=c;break}return b},getCityIndByName:function(a){var b=-1,c,d,e=p.player.cities;for(c=0;c<e.length;c++)if(d=e[c],d.name==a){b=c;break}return b},getCityId:function(a){return p.player.cities[a].id},getNeighId:function(a,b){b==void 0&&(b="neighborhood");return p.player.cities[a].neighborhoods[b].id}},G={addJob:function(a){var b=G.searchJobById(a.id),c,d=p.player.cities;b!=-1&&G.deleteJob(a.id);for(b=0;b<d.length;b++)if(c=d[b],c.id==a.city_id){c.jobs.push(a);break}},deleteJob:function(a){var b=G.searchJobById(a);
if(b!=-1){a=u(b/100);b%=100;var c=p.player.cities[b],d=c.jobs[a];switch(d.queue){case "building":K.setLevelBuild(b,d.city_building_id,d.level)}c.jobs.splice(a,1)}},searchJobById:function(a){var b=-1,c,d,e,f=p.player.cities;for(c=0;c<f.length;c++){e=f[c];for(d=0;d<e.jobs.length;d++)if(e.jobs[d]&&e.jobs[d].id==a){b=d*100+c;break}if(b!=-1)break}return b},getJobsByQueue:function(a,b){var c=[],d,e=p.player.cities[b];for(d=0;d<e.jobs.length;d++)(e.jobs[d]&&e.jobs[d].queue==a||a==="")&&c.push(e.jobs[d]);
return c}},K={checkRequirements:function(a,b){var c=true,d=b.level,e=b.type,f=Math.pow(2,d);if(Ea[e]){c=za(Ea[e]);for(r in c.resources)c.resources[r]*=f;if(d==9){if(c.items==void 0)c.items={};c.items.DonsBlessing==void 0&&(c.items.DonsBlessing=1)}else if(d>9){if(c.items==void 0)c.items={};c.items.DonsBlessing11==void 0&&(c.items.DonsBlessing11=1)}c=Ta(a,c)}return c},setLevelBuild:function(a,b,c){a=K.getBuildById(a,b);if(a!==null)a.level=c},getBuildByType:function(a,b){var c=null,d,e;for(d=0;d<p.player.cities[a].neighborhoods.neighborhood.buildings.length;d++)if(e=
p.player.cities[a].neighborhoods.neighborhood.buildings[d],e.type==b){c=e;break}return c},getBuildById:function(a,b){var c=null,d,e,f,n,j=false;for(d=0;d<y.length;d++){if((e=p.player.cities[a].neighborhoods[y[d]])&&e.buildings){n=e.buildings;for(e=0;e<n.length;e++)if(f=n[e],f.id==b){c=f;j=true;break}}if(j)break}return c},getBuildsByArea:function(a,b,c,d){var e={},a=p.player.cities[a].neighborhoods[b].buildings,f;c==void 0&&(c="");d==void 0&&(d=false);if(a){for(f=0;f<a.length;f++)if(b=a[f],!(b.slot==
void 0||b.location==void 0)){if(d){if(b.unlocked!==true)continue}else if(b.unlocked!==void 0)continue;if(b.location==c||c===""){if(!e[b.type])e[b.type]={},e[b.type].builds=[];e[b.type].builds.push(b)}}for(f in e)e[f].builds.sort(function(a,b){return a.level-b.level})}return e},getBuildsByFirstHood:function(a,b,c){return K.getBuildsByArea(a,y[0],b,c)}},N={showMarchTooltip:function(a){N.showideMarchTooltip(a,true)},hideMarchTooltip:function(a){N.showideMarchTooltip(a,false)},showideMarchTooltip:function(a,
b){var c;for(c=window.event.srcElement;c.tagName!="TR"&&c.tagName!="TABLE";)c=c.parentNode;c.tagName=="TR"&&(c=c.getAttribute("ref"),b?nb(a,c,void 0):qb())},getTimerDelayMarch:function(a){var b;a?(a=l.options.wave.min,b=l.options.wave.max):(a=l.options.gang.min,b=l.options.gang.max);return Math.randRange(a*1E3,b*1E3)},checkAttack:function(a,b,c,d){var e=p.player.cities,f=0,n=0,j={ok:false,msg:""},g;d==void 0&&(d=false);if(p.player.energy)n=p.player.energy;if(n===0)return c.showFeedback(h("Energia insufficiente")+
"!"),j;for(n=0;n<e[b].marches.length;n++)(g=e[b].marches[n])&&g.status!="encamped"&&f++;f++;if(f>e[b].figures.marches.maximum)return c.showFeedback(h("Raggiunto il limite massimo delle marce")),j;f=0;for(n in a){g=e[b].units[n]?e[b].units[n]:0;if(a[n]>g){j.msg=p.player.cities[b].name+" "+h("Non hai abbastanza")+" "+h(n,"troops")+"!";break}f+=a[n]}if(j.msg==="")if(f>e[b].figures.marches.maximum_troops)j.msg=p.player.cities[b].name+" "+h("Troppe truppe")+"!";else if(f===0)j.msg=p.player.cities[b].name+
" "+h("Nessuna truppa selezionata")+"!";j.msg!==""?d&&c.showFeedback(j.msg):j.ok=true;return j},getMarchFromJob:function(a){var b=null,c=v.getCityIndById(a.city_id),c=p.player.cities[c],d,e;for(d=0;d<c.marches.length;d++)if(e=c.marches[d],e.id==a.march_id){b=e;break}return b},recallMarch:function(a,b){s.calls["cities/@@id1/marches/@@id2.json"].parms.city_id=a;s.generalCall("cities/@@id1/marches/@@id2.json",a,b,function(a){if(a.ok){var a=a.dat.result,b=v.getCityIndById(a.job.city_id);p.player.cities[b]=
a.city}})},sendAttack:function(a,b,c,d,e,f,n){var j,z="{",M=1;n!=void 0&&(M=n);for(j in c)z!="{"&&(z+=","),z+='"'+j+'":'+c[j];z+="}";s.calls["cities/@@id1/marches.json"].parms["march[floor]"]=M;s.calls["cities/@@id1/marches.json"].parms["march[x]"]=a;s.calls["cities/@@id1/marches.json"].parms["march[y]"]=b;s.calls["cities/@@id1/marches.json"].parms["march[units]"]=z;s.calls["cities/@@id1/marches.json"].parms.city_id=d;s.generalCall("cities/@@id1/marches.json",d,"",function(a){if(a.ok){var a=a.dat.result,
b=v.getCityIndById(a.job.city_id),c=C();p.player.cities[b]=a.city;a=N.getMarchFromJob(a.job);if(f!=-1)l.options.gang.coords[b][f].time=c;else if(l.options.wave.imperial[b]===true)for(b=0;b<p.player.cities.length;b++)if(l.options.wave.imperial[b]===true&&(l.options.wave.en[b]=false,o.Wave.type==Q&&o.Wave.indcityTroops==b))g("pbwaveCityChk_"+Q).checked=false;o.Gang.type==V&&o.Gang.showDiv();a!==null?da(h("march","common")+" "+h("request-sent","common")+": "+a.x+"/"+a.y):da(h("march","common")+" "+h("request-sent",
"common"));l.options.inMarch=true}else da(h("Errore")+" in "+h("march","common")+": "+a.errmsg)});e.showFeedback(h("march","common")+" "+h("request-sent","common")+": "+a+"/"+b)},getJobByMarch:function(a,b){var c=v.getCityIndById(a),c=G.getJobsByQueue("march",c),d,e=null;for(d=0;d<c.length;d++)if(c[d].march_id==b){e=c[d];break}return e},checkAndCountMarches:function(){var a=p.player.cities,b,c,d,e,f=C();p.marches={total:0,encamped:0,retreating:0,marching:0,active:0};for(b=0;b<a.length;b++){p.marches.total+=
a[b].marches.length;for(c=0;c<a[b].marches.length;c++)if(d=a[b].marches[c])if(d.status=="encamped")p.marches.encamped++;else if((e=N.getJobByMarch(a[b].id,d.id))&&!(e.run_at==void 0||isNaN(e.run_at)))if(e=u(e.run_at-f),e<=0){if(d.status=="marching")d.status="retreating",p.marches.retreating++,p.marches.active++}else d.status=="marching"?p.marches.marching++:p.marches.retreating++,p.marches.active++}},showTab:function(a){var b=p.player.cities,c,d,e,f,n,j,z,M,q,L,s,w=C(),E=[];a==void 0&&(a=false);var F=
g("pb"+(a===true?"wave":"gang")+"TabMarches");for(f=0;f<F.rows.length;f++){E.push(F.rows[f].getAttribute("refid"));M=-1;for(c=0;c<b.length;c++){for(d=0;d<b[c].marches.length;d++)if(e=b[c].marches[d],e.id==E[f]){M=f;break}if(M!=-1)break}M==-1&&(E[f]=0)}for(f=F.rows.length-1;f>=0;f--)E[f]===0&&F.deleteRow(f);E=[];for(f=0;f<F.rows.length;f++)E.push(F.rows[f].getAttribute("refid"));for(c=0;c<b.length;c++){M=false;for(d=b[c].marches.length-1;d>=0;d--)if(e=b[c].marches[d]){L=null;for(f=0;f<F.rows.length;f++)if(e.id==
E[f]){L=F.rows[f];break}L===null&&(L=F.insertRow(0),L.setAttribute("refid",e.id),L.insertCell(0),L.insertCell(1),L.insertCell(2),L.insertCell(3),L.insertCell(4));f=N.getJobByMarch(b[c].id,e.id);if(e.status!="encamped")if(!f||f.run_at==void 0||isNaN(f.run_at)){if(f="---",e.status=="marching")e.status="encamped",M=true}else f=u(f.run_at-w),f<=0?(f="...",M=true):f=Y(f,true);else f="---";n="Attack";e.march_type=="Transport"||e.march_type=="TransportMarch"?n="Transport":e.march_type=="SpyMarch"&&(n="Tip-Off");
e.destination_name?e.destination_name==b[c].name?(z=p.player.cities[c].name,e.status=="retreating"&&(n="Return")):(z=e.destination_name,e.status!="marching"&&(n="Encamp")):z="("+h(e.terrain_type,"map")+"-"+e.terrain_level+")";j="pbMarchOther";e.status=="encamped"?j="pbMarchEncamp":(q=a?l.options.wave.coords[c].x==e.x&&l.options.wave.coords[c].y==e.y:o.Gang.isInActiveList(c,e.x,e.y))?j="pbMarchMine":e.destination_name&&(n=="Return"?j="pbMarchReturn":n=="Encamp"&&(j="pbMarchEncamp"));n="";for(s in e.units)n!==
""&&(n+="<BR>"),n+=e.units[s]+" "+h(s,"troops");L.className=j;L.cells[0].innerHTML=e.x+"/"+e.y;L.cells[1].innerHTML=z;L.cells[2].innerHTML=h(e.status,"common");L.cells[3].innerHTML=f;L.setAttribute("ref",n)}M&&v.addToRefresh(c)}}},A={injail:[],indcity:0,showInfo:false,checkRequirements:function(a,b,c){var d=true;if(p.player.cities[a].type=="DoriaAirport"){if(ua[b]){b=za(ua[b]);for(r in b.units)b.units[r]*=c;d=Ta(a,b)}}else if(ba[b]){b=za(ba[b]);for(r in b.resources)b.resources[r]*=c;for(r in b.items)b.items[r]*=
c;d=Ta(a,b)}return d},initJail:function(){var a;A.injail=[];for(a=0;a<p.player.cities.length;a++)A.injail.push({})},getInJail:function(a,b){function c(a){if(a.ok)a=a.dat.result,A.injail[A.indcity]=a.units,A.showInfo&&o.Train.showInfo()}if(p.player.cities[a].type!="DoriaAirport"){var d=p.player.cities[a].id;A.injail[a]={};A.indcity=a;A.showInfo=b;s.calls["cities/@@id1/cash_jail.json"].parms.city_id=d;s.generalCall("cities/@@id1/cash_jail.json",d,"",c)}},getAllJailed:function(){var a;for(a=0;a<p.player.cities.length;a++)setTimeout(A.getInJail,
a*1E3,a,a==p.player.cities.length-1)},bailOutAuto:function(){var a=p.player.cities,b,c,d,e;for(b=0;b<a.length;b++)for(c in A.injail[b])if(ba[c].bail&&(e=u(p.player.cities[b].resources.cash/ba[c].bail),!(e<1))){e>A.injail[b][c]&&(e=A.injail[b][c]);d={};d[c]=e;setTimeout(A.bailOut,b*1E3,b,d);break}},bailOut:function(a,b){function c(a){a.ok&&A.getInJail(A.indcity,true)}if(p.player.cities[a].type!="DoriaAirport"){var d=p.player.cities[a].id,e,f;for(e in s.calls["cities/@@id1/cash_jail/bail.json"].parms)e.startsWith("units")&&
delete s.calls["cities/@@id1/cash_jail/bail.json"].parms[e];for(f in b)b[f]!==0&&(s.calls["cities/@@id1/cash_jail/bail.json"].parms["units["+f+"]"]=b[f]);A.indcity=a;s.calls["cities/@@id1/cash_jail/bail.json"].parms.city_id=d;s.generalCall("cities/@@id1/cash_jail/bail.json",d,"",c)}},train:function(a,b,c,d){var e=p.player.cities[a].id,f="cities/@@id1/units.json";p.player.cities[a].type=="DoriaAirport"&&(f="troop_crafting/craft.json",s.calls[f].parms["units[building_id]"]=d);s.calls[f].parms["units[unit_type]"]=
b;s.calls[f].parms["units[quantity]"]=c;s.calls[f].parms.city_id=e;s.generalCall(f,e,"",function(a){if(a.ok){var a=a.dat.result,b=v.getCityIndById(a.city.id);p.player.cities[b]=a.city}})},isDefensive:function(a){var b=false,c;for(c=0;c<Db.length;c++)if(a==Db[c]){b=true;break}return b}};o.Info={tabOrder:Ca,tabLabel:Ya,tabDisabled:false,cont:null,todoTimer:null,inworkTimer:null,bannerTimer:null,toolTip:"",expand:[],init:function(a){var b=o.Info,c="";c+=h("Informacion detallada, ciudades, recursos, unidades de ataque, edificaciones e investigaciones.")+"<BR>";
c+="<B>"+h("¬°Ahora traducido a Espa√±ol")+"!</b><BR>";b.toolTip=c;b.cont=a;c="";c+="<DIV id=pbinfoHead></div>";c+="<DIV id=pbinfoBody></div>";b.cont.innerHTML=c;v.assignExpansions();b.expand=[];b.showHead();b.showBody();b.inworkTick()},showHead:function(){var a=o.Info,b="";b+="<DIV class=pbTitle>";b+=qa;b+="<BR>"+Oa();b+='<BR><a target=_website href="'+ta+'"><span class=LinkWhite>'+ta+"</span></a>";b+="</div>";b+="<DIV id=pbinfoButt></div>";g("pbinfoHead").innerHTML=b;a.showButt()},showButt:function(){var a=o.Info,
b="";b+="<TABLE width=100%><TR>";b+="<TD width=50%>"+B("pbinfoUpdate","Actualizar Informaci√≥n",false,false,"small");b+=B("pbinfoReload","Recargar GF",false,false,"small");b+=B("pbinfoToggleFlash","Ocultar flash",false,false,"small")+"</td>";b+="<TD align=right id=pbinfo2 width=50%></td>";b+="</tr></table>";g("pbinfoButt").innerHTML=b;yb("pbinfo");g("pbinfoReload").addEventListener("click",ya,false);g("pbinfoUpdate").addEventListener("click",Ua,false);g("pbinfoToggleFlash").addEventListener("click",function(){var a=
g("container"),b=g("pbinfoToggleFlash");a.style.display=="none"?(a.style.display="block",b.value=h("Ocultar flash")):(a.style.display="none",b.value=h("Mostrar Flash"))},false);clearInterval(a.bannerTimer);a.bannerTimer=setInterval(a.bannerTick,144E5)},bannerTick:function(){yb("pbinfo",true)},showBody:function(){var a=o.Info,b="",c,d=p.player.cities;b+="<DIV id=pbinfoPlayer class=pbSubtitle></div>";for(c=0;c<d.length;c++)a.expand.length<c+1&&a.expand.push(true),b+="<DIV class=pbTitle id=pbinfodivtopcity_"+
c+"></div>",b+="<DIV class=pbSubtitle id=pbinfodivcity_"+c+"></div>";g("pbinfoBody").innerHTML=b;a.showInfo();a.todoTick()},showInfo:function(){function a(a){var b=o.Info,c=a.target.id.split("_"),c=u(c[1]),d="none";b.expand[c]=!b.expand[c];b.expand[c]&&(d="block");a.target.value=" "+(b.expand[c]===true?"-":"+")+" ";g("pbinfodivcity_"+c).style.display=d}function b(a){a=a.target.id.split("_");a=u(a[1]);v.defendCity(a)}var c=o.Info,d=p.player.cities,e,f;f="<TABLE width=100%><TR>";f+="<TD align=left>&nbsp;<B>"+
h("name","common")+":</b> "+p.player.name+"</td>";f+="<TD align=center><B>"+h("respect","common")+":</b> "+D(p.player.respect)+"</td>";f+="<TD align=right><B>"+h("level","common")+":</b> "+p.player.level+"&nbsp;</td></tr>";p.player.alliance&&(f+="<TR><TD colspan=2 align=left>&nbsp;<B>"+h("crew","common")+":</b> "+p.player.alliance.name+"</td>",f+="<TD align=right><B>"+h("rank","common")+":</b> "+p.player.alliance.rank+"&nbsp;</td></tr>");f+="</table>";g("pbinfoPlayer").innerHTML=f;g("pbinfoUpdate").disabled=
false;if(g("pboptsReadInfo"))g("pboptsReadInfo").disabled=false;for(e=0;e<d.length;e++)g("pbinfodivtopcity_"+e).innerHTML=v.getCityTitle(e,c),f="<TABLE width=100%>",d[e].type!="DoriaAirport"&&(f+=c.showInfoByType("resources","common",d[e].resources,false)),f+=c.showInfoByType("troops","troops",d[e].units,d[e].type!="DoriaAirport",true,e),d[e].type!="DoriaAirport"&&(f+=c.showInfoByType("research","research",d[e].research),f+=c.showInfoByType("cityscapes","map",d[e].wildernesses)),f+=c.showInfoJobs("jobs",
"common",e),f+="</table>",g("pbinfodivcity_"+e).innerHTML=f,g("pbinfodivcity_"+e).style.display=c.expand[e]===true?"block":"none",g("pbinfoHideShow_"+e).addEventListener("click",a,false),g("pbinfoDefend_"+e).addEventListener("click",b,false)},showInfoJobs:function(a,b,c){function d(a,b,c,d,g){var l="",o=C(),p,q,w,E="";g==void 0&&(g=false);jobs=G.getJobsByQueue(b,d);if(jobs.length!==0)for(p=0;p<jobs.length;p++){l+="<TR>";l+=p===0?"<TD align=left>"+h(a,"common").toUpperCase()+":</td>":"<TD></td>";l+=
"<TD align=left> ";g?(w=K.getBuildById(d,jobs[0].city_building_id),w!==null?(q=u(jobs[0].run_at-o),E=w.type):q=null):q=u(jobs[0].run_at-o);if(b=="research")E=jobs[0].research_type;switch(b){case "building":case "research":E!==""&&(l+=h(E,c),l+=" "+h("level","common").toLowerCase()+" "+jobs[0].level);break;case "units":case "defense_units":case "craft_offensive":case "craft_defensive":l+=jobs[0].quantity+" "+h(jobs[0].unit_type,c)}l+=q===null?h("unknown","common").toUpperCase():q<=0?"":" ("+Y(q)+")";
l+="</td><tr>"}else l+="<TR>",l+="<TD align=left>"+h(a,"common").toUpperCase()+":</td>",l+="<TD align=left> <FONT COLOR=red>"+h("no","common")+"</font>",l+="</td><tr>";return l}b="";b+="<TR><TD colspan=2><HR></td></tr>";b+="<TR><TD colspan=2 align=center><B>"+h(a,"common").toUpperCase()+":</b></td></tr>";b+="<TR><TD colspan=2><TABLE width=100%>";b+=d("construction","building","buildings",c,true);p.player.cities[c].type!="DoriaAirport"&&(b+=d("research","research","research",c));b+=d("training",p.player.cities[c].type!=
"DoriaAirport"?"units":"craft_offensive","troops",c);b+=d("training-defensive",p.player.cities[c].type!="DoriaAirport"?"defense_units":"craft_defensive","troops",c);return b},showInfoByType:function(a,b,c,d,e,f){var n="";a=="troops"&&(c=v.getUnits(f));d==void 0&&(d=true);e==void 0&&(e=false);d&&(n+="<TR><TD colspan=2><HR></td></tr>");n+="<TR><TD colspan=2 align=center><B>"+h(a,"common").toUpperCase()+":</b></td></tr>";if(c){var j,g,l;g=l=0;n+="<TR><TD colspan=2>";n+="<TABLE width=100%>";a=="troops"&&
(n+="<TR><TD></td><TD>",n+="<TABLE width=100%><TR>",n+="<TD align=right width=20%>"+h("city","common").toUpperCase()+"&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#00FF00>"+h("marching","common").toUpperCase()+"</font>&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#33CCFF>"+h("retreating","common").toUpperCase()+"</font>&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#FF9900>"+h("encamped","common").toUpperCase()+"</font>&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#FF0000>"+
h("EN PRISI√ìN").toUpperCase()+"</font>&nbsp;</td>",n+="</tr></table>",n+="</td></tr>");for(j in c)e?n+="<TR>":(g++,g==1?(l!==0&&(n+="</tr>"),n+="<TR>",l++):g=0),a=="troops"?(n+="<TD align=left>&nbsp;<B>"+h(j,b)+"</b></td>",n+="<TD>",n+="<TABLE width=100%><TR>",n+="<TD align=right width=20%>"+D(c[j].incity)+"&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#00FF00>"+D(c[j].inmarch)+"</font>&nbsp;</td>",n+="<TD align=right width=20%><FONT COLOR=#33CCFF>"+D(c[j].retreat)+"</font>&nbsp;</td>",
n+="<TD align=right width=20%><FONT COLOR=#FF9900>"+D(c[j].encamped)+"</font>&nbsp;</td>",d=!A.injail[f]||A.injail[f][j]==void 0?0:A.injail[f][j],n+="<TD align=right width=20%><FONT COLOR=#FF0000>"+D(d)+"</font>&nbsp;</td>",n+="</tr></table>",n+="</td>"):a=="cityscapes"?c[j].type&&(n+="<TD align=left>"+h(c[j].type,b)+" ("+c[j].x+"/"+c[j].y+")</td>",n+="<TD align=left>"+h("level","common")+" "+c[j].level+"</td>"):e?(n+="<TD align=left>&nbsp;<B>"+h(j,b)+"</b></td>",n+="<TD align=right>"+D(c[j])+"&nbsp;</td>"):
(n+="<TD width=50%>",n+="<TABLE width=100%><TR>",n+="<TD align=left>&nbsp;<B>"+h(j,b)+"</b></td>",n+="<TD align=right>"+D(c[j])+"&nbsp;</td>",n+="</tr></table>",n+="</td>"),e&&(n+="</tr>");!e&&g!==0&&(n+="<TD width=50%></td>",n+="</tr>");n+="</table>";n+="</td></tr>"}return n},todoTick:function(){var a=o.Info;clearTimeout(a.todoTimer);if(eb())a.todoTimer=setTimeout(a.todoTick,3E4)},inworkTick:function(){var a=o.Info,b=p.player.cities,c,d=C(),e;for(c=0;c<b.length;c++)for(k in b[c].jobs)e=u(b[c].jobs[k].run_at-
d),e<=0&&G.deleteJob(b[c].jobs[k].id);a.showInfo();a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};var Q=1;o.Wave={tabOrder:2,tabLabel:"Ataq.",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,curRunStart:0,readed:[],type:Q,indcityTroops:0,indcityMurders:0,indcityStats:0,changefloor:true,feedTimer:null,murders:[],nrmurder:1,color:"",init:function(a){var b=o.Wave;b.toolTip="<BR><B>"+h("Configura ataques continuos a MURDER o tambien a cualquier otra selecci√≥n, ¬°de forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData(true);
a="";a+="<DIV id=pbwaveHead></div>";a+="<DIV id=pbwaveBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(a){var b=l.options.wave,c=false;a==void 0&&(a=false);b==void 0&&(b={enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],units:[],floors:[],imperial:[]},c=true);var d,e,f=p.player.cities,n=C();if(b.floors==void 0)b.floors=[],c=true;if(b.imperial==void 0)b.imperial=[],c=true;for(d=0;d<f.length;d++){b.stat[d]==void 0&&(b.stat[d]=
{start_at:n,numAtt:0,resources:{},items:{}},c=true);if(b.stat[d].start_at==void 0||b.stat[d].start_at===0)b.stat[d].start_at=n,c=true;b.en[d]==void 0&&(b.en[d]=false,c=true);b.coords[d]==void 0&&(b.coords[d]={x:0,y:0},c=true);b.units[d]==void 0&&(b.units[d]={},c=true);b.floors[d]==void 0&&(b.floors[d]=1,c=true);b.imperial[d]==void 0&&(b.imperial[d]=1,c=true);if(!b.enabled&&!l.options.inMarch&&a)for(e in b.units[d])f[d].units[e]==void 0&&(delete b.units[d][e],c=true);for(e in f[d].units)b.units[d][e]==
void 0&&(b.units[d][e]=0,c=true)}return c},showHead:function(){var a=o.Wave,b="";b+="<DIV class=pbTitle>"+B("pbwaveOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbwaveInWork style="height:200px; max-height:200px; overflow-y:auto;"><TABLE id=pbwaveTabMarches width=100%></table></div>';b+='<BR><DIV id=pbwaveFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";b+="<DIV id=pbwaveButt></div>";g("pbwaveHead").innerHTML=b;a.setEnable(l.options.wave.enabled);
g("pbwaveOnOff").addEventListener("click",function(){a.setEnable(!l.options.wave.enabled)},false);g("pbwaveInWork").addEventListener("mouseover",N.showMarchTooltip,false);g("pbwaveInWork").addEventListener("mouseout",N.hideMarchTooltip,false);a.showButt()},showButt:function(){function a(a){var b=o.Wave,a=a.target.id.split("_");b.type=u(a[1]);b.showDiv()}var b="";b+="<TABLE width=100%>";b+="<TR>";b+="<TD>"+B("pbwaveBut_"+Q,h("troops","common"),false,false,"small");b+=B("pbwaveBut_2",h("search","common")+
" MURDER",false,false,"small");b+=B("pbwaveBut_3",h("Opzioni"),false,false,"small");b+=B("pbwaveBut_4",h("stats","common"),false,false,"small")+"</td>";b+="<TD align=center id=pbwave2></td>";b+="</tr>";b+="</table>";g("pbwaveButt").innerHTML=b;g("pbwaveBut_"+Q).addEventListener("click",a,false);g("pbwaveBut_2").addEventListener("click",a,false);g("pbwaveBut_3").addEventListener("click",a,false);g("pbwaveBut_4").addEventListener("click",a,false)},setEnable:function(a){var b=o.Wave;b.color="";if(!b.tabDisabled){var c=
g("pbwaveOnOff"),d=h("Onda").toUpperCase();clearTimeout(b.todoTimer);(l.options.wave.enabled=a)?(b.color="Green",c.value=d+" ON",c.className="butAttackOn",b.curRunStart=C(),b.todoTick()):(b.curRunStart!==0&&(l.options.wave.runTime+=C()-b.curRunStart),c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=o.Wave,b="";b+='<DIV id=pbwaveTroops class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbwaveMurders class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbwaveOptions class=pbStatBox style="display:none;"></div>';
b+='<DIV id=pbwaveStats class=pbStatBox style="display:none;"></div>';g("pbwaveBody").innerHTML=b;a.showDiv()},showDiv:function(){var a=o.Wave;g("pbwaveTroops").style.display="none";g("pbwaveMurders").style.display="none";g("pbwaveOptions").style.display="none";g("pbwaveStats").style.display="none";switch(a.type){case Q:g("pbwaveTroops").style.display="block";a.showTroops();break;case 2:g("pbwaveMurders").style.display="block";a.showMurders();break;case 3:g("pbwaveOptions").style.display="block";
a.showOptions();break;case 4:g("pbwaveStats").style.display="block",a.showStats()}},makeCitySelect:function(a,b){var c=p.player.cities,d="";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("city","common")+": ";if(c.length<2)d+=p.player.cities[0].name;else{d+="<SELECT id=pbwaveCity_"+b+">";for(i=0;i<c.length;i++)p.player.cities[i].type!="DoriaAirport"&&(d+="<OPTION"+(a==i?" selected":"")+' value="'+i+'">'+p.player.cities[i].name+"</option>");c.length>1&&b!=Q&&b!=2&&(d+="<OPTION"+(a==999?" selected":
"")+' value="999">'+h("all","common")+"</option>");d+="</select>"}a!=999&&(c=v.getJailSize(a),c!==0&&(d+=" ("+D(c)+")"));d+="</td>";b==Q?(d+="<TD>"+h("deployedunits","common")+": <SPAN id=pbwaveTotal></span></td>",d+=P(false,"",true,0,"pbwaveCityChk_"+b,l.options.wave.en[a],h("Abilita"),true)):b==4&&(d+="<TD>"+B("pbwaveCityBut_"+b,h("delete","common")+" "+h("stats","common"),false,false)+"</td>");d+="</tr>";d+="</table>";return d},showTroops:function(){function a(a){var b=o.Wave;b.indcityTroops=u(a.target[a.target.selectedIndex].value);
b.showTroops()}function b(a){var b=o.Wave,c=l.options.wave,d=a.target.id.split("_"),e=b.indcityTroops,d=d[1],f=ea(a.target.value);if(f>=fa)a.target.value=f=fa-1;d=="X"?c.coords[e].x=f:c.coords[e].y=f;b.getInfoXY()}var c=o.Wave,d="",e=l.options.wave,f=c.indcityTroops;d+="<DIV class=pbTitle>"+h("troops","common").toUpperCase()+"</div>";d+=c.makeCitySelect(f,Q);d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("target","common")+": X "+J("pbwaveTroops_X",e.coords[f].x,1,3,"normalGreen");d+=" / Y "+J("pbwaveTroops_Y",
e.coords[f].y,1,3,"normalGreen")+"<SPAN id=pbwaveDist></span></td>";d+="<TD id=pbwavetdFloor>"+h("Piano")+": "+J("pbwaveFloor",e.floors[f],1,2,"normalGreen")+"</td>";d+="</tr>";d+="</table>";d+="<DIV align=center class=pbStatBox id=pbwaveCoords></div>";d+="<DIV id=pbwaveTroopsCity></div>";g("pbwaveTroops").innerHTML=d;c.getTotalTroops();c.changefloor=false;c.getInfoXY();c.showTroopsCity();g("pbwaveCity_"+Q)&&g("pbwaveCity_"+Q).addEventListener("change",a,false);g("pbwaveCityChk_"+Q).addEventListener("click",
function(a){var b=o.Wave;l.options.wave.en[b.indcityTroops]=a.target.checked;b.showTroopsCity()},false);g("pbwaveTroops_X").addEventListener("change",b,false);g("pbwaveTroops_Y").addEventListener("change",b,false);g("pbwaveFloor").addEventListener("change",function(a){var b=l.options.wave,c=o.Wave.indcityTroops,d=ea(a.target.value);if(d>10)a.target.value=d=10;else if(d<1)a.target.value=d=1;b.floors[c]=d},false)},getTotalTroops:function(){var a=0,b=o.Wave.indcityTroops,c="",d=l.options.wave.units[b],
e=p.player.cities,f;for(f in d)a+=d[f];a>e[b].figures.marches.maximum_troops&&(c+="<FONT COLOR=#FF0000>");c+=D(a);a>e[b].figures.marches.maximum_troops&&(c+="</font>");c+="/"+D(e[b].figures.marches.maximum_troops);g("pbwaveTotal").innerHTML=c},showTroopsCity:function(){function a(a){var b=o.Wave,c=l.options.wave,d=a.target.id.split("_"),e=b.indcityTroops,d=d[1],f=ea(a.target.value),g=p.player.cities[e].units[d];if(f>g)a.target.value=f=g;c.units[e][d]=f;b.getTotalTroops()}var b="",c=l.options.wave,
d=o.Wave.indcityTroops,e,f;e=[];if(c.en[d]){b+="<TABLE width=100%>";for(f in c.units[d])b+="<TR>",b+="<TD>"+h(f,"troops")+"</td>",b+="<TD>"+J("pbwaveTroops_"+f,c.units[d][f],1,6,"normalGreen")+"</td>",e.push("pbwaveTroops_"+f),b+="</tr>";b+="</table>"}g("pbwaveTroopsCity").innerHTML=b;if(c.en[d])for(b=0;b<e.length;b++)g(e[b]).addEventListener("change",a,false)},getInfoXY:function(){var a=o.Wave.indcityTroops,b=l.options.wave;q.scan(b.coords[a].x,b.coords[a].y,7,function(){var a=o.Wave,b=a.indcityTroops,
e=l.options.wave,f="",n="";if(q.done){var j=q.getSingleInfo(e.coords[b].x,e.coords[b].y);if(j.ok){var p=j.level==99;n+="&nbsp;<B>"+h("Distanza")+": </b>"+j.dist;if(j.player!==null){if(!j.player.alliance||j.player.alliance.name==="")j.player.alliance=null;f+="<B>";f+=j.type_city!==""?j.type_city!="Capital"?h(j.name,"cities"):h(j.type_city,"cities"):h(j.type,"map");f+="</b>";j.level!==0&&(f+=" "+h("level","common")+" <B>"+j.level+"</b>");j.player.alliance!==null&&(f+=" "+h("crew","common")+": "+j.player.alliance.name);
f+="<BR>"+h("player","common")+": <B>"+j.player.name+"</b>";f+=" "+h("level","common")+": <B>"+j.player.level+"</b>";f+=" "+h("respect","common")+": <B>"+D(j.player.respect)+"</b>"}else f+="<B>"+h(j.type,"map")+"</b> "+h("level","common")+" <B>"+(j.level==99?"1-10":j.level)+"</b>";if(!p||a.changefloor)g("pbwaveFloor").value=e.floors[b]=1;e.imperial[b]=p;g("pbwavetdFloor").style.display=p===true?"block":"none"}}g("pbwaveCoords").innerHTML=f;g("pbwaveDist").innerHTML=n;a.changefloor=true},p.player.cities[a].x,
p.player.cities[a].y)},enableButtonForMurders:function(a){a==void 0&&(a=true);if(g("pbwaveBut_"+Q))g("pbwaveBut_"+Q).disabled=!a;if(g("pbwaveBut_2"))g("pbwaveBut_2").disabled=!a;if(g("pbwaveBut_3"))g("pbwaveBut_3").disabled=!a;if(g("pbwaveBut_4"))g("pbwaveBut_4").disabled=!a;if(g("pbwaveMurdersSearch"))g("pbwaveMurdersSearch").disabled=!a},showMurders:function(){function a(a){var b=o.Wave;b.indcityMurders=u(a.target[a.target.selectedIndex].value);b.murders=[];b.nrmurder=1;g("pbwaveMurdersSel").selectedIndex=
0;b.showMurders()}function b(){var a=o.Wave;if(!q.err){var b,c,d,e=q.targets.terrains.BossGang;if(e)for(b=0;b<e.length;b++)if(e[b].level==a.nrmurder){d=false;for(c=0;c<a.murders.length;c++)if(a.murders[c].id==e[b].id){d=true;break}d||a.murders.push({id:e[b].id,terrain:e[b]})}}q.done&&(a.murders.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;c===0&&(c=a.terrain.level-b.terrain.level);return c}),a.showMurdersCity(),a.enableButtonForMurders(),a.showFeedback(h("search","common")+" MURDER OK!"))}
var c=o.Wave,d="",e=h("search","common")+" "+h("le MURDER pi\u00f9 vicine entro una distanza di 37"),f=c.indcityMurders;d+="<DIV class=pbTitle>"+e.toUpperCase()+"</div>";d+=c.makeCitySelect(f,2);d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("search","common")+" "+h("level","common")+": ";d+="<SELECT id=pbwaveMurdersSel>";d+='<OPTION value="1" selected>1</option>';d+='<OPTION value="2">2</option>';d+="</select>&nbsp;"+B("pbwaveMurdersSearch",h("search","common"),false,false);d+="</td>";d+="</tr>";
d+="</table>";d+="<DIV id=pbwaveMurdersCity></div>";g("pbwaveMurders").innerHTML=d;g("pbwaveCity_2")&&g("pbwaveCity_2").addEventListener("change",a,false);g("pbwaveMurdersSel").addEventListener("change",function(a){var b=o.Wave;b.nrmurder=u(a.target[a.target.selectedIndex].value);b.showMurdersCity()},false);g("pbwaveMurdersSearch").addEventListener("click",function(){var a=o.Wave;a.murders=[];a.showFeedback(h("search","common")+" MURDER "+a.nrmurder,false);a.enableButtonForMurders(false);q.scan(p.player.cities[f].x,
p.player.cities[f].y,pa,b,p.player.cities[f].x,p.player.cities[f].y)},false);c.showMurdersCity()},showMurdersCity:function(){function a(a){var b=o.Wave,c=l.options.wave,d=a.target.id.split("_"),a=b.indcityMurders,b=b.murders[u(d[1])];c.coords[a].x=b.terrain.x;c.coords[a].y=b.terrain.y}var b=o.Wave,c="",d,e,f=[];b.murders.length!==0&&(c+="<TABLE width=100%>",c+="<TR>",c+="<TD>"+h("Distanza")+"</td>",c+="<TD>"+h("Coordinate")+"</td>",c+="<TD>"+h("level","common")+"</td>",c+="<TD>&nbsp;</td>",c+="</tr>");
for(d=0;d<b.murders.length;d++)e=b.murders[d],c+="<TR>",c+="<TD>"+e.terrain.dist+"</td>",c+="<TD>"+e.terrain.x+"/"+e.terrain.y+"</td>",c+="<TD>"+e.terrain.level+"</td>",c+="<TD>"+B("pbwaveMurderBut_"+d,h("Copia in Onda"),false,false)+"</td>",f.push("pbwaveMurderBut_"+d),c+="</tr>";b.murders.length!==0&&(c+="</table>");g("pbwaveMurdersCity").innerHTML=c;for(d=0;d<b.murders.length;d++)g(f[d]).addEventListener("click",a,false)},showOptions:function(){var a="",b=l.options.wave;a+="<DIV class=pbTitle>"+
h("Opzioni").toUpperCase()+"</div>";a+="<TABLE width=100%>";a+="<TR>";a+="<TD>"+h("Ritardo tra attacchi")+":</td>";a+="<TD>"+h("from","common")+" "+J("pbwaveOpts_min",b.min,1,3,"normalGreen")+"</td>";a+="<TD>"+h("to","common")+" "+J("pbwaveOpts_max",b.max,1,3,"normalGreen")+" "+h("Secondi").toLowerCase()+"</td>";a+="</tr>";a+="<TR>";a+="<TD>"+h("Elimina rapporti")+":</td>";a+=P(false,"",true,2,"pbwaveOpts_DelRep",b.delrep,"",true);a+="</tr>";a+="</table>";g("pbwaveOptions").innerHTML=a;g("pbwaveOpts_min").addEventListener("change",
function(a){var b=ea(a.target.value),e=l.options.wave,f=a.target.id.split("_")[1];if(b===0){switch(f){case "min":b=optsDefaults.min}if(b!==0)a.target.value=b}switch(f){case "min":e.min=b,e.max=u(b*1.5),g("pbwaveOpts_max").value=e.max}},false);g("pbwaveOpts_max").disabled=true;g("pbwaveOpts_DelRep").addEventListener("click",function(a){l.options.wave.delrep=a.target.checked},false)},showStats:function(){function a(a){var b=o.Wave;b.indcityStats=u(a.target[a.target.selectedIndex].value);b.showStats()}
var b=o.Wave,c="";c+="<DIV class=pbTitle>"+h("stats","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityStats,4);c+="<DIV id=pbwaveStatsCity></div>";g("pbwaveStats").innerHTML=c;g("pbwaveCity_4")&&g("pbwaveCity_4").addEventListener("change",a,false);g("pbwaveCityBut_4").addEventListener("click",function(a){var b=o.Wave;a.target.disabled=true;switch(b.indcityStats){case 999:b.clearStatsAll();break;default:b.clearStatsSingle(b.indcityStats)}a.target.disabled=false;b.showStatsCity()},false);
b.showStatsCity()},showStatsCity:function(){var a=o.Wave,b,c,d="";switch(a.indcityStats){case 999:c=a.getStatsAll();break;default:c=a.getStatsSingle(a.indcityStats)}var e=l.options.wave.runTime;l.options.wave.enabled&&(e+=C()-a.curRunStart);d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("Iniziate il")+"</td>";d+="<TD align=center>"+h("Tempo di esecuzione")+"</td>";d+="<TD align=right>"+h("Attacchi")+"</td>";d+="</tr>";d+="<TR>";d+="<TD>";c.start_at!==0&&(a=new Date(c.start_at*1E3),d+=a.formatDate(Z)+
" "+a.formatTime());d+="</td>";d+="<TD align=center>"+Y(e,true)+"</td>";d+="<TD align=right>"+D(c.numAtt)+"</td>";d+="</tr>";d+="</table>";d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("resources","common")+":</td>";for(b in c.resources)d+="<TD align=right>"+h(b,"common")+"</td>";d+="</tr>";d+="<TR>";d+="<TD>"+h("quantity","common")+":</td>";for(b in c.resources)d+="<TD align=right>"+D(c.resources[b])+"</td>";d+="</tr>";d+="<TR>";d+="<TD>"+h("per-hour","common")+":</td>";for(b in c.resources)e===
0?d+="<TD align=right>---</td>":(a=u(c.resources[b]*3600/e),d+="<TD align=right>"+D(a)+"</td>");d+="</tr>";d+="</table>";d+="<HR>";d+="<TABLE width=100%>";d+="<TR>";d+="<TD width=50%>"+h("items","common")+":</td>";d+="<TD width=50%></td>";d+="</tr>";for(b in c.items)d+="<TR>",d+="<TD width=50%>",d+=h(ga(b),"items")==ga(b)?h(ga(b),"armory"):h(ga(b),"items"),d+="</td>",d+="<TD width=50%>"+D(c.items[b])+" ("+h("per-hour","common")+": ",e===0?d+="<TD align=right>---</td>":(a=u(c.items[b]*3600/e),d+=D(a)),
d+=")",d+="</td>",d+="</tr>";d+="</table>";g("pbwaveStatsCity").innerHTML=d},todoTick:function(){var a=o.Wave,b=N.getTimerDelayMarch(true),c=p.player.cities,d=l.options.wave,e,f=0;clearTimeout(a.todoTimer);for(e=0;e<c.length;e++)d.en[e]&&(setTimeout(a.doAttack,f*1E3,e),f++);a.todoTimer=setTimeout(a.todoTick,b)},doAttack:function(a){var b=o.Wave,c={},d=l.options.wave.units[a],e;for(e in d)d[e]!==0&&(c[e]=d[e]);d=N.checkAttack(c,a,b,true);e=l.options.wave;var f=v.getCityId(a);d.ok&&N.sendAttack(e.coords[a].x,
e.coords[a].y,c,f,b,-1,e.floors[a]);return d},addStatFromReport:function(a,b){var c=o.Wave,d=v.getCityIndByName(a.attacker.city_name),e=l.options.wave;if(a.spoils&&!(a.attacker.name!=p.player.name||c.readed.indexOf(b)!=-1||d==-1||e.coords[d].x!=a.location.x||e.coords[d].y!=a.location.y)){c.readed.push(b);if(a.spoils.resources)for(r in a.spoils.resources)U(e.stat[d].resources,r,u(a.spoils.resources[r])),U(p.player.cities[d].resources,r,u(a.spoils.resources[r]));if(a.spoils.items){for(r=0;r<a.spoils.items.length;r++)U(e.stat[d].items,
a.spoils.items[r],1),U(p.player.items,a.spoils.items[r],1);o.Various.type==ha&&o.Various.showDiv()}e.stat[d].numAtt++;c.type==4&&d==c.indcityStats&&c.showStats();e.delrep&&O.deleteReport(b)}},clearStatsSingle:function(a){var b=l.options.wave,c=C();b.stat[a]={start_at:c,numAtt:0,resources:{},items:{}};if(p.player.cities.length<2)l.options.wave.runTime=0},clearStatsAll:function(){var a=o.Wave,b,c=p.player.cities;b=C();a.curRunStart=b;for(b=0;b<c.length;b++)a.clearStatsSingle(b);l.options.wave.runTime=
0},getStatsSingle:function(a){var b,c={start_at:0,numAtt:0,resources:{},items:{}},a=l.options.wave.stat[a];c.start_at=a.start_at;c.numAtt+=a.numAtt;for(b in a.resources)U(c.resources,b,u(a.resources[b]));for(b in a.items)U(c.items,b,u(a.items[b]));return c},getStatsAll:function(){var a,b,c,d=p.player.cities,e={start_at:0,numAtt:0,resources:{},items:{}};for(a=0;a<d.length;a++){c=l.options.wave.stat[a];if(e.start_at===0||c.start_at<e.start_at&&c.start_at!==0)e.start_at=c.start_at;e.numAtt+=c.numAtt;
for(b in c.resources)U(e.resources,b,u(c.resources[b]));for(b in c.items)U(e.items,b,u(c.items[b]))}return e},showFeedback:function(a,b){var c=o.Wave;b==void 0&&(b=true);clearTimeout(c.feedTimer);g("pbwaveFeedback").innerHTML=a;if(a!==""&&b)c.feedTimer=setTimeout(c.showFeedback,5E3,"")},inworkTick:function(){var a=o.Wave;clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.type==Q&&a.showTroops();N.showTab(true);a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};var T=
1,V=3;o.Gang={tabOrder:3,tabLabel:"Banda",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,curRunStart:0,readed:[],type:T,indcityTroops:0,indcityTargets:0,indcityStats:0,indcity:0,saveEnabled:false,tgts:[],feedTimer:null,color:"",init:function(a){var b=o.Gang;b.toolTip="<BR><B>"+h("Configura ataques continuos a Bandas en cada ciudad, ¬°de forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData(true);a="";a+="<DIV id=pbgangHead></div>";a+="<DIV id=pbgangBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(a){var b=
l.options.gang,c=false;a==void 0&&(a=false);b==void 0&&(b={enabled:false,runTime:0,min:30,max:45,delrep:true,stat:[],en:[],coords:[],last:[],units:[],leven:[],dist:[],same:60},c=true);var d,e,f,n=p.player.cities,j=C();if(b.last==void 0)b.last=[],c=true;for(d=0;d<n.length;d++){if(b.stat[d]==void 0||b.stat[d].length){b.stat[d]={start_at:j,resources:{},items:{},numAtt:[]};for(e=0;e<10;e++)b.stat[d].numAtt.push(0);c=true}if(b.stat[d].start_at==void 0||b.stat[d].start_at===0)b.stat[d].start_at=j,c=true;
if(b.stat[d].resources==void 0)b.stat[d].resources={},c=true;if(b.stat[d].items==void 0)b.stat[d].items={},c=true;for(f in b.stat[d].items)for(e=0;e<10;e++)b.stat[d].items[f][e]==void 0&&(b.stat[d].items[f][e]=0,c=true);if(b.stat[d].numAtt==void 0){b.stat[d].numAtt=[];for(e=0;e<10;e++)b.stat[d].numAtt.push(0);c=true}b.en[d]==void 0&&(b.en[d]=false,c=true);b.last[d]==void 0&&(b.last[d]={x:-1,y:-1},c=true);b.coords[d]==void 0&&(b.coords[d]=[],c=true);if(b.units[d]==void 0||b.units[d].length)b.units[d]=
{},c=true;if(!b.enabled&&!l.options.inMarch&&a)for(f in b.units[d])if(A.isDefensive(f)||n[d].units[f]==void 0)delete b.units[d][f],c=true;for(f in n[d].units)if(!A.isDefensive(f)){b.units[d][f]==void 0&&(b.units[d][f]=[]);for(e=0;e<10;e++)b.units[d][f][e]==void 0&&(b.units[d][f][e]=0,c=true)}if(b.leven[d]==void 0){b.leven[d]=[];for(e=0;e<10;e++)b.leven[d][e]=false;c=true}for(e=0;e<10;e++)b.leven[d][e]==void 0&&(b.leven[d][e]=false,c=true);if(b.dist[d]==void 0){b.dist[d]=[];for(e=0;e<10;e++)b.dist[d][e]=
pa;c=true}for(e=0;e<10;e++)if(b.dist[d][e]==void 0||b.dist[d][e]==30)b.dist[d][e]=pa,c=true}return c},enableButtonForScan:function(a){var b=o.Gang;a==void 0&&(a=true);a?b.saveEnabled&&b.setEnable(true):(b.saveEnabled=l.options.gang.enabled,b.saveEnabled&&b.setEnable(false));if(g("pbgangBut_"+T))g("pbgangBut_"+T).disabled=!a;if(g("pbgangBut_2"))g("pbgangBut_2").disabled=!a;if(g("pbgangBut_"+V))g("pbgangBut_"+V).disabled=!a;if(g("pbgangBut_4"))g("pbgangBut_4").disabled=!a;if(g("pbgangOptsScan"))g("pbgangOptsScan").disabled=
!a},setEnable:function(a){var b=o.Gang;b.color="";if(!b.tabDisabled){var c=g("pbgangOnOff"),d=h("Gang").toUpperCase();clearTimeout(b.todoTimer);(l.options.gang.enabled=a)?(b.color="Green",c.value=d+" ON",c.className="butAttackOn",b.curRunStart=C(),b.todoTick()):(b.curRunStart!==0&&(l.options.gang.runTime+=C()-b.curRunStart),c.value=d+" OFF",c.className="butAttackOff")}},showHead:function(){var a=o.Gang,b="";b+="<DIV class=pbTitle>"+B("pbgangOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";
b+='<DIV id=pbgangInWork style="height:200px; max-height:200px; overflow-y:auto;"><TABLE id=pbgangTabMarches width=100%></table></div>';b+='<BR><DIV id=pbgangFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";b+="<DIV id=pbgangButt></div>";g("pbgangHead").innerHTML=b;a.setEnable(l.options.gang.enabled);g("pbgangOnOff").addEventListener("click",function(){a.setEnable(!l.options.gang.enabled)},false);g("pbgangInWork").addEventListener("mouseover",N.showMarchTooltip,
false);g("pbgangInWork").addEventListener("mouseout",N.hideMarchTooltip,false);a.showButt()},showButt:function(){function a(a){var b=o.Gang,a=a.target.id.split("_");b.type=u(a[1]);b.showDiv()}var b="";b+="<TABLE width=100%>";b+="<TR>";b+="<TD>"+B("pbgangBut_"+T,h("troops","common"),false,false,"small");b+=B("pbgangBut_2",h("Opzioni"),false,false,"small");b+=B("pbgangBut_"+V,h("target","common"),false,false,"small");b+=B("pbgangBut_4",h("stats","common"),false,false,"small")+"</td>";b+="<TD align=center id=pbgang2></td>";
b+="</tr>";b+="</table>";g("pbgangButt").innerHTML=b;g("pbgangBut_"+T).addEventListener("click",a,false);g("pbgangBut_2").addEventListener("click",a,false);g("pbgangBut_"+V).addEventListener("click",a,false);g("pbgangBut_4").addEventListener("click",a,false)},showBody:function(){var a=o.Gang,b="";b+='<DIV id=pbgangTroops class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbgangOptions class=pbStatBox style="display:none;"></div>';b+='<DIV id=pbgangTargets class=pbStatBox style="display:none;"></div>';
b+='<DIV id=pbgangStats class=pbStatBox style="display:none;"></div>';g("pbgangBody").innerHTML=b;a.showDiv();a.checkMap()},showDiv:function(){var a=o.Gang;g("pbgangTroops").style.display="none";g("pbgangOptions").style.display="none";g("pbgangTargets").style.display="none";g("pbgangStats").style.display="none";switch(a.type){case T:g("pbgangTroops").style.display="block";a.showTroops();break;case 2:g("pbgangOptions").style.display="block";a.showOptions();break;case V:g("pbgangTargets").style.display=
"block";a.showTargets();break;case 4:g("pbgangStats").style.display="block",a.showStats()}},makeCitySelect:function(a,b){var c=p.player.cities,d="";d+="<TABLE width=100%>";d+="<TR>";d+="<TD>"+h("city","common")+": ";if(c.length<2)d+=p.player.cities[0].name;else{d+="<SELECT id=pbgangCity_"+b+">";for(i=0;i<c.length;i++)p.player.cities[i].type!="DoriaAirport"&&(d+="<OPTION"+(a==i?" selected":"")+' value="'+i+'">'+p.player.cities[i].name+"</option>");c.length>1&&b!=T&&(d+="<OPTION"+(a==999?" selected":
"")+' value="999">'+h("all","common")+"</option>");d+="</select>"}a!=999&&(c=v.getJailSize(a),c!==0&&(d+=" ("+D(c)+")"));d+="</td>";b==T?d+=P(false,"",true,0,"pbgangCityChk_"+b,l.options.gang.en[a],h("Abilita"),true):b==4?d+="<TD>"+B("pbgangCityBut_"+b,h("delete","common")+" "+h("stats","common"),false,false)+"</td>":b==V&&(d+="<TD>"+B("pbgangCityBut_"+b,h("delete","common")+" "+h("Ultimi attacchi"),false,false)+"</td>");d+="</tr>";d+="</table>";return d},showTroops:function(){function a(a){var b=
o.Gang;b.indcityTroops=u(a.target[a.target.selectedIndex].value);g("pbgangCityChk_"+T).checked=l.options.gang.en[b.indcityTroops];b.showTroops()}var b=o.Gang,c="";c+="<DIV class=pbTitle>"+h("troops","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityTroops,T);c+="<DIV id=pbgangTroopsCity></div>";g("pbgangTroops").innerHTML=c;g("pbgangCity_"+T)&&g("pbgangCity_"+T).addEventListener("change",a,false);g("pbgangCityChk_"+T).addEventListener("click",function(a){var b=o.Gang;l.options.gang.en[b.indcityTroops]=
a.target.checked;b.showTroopsCity()},false);b.showTroopsCity()},showTroopsCity:function(){function a(a){var b=l.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,c=u(c[1]);b.leven[e][c]=a.target.checked}function b(a){var b=l.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,c=u(c[1]),f=ea(a.target.value);if(f<1||f>pa)a.target.value=f=pa;b.dist[e][c]=f}function c(a){var b=l.options.gang,c=a.target.id.split("_"),e=d.indcityTroops,f=u(c[1]),c=c[2],n=ea(a.target.value),j=p.player.cities[e].units[c];
if(n>j)a.target.value=n=j;b.units[e][c][f]=n}var d=o.Gang,e="",f=l.options.gang,n=d.indcityTroops,j,z,M,q,v;z=[];M=[];q=[];if(f.en[n]){e+="<TABLE width=100%>";e+="<TR>";e+="<TD></td>";e+="<TD colspan=10>"+tb(h("level","common"))+"</td>";e+="</tr>";e+="<TR>";e+="<TD></td>";for(j=0;j<10;j++)e+="<TD align=center>"+(j+1)+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+h("Abilita")+"</td>";for(j=0;j<10;j++)e+="<TD align=center>",e+=P(false,"",false,0,"pbgangTroopsChk_"+j,f.leven[n][j],"",false),e+="</td>",z.push("pbgangTroopsChk_"+
j);e+="</tr>";e+="<TR>";e+="<TD>"+h("Distanza")+"</td>";for(j=0;j<10;j++)e+="<TD>"+J("pbgangTroopsDist_"+j,f.dist[n][j],1,2,"normalGreen")+"</td>",M.push("pbgangTroopsDist_"+j);e+="</tr>";e+="<TR>";e+="<TD>&nbsp;</td>";e+="<TD colspan=10></td>";e+="</tr>";for(v in f.units[n]){e+="<TR>";e+="<TD>"+h(v,"troops")+"</td>";for(j=0;j<10;j++)e+="<TD>"+J("pbgangTroops_"+j+"_"+v,f.units[n][v][j],1,6,"normalGreen")+"</td>",q.push("pbgangTroops_"+j+"_"+v);e+="</tr>"}e+="</table>"}g("pbgangTroopsCity").innerHTML=
e;if(f.en[n]){for(j=0;j<z.length;j++)g(z[j]).addEventListener("click",a,false);for(j=0;j<M.length;j++)g(M[j]).addEventListener("change",b,false);for(j=0;j<q.length;j++)g(q[j]).addEventListener("change",c,false)}},showOptions:function(){function a(a){var b=ea(a.target.value),c=l.options.gang,d=a.target.id.split("_")[1];if(b===0){switch(d){case "min":b=optsDefaults.min;break;case "max":b=optsDefaults.max;break;case "same":b=optsDefaults.same}if(b!==0)a.target.value=b}switch(d){case "min":c.min=b;break;
case "max":if(b<c.min)b=c.min,a.target.value=b;c.max=b;break;case "same":c.same=b}}var b=o.Gang,c="",d=l.options.gang;c+="<DIV class=pbTitle>"+h("Opciones").toUpperCase()+"</div>";c+="<TABLE width=100%>";c+="<TR>";c+="<TD>"+h("Ritardo tra attacchi")+":</td>";c+="<TD>"+h("from","common")+" "+J("pbgangOpts_min",d.min,1,3,"normalGreen")+"</td>";c+="<TD>"+h("to","common")+" "+J("pbgangOpts_max",d.max,1,3,"normalGreen")+" "+h("Secondi").toLowerCase()+"</td>";c+="</tr>";c+="<TR>";c+="<TD>"+h("Ritardo stesso obiettivo")+
":</td>";c+="<TD colspan=2>"+J("pbgangOpts_same",d.same,1,3,"normalGreen")+" "+h("minuti").toLowerCase()+"</td>";c+="</tr>";c+="<TR>";c+="<TD>"+h("Elimina rapporti")+":</td>";c+=P(false,"",true,2,"pbgangOpts_DelRep",d.delrep,"",true);c+="</tr>";c+="<TR>";c+="<TD colspan=3></td>";c+="</tr>";c+="<TR>";c+="<TD colspan=3>"+B("pbgangOptsScan","Scan Mappa",false,false)+"</td>";c+="</tr>";c+="</table>";g("pbgangOptions").innerHTML=c;g("pbgangOpts_min").addEventListener("change",a,false);g("pbgangOpts_max").addEventListener("change",
a,false);g("pbgangOpts_same").addEventListener("change",a,false);g("pbgangOpts_DelRep").addEventListener("click",function(a){l.options.gang.delrep=a.target.checked},false);g("pbgangOptsScan").addEventListener("click",b.scanMap,false)},checkMap:function(){var a=o.Gang,b=p.player.cities,c=l.options.gang.last,d,e=false;for(d=0;d<b.length;d++)if(c[d].x==-1||c[d].x!=b[d].x||c[d].y!=b[d].y){e=true;break}e&&a.scanMap()},scanMap:function(){var a=o.Gang;a.enableButtonForScan(false);l.options.gang.coords=[];
a.indcity=0;a.readMap()},readMap:function(){var a=o.Gang,b=p.player.cities;a.indcity>=b.length?(a.type==V&&a.showTargets(),a.enableButtonForScan(),a.showFeedback(h("Scansione terminata")+"!")):(l.options.gang.coords[a.indcity]=[],a.showFeedback(h("Scansione gang di")+" "+p.player.cities[a.indcity].name,false),q.scan(b[a.indcity].x,b[a.indcity].y,pa,function(){var a=o.Gang;if(!q.err){var b,e,f,n,j=a.indcity,g=q.targets.terrains.Gang;for(b=0;b<g.length;b++){n=l.options.gang.coords[j].length;f=false;
for(e=0;e<n;e++)if(l.options.gang.coords[j][e].id==g[b].id){f=true;break}f||l.options.gang.coords[j].push({id:g[b].id,time:0,ind:j,opt:n,terrain:g[b]})}}if(q.done)b=p.player.cities,l.options.gang.last[a.indcity]=q.err?{x:-1,y:-1}:{x:b[a.indcity].x,y:b[a.indcity].y},a.indcity++,setTimeout(a.readMap,2E3)}))},showTargets:function(){function a(a){var b=o.Gang;b.indcityTargets=u(a.target[a.target.selectedIndex].value);b.showTargets()}var b=o.Gang,c="";c+="<DIV class=pbTitle>"+h("target","common").toUpperCase()+
"</div>";c+=b.makeCitySelect(b.indcityTargets,V);c+="<DIV id=pbgangTargetsCity></div>";g("pbgangTargets").innerHTML=c;g("pbgangCity_"+V)&&g("pbgangCity_"+V).addEventListener("change",a,false);g("pbgangCityBut_"+V).addEventListener("click",function(){var a=o.Gang,b=a.indcityTargets,c=l.options.gang,n,j,g=p.player.cities;switch(b){case 999:for(n=0;n<g.length;n++)for(j=0;j<c.coords[b].length;j++)c.coords[n][j].time=0;break;default:for(j=0;j<c.coords[b].length;j++)c.coords[b][j].time=0}a.showTargetsCity()},
false);b.showTargetsCity()},showTargetsCity:function(){function a(a){a=a.target.id.split("_");a=u(a[1]);b.doAttack(a,true)}var b=o.Gang,c=0,d,e,f="",n=C();b.tgts=[];switch(b.indcityTargets){case 999:b.getAllActiveTargets();break;default:b.getActiveTargetsCity(b.indcityTargets)}b.tgts.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;c===0&&(c=a.terrain.level-b.terrain.level);c===0&&(c=a.ind-b.ind);c===0&&(c=a.time-b.time);return c});f+="<TABLE width=100%>";f+="<TR>";f+="<TD>"+h("Distanza")+"</td>";
f+="<TD>"+h("Coordinate")+"</td>";f+="<TD>"+h("level","common")+"</td>";f+="<TD colspan=2>"+h("Ultimo attacco")+"</td>";f+="</tr>";for(d=0;d<b.tgts.length;d++)e=b.tgts[d],c++,f+="<TR>",f+="<TD>"+e.terrain.dist+"</td>",f+="<TD>"+e.terrain.x+"/"+e.terrain.y+"</td>",f+="<TD>"+e.terrain.level+"</td>",e=e.time===0?0:n-e.time,f+="<TD>",f+=e===0?"---":Y(e),f+="</td>",f+="<TD>"+B("pbgangTargets_"+d,h("attack","common"),false,false)+"</td>",f+="</tr>";f+="</table>";g("pbgangTargetsCity").innerHTML=f;for(d=
0;d<b.tgts.length;d++)g("pbgangTargets_"+d).addEventListener("click",a,false)},getAllActiveTargets:function(){var a=o.Gang,b=p.player.cities;for(i=0;i<b.length;i++)a.getActiveTargetsCity(i)},getActiveTargetsCity:function(a){var b=o.Gang,c=l.options.gang,d,e;if(c.en[a])for(d=0;d<c.coords[a].length;d++)e=c.coords[a][d],c.leven[a][e.terrain.level-1]&&e.terrain.dist<=c.dist[a][e.terrain.level-1]&&b.tgts.push(e)},showStats:function(){function a(a){var b=o.Gang;b.indcityStats=u(a.target[a.target.selectedIndex].value);
b.showStats()}var b=o.Gang,c="";c+="<DIV class=pbTitle>"+h("stats","common").toUpperCase()+"</div>";c+=b.makeCitySelect(b.indcityStats,4);c+="<DIV id=pbgangStatsCity></div>";g("pbgangStats").innerHTML=c;g("pbgangCity_4")&&g("pbgangCity_4").addEventListener("change",a,false);g("pbgangCityBut_4").addEventListener("click",function(a){var b=o.Gang;a.target.disabled=true;switch(b.indcityStats){case 999:b.clearStatsAll();break;default:b.clearStatsSingle(b.indcityStats)}a.target.disabled=false;b.showStatsCity()},
false);b.showStatsCity()},showStatsCity:function(){var a=o.Gang,b,c,d,e="";switch(a.indcityStats){case 999:d=a.getStatsAll();break;default:d=a.getStatsSingle(a.indcityStats)}b=l.options.gang.runTime;l.options.gang.enabled&&(b+=C()-a.curRunStart);e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+h("Iniziate il")+"</td>";e+="<TD align=center>"+h("Tempo di esecuzione")+"</td>";e+="<TD align=right>"+h("Attacchi")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>";d.start_at!==0&&(a=new Date(d.start_at*1E3),e+=
a.formatDate(Z)+" "+a.formatTime());e+="</td>";e+="<TD align=center>"+Y(b,true)+"</td>";e+="<TD align=right>"+D(d.totAtt)+"</td>";e+="</tr>";e+="</table>";e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+h("resources","common")+":</td>";for(c in d.resources)e+="<TD align=right>"+h(c,"common")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+h("quantity","common")+":</td>";for(c in d.resources)e+="<TD align=right>"+D(d.resources[c])+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+h("per-hour","common")+":</td>";
for(c in d.resources)b===0?e+="<TD align=right>---</td>":(a=u(d.resources[c]*3600/b),e+="<TD align=right>"+D(a)+"</td>");e+="</tr>";e+="</table>";e+="<HR>";e+="<TABLE width=100%>";e+="<TR>";e+="<TD width=20%></td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";e+="<TD>"+tb(h("level","common"))+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%></td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=1;b<11;b++)e+="<TD align=right width=10%>"+b+"</td>";e+="</tr></table>";
e+="</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%>"+h("Attacchi")+"</td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=0;b<10;b++)e+="<TD align=right width=10%>"+D(d.numAtt[b])+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>";e+="<TR>";e+="<TD width=20%>"+h("items","common")+":</td>";e+="<TD width=80%></td>";e+="</tr>";for(c in d.items){e+="<TR>";e+="<TD width=20%>";e+=h(ga(c),"items")==ga(c)?h(ga(c),"armory"):h(ga(c),"items");e+="</td>";e+="<TD width=80%>";e+="<TABLE width=100%><TR>";for(b=
0;b<10;b++)e+="<TD align=right width=10%>"+D(d.items[c][b])+"</td>";e+="</tr></table>";e+="</td>";e+="</tr>"}e+="</table>";g("pbgangStatsCity").innerHTML=e},todoTick:function(){var a=o.Gang,b=N.getTimerDelayMarch(false),c=l.options.gang,d=C(),e=l.options.gang.same*60+1,f,n,g={ok:false,msg:""};clearTimeout(a.todoTimer);if(c.enabled){a.getAllActiveTargets();a.tgts.sort(function(a,b){var c=a.terrain.dist-b.terrain.dist;c===0&&(c=a.terrain.level-b.terrain.level);c===0&&(c=a.ind-b.ind);c===0&&(c=b.time-
a.time);return c});n=a.tgts.length===0;for(c=0;c<a.tgts.length;c++)if(f=a.tgts[c],!(f.time!==0&&u(d-f.time)<e)&&(n=true,g=a.doAttack(c),g.ok||g.msg===""))break;if(!g.ok&&g.msg==="")g.msg=n?h("Nessuna truppa selezionata")+" "+h("or","common")+" "+h("Nessun obiettivo selezionato")+"!":h("Nessun obiettivo disponibile"),a.showFeedback(g.msg);a.todoTimer=setTimeout(a.todoTick,b)}},doAttack:function(a,b){b==void 0&&(b=false);var c=o.Gang,d=c.tgts[a],e=d.terrain.level-1,f={},n=l.options.gang.units[d.ind],
g;for(g in n)n[g][e]!==0&&(f[g]=n[g][e]);e=N.checkAttack(f,d.ind,c,b);n=v.getCityId(d.ind);e.ok&&N.sendAttack(d.terrain.x,d.terrain.y,f,n,c,d.opt);return e},addStatFromReport:function(a,b){var c=o.Gang,d=v.getCityIndByName(a.attacker.city_name),e=a.location.level-1,f=l.options.gang,g;if(a.spoils&&!(a.attacker.name!=p.player.name||c.readed.indexOf(b)!=-1||a.location.terrain!="Gang"||d==-1)){c.readed.push(b);if(a.spoils.resources)for(r in a.spoils.resources)U(f.stat[d].resources,r,u(a.spoils.resources[r])),
U(p.player.cities[d].resources,r,u(a.spoils.resources[r]));if(a.spoils.items){for(r=0;r<a.spoils.items.length;r++){g=a.spoils.items[r];if(f.stat[d].items[g]==void 0){f.stat[d].items[g]=[];for(i=0;i<10;i++)f.stat[d].items[g].push(0)}f.stat[d].items[g][e]++;U(p.player.items,a.spoils.items[r],1)}o.Various.type==ha&&o.Various.showDiv()}f.stat[d].numAtt[e]++;c.type==4&&d==c.indcityStats&&c.showStats();f.delrep&&O.deleteReport(b)}},clearStatsSingle:function(a){var b=l.options.gang,c=C();b.stat[a]={start_at:c,
resources:{},items:{},numAtt:[]};for(c=0;c<10;c++)b.stat[a].numAtt.push(0);if(p.player.cities.length<2)b.runTime=0},clearStatsAll:function(){var a=o.Gang,b,c=p.player.cities;b=C();a.curRunStart=b;for(b=0;b<c.length;b++)a.clearStatsSingle(b,false);l.options.gang.runTime=0},getStatsSingle:function(a){var b,c,d={start_at:0,totAtt:0,numAtt:[],resources:{},items:{}};for(b=0;b<10;b++)d.numAtt.push(0);a=l.options.gang.stat[a];d.start_at=a.start_at;for(c in a.resources)U(d.resources,c,u(a.resources[c]));
for(b=0;b<10;b++)d.totAtt+=a.numAtt[b],d.numAtt[b]+=a.numAtt[b];for(c in a.items){d.items[c]=[];for(b=0;b<10;b++)d.items[c].push(a.items[c][b])}return d},getStatsAll:function(){var a,b,c,d,e=p.player.cities,f={start_at:0,totAtt:0,numAtt:[],resources:{},items:{}};for(b=0;b<10;b++)f.numAtt.push(0);for(a=0;a<e.length;a++){d=l.options.gang.stat[a];if(f.start_at===0||d.start_at<f.start_at&&d.start_at!==0)f.start_at=d.start_at;for(c in d.resources)U(f.resources,c,u(d.resources[c]));for(b=0;b<10;b++)f.totAtt+=
d.numAtt[b],f.numAtt[b]+=d.numAtt[b];for(c in d.items){if(f.items[c]==void 0){f.items[c]=[];for(b=0;b<10;b++)f.items[c].push(0)}for(b=0;b<10;b++)f.items[c][b]+=d.items[c][b]}}return f},showFeedback:function(a,b){var c=o.Gang;b==void 0&&(b=true);clearTimeout(c.feedTimer);g("pbgangFeedback").innerHTML=a;if(a!==""&&b)c.feedTimer=setTimeout(c.showFeedback,5E3,"")},isInActiveList:function(a,b,c){var a=o.Gang,d,e,f=false;a.getActiveTargetsCity(d);for(d=0;d<a.tgts.length;d++)if(e=a.tgts[d],e.terrain.x==
b&&e.terrain.y==c){f=true;break}return f},inworkTick:function(){var a=o.Gang;clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.type==T&&a.showTroops();a.type==V&&a.showTargets();N.showTab();a.inworkTimer=setTimeout(a.inworkTick,5E3)},hide:function(){},show:function(){}};o.Build={tabOrder:wb,tabLabel:Za,tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,expand:[],feedTimer:null,color:"",init:function(a){var b=o.Build;b.toolTip="<BR><B>"+h("Configura construcciones continuas en cada ciudad, ¬°de forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData();
a="";a+="<DIV id=pbbldsHead></div>";a+="<DIV id=pbbldsBody></div>";b.cont.innerHTML=a;b.expand=[];b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a,b,c,d,e,f=p.player.cities,g=l.options,j=false;if(g.blds==void 0)g.blds={},g.blds.enabled=false,g.blds.ind=0,g.blds.type="",g.blds.blden=[],g.blds.bldcap=[],g.blds.bldexp=[],j=true;if(g.blds.bldexp==void 0)g.blds.bldexp=[],j=true;for(a=0;a<f.length;a++)for(e in g.blds.blden[a]==void 0&&(g.blds.blden[a]={},j=true),g.blds.bldcap[a]==
void 0&&(g.blds.bldcap[a]={},j=true),g.blds.bldexp[a]==void 0&&(g.blds.bldexp[a]={},j=true),v.citiesExpansions[a])for(b in d=K.getBuildsByArea(a,e),d)if(e==y[0]?c=b:(c=b+e,g.blds.blden[a][c]!==void 0&&delete g.blds.blden[a][c],g.blds.bldcap[a][c]!==void 0&&delete g.blds.bldcap[a][c],g.blds.bldexp[a][c]!==void 0&&delete g.blds.bldexp[a][c],c=e+b),g.blds.blden[a][c]==void 0&&(g.blds.blden[a][c]=false,j=true),g.blds.bldcap[a][c]==void 0&&(g.blds.bldcap[a][c]=0,j=true),g.blds.bldexp[a][c]==void 0||g.blds.bldexp[a][c]===
"")g.blds.bldexp[a][c]=e,j=true;return j},showHead:function(){var a=o.Build,b="";b+="<DIV class=pbTitle>"+B("pbbldsOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbbldsInWork style="height:200px; max-height:200px; overflow-y:auto;"></div>';b+='<BR><DIV id=pbbldsFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';b+="</div>";b+="<TABLE width=100%>";b+="<TR>";b+="<TD align=center id=pbblds2></td>";b+="</tr>";b+="</table>";g("pbbldsHead").innerHTML=
b;a.setEnable(l.options.blds.enabled);g("pbbldsOnOff").addEventListener("click",function(){a.setEnable(!l.options.blds.enabled)},false)},setEnable:function(a){var b=o.Build;b.color="";if(!b.tabDisabled){var c=g("pbbldsOnOff"),d=h("construction","common").toUpperCase();clearTimeout(b.todoTimer);(l.options.blds.enabled=a)?(b.color="Green",c.value=d+" ON",c.className="butAttackOn",b.todoTick()):(c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=o.Build,b="",c,d=p.player.cities;
for(c=0;c<d.length;c++)a.expand.length<c+1&&a.expand.push(true),b+="<DIV class=pbTitle id=pbbldsdivtopcity_"+c+"></div>",b+="<DIV class=pbSubtitle id=pbbldsdivcity_"+c+"></div>";g("pbbldsBody").innerHTML=b;a.showInfo()},showInfo:function(){function a(a){var b=a.target.id.split("_"),c=u(b[1]);l.options.blds.blden[c][b[2]]=a.target.checked}function b(a){var b=a.target.id.split("_"),c=u(b[1]);l.options.blds.bldcap[c][b[2]]=u(a.target[a.target.selectedIndex].value)}function c(a,b,c,d){var e="",f=l.options.blds,
g=K.getBuildsByArea(a,y[d],b),j,n;e+="<B>&nbsp;"+h(b,"common").toUpperCase()+"</b>";e+="<TABLE id=pbblds_"+b+"_"+a+" width=100%>";for(j in g)if(n=g[j],n.builds.length!==0&&Ea[j]){b=y[d]+j;d===0&&(b=j);if(f.bldcap[a][b]===0||f.bldcap[a][b]<n.builds[0].level)f.bldcap[a][b]=n.builds[0].level;e+=P(true,"valign=top",true,0,"pbbldsChk_"+a+"_"+b,f.blden[a][b],h(n.builds[0].presentation_type,"buildings"),true);e+="<TD><SELECT id=pbbldsSel_"+a+"_"+b+">";for(n=1;n<Ea[j].maxlevel+1;n++)e+="<OPTION"+(f.bldcap[a][b]==
n?" selected":"")+' value="'+n+'">'+n+"</option>";e+="</select></td>";e+="</tr>";c.push({en:"pbbldsChk_"+a+"_"+b,cap:"pbbldsSel_"+a+"_"+b})}e+="</table>";return e}function d(a){var b=o.Build,c=a.target.id.split("_"),c=u(c[1]),d="none";b.expand[c]=!b.expand[c];b.expand[c]&&(d="block");a.target.value=" "+(b.expand[c]===true?"-":"+")+" ";g("pbbldsdivcity_"+c).style.display=d}function e(a){var b=a.target.id.replace("pbbldsHideShow_",""),c=a.target.value==" - "?" + ":" - ";if(g(b))g(b).style.display=g(b).style.display==
"none"?"block":"none";a.target.value=c}function f(a){a=a.target.id.split("_");a=u(a[1]);v.defendCity(a)}var n=o.Build,j="",z,q,s,L,A,w=[],E=p.player.cities;for(z=0;z<E.length;z++){g("pbbldsdivtopcity_"+z).innerHTML=v.getCityTitle(z,n);j="";s=Object.size(v.citiesExpansions[z])>1;for(q=0;q<y.length;q++)if(v.citiesExpansions[z][y[q]]!==void 0&&v.citiesExpansions[z][y[q]]){if(s){L="+";A=g("pbbldsHideShow_pbbldsExp_"+z+"_"+q);if(!A||A.style.display!="none")L="-";j+="<DIV class=pbTitle>"+h("neighborhood-"+
y[q],"common");j+="&nbsp;"+B("pbbldsHideShow_pbbldsExp_"+z+"_"+q," "+L+" ",false,false,"small");j+="</div>"}j+="<TABLE id=pbbldsExp_"+z+"_"+q+" width=100%><TR>";j+="<TD width="+(q===0?50:100)+'% style="text-align:left; vertical-align:top;">'+c(z,"neighborhood",w,q)+"</td>";q===0&&(j+='<TD width=50% style="text-align:left; vertical-align:top;">'+c(z,"compound",w,q)+"</td>");j+="</tr></table>"}g("pbbldsdivcity_"+z).innerHTML=j;g("pbbldsdivcity_"+z).style.display=n.expand[z]===true?"block":"none";g("pbbldsHideShow_"+
z).addEventListener("click",d,false);g("pbbldsDefend_"+z).addEventListener("click",f,false);if(s)for(q=0;q<y.length;q++)v.citiesExpansions[z][y[q]]!==void 0&&v.citiesExpansions[z][y[q]]&&g("pbbldsHideShow_pbbldsExp_"+z+"_"+q).addEventListener("click",e,false)}for(z=0;z<w.length;z++)g(w[z].en).addEventListener("click",a,false),g(w[z].cap).addEventListener("change",b,false)},checkJobs:function(a){var b,c,d,e,f=C();d=G.getJobsByQueue("building",a);for(b=d.length-1;b>=0;b--)e=d[b],c=u(e.run_at-f),c<=
0?G.deleteJob(e.id):(c=K.getBuildById(a,e.city_building_id),c===null&&G.deleteJob(e.id))},todoTick:function(){var a=o.Build,b=5E3,c=l.options.blds;if(c.ind>=p.player.cities.length)c.ind=0,c.type="";var d=c.type,e=c.ind,f,g,j,h,q,u=false,s=false;clearTimeout(a.todoTimer);a.checkJobs(e);if(G.getJobsByQueue("building",e).length===0){var A;for(f=0;f<y.length;f++){if(v.citiesExpansions[e][y[f]]!==void 0&&v.citiesExpansions[e][y[f]])for(g in A=K.getBuildsByArea(e,y[f]),A){q=A[g];j=y[f]+g;f===0&&(j=g);if(d===
""||j==d){u=true;c.type=j;if(d!=="")continue;d=j}if(u&&c.blden[e][j]&&q.builds.length!==0){c.type=j;for(h=0;h<q.builds.length;h++)if(q.builds[h].level<c.bldcap[e][j]&&K.checkRequirements(e,q.builds[h])){a.doWork(e,q.builds[h],y[f]);s=true;break}if(s)break}}if(s)break}}if(!s){c.ind++;if(c.ind>=p.player.cities.length)c.ind=0;c.type="";p.player.cities.length<2&&(b=3E3)}a.todoTimer=setTimeout(a.todoTick,b)},doWork:function(a,b,c){var d=b.id,e=v.getCityId(a);s.calls["cities/@@id1/buildings/@@id2.json"].parms["city_building[neighborhood_id]"]=
v.getNeighId(a,c);s.calls["cities/@@id1/buildings/@@id2.json"].parms.city_id=e;s.generalCall("cities/@@id1/buildings/@@id2.json",e,d,function(a){if(a.ok){var a=a.dat.result,c=v.getCityIndById(a.city.id);p.player.cities[c]=a.city;da(h("build","common")+" "+h(b.presentation_type,"buildings")+" "+h("level","common")+" "+(b.level+1))}else da(h("Errore")+" in "+h("build","common")+": "+a.errmsg)})},showFeedback:function(a){var b=o.Build;clearTimeout(b.feedTimer);g("pbbldsFeedback").innerHTML=a;if(a!==
"")b.feedTimer=setTimeout(b.showFeedback,5E3,"")},inworkTick:function(){var a=o.Build,b="",c=p.player.cities,d,e,f,n,j,l,q=C();clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.showInfo();for(d=0;d<c.length;d++)a.checkJobs(d);b+="<TABLE class=pbTab>";for(d=0;d<c.length;d++){b+="<TR><TD align=left>";b+=p.player.cities[d].name;b+="</td>";f=G.getJobsByQueue("building",d);for(e=0;e<f.length;e++)j=f[e],l=u(j.run_at-q),n=K.getBuildById(d,j.city_building_id),b+="<TD align=left>",b+=h(n.presentation_type,
"buildings")+" "+h("level","common")+" "+j.level,b+="</td>",b+="<TD align=right>("+Y(l)+")</td>";f.length===0&&(b+="<TD align=left><FONT COLOR=red>"+h("no","common")+"</font></td><TD></td>");b+="</tr>"}b+="</table>";g("pbbldsInWork").innerHTML=b;a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};o.Train={tabOrder:5,tabLabel:"Entr.",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,expand:[],color:"",init:function(a){var b=o.Train;b.toolTip="<B>"+
h("Configura entrenamientos continuos en cada ciudad, ¬°de forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbtraiHead></div>";a+="<DIV id=pbtraiBody></div>";b.cont.innerHTML=a;b.expand=[];b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a=l.options.trai,b=false,c,d,e=p.player.cities,f;a==void 0&&(a={enabled:false,ind:0,type:"",dind:0,dtype:"",traen:[],traqty:[]},b=true);if(a.dind==void 0)a.dind=0,a.dtype="",b=true;for(c=0;c<e.length;c++)for(d in a.traen[c]==void 0&&(a.traen[c]={},b=true),a.traqty[c]==void 0&&
(a.traqty[c]={},b=true),f=ba,e[c].type=="DoriaAirport"&&(f=ua),f)f[d].city&&e[c].type!=f[d].city||(a.traen[c][d]==void 0&&(a.traen[c][d]=false,b=true),a.traqty[c][d]==void 0&&(a.traqty[c][d]=0,b=true));return b},showHead:function(){var a=o.Train,b="";b+="<DIV class=pbTitle>"+B("pbtraiOnOff","",false,false)+"</div>";b+="<DIV class=pbStatBox>";b+='<DIV id=pbtraiInWork style="height:200px; max-height:200px; overflow-y:auto;"></div>';b+='<BR><DIV id=pbtraiFeedback style="font-weight:bold; border: 1px solid #AA00FF; min-height:17px;"></div>';
b+="</div>";b+="<TABLE width=100%>";b+="<TR>";b+="<TD align=center id=pbtrai2></td>";b+="</tr>";b+="</table>";g("pbtraiHead").innerHTML=b;a.setEnable(l.options.trai.enabled);g("pbtraiOnOff").addEventListener("click",function(){a.setEnable(!l.options.trai.enabled)},false)},setEnable:function(a){var b=o.Train;b.color="";if(!b.tabDisabled){var c=g("pbtraiOnOff"),d=h("train","common").toUpperCase();clearTimeout(b.todoTimer);(l.options.trai.enabled=a)?(b.color="Green",c.value=d+" ON",c.className="butAttackOn",
b.todoTick()):(c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=o.Train,b="",c,d=p.player.cities;for(c=0;c<d.length;c++)a.expand.length<c+1&&a.expand.push(true),b+="<DIV class=pbTitle id=pbtraidivtopcity_"+c+"></div>",b+="<DIV class=pbSubtitle id=pbtraidivcity_"+c+"></div>";g("pbtraiBody").innerHTML=b;a.showInfo()},showInfo:function(){function a(a){var b=a.target.id.split("_"),c=u(b[1]);l.options.trai.traen[c][b[2]]=a.target.checked}function b(a){var b=a.target.id.split("_"),
c=u(b[1]);l.options.trai.traqty[c][b[2]]=mb(a.target.value)}function c(a){var b=a.target.id.split("_"),a=u(b[1]),b=b[2],c=l.options.trai.traqty[a][b],d=A.isDefensive(b),e=(d===true?"defense_":"")+"units",f=0;if(p.player.cities[a].type=="DoriaAirport")e="craft_"+(d===true?"defensive":"offensive"),f=K.getBuildByType(a,d===true?"Tower":"Hangar").id;G.getJobsByQueue(e,a).length===0&&A.checkRequirements(a,b,c)&&A.train(a,b,c,f)}function d(a){var b=o.Train,c=a.target.id.split("_"),a=u(c[1]),c=c[2];if(ba[c].bail){var d=
mb(g("pbtraiBailQty_"+a+"_"+c).value),e={};e[c]=d;d>A.injail[a][c]?b.showFeedback(p.player.cities[a].name+" "+h("Troppe truppe")+"!"):d*ba[c].bail>p.player.cities[a].resources.cash?b.showFeedback(p.player.cities[a].name+" "+h("Non hai abbastanza")+" "+h("cash","common")+"!"):A.bailOut(a,e)}}function e(a,b,c){var d="",e,f,g=0,j=l.options.trai,n=p.player.cities,o=ba;n[a].type=="DoriaAirport"&&(o=ua);c==void 0&&(c=false);e="training-offensive";c&&(e="training-defensive");d+="<TABLE width=100%>";d+="<TR><TD align=center>"+
h(e,"common").toUpperCase()+"</td></tr>";d+="</table>";d+="<TABLE width=100%>";for(f in o){if(c){if(!A.isDefensive(f))continue}else if(A.isDefensive(f))continue;o[f].city&&n[a].type!=o[f].city||(g++,g%2!==0&&(g>1&&(d+="</tr>"),d+="<TR>"),d+="<TD align=left width=50%>",d+="<TABLE width=100%><TR>",d+="<TD align=left width=55% valign=top>&nbsp;"+P(false,"",false,0,"pbtraiChk_"+a+"_"+f,j.traen[a][f])+" "+h(f,"troops")+"</td>",d+="<TD align=left width=45% valign=top>"+J("pbtraiQty_"+a+"_"+f,j.traqty[a][f],
1,6,"normalGreen")+" ",d+=B("pbtraiTrain_"+a+"_"+f,h("train","common"),false,false)+"&nbsp;</td>",d+="</tr></table>",d+="</td>",b.push({en:"pbtraiChk_"+a+"_"+f,qty:"pbtraiQty_"+a+"_"+f,but:"pbtraiTrain_"+a+"_"+f}))}g%2!==0&&(d+="<TD width=50%>&nbsp;</td>");d+="</table>";return d}function f(a,b){var c="",d,e=0;if(Object.size(A.injail[a])>0){c+="<TABLE width=100%>";c+="<TR><TD align=center>"+h("bail","common").toUpperCase()+"</td></tr>";c+="</table>";c+="<TABLE width=100%>";for(d in A.injail[a])e++,
e%2!==0&&(e>1&&(c+="</tr>"),c+="<TR>"),c+="<TD align=left width=50%>",c+="<TABLE width=100%><TR>",c+="<TD align=left width=55% valign=top>&nbsp;"+h(d,"troops")+" ("+A.injail[a][d]+")</td>",c+="<TD align=left width=45% valign=top>"+J("pbtraiBailQty_"+a+"_"+d,0,1,6,"normalGreen")+" ",c+=B("pbtraiBail_"+a+"_"+d,h("bail","common"),false,false)+"&nbsp;</td>",c+="</tr></table>",c+="</td>",b.push({qty:"pbtraiBailQty_"+a+"_"+d,but:"pbtraiBail_"+a+"_"+d});e%2!==0&&(c+="<TD width=50%>&nbsp;</td>");c+="</table>"}return c}
function n(a){var b=o.Train,c=a.target.id.split("_"),c=u(c[1]),d="none";b.expand[c]=!b.expand[c];b.expand[c]&&(d="block");a.target.value=" "+(b.expand[c]===true?"-":"+")+" ";g("pbtraidivcity_"+c).style.display=d}function j(a){a=a.target.id.split("_");a=u(a[1]);v.defendCity(a)}var q=o.Train,s="",H,y=[],C=[],w=p.player.cities;for(H=0;H<w.length;H++)g("pbtraidivtopcity_"+H).innerHTML=v.getCityTitle(H,q),s=e(H,y),s+=e(H,y,true),s+=f(H,C),g("pbtraidivcity_"+H).innerHTML=s,g("pbtraidivcity_"+H).style.display=
q.expand[H]===true?"block":"none",g("pbtraiHideShow_"+H).addEventListener("click",n,false),g("pbtraiDefend_"+H).addEventListener("click",j,false);for(H=0;H<y.length;H++)g(y[H].en).addEventListener("click",a,false),g(y[H].qty).addEventListener("change",b,false),g(y[H].but).addEventListener("click",c,false);for(H=0;H<C.length;H++)g(C[H].but).addEventListener("click",d,false)},todoTick:function(){var a=o.Train,b=5E3,c=l.options.trai,d=false;if(c.ind>=p.player.cities.length)c.ind=0,c.type="";if(c.dind>=
p.player.cities.length)c.dind=0,c.dtype="";var d=c.type,e=c.ind,f=c.dtype,g,j,h=false,q=false,u=p.player.cities,s=ba,v=0;u[e].type=="DoriaAirport"&&(s=ua);clearTimeout(a.todoTimer);a.checkJobs(e);a.checkJobs(e,true);g="units";if(u[e].type=="DoriaAirport")g="craft_offensive",v=K.getBuildByType(e,"Hangar"),v=v.id;g=G.getJobsByQueue(g,e);if(g.length===0)for(j in s){if(d===""||j==d){h=true;c.type=j;if(d!=="")continue;d=j}if(h&&c.traen[e][j]&&c.traqty[e][j]!==0&&!A.isDefensive(j)&&(c.type=j,A.checkRequirements(e,
j,c.traqty[e][j]))){a.doWork(e,j,c.traqty[e][j],v);q=true;break}}d=q;if(!q){c.ind++;if(c.ind>=p.player.cities.length)c.ind=0;c.type="";p.player.cities.length<2&&(b=3E3)}q=h=false;g="defense_units";if(u[e].type=="DoriaAirport")g="craft_defensive",v=K.getBuildByType(e,"Tower"),v=v.id;g=G.getJobsByQueue(g,e);if(g.length===0)for(j in s){if(f===""||j==f){h=true;c.dtype=j;if(f!=="")continue;f=j}if(h&&c.traen[e][j]&&c.traqty[e][j]!==0&&A.isDefensive(j)&&(c.dtype=j,A.checkRequirements(e,j,c.traqty[e][j]))){d?
setTimeout(a.doWork,1500,e,j,c.traqty[e][j],v):a.doWork(e,j,c.traqty[e][j],v);q=true;break}}if(!q){c.dind++;if(c.dind>=p.player.cities.length)c.dind=0;c.dtype="";p.player.cities.length<2&&(b=3E3)}a.todoTimer=setTimeout(a.todoTick,b)},doWork:function(a,b,c,d){A.train(a,b,c,d)},showFeedback:function(a){var b=o.Train;clearTimeout(b.feedTimer);g("pbtraiFeedback").innerHTML=a;if(a!=="")b.feedTimer=setTimeout(b.showFeedback,5E3,"")},checkJobs:function(a,b){var c,d,e,f,g=C();b==void 0&&(b=false);c=(b===
true?"defense_":"")+"units";p.player.cities[a].type=="DoriaAirport"&&(c="craft_"+(b===true?"defensive":"offensive"));d=G.getJobsByQueue(c,a);for(c=d.length-1;c>=0;c--)e=d[c],f=u(e.run_at-g),f<=0&&G.deleteJob(e.id)},inworkTick:function(){var a=o.Train,b="",c=C(),d,e,f,n=p.player.cities;clearTimeout(a.inworkTimer);a.clearDefaultData()&&a.showInfo();for(d=0;d<n.length;d++)a.checkJobs(d),a.checkJobs(d,true);b+="<TABLE class=pbTab>";for(d=0;d<n.length;d++){b+="<TR><TD align=left>";b+=n[d].name;b+="</td>";
e="units";n[d].type=="DoriaAirport"&&(e="craft_offensive");jobs=G.getJobsByQueue(e,d);f=jobs.length===0;for(e=0;e<jobs.length;e++)job=jobs[e],time=u(job.run_at-c),b+="<TD align=left>",b+=job.quantity+" "+h(job.unit_type,"troops"),b+="</td>",b+="<TD align=right>("+Y(time)+")</td>";e="defense_units";n[d].type=="DoriaAirport"&&(e="craft_defensive");jobs=G.getJobsByQueue(e,d);if(jobs.length===0)f&&(b+="<TD align=left><FONT COLOR=red>"+h("no","common")+"</font></td><TD></td>");else{f||(b+="</tr>",b+="<TR><TD align=left>&nbsp;</td>");
for(e=0;e<jobs.length;e++)job=jobs[e],time=u(job.run_at-c),b+="<TD align=left>",b+=job.quantity+" "+h(job.unit_type,"troops"),b+="</td>",b+="<TD align=right>("+Y(time)+")</td>"}b+="</tr>"}b+="</table>";g("pbtraiInWork").innerHTML=b;a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},show:function(){}};o.Research={tabOrder:6,tabLabel:"Inve.",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,expand:[],color:"",init:function(a){var b=o.Research;b.toolTip="<B>"+h("Configura investigaciones de forma continua en cada ciudad, ¬°de forma facil")+
"! (Actualmente en desarrollo)</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbreseHead></div>";a+="<DIV id=pbreseBody></div>";b.cont.innerHTML=a;b.expand=[];b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a=l.options.rese,b=false,c,d,e=p.player.cities;a==void 0&&(a={enabled:false,ind:0,type:"",resen:[],rescap:[]},b=true);for(c=0;c<e.length;c++){a.resen[c]==void 0&&(a.resen[c]={},b=true);a.rescap[c]==void 0&&(a.rescap[c]={},b=true);var f;for(d=0;d<Eb.length;d++)f=Eb[d],a.resen[c][f]==void 0&&
(a.resen[c][f]=false,b=true),a.rescap[c][f]==void 0&&(a.rescap[c][f]=0,b=true)}return b},showHead:function(){var a="";a+="<TABLE width=100%>";a+="<TR>";a+="<TD align=center id=pbrese2></td>";a+="</tr>";a+="</table>";g("pbreseHead").innerHTML=a},setEnable:function(a){var b=o.Research;b.color="";if(!b.tabDisabled){var c=g("pbreseOnOff"),d=h("research","common").toUpperCase();clearTimeout(b.todoTimer);(l.options.rese.enabled=a)?(b.color="Green",c.value=d+" ON",c.className="butAttackOn",b.todoTick()):
(c.value=d+" OFF",c.className="butAttackOff")}},showBody:function(){var a=o.Research,b="";b+="<BR><BR><DIV class=incoming>"+h("In arrivo")+"</div>";g("pbreseBody").innerHTML=b;a.showInfo()},showInfo:function(){},showFeedback:function(a){var b=o.Research;clearTimeout(b.feedTimer);g("pbreseFeedback").innerHTML=a;if(a!=="")b.feedTimer=setTimeout(b.showFeedback,5E3,"")},inworkTick:function(){var a=o.Research;C();clearTimeout(a.inworkTimer);a.inworkTimer=setTimeout(a.inworkTick,2500)},hide:function(){},
show:function(){}};o.Collect={tabOrder:7,tabLabel:"Reco.",tabDisabled:false,cont:null,toolTip:"",todoTimer:null,inworkTimer:null,init:function(a){var b=o.Collect;b.toolTip=h("Investigacion automatizada.")+"<BR><B>"+h("Configura investigaciones continuas en cada ciudad, ¬°de forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pbcollHead></div>";a+="<DIV id=pbcollBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody();b.inworkTick()},clearDefaultData:function(){var a,b,c,d,e,f,g=p.player.cities,j=l.options,h=false;if(j.coll==void 0)j.coll=
{},j.coll.collen=[],j.coll.scapes=[],h=true;if(j.coll.scapes==void 0)j.coll.scapes=[],h=true;for(a=0;a<g.length;a++){j.coll.collen[a]==void 0&&(j.coll.collen[a]={},h=true);j.coll.scapes[a]==void 0&&(j.coll.scapes[a]={},h=true);c=K.getBuildsByFirstHood(a,"",true);for(b in c)j.coll.collen[a][b]==void 0&&(j.coll.collen[a][b]=false,h=true);if(g[a].wildernesses){for(b in j.coll.scapes[a]){d=u(b/1E3);e=u(b)%1E3;f=false;for(c=0;c<g[a].wildernesses.length;c++)if(g[a].wildernesses[c].x==d&&g[a].wildernesses[c].y==
e){f=true;break}f||(delete j.coll.scapes[a][b],h=true)}for(b=0;b<g[a].wildernesses.length;b++)c=""+(g[a].wildernesses[b].x*1E3+g[a].wildernesses[b].y),j.coll.scapes[a][c]==void 0&&(j.coll.scapes[a][c]=false,h=true)}}return h},showHead:function(){var a="";a+="<DIV class=pbTitle>"+h("collect","common").toUpperCase()+"</div>";a+="<TABLE width=100%>";a+="<TR>";a+="<TD align=center id=pbcoll2></td>";a+="</tr>";a+="</table>";a+="<DIV id=pbcollInWork></div>";g("pbcollHead").innerHTML=a},checkJobs:function(){var a=
o.Collect,b=p.player.cities,c,d,e,f,g=C();a.clearDefaultData();for(a=0;a<b.length;a++){c=K.getBuildsByFirstHood(a,"",true);for(d in c)e=G.getJobsByQueue("collection"+d,a),e.length!==0&&(f=u(e[0].run_at-g),f<=0&&G.deleteJob(e[0].id));e=G.getJobsByQueue("city_scape_collect",a);for(d=0;d<e.length;d++)f=u(e[d].run_at-g),f<=0&&G.deleteJob(e[d].id)}},showBody:function(){var a=o.Collect;g("pbcollBody").innerHTML="";a.todoTick()},todoTick:function(){var a=o.Collect,b=p.player.cities,c,d,e,f,g,j,h,q=C(),s=
0,y=l.options.coll;clearTimeout(a.todoTimer);a.checkJobs();for(c=0;c<b.length;c++){g=K.getBuildsByFirstHood(c,"",true);for(d in g)if(y.collen[c][d]&&(j=g[d],j.builds.length!==0)){f=G.getJobsByQueue("collection"+d,c);if(h=f.length!==0)e=u(f[0].run_at-q),e<=0&&(h=false);h||(setTimeout(a.doWork,s*3E3,v.getCityId(c),j.builds[0].id),s++)}f=G.getJobsByQueue("city_scape_collect",c);if(b[c].wildernesses)for(d=0;d<b[c].wildernesses.length;d++)if(g=b[c].wildernesses[d],h=""+(g.x*1E3+g.y),y.scapes[c][h]){h=
false;for(e=0;e<f.length;e++)if(f[e].x==g.x&&f[e].y==g.y){h=true;e=u(f[e].run_at-q);e<=0&&(h=false);break}h||g.last_collected_at!=void 0&&(h=v.remainingTimeToCollect(c,g.last_collected_at)>=0);h||(setTimeout(a.doWork,s*3E3,v.getCityId(c),g.id,true),s++)}}a.todoTimer=setTimeout(a.todoTick,(s+2)*3E3)},doWork:function(a,b,c){c==void 0&&(c=false);c=c?"cities/@@id1/wildernesses/@@id2/collect.json":"cities/@@id1/npc_buildings/@@id2.json";s.calls[c].parms.city_building_id=b;s.calls[c].parms.city_id=a;s.generalCall(c,
a,b,function(a){if(a.ok){var b=o.Collect,a=a.dat.result,c,g;a.job?(c=a.job.queue.replace("collection",""),g=a.city_id):(c="",g=a.city.id);g=v.getCityIndById(g);var j="";a.job?(p.player.cities[g].resources=a.resources,G.addJob(a.job),j=h(c,"buildings")):(p.player.cities[g]=a.city,j=h("cityscapes","common"));da(h("collect","common")+" "+h("from","common")+" "+j);b.showBody()}else da(h("Errore")+" in "+h("collect","common")+": "+a.errmsg)})},inworkTick:function(){function a(a){var b=a.target.id.split("_"),
c=u(b[1]);l.options.coll.collen[c][b[2]]=a.target.checked}function b(a){var b=o.Collect,a=a.target.id.split("_");b.doWork(a[1],a[2])}function c(a){var b=a.target.id.split("_"),c=u(b[1]);l.options.coll.scapes[c][b[2]]=a.target.checked}function d(a){var b=o.Collect,a=a.target.id.split("_");b.doWork(a[1],a[2],true)}function e(a){var b=a.target.id.split("_"),a=u(b[1])!==0,c=u(b[2]),b=p.player.cities,d,e,f;if(c===0)for(c=0;c<b.length;c++)for(d in e=K.getBuildsByFirstHood(c,"",true),e)f=e[d],f.builds.length!==
0&&(l.options.coll.collen[c][d]=a);else for(c=0;c<b.length;c++){e=b[c].wildernesses;for(d=0;d<e.length;d++)f=""+(e[d].x*1E3+e[d].y),l.options.coll.scapes[c][f]=a}}var f=o.Collect,n="",j=p.player.cities,q,s,y,A,D,w,E,F,J=C();clearTimeout(f.inworkTimer);f.checkJobs();n+="<DIV class=pbSubtitle>";n+="<TABLE width=100%>";n+="<TR><TD colspan=4 align=center>&nbsp;";q=h("from","common")+" "+h("construction","common");n+="<DIV class=pbTitle>"+q.toUpperCase()+" ";n+=B("pbcollSel_1_0",h("select","common")+" "+
h("all","common"),false,false,"small")+" ";n+=B("pbcollSel_0_0","De"+h("select","common")+" "+h("all","common"),false,false,"small");n+="</div>";n+="</td></tr>";for(q=0;q<j.length;q++)for(s in y=K.getBuildsByFirstHood(q,"",true),y)D=y[s],D.builds.length!==0&&(n+="<TR><TD align=left>&nbsp;"+h(s,"buildings")+"</td>",n+="<TD align=center>",A=G.getJobsByQueue("collection"+s,q),n+=B("pbcollBut_"+v.getCityId(q)+"_"+D.builds[0].id,h("collect","common"),A.length!==0,false,"small")+"</td>",A.length!==0?(F=
u(A[0].run_at-J),n+="<TD align=left>&nbsp;("+Y(F)+")</td>"):n+="<TD>&nbsp;</td>",n+="<TD align=right>"+P(false,"",false,0,"pbcollChk_"+q+"_"+s,l.options.coll.collen[q][s])+" "+h("collect","common")+" "+h("in automatico")+"&nbsp;</td></tr>");n+="<TR><TD colspan=4 align=center>&nbsp;";q=h("from","common")+" "+h("cityscapes","common");n+="<DIV class=pbTitle>"+q.toUpperCase()+" ";n+=B("pbcollSel_1_1",h("select","common")+" "+h("all","common"),false,false,"small")+" ";n+=B("pbcollSel_0_1","De"+h("select",
"common")+" "+h("all","common"),false,false,"small");n+="</div>";n+="</td></tr>";for(q=0;q<j.length;q++)if(w=j[q].wildernesses,A=G.getJobsByQueue("city_scape_collect",q),w)for(s=0;s<w.length;s++){D=""+(w[s].x*1E3+w[s].y);E=false;for(y=0;y<A.length;y++)if(A[y].x==w[s].x&&A[y].y==w[s].y){E=true;F=u(A[y].run_at-J);break}!E&&w[s].last_collected_at&&(F=v.remainingTimeToCollect(q,w[s].last_collected_at),E=F>0);n+="<TR><TD align=left>&nbsp;"+h("cityscapes","common")+": "+w[s].x+"/"+w[s].y+"</td>";n+="<TD align=center>";
n+=B("pbcollScapesBut_"+v.getCityId(q)+"_"+w[s].id,h("collect","common"),E,false,"small")+"</td>";n+=E?"<TD align=left>&nbsp;("+Y(F)+")</td>":"<TD>&nbsp;</td>";n+="<TD align=right>"+P(false,"",false,0,"pbcollScapesChk_"+q+"_"+D,l.options.coll.scapes[q][D])+" "+h("collect","common")+" "+h("in automatico")+"&nbsp;</td></tr>"}n+="</table>";n+="</div>";g("pbcollInWork").innerHTML=n;f.inworkTimer=setTimeout(f.inworkTick,2500);for(q=0;q<j.length;q++){w=j[q].wildernesses;y=K.getBuildsByFirstHood(q,"",true);
for(s in y)D=y[s],D.builds.length!==0&&(g("pbcollBut_"+v.getCityId(q)+"_"+D.builds[0].id).addEventListener("click",b,false),g("pbcollChk_"+q+"_"+s).addEventListener("click",a,false));if(w)for(s=0;s<w.length;s++)D=""+(w[s].x*1E3+w[s].y),g("pbcollScapesBut_"+v.getCityId(q)+"_"+w[s].id).addEventListener("click",d,false),g("pbcollScapesChk_"+q+"_"+D).addEventListener("click",c,false)}g("pbcollSel_1_0").addEventListener("click",e,false);g("pbcollSel_0_0").addEventListener("click",e,false);g("pbcollSel_1_1").addEventListener("click",
e,false);g("pbcollSel_0_1").addEventListener("click",e,false)},hide:function(){},show:function(){}};var ha=0;o.Various={tabOrder:8,tabLabel:"Vari.",tabDisabled:false,cont:null,toolTip:"",type:ha,todoTimer:null,inworkTimer:null,init:function(a){var b=o.Various;b.toolTip=h("Controla y usa tus objetos sin necesidad de entrar al FLASH (juego), ¬° de forma facil")+"!</b><BR>";b.cont=a;a="";a+="<DIV id=pbvarsHead></div>";a+="<DIV id=pbvarsBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},showHead:function(){var a=o.Various,b="";b+="<DIV class=pbTitle>"+h("Varios").toUpperCase()+
"</div>";b+="<DIV id=pbvarsButt></div>";g("pbvarsHead").innerHTML=b;a.showButt()},showButt:function(){var a="";a+="<TABLE width=100%>";a+="<TR>";a+="<TD>"+B("pbvarsBut_"+ha,h("my-items","common"),false,false,"small")+"</td>";a+="<TD align=center id=pbvars2></td>";a+="</tr>";a+="</table>";g("pbvarsButt").innerHTML=a;g("pbvarsBut_"+ha).addEventListener("click",function(a){var c=o.Various,a=a.target.id.split("_");c.type=u(a[1]);c.showDiv()},false)},showDiv:function(){var a=o.Various;g("pbvarsItems").style.display=
"none";switch(a.type){case ha:g("pbvarsItems").style.display="block",a.showItems()}},showBody:function(){var a=o.Various,b="";b+='<DIV id=pbvarsItems class=pbStatBox style="display:none;"></div>';g("pbvarsBody").innerHTML=b;a.showDiv()},showItems:function(){function a(a){a=a.target.id.split("_");S.useObject(a[1])}var b=S.getInventory(),c;g("pbvarsItems").innerHTML=b.msg;for(c=0;c<b.els.length;c++)g(b.els[c]).addEventListener("click",a,false)},inworkTick:function(){var a=o.Various;clearTimeout(a.inworkTimer);
a.inworkTimer=setTimeout(a.inworkTick,5E3)},hide:function(){},show:function(){}};o.Options={tabOrder:ub,tabLabel:vb,tabDisabled:false,cont:null,toolTip:"",timerInfo:null,timerFlash:null,timerTool:null,timerJail:null,timerBear:null,init:function(a){var b=o.Options;b.toolTip=h("Selecciona y configura las opciones de acorde a tus necesidades.")+"<BR><B>"+h("¬°De forma facil")+"!</b><BR>";b.cont=a;b.clearDefaultData();a="";a+="<DIV id=pboptsHead></div>";a+="<DIV id=pboptsBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},clearDefaultData:function(){var a=
l.options,b=p.player.cities.length*5;if(a.info==void 0)a.info={},a.info.enabled=true,a.info.delay=5,a.info.unit=60;if(a.info.delay*a.info.unit<b)a.info.delay=b,a.info.unit=1;if(a.flash==void 0)a.flash={},a.flash.enabled=false,a.flash.delay=15,a.flash.unit=60;if(a.tool==void 0)a.tool={},a.tool.enabled=false,a.tool.delay=15,a.tool.unit=60;if(a.jail==void 0)a.jail={},a.jail.enabled=false,a.jail.delay=15,a.jail.unit=60;if(a.jail.enabled==void 0)a.jail.enabled=false;if(a.jail.enabled==void 0)a.jail.delay=
15;if(a.jail.enabled==void 0)a.jail.unit=60;if(a.bear==void 0)a.bear={},a.bear.enabled=false,a.bear.delay=8,a.bear.unit=3600},showHead:function(){var a="";a+="<DIV class=pbTitle>"+h("Caracteristicas").toUpperCase()+"</div>";g("pboptsHead").innerHTML=a},setTimerInfo:function(){var a=o.Options,b=l.options.info;clearInterval(a.timerInfo);if(b.enabled)a.timerInfo=setInterval(Ua,b.delay*b.unit*1E3)},setTimerFlash:function(){var a=o.Options,b=l.options.flash;clearInterval(a.timerFlash);if(b.enabled)a.timerFlash=
setInterval(a.resetFlash,b.delay*b.unit*1E3)},setTimerTool:function(){var a=o.Options,b=l.options.tool;clearTimeout(a.timerTool);if(b.enabled)a.timerTool=setTimeout(ya,b.delay*b.unit*1E3)},setTimerJail:function(){var a=o.Options,b=l.options.jail;clearInterval(a.timerJail);if(b.enabled)a.timerJail=setInterval(A.bailOutAuto,b.delay*b.unit*1E3)},setTimerBear:function(){var a=o.Options,b=l.options.bear;clearInterval(a.timerBear);if(b.enabled)a.timerBear=setInterval(v.checkBear,b.delay*b.unit*1E3)},resetFlash:function(){var a=
o.Options,b=g("container");b.style.display=="none"?b.style.display="block":(b.style.display="none",setTimeout(a.resetFlash,1E3))},showBody:function(){function a(a){var b=a.target.id.replace("pbopts",""),a=a.target.checked;switch(b){case "Info":l.options.info.enabled=a;d.setTimerInfo();break;case "Flash":l.options.flash.enabled=a;d.setTimerFlash();break;case "Tool":l.options.tool.enabled=a;d.setTimerTool();break;case "Every6":l.options.every6=a;break;case "Jail":l.options.jail.enabled=a;d.setTimerJail();
break;case "Bear":l.options.bear.enabled=a,d.setTimerBear()}}function b(a){var b=a.target.id.replace("pboptsDelay",""),c=ea(a.target.value),e=p.player.cities.length*5;switch(b){case "Info":if(c<e&&l.options.info.unit==1)a.target.value=c=e;l.options.info.delay=c;d.setTimerInfo();break;case "Flash":l.options.flash.delay=c;d.setTimerFlash();break;case "Tool":l.options.tool.delay=c;d.setTimerTool();break;case "Jail":l.options.jail.delay=c;d.setTimerJail();break;case "Bear":l.options.bear.delay=c,d.setTimerBear()}}
function c(a){var b=a.target.id.replace("pboptsUnit",""),a=u(a.target[a.target.selectedIndex].value),c=p.player.cities.length*5;switch(b){case "Info":if(a==1&&l.options.info.delay<c)g("pboptsDelayInfo").value=l.options.info.delay=c;l.options.info.unit=a;d.setTimerInfo();break;case "Flash":l.options.flash.unit=a;d.setTimerFlash();break;case "Tool":l.options.tool.unit=a;d.setTimerTool();break;case "Jail":l.options.jail.unit=a;d.setTimerJail();break;case "Bear":l.options.bear.unit=a,d.setTimerBear()}}
var d=o.Options,e="";e+="<TABLE width=100%>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsInfo",l.options.info.enabled)+" "+h("Leggi Info ogni")+"&nbsp;</td>";e+="<TD>"+J("pboptsDelayInfo",l.options.info.delay,1,2,"normalGreen")+"</td>";e+=sa(false,true,"pboptsUnitInfo",1,zb,l.options.info.unit,Ab,true);e+="<TD>"+B("pboptsReadInfo",h("Leggi ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsFlash",l.options.flash.enabled)+" "+h("Riavvia Flash ogni")+"&nbsp;</td>";
e+="<TD>"+J("pboptsDelayFlash",l.options.flash.delay,1,2,"normalGreen")+"</td>";e+=sa(false,true,"pboptsUnitFlash",1,Bb,l.options.flash.unit,Cb,true);e+="<TD>"+B("pboptsResetFlash",h("Riavvia ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsTool",l.options.tool.enabled)+" "+h("Riavvia Tool ogni")+"&nbsp;</td>";e+="<TD>"+J("pboptsDelayTool",l.options.tool.delay,1,2,"normalGreen")+"</td>";e+=sa(false,true,"pboptsUnitTool",1,Bb,l.options.tool.unit,Cb,true);
e+="<TD>"+B("pboptsResetTool",h("Riavvia ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,4,"pboptsEvery6",l.options.every6)+" "+h("collect","common")+" "+h("from","common")+" "+h("cityscapes","common")+" "+h("ogni")+" 6 "+h("Ore")+"&nbsp;</td>";e+="</tr>";e+="<TR>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsJail",l.options.jail.enabled)+" "+h("bail","common")+" "+h("in automatico")+" "+h("ogni")+"&nbsp;</td>";e+="<TD>"+J("pboptsDelayJail",l.options.jail.delay,
1,2,"normalGreen")+"</td>";e+=sa(false,true,"pboptsUnitJail",1,zb,l.options.jail.unit,Ab,true);e+="<TD>"+B("pboptsReadJail",h("bail","common")+" "+h("ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD>"+P(false,"",false,0,"pboptsBear",l.options.bear.enabled)+" "+h("Controlla")+" "+h("bearerbond","items")+" "+h("ogni")+"&nbsp;</td>";e+="<TD>"+J("pboptsDelayBear",l.options.bear.delay,1,2,"normalGreen")+"</td>";e+=sa(false,true,"pboptsUnitBear",1,Rb,l.options.bear.unit,Sb,true);e+="<TD>"+
B("pboptsReadBear",h("Controlla")+" "+h("ORA"),false,false,"small")+"</td>";e+="</tr>";e+="<TR>";e+="<TD colspan=4 align=center id=pbopts2></td>";e+="</tr>";e+="</table>";g("pboptsBody").innerHTML=e;d.setTimerInfo();d.setTimerFlash();d.setTimerTool();d.setTimerJail();d.setTimerBear();g("pboptsInfo").addEventListener("click",a,false);g("pboptsDelayInfo").addEventListener("change",b,false);g("pboptsUnitInfo").addEventListener("change",c,false);g("pboptsReadInfo").addEventListener("click",Ua,false);
g("pboptsFlash").addEventListener("click",a,false);g("pboptsDelayFlash").addEventListener("change",b,false);g("pboptsUnitFlash").addEventListener("change",c,false);g("pboptsResetFlash").addEventListener("click",d.resetFlash,false);g("pboptsTool").addEventListener("click",a,false);g("pboptsDelayTool").addEventListener("change",b,false);g("pboptsUnitTool").addEventListener("change",c,false);g("pboptsResetTool").addEventListener("click",ya,false);g("pboptsEvery6").addEventListener("click",a,false);g("pboptsJail").addEventListener("click",
a,false);g("pboptsDelayJail").addEventListener("change",b,false);g("pboptsUnitJail").addEventListener("change",c,false);g("pboptsReadJail").addEventListener("click",A.bailOutAuto,false);g("pboptsBear").addEventListener("click",a,false);g("pboptsDelayBear").addEventListener("change",b,false);g("pboptsUnitBear").addEventListener("change",c,false);g("pboptsReadBear").addEventListener("click",v.checkBear,false)},hide:function(){},show:function(){}};o.Help={tabOrder:10,tabLabel:xb,tabDisabled:false,cont:null,
toolTip:"",todoTimer:null,inworkTimer:null,logTab:null,maxEntries:500,saveEntries:200,state:null,type:va,init:function(a){var b=o.Help;b.toolTip=h("En esta pesta√±a encontraras informacion sobre la herramienta")+".<BR><B>"+h("¬°Acerca de")+"!</b><BR>";b.cont=a;a="";a+="<DIV id=pbhelpHead></div>";a+="<DIV id=pbhelpBody></div>";b.cont.innerHTML=a;b.showHead();b.showBody()},showHead:function(){var a=o.Help,b="";b+="<DIV class=pbTitle>"+h("Version Translated").toUpperCase()+"</div>";b+="<DIV id=pbhelpButt></div>";b+="<TABLE width=100%>";b+=
"<TR>";b+="<TD align=center id=pbhelp2></td>";b+="</tr>";b+="</table>";b+="<HR>";b+="<DIV id=pbhelpCont></div>";g("pbhelpHead").innerHTML=b;a.showButt()},showButt:function(){function a(a){var b=o.Help,a=a.target.id.split("_");switch(u(a[1])){case va:b.showHelp();break;case Fa:b.showLog()}}var b=o.Help,c="";c+=B("pbhelp_"+va,"?",false,false,"small")+"&nbsp;";c+=B("pbhelp_"+Fa,"Log",false,false,"small");g("pbhelpButt").innerHTML=c;b.showHelp();b.todoTick();g("pbhelp_"+va).addEventListener("click",a,
false);g("pbhelp_"+Fa).addEventListener("click",a,false)},showBody:function(){g("pbhelpBody").innerHTML=""},todoTick:function(){var a=o.Help;clearTimeout(a.todoTimer);a.todoTimer=setTimeout(a.todoTick,3E4)},showLog:function(){var a=o.Help,b;b="";a.type=Fa;b+="<DIV class=pbTitle>"+h("Lista de acciones")+" ";b+=B("pbhelpDelete","Cancelar acciones",false,false);b+="<TABLE cellpadding=0 cellspacing=0 id=pbhelpTabLog class=pbTabLined><TR><TD></td><TD width=95%></td></table></div>";g("pbhelpCont").innerHTML=b;a.logTab=
g("pbhelpTabLog");a.state=1;if(la(l.log)=="array")for(b=0;b<l.log.length;b++)a._addTab(l.log[b].msg,l.log[b].ts);g("pbhelpDelete").addEventListener("click",function(){var a=o.Help,b,e=a.logTab.rows.length;l.log=[];for(b=0;b<e;b++)a.logTab.deleteRow(0)},false)},_addTab:function(a,b){var c=o.Help;if(c.state==1)c.logTab.rows.length>=c.maxEntries&&c.logTab.deleteRow(c.maxEntries-1),c=c.logTab.insertRow(0),c.vAlign="top",c.insertCell(0).innerHTML=b,c.insertCell(1).innerHTML=a},log:function(a){var b=o.Help,
c=(new Date).toLocaleTimeString();for(b._addTab(a,c);l.log.length>=b.saveEntries;)l.log.shift();l.log.push({msg:a,ts:c})},showHelp:function(){var a="";o.Help.type=va;a+="<div class=pbTitle>";a+=qa;a+="<br>"+Oa();a+='<br><a target=_website href="'+ta+'"><span class=LinkWhite>'+ta+"</span></a>";a+="</div>";a+="<div class=pbTitle>"+h("Grupo oficial en Facebook")+"</div>";a+='<CENTER><a target=_facebook href="'+Fb+'"><span class=LinkWhite>'+Fb+"</span></a></center>";g("pbhelpCont").innerHTML=a},inworkTick:function(){var a=
o.Info;a.inworkTimer=setTimeout(a.inworkTick,1E4)},hide:function(){},show:function(){}};var l={cookieName:"Kabamfuck",serverID:function(){if($a===null){var a=/^[a-zA-Z]+([0-9]+)\./.exec(document.location.hostname);$a=a?a[1]:"??"}return $a}(),names:[],init:function(a){var b=l,c;for(c in a)b[c]=b.readMergeOptions(c,a[c]),b.names.push(c);a=l.options;if(a.inMarch==void 0)a.inMarch=false;if(a.every6==void 0)a.every6=false;a.bail&&delete a.bail;if(a.tabEnabled.length===0){a.tabEnabled[0]=false;for(i=Ca;i<=
10;i++)a.tabEnabled[i]=true}else for(i=Ca;i<=10;i++)a.tabEnabled[i]==void 0&&(a.tabEnabled[i]=true)},save:function(){var a=l,b,c;b=o.Wave;c=a.options.wave;!b.tabDisabled&&c.enabled&&b.curRunStart!==0&&(c.runTime+=C()-b.curRunStart);b=o.Gang;c=a.options.gang;!b.tabDisabled&&c.enabled&&b.curRunStart!==0&&(c.runTime+=C()-b.curRunStart);$("===========  Data.onUnload");if(aa)a.options.ptWin.Pos=aa.getLocation();for(b=0;b<a.names.length;b++)try{Wa?localStorage.setItem(a.names[b],ra.stringify(a[a.names[b]])):
GM_setValue(a.names[b]+"_"+a.serverID,ra.stringify(a[a.names[b]]))}catch(d){$(d)}},readMergeOptions:function(a,b){var c=l,d;$("==========  Load preference");try{d=Wa?localStorage.getItem(a):GM_getValue(a+"_"+c.serverID)}catch(e){d=null}if(d===null)return b;opts=ra.parse(d);if(la(b)=="array")b=b.concat(opts);else if(la(opts)=="object")for(k in opts)b[k]=opts[k];return b},getCookie:function(a){var b=document.cookie.indexOf(a+"="),c=null;if(b>=0){c=document.cookie.indexOf(";",b);if(c<0)c=document.cookie.length;
c=unescape(document.cookie.substring(b+a.length+1,c))}return c}},$a=null,R={tabList:{},currentTab:null,minimized:false,init:function(a){var b=R,c=[],d,e;for(e in o){if(!o[e].tabDisabled&&o[e].tabOrder!==null)o[e].tabDisabled=!l.options.tabEnabled[o[e].tabOrder];if(!o[e].tabDisabled)b.tabList[e]={},b.tabList[e].name=e,b.tabList[e].obj=o[e],b.tabList[e].label=o[e].tabLabel!==null?o[e].tabLabel:e,o[e].tabOrder!==null?c.push([o[e].tabOrder,b.tabList[e]]):c.push([1E3,b.tabList[e]]),b.tabList[e].div=document.createElement("div")}c.sort(function(a,
b){return a[0]-b[0]});var f="";W=db();f+="<TABLE cellspacing=0 class=pbMainTab><TR>";for(d=0;d<c.length;d++)f+="<TD class=spacer></td><TD class=notSel id="+W+c[d][1].name+" ><A><SPAN>"+h(c[d][1].label)+"</span></a></td>";f+="<TD class=spacer align=center>"+B("pbmainMin"," MIN ",false,false,"small")+"</td>";f+="<TD id=ptdmainVer class=spacer align=center><FONT COLOR=#FF0000><b> v20131107a</b></font></td>";f+="</tr></table>";f+="<div id=docSwfPlyr></div>";aa.getTopDiv().innerHTML=f;b.currentTab=null;pb("ttTooltip",
"");ob("fuckruler","");for(e in b.tabList){if(b.tabList[e].name==l.options.currentTab)b.currentTab=b.tabList[e];g(W+e).addEventListener("click",this.e_clickedTab,false);d=b.tabList[e].div;d.style.display="none";d.style.height="100%";d.style.maxWidth="auto";d.style.overflowX="auto";a.appendChild(d);try{b.tabList[e].obj.init(d),b.tabList[e].obj.toolTip&&(g(W+e).addEventListener("mouseover",this.showTooltip,false),g(W+e).addEventListener("mouseout",this.hideTooltip,false))}catch(n){d.innerHTML="INIT ERROR: "+
n}}if(b.currentTab===null)b.currentTab=c[0][1];b.setTabStyle(g(W+b.currentTab.name),true,b.currentTab.obj.color);b.currentTab.div.style.display="block";g("pbmainMin").addEventListener("click",function(a){var b=R;b.minimized=!b.minimized;a.target.value=" "+(b.minimized?"MAX":"MIN")+" ";b.currentTab.div.style.display=b.minimized?"none":"block";aa.div.style.height=(b.minimized?36:l.options.size.y)+"px"},false)},refreshTabs:function(){var a=R,b;for(b in a.tabList)a.setTabStyle(g(W+b),a.currentTab==a.tabList[b],
a.tabList[b].obj.color)},showTooltip:function(a){R.showTabTooltip(a,l.options.tips)},hideTooltip:function(a){R.showTabTooltip(a,false)},showTabTooltip:function(a,b){var c=R,d=a.target.id.substring(W.length);(c=c.tabList[d])&&c.obj.toolTip&&(b?nb(a,c.obj.toolTip,void 0):qb())},hideTab:function(){R.currentTab.obj.hide()},showTab:function(){R.currentTab.obj.show()},setTabStyle:function(a,b,c){c==void 0&&(c="");a.className=b?"sel"+c:"notSel"+c},e_clickedTab:function(a){var b=R;(a=b.tabList[a.target.parentNode.parentNode.id.substring(W.length)])&&
b.tab_clicked(a)},tab_clicked:function(a){var b=R;if(b.currentTab.name!=a.name){b.setTabStyle(g(W+a.name),true,a.obj.color);b.setTabStyle(g(W+b.currentTab.name),false,b.currentTab.obj.color);b.currentTab.obj.hide();b.currentTab.div.style.display="none";b.currentTab=a;if(!b.minimized)a.div.style.display="block";l.options.currentTab=a.name}a.obj.show()}},ma={wins:{},get:function(a){return ma.wins[a]},add:function(a,b){ma.wins[a]=b},winDelete:function(a){delete ma.wins[a]}};Array.prototype.compare=function(a){var b=
true,c;if(this.length!=a.length)b=false;else for(c=0;c<a.length;c++){if(this[c].compare&&!this[c].compare(a[c])){b=false;break}if(this[c]!==a[c]){b=false;break}}return b};String.prototype.entityTrans={"&":"&","<":"<",">":">",'"':'"'};String.prototype.htmlEntities=function(){var a=this.toString();for(k in this.entityTrans)a=a.split(k).join(this.entityTrans[k]);return a};String.prototype.stripTags=function(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")};String.prototype.capitalize=
function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()};if(String.trim==void 0)String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")};String.prototype.startsWith=function(a){return this.indexOf(a)===0};String.prototype.endsWith=function(a){return this.match(a+"$")==a};String.prototype.visualWidth=function(){var a=g("fuckruler");a.innerHTML=this;return a.clientWidth+1};String.prototype.visualHeight=function(){var a=g("fuckruler");a.innerHTML=this;
return a.clientHeight+1};Object.size=function(a){var b=0,c;for(c in a)b++;return b};Math.randRange=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};typeof XML=="undefined"&&(XML=function(){});XML.ObjTree=function(){return this};XML.ObjTree.VERSION="0.24";XML.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n';XML.ObjTree.prototype.attr_prefix="-";XML.ObjTree.prototype.overrideMimeType="text/xml";XML.ObjTree.prototype.parseXML=function(a){var b="",c="";if(window.DOMParser){if(c=
new DOMParser,a=c.parseFromString(a,"application/xml"))b=a.documentElement}else if(window.ActiveXObject)c=new ActiveXObject("Microsoft.XMLDOM"),c.async=false,c.loadXML(a),b=c.documentElement;return c=b?this.parseDOM(b):""};XML.ObjTree.prototype.parseHTTP=function(a,b,c){var d={},e;for(e in b)d[e]=b[e];if(!d.method)d.method=typeof d.postBody=="undefined"&&typeof d.postbody=="undefined"&&typeof d.parameters=="undefined"?"get":"post";if(c){d.asynchronous=true;var f=this,g=d.onComplete;d.onComplete=function(a){var b;
a&&a.responseXML&&a.responseXML.documentElement?b=f.parseDOM(a.responseXML.documentElement):a&&a.responseText&&(b=f.parseXML(a.responseText));c(b,a);g&&g(a)}}else d.asynchronous=false;var h,l;if(typeof HTTP!=="undefined"&&HTTP.Request){if(d.uri=a,a=new HTTP.Request(d))h=a.transport}else if(typeof s!=="undefined"&&s.Request&&(a=new s.Request(a,d)))h=a.transport;c?l=h:h&&h.responseXML&&h.responseXML.documentElement?l=this.parseDOM(h.responseXML.documentElement):h&&h.responseText&&(l=this.parseXML(h.responseText));
return l};XML.ObjTree.prototype.parseDOM=function(a){var b;if(a){this.__force_array={};if(this.force_array)for(b=0;b<this.force_array.length;b++)this.__force_array[this.force_array[b]]=1;b=this.parseElement(a);this.__force_array[a.nodeName]&&(b=[b]);if(a.nodeType!==11){var c={};c[a.nodeName]=b;b=c}}else b="";return b};XML.ObjTree.prototype.parseElement=function(a){var b,c,d,e;if(a.nodeType==7)b={};else if(a.nodeType==3||a.nodeType==4)b=a.nodeValue.match(/[^\x00-\x20]/)===null?{}:a.nodeValue;else{var f=
{};if(a.attributes&&a.attributes.length){b={};for(c=0;c<a.attributes.length;c++)if(d=a.attributes[c].nodeName,typeof d==="string"&&(e=a.attributes[c].nodeValue))d=this.attr_prefix+d,typeof f[d]=="undefined"&&(f[d]=0),f[d]++,this.addNode(b,d,f[d],e)}if(a.childNodes&&a.childNodes.length){d=true;b&&(d=false);for(c=0;c<a.childNodes.length&&d;c++)e=a.childNodes[c].nodeType,e==3||e==4||(d=false);if(d){b||(b="");for(c=0;c<a.childNodes.length;c++)b+=a.childNodes[c].nodeValue}else{b||(b={});for(c=0;c<a.childNodes.length;c++)if(d=
a.childNodes[c].nodeName,typeof d==="string"&&(e=this.parseElement(a.childNodes[c])))typeof f[d]=="undefined"&&(f[d]=0),f[d]++,this.addNode(b,d,f[d],e)}}}return b};XML.ObjTree.prototype.addNode=function(a,b,c,d){this.__force_array[b]?(c==1&&(a[b]=[]),a[b][a[b].length]=d):c==1?a[b]=d:c==2?a[b]=[a[b],d]:a[b][a[b].length]=d};XML.ObjTree.prototype.writeXML=function(a){return this.xmlDecl+this.hash_to_xml(null,a)};XML.ObjTree.prototype.hash_to_xml=function(a,b){var c=[],d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=
b[e];e.charAt(0)!==this.attr_prefix?c[c.length]=typeof f=="undefined"||f===null?"<"+e+" />":typeof f=="object"&&f.constructor==Array?this.array_to_xml(e,f):typeof f=="object"?this.hash_to_xml(e,f):this.scalar_to_xml(e,f):d[d.length]=" "+e.substring(1)+'="'+this.xml_escape(f)+'"'}var d=d.join(""),g;return g=typeof a=="undefined"||a===null?c.join(""):c.length>0?g.match(/\n/)?"<"+a+d+">\n"+g+"</"+a+">\n":"<"+a+d+">"+g+"</"+a+">\n":"<"+a+d+" />\n"};XML.ObjTree.prototype.array_to_xml=function(a,b){var c=
[],d;for(d=0;d<b.length;d++){var e=b[d];c[c.length]=typeof e=="undefined"||e===null?"<"+a+" />":typeof e=="object"&&e.constructor==Array?this.array_to_xml(a,e):typeof e=="object"?this.hash_to_xml(a,e):this.scalar_to_xml(a,e)}return c.join("")};XML.ObjTree.prototype.scalar_to_xml=function(a,b){return a=="#text"?this.xml_escape(b):"<"+a+">"+this.xml_escape(b)+"</"+a+">\n"};XML.ObjTree.prototype.xml_escape=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;")};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var Ga=["GF PUPPACELO KABAM","http://www.gamespowerita.com","Creato da"," Tiestoale, mikmeg, Ciccio[TeamDoa]"],Ha=[Ga[0],Ga[1],Ga[2],Ga[3]],Ia=[Ha[0],Ha[1],Ha[2],Ha[3]],Ja=[Ia[0],Ia[1],Ia[2],Ia[3]],Da=[Ja[0],Ja[1],Ja[2],Ja[3]];(function(){var a=true;window.location.href.indexOf("godfather.wonderhill.com")<0&&($("In questa finestra non verr\u00e0 eseguito il GF PUPPACELO KABAM"),
a=false);return a})()&&Pa()}}})();
