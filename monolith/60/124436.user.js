// ==UserScript==
// @id             GPPS
// @name           Pause Your Stream for Google+
// @version        1.7.0
// @namespace      simon
// @author         Simon Chan
// @description    Pause your Google+ stream, enjoy what you like and then display them later.
// @match          https://plus.google.com/*
// @match          http://userstyles.org/styles/operacss/60100/*
// @run-at         document-end
// ==/UserScript==
var classNames = { body: "wIa" }, d = document, cL = "classList", cNs = classNames, pausedCount, isPaused, infoBox, info, ctrl; if (!window.frameElement && d.body[cL].contains(cNs.body)) { classNames = { post: "Tg", streamContainer: "ow", sub_div: "bS Ym", header: "TP tx hp", box: "pSB", info: "pSB-i", ctrlButton: "pSB-c", full: "fll", notificationBox: "pSB-n" }; var aC = "appendChild", aE = "addEventListener", cE = "createElement", cN = "className", cNs = classNames, ds = "display", dv = "div", eC = "getElementsByClassName", f = !1, MO = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver, s = "style", t = !0, tC = "textContent"; function MutationEventHandler(n) { return function (t) { t.forEach(function (t) { t.addedNodes.length == 1 && n(t.addedNodes[0]) }) } } pausedCount = 0, isPaused = f, GM_xmlhttpRequest({ method: "GET", url: "http://userstyles.org/styles/operacss/60100/Style%20for%20Pause%20Your%20Stream%20for%20Google%2B.css", onload: function (n) { GM_addStyle(n.responseText) } }), infoBox = d[cE](dv), infoBox[cN] = cNs.box, info = d[cE](dv), info[cN] = cNs.info, info[tC] = "0", info[aE]("click", function () { d.documentElement.scrollTop = 0 }), infoBox[aC](info), ctrl = d[cE](dv), ctrl[cN] = cNs.ctrlButton, ctrl[tC] = "\u258c\u258c Pause", ctrl[aE]("click", function () { var u, i, r, e; if (isPaused) { if (isPaused = f, info[cL].remove(cNs.full), ctrl[cL].remove(cNs.full), ctrl[tC] = "\u258c\u258c Pause", u = d[eC](cNs.post), pausedCount > 0) { for (i = d[cE](dv), i[cN] = cNs.notificationBox, i.innerHTML = '<div class="' + cNs.sub_div + '"><h3 class="' + cNs.header + '" style="max-width : none"><span>' + infoBox.title + "</span></h3></div>", u[pausedCount].parentNode.insertBefore(i, u[pausedCount]), infoBox.title = "", r = 0; r < pausedCount; r++) u[r].removeAttribute("style"); i.scrollIntoView() } } else isPaused = t, pausedCount = 0, info[tC] = "0", ctrl[cL].add(cNs.full), ctrl[tC] = "\u25ba Restore", e = new Date, infoBox.title = "\u258c\u258c Stream paused at " + e.toLocaleTimeString() + " " + e.toLocaleDateString() }), infoBox[aC](ctrl), d.body[aC](infoBox), new MO(MutationEventHandler(function (n) { isPaused && n[cL].contains(cNs.post) && (pausedCount == 0 && (info[cL].add(cNs.full), ctrl[cL].add(cNs.full), ctrl[tC] = "\u25ba Display Posts"), info[tC] = ++pausedCount > 99 ? "99+" : pausedCount, n[s][ds] = "none") })).observe(d[eC](cNs.streamContainer)[0], { childList: t }) }