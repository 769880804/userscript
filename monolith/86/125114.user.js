// ==UserScript==
// @name           18P2P_SIS_smiles
// @description    18P2P和SIS 自定义表情
// @include        http://210.6.90.*/*
// @include        http://*18p2p.com/*
// @include        http://18p2p.z4.cc/*
// @include        http://67.220.90.30/*
// @include        http://www.semin.us/*
// @include        http://67.220.93.4/*
// @include        http://www.sis001.com/*
// @require        http://code.jquery.com/jquery-latest.min.js
// @author         congxz6688
// @version        2012.2.11
// ==/UserScript==

GM_addStyle('#ImgList{margin:5px;border-style:double;border-width:4px;border-color:gray}[valign="bottom"]>img{max-height:80px !important}')
function lodex(r){return window.location.href.indexOf(r);}
function tidex(r){return document.title.indexOf(r);}

//以下为四组表情，可替换使用
//var faces=["http://upic.me/","i/12/lam01.gif","i/fp/6am02.gif","i/5n/2am03.gif","i/uu/7am04.gif","i/q7/dam05.gif","i/wt/cam06.gif","i/d2/tam08.gif","i/nk/kam09.gif","i/63/5am10.gif","i/tz/wam11.gif","i/e4/5am12.gif","i/9o/ram13.gif","i/ci/qam15.gif","i/tt/6am33.gif","i/c2/kam17.gif","i/mz/tam18.gif","i/n9/ham19.gif","i/ma/oam20.gif","i/ri/vbyes.gif","i/8b/5v018.gif","i/hg/7am23.gif","i/6d/fam24.gif","i/qz/zam25.gif","i/h2/0he12.gif","i/sn/0g129.gif","i/wd/qam28.gif","i/ul/yam29.gif","i/gs/vam30.gif","i/oz/gam32.gif","i/ua/lam34.gif","i/yn/7am35.gif","i/kb/oam37.gif","i/ey/dam38.gif","i/fl/aam39.gif","i/y9/aam40.gif","i/xd/dam41.gif","i/6n/7am42.gif","i/in/3am43.gif","i/fn/wam44.gif","i/1u/7am45.gif","i/1r/kam46.gif","i/oq/jam47.gif","i/63/kam49.gif","i/pm/ali_029.gif","i/98/pam51.gif","i/5s/lam53.gif","i/9u/9am54.gif","i/8i/nam55.gif","i/al/ali94.gif","i/9z/wam57.gif","i/vt/eam58.gif","i/cz/zam59.gif","i/op/8am60.gif","i/sz/lam61.gif","i/on/eam64.gif","i/rw/gam65.gif","i/a7/3am66.gif","i/7q/nam67.gif","i/0j/zam68.gif","i/vz/xyv49.gif","i/kl/pam70.gif","i/14/8am71.gif","i/6p/kam72.gif"];
//var faces=["http://ws16.kilu.de/","mytools/smilies/am01.gif","mytools/smilies/am02.gif","mytools/smilies/am03.gif","mytools/smilies/am04.gif","mytools/smilies/am05.gif","mytools/smilies/am06.gif","mytools/smilies/am08.gif","mytools/smilies/am09.gif","mytools/smilies/am10.gif","mytools/smilies/am11.gif","mytools/smilies/am12.gif","mytools/smilies/am13.gif","mytools/smilies/am15.gif","mytools/smilies/am16.gif","mytools/smilies/am17.gif","mytools/smilies/am18.gif","mytools/smilies/am19.gif","mytools/smilies/am20.gif","mytools/smilies/am21.gif","mytools/smilies/am22.gif","mytools/smilies/am23.gif","mytools/smilies/am24.gif","mytools/smilies/am25.gif","mytools/smilies/am26.gif","mytools/smilies/am27.gif","mytools/smilies/am28.gif","mytools/smilies/am29.gif","mytools/smilies/am30.gif","mytools/smilies/am32.gif","mytools/smilies/am34.gif","mytools/smilies/am35.gif","mytools/smilies/am37.gif","mytools/smilies/am38.gif","mytools/smilies/am39.gif","mytools/smilies/am40.gif","mytools/smilies/am41.gif","mytools/smilies/am42.gif","mytools/smilies/am43.gif","mytools/smilies/am44.gif","mytools/smilies/am45.gif","mytools/smilies/am46.gif","mytools/smilies/am47.gif","mytools/smilies/am49.gif","mytools/smilies/am50.gif","mytools/smilies/am51.gif","mytools/smilies/am53.gif","mytools/smilies/am54.gif","mytools/smilies/am55.gif","mytools/smilies/am56.gif","mytools/smilies/am57.gif","mytools/smilies/am58.gif","mytools/smilies/am59.gif","mytools/smilies/am60.gif","mytools/smilies/am61.gif","mytools/smilies/am64.gif","mytools/smilies/am65.gif","mytools/smilies/am66.gif","mytools/smilies/am67.gif","mytools/smilies/am68.gif","mytools/smilies/am69.gif","mytools/smilies/am70.gif","mytools/smilies/am71.gif","mytools/smilies/am72.gif"];
var faces=["http:","//photo6.webshare.cc/0732189001328805543u3uce.gif","//photo4.webshare.cc/01086540013288055418KWwQ.gif","//photo4.webshare.cc/0273375001328805539iZubN.gif","//photo4.webshare.cc/0313272001328805537y6wV7.gif","//photo4.webshare.cc/0498615001328805535iCcAA.gif","//photo4.webshare.cc/0979948001328805532C94jt.gif","//photo4.webshare.cc/0139008001328805529d3VKU.gif","//photo4.webshare.cc/0575865001328805526EgyZx.gif","//photo4.webshare.cc/0880394001328805524JB3rt.gif","//photo4.webshare.cc/07915960013288055225tIto.gif","//photo4.webshare.cc/03489040013288055215mRTg.gif","//photo4.webshare.cc/0577676001328805519FWCTp.gif","//photo4.webshare.cc/0254085001328805516o3qkY.gif","//photo4.webshare.cc/09983950013288054873sQVp.gif","//photo4.webshare.cc/00048310013288055159DuGn.gif","//photo4.webshare.cc/0889304001328805512YJhvR.gif","//photo4.webshare.cc/0681580001328805510GraWy.gif","//photo4.webshare.cc/0927415001328805508jKlMI.gif","//photo4.webshare.cc/04471960013288055078yzDk.gif","//photo4.webshare.cc/0943921001328805505PS7dn.gif","//photo4.webshare.cc/064280000132880550498pj3.gif","//photo4.webshare.cc/0054252001328805503w4Hcl.gif","//photo4.webshare.cc/0925066001328805500iDWP2.gif","//photo4.webshare.cc/03971360013288054993KWza.gif","//photo4.webshare.cc/0922886001328805497wvtCg.gif","//photo4.webshare.cc/0173714001328805496EZsjR.gif","//photo4.webshare.cc/0721503001328805494SCgvI.gif","//photo4.webshare.cc/0101987001328805493xOBpf.gif","//photo4.webshare.cc/0638960001328805489zIiic.gif","//photo4.webshare.cc/02269500013288054866s4dh.gif","//photo4.webshare.cc/05759210013288054846UvR1.gif","//photo2.webshare.cc/0917521001328805480Omgfx.gif","//photo2.webshare.cc/0496844001328805478IlG9s.gif","//photo2.webshare.cc/0470020001328805476iXhyt.gif","//photo2.webshare.cc/0372205001328805474eUXjN.gif","//photo2.webshare.cc/0307940001328805472w3tAG.gif","//photo2.webshare.cc/0741942001328805470W3Y4Q.gif","//photo2.webshare.cc/0006163001328805469IoYcr.gif","//photo2.webshare.cc/0743880001328805467mrAzj.gif","//photo2.webshare.cc/0228335001328805466npYd6.gif","//photo2.webshare.cc/0978902001328805464mrdKM.gif","//photo2.webshare.cc/0762248001328805463itrJk.gif","//photo2.webshare.cc/0689244001328805460AI5Nf.gif","//photo2.webshare.cc/0531322001328805458uRJNe.gif","//photo2.webshare.cc/0137986001328805456idcfm.gif","//photo2.webshare.cc/0730391001328805450fd5Ut.gif","//photo2.webshare.cc/06239160013288054484F29C.gif","//photo2.webshare.cc/0364671001328805446TdHU1.gif","//photo2.webshare.cc/0241475001328805444mb3xl.gif","//photo2.webshare.cc/0901223001328805441Ath2D.gif","//photo2.webshare.cc/0729008001328805439wbE7D.gif","//photo2.webshare.cc/0646560001328805437AJvVF.gif","//photo2.webshare.cc/0213539001328805436OUaoU.gif","//photo2.webshare.cc/01413390013288054344rSdP.gif","//photo2.webshare.cc/0599206001328805432pHXna.gif","//photo2.webshare.cc/0621379001328805424yrQWS.gif","//photo2.webshare.cc/0239690001328805422ss43K.gif","//photo1.webshare.cc/0919397001328805420l3brk.gif","//photo1.webshare.cc/0812118001328805418BwoVW.gif","//photo1.webshare.cc/0124399001328805417rtZXy.gif","//photo1.webshare.cc/0238518001328805415ejQ31.gif","//photo1.webshare.cc/0526212001328805413VYELR.gif","//photo1.webshare.cc/0801990001328805411PoU7d.gif"];
//var faces=["http://513pic.com/pic.","aspx?id=8b7b753e-9a6f-4dd7-ae1d-050043d85239","aspx?id=02135b34-c9cd-45ac-89e4-9ad5a416feb4","aspx?id=f6ad5870-8b99-4090-bbf0-06dfe8aaf2fa","aspx?id=2315101e-a82c-48c3-8405-41d462fa9785","aspx?id=02ed0b64-97e8-44e7-97ae-c180b5fdbed4","aspx?id=8c9665de-16fc-492f-bb82-318551af9c11","aspx?id=aef500cd-93a3-4315-8c1f-1b96b66a9629","aspx?id=b3051559-967f-43b9-98fe-140a35abc20a","aspx?id=9ef138fe-0a98-439f-9728-dd74e71958b7","aspx?id=12b5311b-6602-4635-8d7d-ebe140cff8a4","aspx?id=739dc5e1-b105-40c4-afc3-de2c2f48f659","aspx?id=39268eba-12cd-4926-a483-86e7216802c7","aspx?id=62f8f720-a8c0-495d-8887-37f2d98cd5c9","aspx?id=b889cd2d-7c1b-4316-9fac-76a155ccf719","aspx?id=11b3767b-2ce2-4de2-b901-0cb9dea57865","aspx?id=23086dd0-e82b-47d5-b862-38f6718517dc","aspx?id=2f5081a0-46ba-4cdf-9f0d-c2521a8d9cb9","aspx?id=cc62044d-f2d6-4c26-8e01-21b4a2e669a1","aspx?id=5eacf918-67e4-4992-a939-dd1b942561cb","aspx?id=6c2f4d76-eb17-4ced-bbfe-eb4bdddae8fa","aspx?id=f0555018-b4fa-4208-a5a7-839fa9b5af01","aspx?id=f3b2f74e-6647-4674-996a-d49e7ba0e22b","aspx?id=ae87e303-1a2a-4abc-aae4-705de143b0b8","aspx?id=731b49f8-79e3-4100-9e58-32f1e861f451","aspx?id=8b7ac0fa-9942-4117-8bb9-396b5632e4c3","aspx?id=e6d4411c-8e6b-4639-86f8-10f99dfb697f","aspx?id=77ccffb2-8e06-413b-ac99-c9c1922cb109","aspx?id=5b3f094d-ffdb-406d-bab9-c0d3cfa05932","aspx?id=0e2165f9-82f7-4f1a-9011-19e21c4fd40b","aspx?id=f0524c8b-726d-4670-8ed8-284cfce6f7b3","aspx?id=1c100a88-4e5c-43e7-afa3-5f78988b6d05","aspx?id=83dd79d3-19da-426e-810b-61302777c96c","aspx?id=2a9f61d7-e362-46af-9d70-cd9edb841eb4","aspx?id=de5254f4-f602-44b9-9ae2-4175cbc50dd7","aspx?id=492e8738-178d-4fab-9d0f-2d983c593bb8","aspx?id=2ccd61e3-c5bd-4550-a800-9e3ed985b7f8","aspx?id=186f9b54-d767-4ff7-b1b2-d34cd3dd9a70","aspx?id=4642c89e-a219-4bc9-903b-efca3d4fe6c9","aspx?id=fa5709b2-ae2b-455b-ad64-c9f19acaf869","aspx?id=5993b41c-4eee-4cce-86c1-15d454cf5a05","aspx?id=62a066df-778f-4f34-a3ee-b6e6e91d6780","aspx?id=65729055-f154-4b3c-b28d-f3b2320f2bda","aspx?id=1cf3f451-b335-4860-9b41-c09965c8246f","aspx?id=f2193368-bae3-4962-9527-e955581a42c9","aspx?id=6ff1647d-403f-412d-b45c-13bd7cc68bf3","aspx?id=9af468c3-ec83-400e-94b4-6e8c76bdc228","aspx?id=1bcb442b-692e-48dc-b0a5-a5d6d5928507","aspx?id=94ccb2e7-9c8e-4ce6-9155-b89ec191514c","aspx?id=53509888-2517-4029-bc92-3291882ef185","aspx?id=bd27b1f9-1a60-4aea-beb8-cec6eee274a8","aspx?id=178a40e5-7c34-4465-a65c-a0c1f8355077","aspx?id=0f63054f-7ecd-4395-819d-39cf4694cef0","aspx?id=789d5fab-7bda-4995-93ab-1f24ca6e6476","aspx?id=64910d9d-a164-43a9-95bd-c3c0c92ed2be","aspx?id=2f976061-5597-41d2-ac85-5a2f2c23dc80","aspx?id=28bb718c-faf9-4748-8793-467cfcb0edb5","aspx?id=638d52e3-e402-48ea-84cb-8ec779e1e938","aspx?id=1c83ada9-bcc7-4a08-ab38-ac19204e2821","aspx?id=44d1f363-58c0-48bd-9141-eb3a960f884c","aspx?id=202d8fde-72c0-4c0e-b4ab-45e17d5c6b19","aspx?id=79b8489d-0604-40b7-a38c-af64526498d7","aspx?id=67df3368-3ed8-4af3-bfb7-f6498ee53f57","aspx?id=bc5aa08d-d5d4-4f02-9a9f-ad54810927c8"];

if(tidex("SexInSex")!=-1 && $('#smilieslist').length!=0){
	GM_addStyle('.defaultpost{min-height:130px !important;}th{width:240px !important}.smilies{min-width:230px !important}.postoptions{width:180px !important}textarea{width:100% !important}.postform{width:750px !important}');
	var Listdiv=$("<div>",{id:"ImgList",width:"226px",height:"290px"});
	$("#smilieslist").replaceWith(Listdiv);
}
if(tidex("18P2P")!=-1){
	if(lodex("viewthread.php")!=-1||lodex("redirect.php")!=-1){
		var Listdiv=$("<div>",{id:"ImgList",width:"226px",height:"290px"});
		$('td[width="18%"]').removeAttr("valign").removeAttr("width");
		$('td[width="82%"]').attr("width","722px");
		$('textarea').attr("style","width:100%");
		$("<td>",{rowspan:"2",class:"altbg1",width:"250"}).append(Listdiv).appendTo($('tr:has([name="subject"])'));
	}
	if(lodex("pm.php?action=send")!=-1){
		var Listdiv=$("<div>",{id:"ImgList",width:"226px",height:"290px"});
		$('textarea').attr("style","width:100%");
		$("<td>",{rowspan:"3",class:"altbg1",width:"250"}).append(Listdiv).insertAfter($('[name="msgto"]')[0].parentNode);
	}
	if(lodex("post.php")!=-1){
		$('.altbg2>.smalltxt>br,.altbg1>br').detach();
		$('[valign="top"]').removeAttr("valign");
		var Listdiv=$("<div>",{id:"ImgList",width:"226px",height:"290px"});
		$('td>.tableborder').replaceWith(Listdiv);
	}
}
GM_addStyle('#listImg{position:relative;left:2px;top:2px}');
$("<img>",{src:"http://18.qinghe18.co.cc/smiles/ScreenShot000.png",id:"listImg",usemap:"#listMap"}).appendTo(Listdiv);
var listMap=$("<map>",{id:"listMap"}).appendTo(Listdiv);
GM_log(listMap.hspace)
for(i=1;i<64;i++){
	var lll=Math.floor((i-1)/7);
	var bbb=(i-1)-lll*7;
	$("<area>",{shape:"rect",coords:bbb*32+","+lll*32+","+(bbb*32+30)+","+(lll*32+30),gif:faces[0]+faces[i]}).click(function(){var wl=0;if($('textarea').length>1){wl=1;};$("textarea")[wl].value = $("textarea")[wl].value.slice(0, $("textarea")[wl].selectionStart) + '[img]' + this.getAttribute("gif") + '[/img]' + $("textarea")[wl].value.slice($("textarea")[wl].selectionEnd);}).mouseover(function(){var rect=$("#ImgList")[0].getClientRects()[0];var floatDiv=$("<div>",{id:"floatDiv",width:"52px",height:"52px"}).css({"position":"fixed","left":((rect.left<300)?(rect.left+180):(rect.left-54)),"top":((rect.left<300)?(rect.top-54):rect.top),"border-style":"solid","border-width":"1px","border-color":"gray"}).appendTo(document.body);$("<img>",{src:this.getAttribute("gif")}).css({"width":"52px","height":"52px","background-color":"#FFFFFF"}).appendTo(floatDiv);}).mouseout(function(){$('#floatDiv').detach()}).appendTo(listMap);
}