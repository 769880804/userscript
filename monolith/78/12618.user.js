// ==UserScript==
// @name           Amazorrent
// @namespace      http://www.no-copy.org
// @author				 pinnochio
// @description    Adds links from Amazon albums to ThePirateBay.org and Mininova.org
// @include        http://www.amazon.com/*
// @date					 28/09/07
// @version				 1
// 
// This script is not affiliated with no-copy.org in any way
//
// ==/UserScript==

	function createLink(URL, imgsrc){
		var newLink = document.createElement('a');
		newLink.setAttribute('href',URL);
		iconImg=document.createElement("img");
		iconImg.src = imgsrc;
		iconImg.setAttribute('border', 0);
		newLink.appendChild(iconImg);
		return newLink;
	}
	var artistAlbumXPath 		= "//div[starts-with(@class,'buying') and child::b[@class='sans']]";
	var thePirateBayHint 		= "site:thepiratebay.org \"%artist\" \"%album\" inurl:tor music";
	var thePirateBayIcon		= "data:text/html;charset=utf-8;base64,R0lGODlhkQAlAOYAACEhIejp66anq3Nzc1JTV9ja2TMyN42OksHCxPj5%2B1xbYH6Cg0ZHS7S0tpebnNDP1CgjJ%2BLm5%2FHz8mFgXmdobD0%2BQoaLjp%2BjpHp6fLm9wGBcWy8tME5PUcXOzq6uru%2Fv75OUltPR1KGdnoWGivz6%2B2xtcnR1ea6vs2ZmZjo6OlhWWd7e3tjZ3cbHyykpKfHy9J2eorzAw31%2Bgre4uoOFhCgkI0JDR%2Ff395SVmaWlpTMzMzs8QOfl5uDh46esr0tMTo2Nja21tXV5elhUVWdmay4qK9DU1err7evp6pmZmcTExr29vWtzc0ZERToxMV5fYfL29f%2F%2F%2F1tbW9XV10JCQkpKSmpqbEI6Orq4uVFRU8zMzHN7c5OPkPf%2F%2F721vVJaWtfd3UpCSkI6QjE6OlpaUu3s6gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAHAP8ALAAAAACRACUAAAf%2FgCkTUoQahoeIiYqLjI2Oj5CRkoyElZWTh01SUZydnpwrK5%2BjpKWmp6ipqqusrZ0im6gFM661tre4uamwqSMjn1C6wsPEww4aqC0AMp4hWsXQ0dKmIsimESlAGWWcCBnT4OHQ1aczABFaog4MH503N%2BLx8qvkpSQDKVArDUspKe1RbngIMK%2BgwU%2F1Or3oEWXFExcIokzBQQHAshUfRiiJcsTTBxIHQ05LyGnKrxBPGnCaYcMiAB0YKjAL8AzURpE4i5GMAsLKixcwQCqpYrHKiQgDXIhi8YBTgAvwckrVRVKCjAYbp0CBQsBiiQRHUADAwCnElCgfSkQcFeDEBQEI%2F1ZI4PRASwKOPFhNOTDimdYWWEZ9CBZNixQOMgTAENBjyQArLGqRXOFgHwIQNwa4hDGFisW1WnrckPKElIcdBiC4TEFACgMWPiiKUnUEBowsALR4cNBVxlxOEgbkZfX71IcFIEyUqHAABo0pSQBIuduK5IMTRy4QKPFCBYASOCaksMjgBacnHoAAUPmpRYkCJ2AIATBCgQoKG7XQr%2FUAgJXnEtDgH3U9sLfKA7%2BgEsBZUQAxwgM11DTABgCxQlILWnygngE8aAZGDi4BMEAnRGDgwg4dfQLDEUoIEYWAPDRgXkkAHMBRipzwUNwoIYzVQIoHrJdjVDfkBQU3nBzR0f9dH1RRQhQgRfHCcKTo1wIOABQQTAkLuMNQFEwCRGUUJAVwwwMVWISBACU4ECIAFnRCgwsAuDiKkj%2B0EIUM55xQ4RQA4NBDFRrAU0ASLsRZpXoHzDBbfyBEMUMRNEA5QgpaCEHAQg5UYYAMICRgAQA7PBFCAlgoUMGXo1wAgEk1LKFFCyPcBYUAVnxnwRQ9cDABFCCkUMAr1ngyn0sYPAEABEAciwMnLaQJgAClOPADJwv0WaER%2FrVgAgAPfLCBDOo58ElwA7AA5wkgzDBDdDZ6AIAJaIEAAHI6sBBBDlp8GyegJnQ0wgYn6EAAQZ44YAOdRtAAQQwwAGGCSgnwi2X%2FFlEUoAAAF4xaKSc73UAUABRYMB4KSkDhg0XmruCdRSGUgoIC2GrbCaC%2FCABACx8AUCkKHMwInAA%2FdGVBBjyw0EMPNUoEgLlRKHNBFMNdEEF%2FU0dwLyd8fpCBkJ3wAMMKmoUwAgRLUDsCADErsUQUDJQWxdorvKCDFcR%2BcgQVEBBBxNpNGHHCEtwCEOkELumA8ChPMHBXthGcUBygNurM870IwFChRxsf0AAMHngAQ9OAJsGJEhx3ssICS9ib9TLYuqAEDHqO8oK9IdCgQwswLLF2DA2GboDcazPUBDMgF%2BvUExg04BIBS3wQgADJghpiCjh%2BggEAG2HwQwIetINA%2FwjqVr5zGUVk8bYpMdTYgBHdkP706alzMoC57U%2FNA%2BxRZHvA4p6IgBXGM4UnCGEFtBtVC5ZQmg9UgHgACEAIdAC%2F5H2iBwIQQLYsYgMlWEABA4jBnDYQog3MZhQIAEAWHnAAhpzgBlMoARTKFwWdKaFnXTpFfywwgynAg2k2AhTUUDe1KKAvTinU39b6F8FSFCByUvDACG6wAlrYqwUYYEAUoPBATqztAQMwEJmssQSGPGAFuXIJBGQgBCAAwQMkfBMAaFEK9dRoBT0AgQyosBHn0UtnWgAUB2JghPV5YgoUoBMIXEUFGhAtZgUYC0GwNIAWBOAFFdBBA%2BwlhA%2B0T%2F8FLYBCrrjAgjKO4gZEoIIOGPADKYAAAQ6AwQv45LkUMOAZAhpBzDxRjwgkoQAF2GCIKCCtFNRAjt85BdFCpIAKnqAGzEgCBJCwAgtQoQg5IEwnGGgBeJ1ABsoiwJck4KsISCQpJ%2BDE6HLwgR8QQXprS8KtKlKCyHyCBElo1Lu8M4ITTkEHA4DCpTKEAqiMIiEvEAANOAAAz7ikCEVA5psMSYoXTGEJSzhhjkjwAQVQK0ka5QQJZtCRFcApAyUFYA8qBAVW3eBLPAAICXoQpYwJzRM5oCMnoDCsCwbjA3m5QE8PqryVAcAFUnhTFawwgiyUAAMoUM31dukKErQACLX%2FW4W6aHACAMrDATplRQ4CEAAcbG6MnWABnTawgSZAgABUkEEJqkADLGIABhaoQgowUILdlEAKN2lFAZawI1UEYAQgEEBUppKKGHlgLbwsFhJSIAQUlGAHG%2BBACqjAAQ7sQAA4wMEAfuCzD0CNIz1krGpdQZID%2BGCW%2FvBMFZ7wg1LRAAYM2BgGQMAAD3iipqsN7ilIMlIl9EBAFhGCDGQwAiEwwApZoAIBnkAACiQWuMLNbil48QnpLYEDLljABUBgARrkQAVZUMEPKtCEJqgPATnQrny3G4tRnGAAFYDBBRowgxFUwAUu0MEOdqAD1VRgAB%2Bdr4JBVl93jMAGA6BCsAlgIAMikNAFKaiAtACw2Rp15AMeCOmCVctdqvEgBwjwDESL8INjShQANRjPS3DQACEIIXsjZmxCaICbJhizBkBeFgSGTOQiq2bIFkkBB55Q2BxLJSESZMEUWEBlFoRiBVXOcpavHIoCTMGrTn4yxnjAgyN8oAxoTrOa18zmNpP5zXCOs5znTOc62%2FnOeM6znuMcBS6oYAKADrSgB03oQhv60IhOtKIXzehGO7rQQwgEADs%3D";
	var mininovaHint		 		= "site:mininova.org \"%artist\" \"%album\" inurl:tor music";
	var mininovaIcon     	 	= "data:text/html;charset=utf-8;base64,R0lGODlhkQAlAOYAAP%2F%2F%2F%2Ff%2F%2F%2Ff39%2Ff3%2F%2B%2F3%2F%2B%2Fv%2F%2B%2Fv7%2Bbv%2F%2Bbm%2F97m%2F%2Bbm5t7m99bm%2F9bm99be997e3s7e987e%2F9bW1s7W98XW973W987Ozr3O97XO97XF98XFxa3F9729va2976W996W975y977W1tZy175S1762trZSt74yt74St76WlpYSl73ul75ycnHuc73Oc73Oc5pSUlHOU73OU5muU5muU72OU5oyMjGOM5lqM5oSEhFqE5lKE5kqE5nt7e0p75kJ75nNzc0Jz5jpz5jpz3mtrazpr5jpr3jFr5jFr3ilr3mNjYylj3iFj3lpaWhBa3lJSUhBS3kpKSkJCQjo6OjExMSkpKSEhIRkZGRAQEAgICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAHAP8ALAAAAACRACUAAAf%2FgACCg4SFhoeDAweLBwUBiJCGioyOkZaXmJmam5wfPT6fPRuchp6goBmkqqusrYcBKUY2MjZHKY%2BrA7Gztbeuv8DBiLoqBAAELioDrLopxgQyysLT1K3NywMs0rkpJ48DLinL1eTll82D2uOquiaD4evm8vMAujoiHyI92%2Bwq9%2Fk9xNEbKK%2FEEiVIlCwxgWuViYMJFzYkSFHYgnwiRICgMJHUxYwaOVYcSWhCihYpIBQqAKIFiw8FLnU0tGBECxUfjLl6UGPIDxQGIgnggGOIzxcSpinQ8OKH0R81OAggRCCFjKsyRBwwYQRJECRGSoyjoEOJka46VBK60EKGCxkt%2FygICvABa7QFGHooCdLVxoJCGNq%2BjStIwAomSZIw%2BSGBhBQrVKhUYfIAkQUmVCBPqWJlCo%2BghXEgVpyEAyEBNUYnNq2BiRTJVahMyUwFSohBDIwE%2BaRbh5GUCyDMUAIiQAYjoho42ADq79wTSoD0ACKxng0loIAg0RHExgXlHnzcODAI1hLp1BkCEOCks5QpVqJQYcJBgoUVU5woMMRhMw8NEthHQntM7LeeE1dM8Z4VQ0wliASzSfHaFS8I8MNkL3BgQYAWEPXaCoJEoAMFi3zQxBEbNESACT6YEAQNCRACARAnjKNLCw0c0AAN0hBAgwkL6AjEEynENAgFQahXj%2F8KOOpogzQGMFHDAwpAiAUPBgrSXw0OCmLBFFBY0KUgBqBQRRJTCcADExIowFMUWZIQhQZukjAFCQYMgSUiDwxBhWkRjCfIBT6kUggBOjzRgpGE6OMcOgAEoM4xMnwgyAA58DPICD2QV08K7kQKDwBRolAYFDyMKUgNcA5iQBJQVIYICVSACMCAoFkwZ2E1oCmInBIIMMQLZD5AZZcGOMGEAIE650AFiIhAg6eFLNCDocRgc9My0Fh6TAY6VdvDBZemIBA4ApVKJp6HSCDFbb%2F%2BOYgA9mWpphT7SQCFBoIoAIWtAiTB5Xo%2FMGGAsFOiwMQUU0TBg6wAcCCFBc0SMgD%2FBBQgQEgBxixAgQMNDSCDCdikIM0A21Lq7SAeO0DVjyWfO6q6hEgAICFRDhxlg2TiMBsUJAzywBQgCsBEhesl8cNU%2FgZNKhQ4rDeEE1B0BoUTUVShX79OvFCxIA2w8NWIFnvi1Qg2puBCySen3O0gBOjj1Qe4DMBkzNjMzISpZL7wGNHzOjWVBFGYth4PVkCxsLwELwsADzyj5kRQGkCRFAAWSBG0sFhMgYMFChhQJuBS%2F%2FD1AjogYUMMQdzA6AhI9NCCb%2BTWYwINxmRbj9uVzmUCEjvMHoRaA5ggQ%2B7m5p3u3qHFN4R8FhTGg68kQGGgBVQ8bIC%2BBv8aRWUDGhiC%2FxRJrTC5ICtYLkgI%2FzkowAMcROGrhUl8jYERWg1wQQ9yHaMDDQ1QBA0EEoAR2AB5betR746xAxksYAALyMEIHhGAEuDuUzJbHt8MIIUkBEtfSBOAaKbSkzSx6nIRm5iXCgcAwvGrhVEIgZoiVzDQrAcACljBmqRQhSss7XD1u4FzMKCDBlzKBqM4xg1AMAgRHC9SBkSgthTorQLcYGUmYMEyCnjBa9RDb3zzl60AgIMfinBZwsJBmpRmw2Rt0AkgihKxSCWlVyFNAU5QIyGqh4UqREFPL4geEO2nA%2Bf4yFsEWOIgPnDBAh7wUwnk1gKt6K0AONEYXEReBpdBMzHyKv8JQTmjAIy2gqkka2CFGcLAjBa1x83PKfoyXObgtZ4aJG4FGniAqtQUxCEWURDQKI4SmSgIRmIyipCcoiSrqEhBgOCJmcSg8jjJPBz%2BqzAvAOV6Rmi0MF4zcKlKWjhRYD30OQEFTpDVCqKAwhVUYU%2BI4CUhjVgPGQgzkcQEgDGh%2BEjdoYyKgrBiPutyzC4m74sa7Nc3DdM9UXZToXwrzA%2FCGbBwxnKFTBhCKIegTQA8QAo8IxNTfiK9XgqCiPQU2T2bqc9GItOfvGPmQKE5AoNuko7eBNhhQsnNavorogSjaBLCmaw5GiAKVqgBmaDmIBRIAWIokI8VsBC56c3zUvb%2FfAQ%2BF%2BnSfppMmSoLKEsJCkWbThOnCtVpQ3tqKwN8M5V6NBpFIbdGLDhNA1FwmoV%2BCIAQVGEKPzhMVU0KAJRidaUD7aoUdwdQAAh0kTQ1K0KpmdPC7HSbaEwC0qKkRzJp1pROQGX1DGRLQa7zclFqKxOcQCcRDvaq9UQsV4%2Fp1UiG1bFjjawmz9rJhV5WlI%2Bbq%2BME8QDbEPetLvzV1izUPVI5AV4KiALASjhIIZ70l7HV6lgVm0zGLlOsMy3obieLVmuqlaeOMx9o7PRCMrYqhYaj4xwlUEprohKP8HpADAfRk1Ba1bqFxa5KtZtY2i72n9%2FFbXjLOl50UTatll1r%2F%2Ffwejl%2F5ZUDNajCHAHwgu%2FNi67rud67XOUEp0XXVgrIaJr%2B68uUZnWYs%2BXngWMKXsiKV5rk7e15MRsUfylVEHi1gpA1utQf2PBWWyNE%2BlCY2lRKYQUkwAy85Algw2YXxsXkLkwb%2B9hi6hbHDi6vJ9fzW9GABgdPFdoKcMAuQaCACk4bRHLnxVEbztBBurqCFaRQA0FSWWMAuAB234bllurkpQdF8G236uVx1LTBYCQTHC2rzTOC5qM8iMRHC1QIORLCX539FfnkvAJc4mCuQfSUoOlJ6AFsdxwi8KovAuA2GnjL1TN1tE0pGGnn6tRXAEiNDd254ULgkXGnwQGwAf%2BggRF%2FOgo%2FMMQLrpCEQUyPAUGQgblu0INH0UAHKkgBC4yQzw4EgQUnUEEPboA8H6gg3UE4mQ10YC4XGMEDizx3unvgVXfDWyDscRjkajWIFVBBTz%2BQwnAJZoUkaKBLOczaC448CDvpiQc8gAI7DWEmHIBGAhf660R%2FMIUkHEAvZ1HCDWIUKRWYpStGSGKgv5LyFsD6CGDpygTrwYKXe0XmF4C5EZRgc0HADixIQMIIUmmFKnAGzhXPjNMZNCYD8OAKtTFKEpBaqywVQr9Nn%2FpnDKEm5y3snTyAjdMzTYENZODtFWAUXtyeAQzQ8xhtf3sGKDCOA1yA7hmAAC4WkAFRumPAOceoAOD5Lgi%2FA17wxCWB5CXPZA5MngQPL4QAQpCE2UTGYSGgeCEscHkSiOkQBvBbbOCoAAWE4PKCJInsIWGADoVAQ14HhgQ4UB9VDSIQADs%3D";
	var googleBaseURL 			= "http://www.google.com/search?btnI=1&q=";
	var buyingDetailsXPath 	= "//table[@class='buyingDetailsGrid']/tbody/tr/td";
	var hookInto = document.evaluate(buyingDetailsXPath, window.document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null ).singleNodeValue;
	
	if (document.evaluate(artistAlbumXPath, window.document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null ).singleNodeValue){
			var album = document.evaluate(artistAlbumXPath + "/b", window.document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null ).singleNodeValue.textContent.replace(/^\s+|\s+$/g, '').replace(/ \[.*\]+$/g, '').replace(/ \(.*\)+$/g, '');
			var artist = document.evaluate(artistAlbumXPath + "/a", window.document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null ).singleNodeValue.textContent.replace(/^\s+|\s+$/g, '');
			var container = document.createElement("div");
			var tpb = createLink(googleBaseURL + encodeURIComponent(thePirateBayHint.replace(/%artist/g, artist).replace(/%album/g, album)), thePirateBayIcon);
			container.appendChild(tpb);
			container.appendChild(document.createElement("br"));
			var mnv = createLink(googleBaseURL + encodeURIComponent(mininovaHint.replace(/%artist/g, artist).replace(/%album/g, album)), mininovaIcon);
			container.appendChild(mnv);
			hookInto.insertBefore(container, hookInto.firstChild);
	}
