// ==UserScript==
// @name        cashtream
// @namespace   cashtream
// @include     http://www.cashtream.com/index.php?view=click&sid=*
// @require     http://userscripts.org/scripts/source/163375.user.js?
// @include     http://*.*cks.com/
// @include     http://*dfoc.us/*
// @include     http://*df.ly/*
// @version     update
// ==/UserScript==

var wind = $(window)[0];
var wparent = (wind.wrappedJSObject) ? wind.wrappedJSObject : wind;
var url = wparent.location.href;

if(wparent.location.href.indexOf("cashtream.com/index.php?view=click")!=-1){var sid=url.match(/sid=[0-9a-zA-Z]+/)[0].replace("sid=","");var sid2=url.match(/sid2=[0-9a-zA-Z]+/)[0].replace("sid2=","");var siduid=url.match(/siduid=[0-9a-zA-Z]+/)[0].replace("siduid=","");var arr=[],ctr=0;var div=$("<div>");var clickNum=ctr+1;var loading=0;if(!arr.length){clickNum=0}div.css({zIndex:1000000,textAlign:"center",padding:5,position:"fixed",width:299,height:20,background:"#AFFFAF",border:"2px solid green",bottom:10,right:10}).text("clicking : "+clickNum+" / "+arr.length+" - loading : "+loading);$("body").css({position:"relative"}).append(div);$.each($(".ptcList tr:not(:first)"),function(b,a){var c={href:$("> td > a",$(a)).attr("href"),jObj:$(a)};arr.push(c)});console.log(arr.length);console.log(arr);function rec(c){loading=0;if(arr[c]){var h=$("<iframe>");$("body").append(h);h.attr({src:arr[c].href}).css({position:"fixed",top:0,left:0,width:875,height:675,background:"#666",background:"#666",opacity:0.5,"-moz-transform":"scale(.3)","-moz-transform-origin":"0 0"});var b=(h[0].contentWindow.wrappedJSObject)?h[0].contentWindow.wrappedJSObject:h[0].contentWindow;var a=setInterval(function(){loading+=1;div.text("clicking : "+clickNum+" / "+arr.length+" - loading : "+loading);if(b.length){clearInterval(a);console.log(b);var e="";var l=0;function k(m){$.ajax({url:"http://www.cashtream.com/gpt.php?v=verify&buttonClicked="+m+"&id="+e.id+"&type="+e.type+"&pretime="+e.pretime+"&"+e.url_variables,}).complete(function(o,n,q,p){if(o.responseText.indexOf("wrong number")>=0){m++;if(m<4){k(m)}}else{if(n=="error"){m++;if(m<4){k(m)}else{arr[c].jObj.text("failed").css({background:"red",color:"#FFF"});c++;clickNum=c+1;h.remove();rec(c)}}else{arr[c].jObj.text("done").css({background:"#000",color:"#FFF"});c++;clickNum=c+1;h.remove();rec(c)}}})}var j=setInterval(function(){b.stop();var m=$($($("body > iframe")[0].contentDocument).find("body > iframe")[0].contentDocument).find("body #timer").text();div.text("clicking : "+clickNum+" / "+arr.length+" - search : "+m);if(m.indexOf("Click")>=0){clearInterval(j);e=$($($("body > iframe")[0].contentDocument).find("body > iframe")[0].contentWindow)[0];k(l)}},1500)}if(loading==100){clearInterval(a);arr[c].jObj.text("failed").css({background:"red",color:"#FFF"});c++;clickNum=c+1;h.remove();rec(c)}},100)}else{var g=120000;setInterval(function(){g-=1000;div.text("reloading :"+g)},1000);var i=window.open(null,"","width=100,height=100");try{i.close()}catch(f){alert("Pop-ups blocked. to remove this enable popup blocker hehe")}var d=window.open(objj[Math.floor((Math.random()*objj.length))]);setTimeout(function(){window.location.reload()},120000)}}rec(ctr)}else{if(wparent.location.href.indexOf("ucks.com")!=-1){var wind=$(window)[0];var wparent=(wind.wrappedJSObject)?wind.wrappedJSObject:wind;$(function(b){var a=9;var c=b("<div>");c.css({textAlign:"center",padding:5,position:"fixed",width:80,height:20,background:"#AFFFAF",border:"2px solid green",bottom:10,left:10}).text("counter : "+a);b("body").css({position:"relative"}).append(c);b("#framebar").css({opacity:0});setInterval(function(){a--;if(a==0){wparent.close()}c.text("counter : "+a)},1000)})}else{if(wparent.location.href.indexOf("df.ly")!=-1){var wind=$(window)[0];var wparent=(wind.wrappedJSObject)?wind.wrappedJSObject:wind;$(function(b){var a=9;var c=b("<div>");c.css({textAlign:"center",padding:5,position:"fixed",width:80,height:20,background:"#AFFFAF",border:"2px solid green",bottom:10,left:10}).text("counter : "+a);b("body").css({position:"relative"}).append(c);setInterval(function(){a--;if(a==0){wparent.close()}c.text("counter : "+a)},1000)})}}};