// ==UserScript==
// @name           SoundCloud Downloader 4 Pirates
// @author         Piratezzz
// @include        http://soundcloud.com/*
// @include        http://*.soundcloud.com/*
// ==/UserScript==

function init_scuserscript(){function c(a){return(a/1e3*128/8/1e3).toFixed(2)}var a=document.getElementsByTagName("head")[0];var b=document.createElement("style");b.innerHTML='.mydownload {padding-top: 5px;padding-right: 8px;padding-bottom: 5px;padding-left: 20px;white-space: nowrap;font-size: 10px;line-height: 21px;color: #333333;border-right-color: #cccccc;border-right-width: 1px;border-right-style: solid;background-image: url("http://a1.soundcloud.com/images/icons_mini.png?taylor16");background-repeat: no-repeat;background-position: -76px -236px;} .mydownload:hover {color: #0066cc;background-position: -76px -256px;}';a.appendChild(b);players=document.getElementsByClassName("player");actionbars=document.getElementsByClassName("actions");tracks=window.SC.clientDB.getTracks();for(var d in actionbars){if(actionbars[d].className=="actions"){if(actionbars[d].parentNode.nodeName=="DIV"){trackid=actionbars[d].parentNode.parentNode.getAttribute("data-sc-track");track=tracks[trackid];if(typeof track!="undefined"){if(window.$(actionbars[d]).find(".primary .download").length!=0){if(window.$(actionbars[d]).find(".primary .download.disabled").length!=0){window.$(actionbars[d]).find(".primary .download.disabled").remove();window.$(actionbars[d]).find(".primary").append('<a title="Grootte: '+c(track.duration)+' MB" class="mydownload" href="'+track.streamUrl+'"><span>Downloadknop voor piraten</span></a>');window.$(".pl-button").unbind();window.$(".download").unbind()}}else{window.$(actionbars[d]).find(".primary").append('<a title="Grootte: '+c(track.duration)+' MB" class="mydownload" href="'+track.streamUrl+'"><span>Downloadknop voor piraten</span></a>')}}}if(actionbars[d].parentNode.nodeName=="LI"){trackid=actionbars[d].parentNode.getAttribute("data-sc-track");track=tracks[trackid];if(typeof track!="undefined"){item=window.$(actionbars[d]);if(item.find(".download").length==0)item.prepend('<a title="Download '+item.parent().find(".info a").text()+'" class="download pl-button" href="'+track.streamUrl+'">Downloadknop voor piraten '+item.parent().find(".info a").text()+"</a>")}}}}window.$(window.document).bind("clientDbTracksUpdated",function(a){db=window.SC.clientDB.getTracks();for(var b in db){item=window.$("li[data-sc-track="+b+"]");if(item.find(".download").length==0)item.find(".actions").prepend('<a title="Download '+item.find(".info a").text()+'" class="download pl-button" href="'+db[b].streamUrl+'">Downloadknop voor piraten '+item.find(".info a").text()+"</a>")}})}

var script = document.createElement("script");
script.setAttribute('type', 'text/javascript');
script.innerHTML = init_scuserscript.toString()+"\ninit_scuserscript()";
document.getElementsByTagName('head')[0].appendChild(script);