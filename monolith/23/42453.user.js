// ==UserScript==
// @name           Link Fixer
// @namespace      Porn
// @description    Fixes TGP links to what they should be, so no 1 in 10 going where you want them to.
// @include       http://*3some*.*
// @include       http://*.*/*3some*
// @include       http://*4some*.*
// @include       http://*.*/*4some*
// @include       http://*69*.*
// @include       http://*.*/*69*
// @include       http://*anime*.*
// @include       http://*.*/*anime*
// @include       http://*adult*.*
// @include       http://*.*/*adult*
// @include       http://*amateur*.*
// @include       http://*.*/*amateur*
// @include       http://*amatuer*.*
// @include       http://*.*/*amateur*
// @include       http://*anal*.*
// @include       http://*.*/*anal*
// @include       http://*anus*.*
// @include       http://*.*/*anus*
// @include       http://ass*.*
// @include       http://*.*/ass*
// @include       http://*babe*.*
// @include       http://*.*/*babe*
// @include       http://*backdoor*.*
// @include       http://*.*/*backdoor*
// @include       http://*banging*.*
// @include       http://*.*/*banging*
// @include       http://*barely-legal*.*
// @include       http://*.*/*barely-legal*
// @include       http://*barelylegal*.*
// @include       http://*.*/*barelylegal*
// @include       http://*bbw*.*
// @include       http://*.*/*bbw*
// @include       http://*bdsm*.*
// @include       http://*.*/*bdsm*
// @include       http://*beastial*.*
// @include       http://*.*/*beastial*
// @include       http://*bendover*.*
// @include       http://*.*/*bendover*
// @include       http://*bend-over*.*
// @include       http://*.*/*bend-over*
// @include       http://*bestial*.*
// @include       http://*.*/*bestial*
// @include       http://*bikini*.*
// @include       http://*.*/*bikini*
// @include       http://*bisex*.*
// @include       http://*.*/*bisex*
// @include       http://*blonde*.*
// @include       http://*.*/*blonde*
// @include       http://*blowjob*.*
// @include       http://*.*/*blowjob*
// @include       http://*bondage*.*
// @include       http://*.*/*bondage*
// @include       http://*boner*.*
// @include       http://*.*/*boner*
// @include       http://*boobs*.*
// @include       http://*.*/*boobs*
// @include       http://*booty*.*
// @include       http://*.*/*booty*
// @include       http://*bukkake*.*
// @include       http://*.*/*bukkake*
// @include       http://*busty*.*
// @include       http://*.*/*busty*
// @include       http://*butt*.*
// @include       http://*.*/*butt*
// @include       http://*cameltoe*.*
// @include       http://*.*/*cameltoe*
// @include       http://*CBT*.*
// @include       http://*.*/*CBT*
// @include       http://*celeb*.*
// @include       http://*.*/*celeb*
// @include       http://*centerfold*.*
// @include       http://*.*/*centerfold*
// @include       http://*CFNM*.*
// @include       http://*.*/*CFNM*
// @include       http://*cheerleader*.*
// @include       http://*.*/*cheerleader*
// @include       http://*clit*.*
// @include       http://*.*/*clit*
// @include       http://*cock*.*
// @include       http://*.*/*cock*
// @include       http://*collegehumor*.*
// @include       http://*.*/*collegehumor*
// @include       http://*coeds*.*
// @include       http://*.*/*coeds*
// @include       http://*creampie*.*
// @include       http://*.*/*creampie*
// @include       http://*crotchless*.*
// @include       http://*.*/*crotchless*
// @include       http://*cum*.*
// @include       http://*.*/*cum*
// @include       http://*cunt*.*
// @include       http://*.*/*cunt*
// @include       http://*deepthroat*.*
// @include       http://*.*/*deepthroat*
// @include       http://*deep-throat*.*
// @include       http://*.*/*deep-throat*
// @include       http://*dick*.*
// @include       http://*.*/*dick*
// @include       http://*dildo*.*
// @include       http://*.*/*dildo*
// @include       http://*doggystyle*.*
// @include       http://*.*/*doggystyle*
// @include       http://*doggy-style*.*
// @include       http://*.*/*doggy-style*
// @include       http://*domination*.*
// @include       http://*.*/*domination*
// @include       http://*dominatrix*.*
// @include       http://*.*/*dominatrix*
// @include       http://*DP*.*
// @include       http://*.*/*DP*
// @include       http://*dyke*.*
// @include       http://*.*/*dyke*
// @include       http://*ejacula*.*
// @include       http://*.*/*ejacula*
// @include       http://*erection*.*
// @include       http://*.*/*erection*
// @include       http://*eros*.*
// @include       http://*.*/*eros*
// @include       http://*eroti*.*
// @include       http://*.*/*eroti*
// @include       http://*escort*.*
// @include       http://*.*/*escort*
// @include       http://*explicit*.*
// @include       http://*.*/*explicit*
// @include       http://*exposed*.*
// @include       http://*.*/*exposed*
// @include       http://*facefuck*.*
// @include       http://*.*/*facefuck*
// @include       http://*facesitting*.*
// @include       http://*.*/*facesitting*
// @include       http://*facial*.*
// @include       http://*.*/*facial*
// @include       http://*fellatio*.*
// @include       http://*.*/*fellatio*
// @include       http://*femdom*.*
// @include       http://*.*/*femdom*
// @include       http://*fetish*.*
// @include       http://*.*/*fetish*
// @include       http://*FFM*.*
// @include       http://*.*/*FFM*
// @include       http://*fingering*.*
// @include       http://*.*/*fingering*
// @include       http://*fisting*.*
// @include       http://*.*/*fisting*
// @include       http://*flesh*.*
// @include       http://*.*/*flesh*
// @include       http://*footjob*.*
// @include       http://*.*/*footjob*
// @include       http://*foreplay*.*
// @include       http://*.*/*foreplay*
// @include       http://*foursome*.*
// @include       http://*.*/*foursome*
// @include       http://*fuck*.*
// @include       http://*.*/*fuck*
// @include       http://*gang-bang*.*
// @include       http://*.*/*gang-bang*
// @include       http://*gangbang*.*
// @include       http://*.*/*gangbang*
// @include       http://*gay*.*
// @include       http://*.*/*gay*
// @include       http://*gloryhole*.*
// @include       http://*.*/*gloryhole*
// @include       http://*glory-hole*.*
// @include       http://*.*/*glory-hole*
// @include       http://*goldenshower*.*
// @include       http://*.*/*goldenshower*
// @include       http://*golden-shower*.*
// @include       http://*.*/*golden-shower*
// @include       http://*handjob*.*
// @include       http://*.*/*handjob*
// @include       http://*hand-job*.*
// @include       http://*.*/*hand-job*
// @include       http://*hardcore*.*
// @include       http://*.*/*hardcore*
// @include       http://*hard-core*.*
// @include       http://*.*/*hard-core*
// @include       http://*hardon*.*
// @include       http://*.*/*hardon*
// @include       http://*hard-on*.*
// @include       http://*.*/*hard-on*
// @include       http://*hentai*.*
// @include       http://*.*/*hentai*
// @include       http://*hiddencam*.*
// @include       http://*.*/*hiddencam*
// @include       http://*hidden-cam*.*
// @include       http://*.*/*hidden-cam*
// @include       http://*hogtied*.*
// @include       http://*.*/*hogtied*
// @include       http://*hooker*.*
// @include       http://*.*/*hooker*
// @include       http://*horny*.*
// @include       http://*.*/*horny*
// @include       http://*horney*.*
// @include       http://*.*/*horney*
// @include       http://*hottie*.*
// @include       http://*.*/*hottie*
// @include       http://*hotty*.*
// @include       http://*.*/*hotty*
// @include       http://*hustler*.*
// @include       http://*.*/*hustler*
// @include       http://*incest*.*
// @include       http://*.*/*incest*
// @include       http://*interacial*.*
// @include       http://*.*/*interacial*
// @include       http://*interracial*.*
// @include       http://*.*/*interracial*
// @include       http://*intercourse*.*
// @include       http://*.*/*intercourse*
// @include       http://*jackoff*.*
// @include       http://*.*/*jackoff*
// @include       http://*jack-off*.*
// @include       http://*.*/*jack-off*
// @include       http://*jerking*.*
// @include       http://*.*/*jerking*
// @include       http://*jizz*.*
// @include       http://*.*/*jizz*
// @include       http://*juggs*.*
// @include       http://*.*/*juggs*
// @include       http://*kink*.*
// @include       http://*.*/*kink*
// @include       http://*knocker*.*
// @include       http://*.*/*knocker*
// @include       http://*ladyboy*.*
// @include       http://*.*/*ladyboy*
// @include       http://*lapdanc*.*
// @include       http://*.*/*lapdanc*
// @include       http://*latex*.*
// @include       http://*.*/*latex*
// @include       http://*lesbi*.*
// @include       http://*.*/*lesbi*
// @include       http://*lesbo*.*
// @include       http://*.*/*lesbo*
// @include       http://*lezdom*.*
// @include       http://*.*/*lezdom*
// @include       http://*licking*.*
// @include       http://*.*/*licking*
// @include       http://*lingerie*.*
// @include       http://*.*/*lingerie*
// @include       http://*livecam*.*
// @include       http://*.*/*livecam*
// @include       http://*live-cam*.*
// @include       http://*.*/*live-cam*
// @include       http://*lolita*.*
// @include       http://*.*/*lolita*
// @include       http://*maledom*.*
// @include       http://*.*/*maledom*
// @include       http://*masterba*.*
// @include       http://*.*/*masterba*
// @include       http://*masturba*.*
// @include       http://*.*/*masturba*
// @include       http://*mature*.*
// @include       http://*.*/*mature*
// @include       http://*meninpain*.*
// @include       http://*.*/*meninpain*
// @include       http://*milf*.*
// @include       http://*.*/*milf*
// @include       http://*MILF*.*
// @include       http://*.*/*MILF*
// @include       http://*mistress*.*
// @include       http://*.*/*mistress*
// @include       http://*MMF*.*
// @include       http://*.*/*MMF*
// @include       http://*mouthful*.*
// @include       http://*.*/*mouthful*
// @include       http://*muff*.*
// @include       http://*.*/*muff*
// @include       http://*naked*.*
// @include       http://*.*/*naked*
// @include       http://*nipple*.*
// @include       http://*.*/*nipple*
// @include       http://*nookie*.*
// @include       http://*.*/*nookie*
// @include       http://*nooky*.*
// @include       http://*.*/*nooky*
// @include       http://*nude*.*
// @include       http://*.*/*nude*
// @include       http://*nude*.*
// @include       http://*.*/*nude*
// @include       http://*nudie*.*
// @include       http://*.*/*nudie*
// @include       http://*nudis*.*
// @include       http://*.*/*nudis*
// @include       http://*oral*.*
// @include       http://*.*/*oral*
// @include       http://*orgasm*.*
// @include       http://*.*/*orgasm*
// @include       http://*orgy*.*
// @include       http://*.*/*orgy*
// @include       http://*p0rn*.*
// @include       http://*.*/*p0rn*
// @include       http://*pantie*.*
// @include       http://*.*/*pantie*
// @include       http://*panty*.*
// @include       http://*.*/*panty*
// @include       http://*pecker*.*
// @include       http://*.*/*pecker*
// @include       http://*pee*.*
// @include       http://*.*/*pee*
// @include       http://*penetration*.*
// @include       http://*.*/*penetration*
// @include       http://*penile*.*
// @include       http://*.*/*penile*
// @include       http://*penis*.*
// @include       http://*.*/*penis*
// @include       http://*penthouse*.*
// @include       http://*.*/*penthouse*
// @include       http://*pent-house*.*
// @include       http://*.*/*pent-house*
// @include       http://*pervert*.*
// @include       http://*.*/*pervert*
// @include       http://*petite*.*
// @include       http://*.*/*petite*
// @include       http://*piss*.*
// @include       http://*.*/*piss*
// @include       http://*playboy*.*
// @include       http://*.*/*playboy*
// @include       http://*play-boy*.*
// @include       http://*.*/*play-boy*
// @include       http://*playmate*.*
// @include       http://*.*/*playmate*
// @include       http://*pleasure*.*
// @include       http://*.*/*pleasure*
// @include       http://*plumper*.*
// @include       http://*.*/*plumper*
// @include       http://*porn*.*
// @include       http://*.*/*porn*
// @include       http://*pron*.*
// @include       http://*.*/*pron*
// @include       http://*pr0n*.*
// @include       http://*.*/*pr0n*
// @include       http://*prostit*.*
// @include       http://*.*/*prostit*
// @include       http://*pubic*.*
// @include       http://*.*/*pubic*
// @include       http://*puss*.*
// @include       http://*.*/*puss*
// @include       http://*rape*.*
// @include       http://*.*/*rape*
// @include       http://*rectal*.*
// @include       http://*.*/*rectal*
// @include       http://*redhead*.*
// @include       http://*.*/*redhead*
// @include       http://*richardsrealm*.*
// @include       http://*.*/*richardsrealm*
// @include       http://*richards-realm*.*
// @include       http://*.*/*richards-realm*
// @include       http://*rimjob*.*
// @include       http://*.*/*rimjob*
// @include       http://*sex*.*
// @include       http://*.*/*sex*
// @include       http://*shemale*.*
// @include       http://*.*/*shemale*
// @include       http://*she-male*.*
// @include       http://*.*/*she-male*
// @include       http://*slut*.*
// @include       http://*.*/*slut*
// @include       http://*smut*.*
// @include       http://*.*/*smut*
// @include       http://*sodom*.*
// @include       http://*.*/*sodom*
// @include       http://*softcore*.*
// @include       http://*.*/*softcore*
// @include       http://*soft-core*.*
// @include       http://*.*/*soft-core*
// @include       http://*sologirl*.*
// @include       http://*.*/*sologirl*
// @include       http://*spank*.*
// @include       http://*.*/*spank*
// @include       http://*speculum*.*
// @include       http://*.*/*speculum*
// @include       http://*sperm*.*
// @include       http://*.*/*sperm*
// @include       http://*spunk*.*
// @include       http://*.*/*spunk*
// @include       http://*strapon*.*
// @include       http://*.*/*strapon*
// @include       http://*strap-on*.*
// @include       http://*.*/*strap-on*
// @include       http://*stripper*.*
// @include       http://*.*/*stripper*
// @include       http://*suck*.*
// @include       http://*.*/*suck*
// @include       http://*swinger*.*
// @include       http://*.*/*swinger*
// @include       http://*swinging*.*
// @include       http://*.*/*swinging*
// @include       http://*sybian*.*
// @include       http://*.*/*sybian*
// @include       http://*taboo*.*
// @include       http://*.*/*taboo*
// @include       http://*teen*.*
// @include       http://*.*/*teen*
// @include       http://*tgirl*.*
// @include       http://*.*/*tgirl*
// @include       http://*tgp*.*
// @include       http://*.*/*tgp*
// @include       http://*thong*.*
// @include       http://*.*/*thong*
// @include       http://*threesome*.*
// @include       http://*.*/*threesome*
// @include       http://*tiava*.*
// @include       http://*.*/*tiava*
// @include       http://*tits*.*
// @include       http://*.*/*tits*
// @include       http://*tittyfuck*.*
// @include       http://*.*/*tittyfuck*
// @include       http://*topless*.*
// @include       http://*.*/*topless*
// @include       http://*torture*.*
// @include       http://*.*/*torture*
// @include       http://*trampling*.*
// @include       http://*.*/*trampling*
// @include       http://*trannie*.*
// @include       http://*.*/*trannie*
// @include       http://*tranny*.*
// @include       http://*.*/*tranny*
// @include       http://*twat*.*
// @include       http://*.*/*twat*
// @include       http://*twink*.*
// @include       http://*.*/*twink*
// @include       http://*twistys*.*
// @include       http://*.*/*twistys*
// @include       http://*uncensored*.*
// @include       http://*.*/*uncensored*
// @include       http://*upskirt*.*
// @include       http://*.*/*upskirt*
// @include       http://*vagina*.*
// @include       http://*.*/*vagina*
// @include       http://*vibrator*.*
// @include       http://*.*/*vibrator*
// @include       http://*virgin*.*
// @include       http://*.*/*virgin*
// @include       http://*voyeur*.*
// @include       http://*.*/*voyeur*
// @include       http://*warez*.*
// @include       http://*.*/*warez*
// @include       http://*waterbondage*.*
// @include       http://*.*/*waterbondage*
// @include       http://*water-bondage*.*
// @include       http://*.*/*water-bondage*
// @include       http://*watersport*.*
// @include       http://*.*/*watersport*
// @include       http://*water-sport*.*
// @include       http://*.*/*water-sport*
// @include       http://*web-cam*.*
// @include       http://*.*/*web-cam*
// @include       http://*webcam*.*
// @include       http://*.*/*webcam*
// @include       http://*whippedass*.*
// @include       http://*.*/*whippedass*
// @include       http://*whore*.*
// @include       http://*.*/*whore*
// @include       http://*wiredpussy*.*
// @include       http://*.*/*wiredpussy*
// @include       http://*xxx*.*
// @include       http://*.*/*xxx*
// @include       http://*xrated*.*
// @include       http://*.*/*xrated*
// @include       http://*x-rated*.*
// @include       http://*.*/*x-rated*
// ==/UserScript==
// @version 1.0.0




if (!GM_xmlhttpRequest) {
    alert('Please upgrade to the latest version of Greasemonkey.');
    return;
} else {
	GM_registerMenuCommand( GM_getValue("targetScriptName", "link fixer") + " - Manual Update Check", function() {updateCheck(true);});

}


function updateCheck(forced)
{
	if ((forced) || (parseInt(GM_getValue("lastUpdate", "0")) + 86400000 <= (new Date().getTime()))) // Checks once a day (24 h * 60 m * 60 s * 1000 ms)
	{
		try
		{
			GM_xmlhttpRequest(
			{
				method: "GET",
				url: "http://userscripts.org/scripts/review/42453",
				headers: {'Cache-Control': 'no-cache'},
				onload: function(result)
				{
					GM_setValue("lastUpdate", new Date().getTime() + "");
					if (result.responseText.indexOf('@version 1.0.0') == -1)
					{
						if (confirm("There is an update available for the Greasemonkey script \"Link Fixer\".\nWould you like to go to the install page now?"))
							{GM_openInTab("http://userscripts.org/scripts/source/42453.user.js");}
					}
					else if (forced)
						{alert("No update is available for \"Link Fixer\".\"");}
				}
			});
		}
		catch (err)
		{
			if (forced)
				{alert("An error occurred while checking for updates:\n" + err);}
		}
	}
}

var hexv = {
  "00":0,"01":1,"02":2,"03":3,"04":4,"05":5,"06":6,"07":7,"08":8,"09":9,"0A":10,"0B":11,"0C":12,"0D":13,"0E":14,"0F":15,
  "10":16,"11":17,"12":18,"13":19,"14":20,"15":21,"16":22,"17":23,"18":24,"19":25,"1A":26,"1B":27,"1C":28,"1D":29,"1E":30,"1F":31,
  "20":32,"21":33,"22":34,"23":35,"24":36,"25":37,"26":38,"27":39,"28":40,"29":41,"2A":42,"2B":43,"2C":44,"2D":45,"2E":46,"2F":47,
  "30":48,"31":49,"32":50,"33":51,"34":52,"35":53,"36":54,"37":55,"38":56,"39":57,"3A":58,"3B":59,"3C":60,"3D":61,"3E":62,"3F":63,
  "40":64,"41":65,"42":66,"43":67,"44":68,"45":69,"46":70,"47":71,"48":72,"49":73,"4A":74,"4B":75,"4C":76,"4D":77,"4E":78,"4F":79,
  "50":80,"51":81,"52":82,"53":83,"54":84,"55":85,"56":86,"57":87,"58":88,"59":89,"5A":90,"5B":91,"5C":92,"5D":93,"5E":94,"5F":95,
  "60":96,"61":97,"62":98,"63":99,"64":100,"65":101,"66":102,"67":103,"68":104,"69":105,"6A":106,"6B":107,"6C":108,"6D":109,"6E":110,"6F":111,
  "70":112,"71":113,"72":114,"73":115,"74":116,"75":117,"76":118,"77":119,"78":120,"79":121,"7A":122,"7B":123,"7C":124,"7D":125,"7E":126,"7F":127,
  "80":128,"81":129,"82":130,"83":131,"84":132,"85":133,"86":134,"87":135,"88":136,"89":137,"8A":138,"8B":139,"8C":140,"8D":141,"8E":142,"8F":143,
  "90":144,"91":145,"92":146,"93":147,"94":148,"95":149,"96":150,"97":151,"98":152,"99":153,"9A":154,"9B":155,"9C":156,"9D":157,"9E":158,"9F":159,
  "A0":160,"A1":161,"A2":162,"A3":163,"A4":164,"A5":165,"A6":166,"A7":167,"A8":168,"A9":169,"AA":170,"AB":171,"AC":172,"AD":173,"AE":174,"AF":175,
  "B0":176,"B1":177,"B2":178,"B3":179,"B4":180,"B5":181,"B6":182,"B7":183,"B8":184,"B9":185,"BA":186,"BB":187,"BC":188,"BD":189,"BE":190,"BF":191,
  "C0":192,"C1":193,"C2":194,"C3":195,"C4":196,"C5":197,"C6":198,"C7":199,"C8":200,"C9":201,"CA":202,"CB":203,"CC":204,"CD":205,"CE":206,"CF":207,
  "D0":208,"D1":209,"D2":210,"D3":211,"D4":212,"D5":213,"D6":214,"D7":215,"D8":216,"D9":217,"DA":218,"DB":219,"DC":220,"DD":221,"DE":222,"DF":223,
  "E0":224,"E1":225,"E2":226,"E3":227,"E4":228,"E5":229,"E6":230,"E7":231,"E8":232,"E9":233,"EA":234,"EB":235,"EC":236,"ED":237,"EE":238,"EF":239,
  "F0":240,"F1":241,"F2":242,"F3":243,"F4":244,"F5":245,"F6":246,"F7":247,"F8":248,"F9":249,"FA":250,"FB":251,"FC":252,"FD":253,"FE":254,"FF":255
};

var END_OF_INPUT = -1;

var base64Chars = new Array(
    'A','B','C','D','E','F','G','H',
    'I','J','K','L','M','N','O','P',
    'Q','R','S','T','U','V','W','X',
    'Y','Z','a','b','c','d','e','f',
    'g','h','i','j','k','l','m','n',
    'o','p','q','r','s','t','u','v',
    'w','x','y','z','0','1','2','3',
    '4','5','6','7','8','9','+','/'
);

var reverseBase64Chars = new Array();
for (var i=0; i < base64Chars.length; i++){
    reverseBase64Chars[base64Chars[i]] = i;
}

var base64Str;
var base64Count;
function setBase64Str(str){
    base64Str = str;
    base64Count = 0;
}

function readBase64(){    
    if (!base64Str) return END_OF_INPUT;
    if (base64Count >= base64Str.length) return END_OF_INPUT;
    var c = base64Str.charCodeAt(base64Count) & 0xff;
    base64Count++;
    return c;
}

function encodeBase64(str){
    setBase64Str(str);
    var result = '';
    var inBuffer = new Array(3);
    var lineCount = 0;
    var done = false;
    while (!done && (inBuffer[0] = readBase64()) != END_OF_INPUT){
        inBuffer[1] = readBase64();
        inBuffer[2] = readBase64();
        result += (base64Chars[ inBuffer[0] >> 2 ]);
        if (inBuffer[1] != END_OF_INPUT){
            result += (base64Chars [(( inBuffer[0] << 4 ) & 0x30) | (inBuffer[1] >> 4) ]);
            if (inBuffer[2] != END_OF_INPUT){
                result += (base64Chars [((inBuffer[1] << 2) & 0x3c) | (inBuffer[2] >> 6) ]);
                result += (base64Chars [inBuffer[2] & 0x3F]);
            } else {
                result += (base64Chars [((inBuffer[1] << 2) & 0x3c)]);
                result += ('=');
                done = true;
            }
        } else {
            result += (base64Chars [(( inBuffer[0] << 4 ) & 0x30)]);
            result += ('=');
            result += ('=');
            done = true;
        }
        lineCount += 4;
        if (lineCount >= 76){
            result += ('\n');
            lineCount = 0;
        }
    }
    return result;
}

function readReverseBase64(){   
    if (!base64Str) return END_OF_INPUT;
    while (true){      
        if (base64Count >= base64Str.length) return END_OF_INPUT;
        var nextCharacter = base64Str.charAt(base64Count);
        base64Count++;
        if (reverseBase64Chars[nextCharacter]){
            return reverseBase64Chars[nextCharacter];
        }
        if (nextCharacter == 'A') return 0;
    }
    return END_OF_INPUT;
}

function ntos(n){
    n=n.toString(16);
    if (n.length == 1) n="0"+n;
    n="%"+n;
    return unescape(n);
}

function decodeBase64(str){
    setBase64Str(str);
    var result = "";
    var inBuffer = new Array(4);
    var done = false;
    while (!done && (inBuffer[0] = readReverseBase64()) != END_OF_INPUT
        && (inBuffer[1] = readReverseBase64()) != END_OF_INPUT){
        inBuffer[2] = readReverseBase64();
        inBuffer[3] = readReverseBase64();
        result += ntos((((inBuffer[0] << 2) & 0xff)| inBuffer[1] >> 4));
        if (inBuffer[2] != END_OF_INPUT){
            result +=  ntos((((inBuffer[1] << 4) & 0xff)| inBuffer[2] >> 2));
            if (inBuffer[3] != END_OF_INPUT){
                result +=  ntos((((inBuffer[2] << 6)  & 0xff) | inBuffer[3]));
            } else {
                done = true;
            }
        } else {
            done = true;
        }
    }
    return result;
}

var digitArray = new Array('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f');
function toHex(n){
    var result = ''
    var start = true;
    for (var i=32; i>0;){
        i-=4;
        var digit = (n>>i) & 0xf;
        if (!start || digit != 0){
            start = false;
            result += digitArray[digit];
        }
    }
    return (result==''?'0':result);
}

function pad(str, len, pad){
    var result = str;
    for (var i=str.length; i<len; i++){
        result = pad + result;
    }
    return result;
}

function encodeHex(str){
    var result = "";
    for (var i=0; i<str.length; i++){
        result += pad(toHex(str.charCodeAt(i)&0xff),2,'0');
    }
    return result;
}

function decodeHex(str){
    str = str.toUpperCase().replace(new RegExp("s/[^0-9A-Z]//g"));
    var result = "";
    var nextchar = "";
    for (var i=0; i<str.length; i++){
        nextchar += str.charAt(i);
        if (nextchar.length == 2){
            result += ntos(hexv[nextchar]);
            nextchar = "";
        }
    }
    return result;
    
}

function urlDecode(str){
    str=str.replace(new RegExp('\\+','g'),' ');
    return unescape(str);
}
function urlEncode(str){
    str=escape(str);
    str=str.replace(new RegExp('\\+','g'),'%2B');
    return str.replace(new RegExp('%20','g'),'+');
}

function contAfterQuest( url )
{	
	var temp = url.split('?');
	var newTMPURL=""
	for( ques = 1 ; ques < temp.length ; ques ++)
	{
		if( ques == 1)
		newTMPURL = temp[ques];
		else
		newTMPURL = newTMPURL + "?" + temp[ques];
	}

	return newTMPURL;
}

function longestvar( url )
{
	var temp = url.split('&');
	var longest = temp[0];
	for (x=1;x<temp.length;x++)
	{
		if (temp[x].length > longest.length)
		longest = temp[x];
	} 
	return longest;
}

function tilde( url )
{
	var temp = urlDecode(url).split('~');
	var longest = temp[0];
	for (x=1;x<temp.length;x++)
	{
		if (temp[x].length > longest.length)
		longest = temp[x];
	} 
	return decodeBase64(longest);

}


function equalSRemove( url )
{
	var temp = urlDecode(url).split('=');
	var longest = temp[0];
	for (x=1;x<temp.length;x++)
	{
		if (temp[x].length > longest.length)
		longest = temp[x];
	}
	if(longest.indexOf(".")  >= 0 )
	return longest;
	else
	return decodeBase64(longest);
}

function natsClean( url )
{
	var temp = urlDecode(url).split('?nat');
	var longest = temp[0];
	return longest;
}


links = document.body.getElementsByTagName('a');
for( l = 0 ; l < links.length  ; l++)
{
	if(links[l].href.length >= 25)
	{
		newURL = contAfterQuest( links[l].href )
		newURL = longestvar( newURL )
		if( urlDecode(newURL).indexOf("~") >= 0 )
		{
			newURL = urlDecode(tilde(newURL));
		}
		else
		{
			newURL = urlDecode(equalSRemove(newURL));
		}
		if( newURL.indexOf("?nat")  >= 0 )
		newURL = natsClean( newURL );
		if( newURL.indexOf("http")  >= 0 )
		links[l].href = newURL;
	}


}

updateCheck(false);