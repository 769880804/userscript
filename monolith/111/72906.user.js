// ==UserScript==
// @name           Better DS Write Favico
// @namespace      Rhian Hibner
// @description    Fix DS Write interface favicon
// @include        http://write.demandstudios.com/*
// ==/UserScript==


var faviconsrc = 'data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAADr1r8At5R4ALqHVgDRonEA17maALeJXwDavqQA3cSsAL2UcQC6iVgAxqF%2FALqHVQDRonAA%2F%2F%2F%2FAMudbADLm2kAxpZlAO3h1QDz6NsAuohYALqHUwD58%2B0AxqB%2FAOjRuADu5%2BMA0aJuANKibgD48eoAxpZkAN2%2FnwDDpY8AuohXANCjcgDjyrEAzJtnANSpegDGoH4A6dG3AMmhfADSom0Ay6eEAOvWwQC9mnwA7tzJAP78%2BwC6iFYA0KNxANGjcQC7hlMAvZVxAOvWwAD%2B%2Fv0A2rSLAM6ogQD79vIA9vPxAN%2B%2FnQDl1cgA48WlAN3PxgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICAgICAgICAgICAgICAgIC4uLi4uLi4uLi4uLi4uLi4vLy8vLy8vDQovLy8vLy8vLyMKMSgxEA0KLzUKCgUOLwMbDQ0NOwkNFikNDQ0NAQMDDRgmDTsTDRYNDQYXDTsDDA07DA07Hw0WEhIcMg07DAwNOw8NOy0NFgw0EQ0NBwwMDTceDTsCDRY4DQ0zFwwMDCsNNg07Cw0WFQ05NBYIDBkZGRkNOxQNJCwNKgQNOxkaGhoaDTswDSQADQ0NDSEaGhoaGiUdIg0kGjolJToaGhoaGhoaGhoNJBoaGhoaGhonJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%3D';



function trim(str) {
    return str.match(/^\W*(.*?)\W*$/)[1];
}

function remove(node) {
    if (node.parentNode)
        node.parentNode.removeChild(node);
}

var head = document.getElementsByTagName('head')[0];
var lns = head.getElementsByTagName('link');

for (var i = 0; i < lns.length; i++) {
    v = lns[i];
    var relval = trim(v.getAttribute('rel'));
    if (relval == 'shortcut icon' || relval == 'icon')
        remove(v);
}
var newln = document.createElement('link');

newln.setAttribute('rel', 'icon');
newln.setAttribute('href', faviconsrc);
head.appendChild(newln);